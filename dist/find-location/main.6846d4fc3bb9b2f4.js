(self.webpackChunkfind_Location=self.webpackChunkfind_Location||[]).push([[179],{310:(mu,Bs,ta)=>{"use strict";function xn(e){return"function"==typeof e}function lc(e){const n=e(i=>{Error.call(i),i.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const gu=lc(e=>function(n){e(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function y(e,t){if(e){const n=e.indexOf(t);0<=n&&e.splice(n,1)}}class ei{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const l of n)l.remove(this);else n.remove(this);const{initialTeardown:i}=this;if(xn(i))try{i()}catch(l){t=l instanceof gu?l.errors:[l]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const l of r)try{Qi(l)}catch(h){t=t??[],h instanceof gu?t=[...t,...h.errors]:t.push(h)}}if(t)throw new gu(t)}}add(t){var n;if(t&&t!==this)if(this.closed)Qi(t);else{if(t instanceof ei){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}}_hasParent(t){const{_parentage:n}=this;return n===t||Array.isArray(n)&&n.includes(t)}_addParent(t){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t}_removeParent(t){const{_parentage:n}=this;n===t?this._parentage=null:Array.isArray(n)&&y(n,t)}remove(t){const{_finalizers:n}=this;n&&y(n,t),t instanceof ei&&t._removeParent(this)}}ei.EMPTY=(()=>{const e=new ei;return e.closed=!0,e})();const xe=ei.EMPTY;function Xr(e){return e instanceof ei||e&&"closed"in e&&xn(e.remove)&&xn(e.add)&&xn(e.unsubscribe)}function Qi(e){xn(e)?e():e.unsubscribe()}const ht={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},bs={setTimeout(e,t,...n){const{delegate:i}=bs;return i?.setTimeout?i.setTimeout(e,t,...n):setTimeout(e,t,...n)},clearTimeout(e){const{delegate:t}=bs;return(t?.clearTimeout||clearTimeout)(e)},delegate:void 0};function So(e){bs.setTimeout(()=>{const{onUnhandledError:t}=ht;if(!t)throw e;t(e)})}function Us(){}const Ji=xs("C",void 0,void 0);function xs(e,t,n){return{kind:e,value:t,error:n}}let os=null;function ws(e){if(ht.useDeprecatedSynchronousErrorHandling){const t=!os;if(t&&(os={errorThrown:!1,error:null}),e(),t){const{errorThrown:n,error:i}=os;if(os=null,n)throw i}}else e()}class Ue extends ei{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,Xr(t)&&t.add(this)):this.destination=br}static create(t,n,i){return new ln(t,n,i)}next(t){this.isStopped?fi(function bl(e){return xs("N",e,void 0)}(t),this):this._next(t)}error(t){this.isStopped?fi(function bi(e){return xs("E",void 0,e)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?fi(Ji,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const He=Function.prototype.bind;function yt(e,t){return He.call(e,t)}class ot{constructor(t){this.partialObserver=t}next(t){const{partialObserver:n}=this;if(n.next)try{n.next(t)}catch(i){Dt(i)}}error(t){const{partialObserver:n}=this;if(n.error)try{n.error(t)}catch(i){Dt(i)}else Dt(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(n){Dt(n)}}}class ln extends Ue{constructor(t,n,i){let r;if(super(),xn(t)||!t)r={next:t??void 0,error:n??void 0,complete:i??void 0};else{let l;this&&ht.useDeprecatedNextContext?(l=Object.create(t),l.unsubscribe=()=>this.unsubscribe(),r={next:t.next&&yt(t.next,l),error:t.error&&yt(t.error,l),complete:t.complete&&yt(t.complete,l)}):r=t}this.destination=new ot(r)}}function Dt(e){ht.useDeprecatedSynchronousErrorHandling?function $e(e){ht.useDeprecatedSynchronousErrorHandling&&os&&(os.errorThrown=!0,os.error=e)}(e):So(e)}function fi(e,t){const{onStoppedNotification:n}=ht;n&&bs.setTimeout(()=>n(e,t))}const br={closed:!0,next:Us,error:function ki(e){throw e},complete:Us},as="function"==typeof Symbol&&Symbol.observable||"@@observable";function ji(e){return e}function xl(e){return 0===e.length?ji:1===e.length?e[0]:function(n){return e.reduce((i,r)=>r(i),n)}}let pi=(()=>{class e{constructor(n){n&&(this._subscribe=n)}lift(n){const i=new e;return i.source=this,i.operator=n,i}subscribe(n,i,r){const l=function Gn(e){return e&&e instanceof Ue||function ro(e){return e&&xn(e.next)&&xn(e.error)&&xn(e.complete)}(e)&&Xr(e)}(n)?n:new ln(n,i,r);return ws(()=>{const{operator:h,source:f}=this;l.add(h?h.call(l,f):f?this._subscribe(l):this._trySubscribe(l))}),l}_trySubscribe(n){try{return this._subscribe(n)}catch(i){n.error(i)}}forEach(n,i){return new(i=wl(i))((r,l)=>{const h=new ln({next:f=>{try{n(f)}catch(_){l(_),h.unsubscribe()}},error:l,complete:r});this.subscribe(h)})}_subscribe(n){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(n)}[as](){return this}pipe(...n){return xl(n)(this)}toPromise(n){return new(n=wl(n))((i,r)=>{let l;this.subscribe(h=>l=h,h=>r(h),()=>i(l))})}}return e.create=t=>new e(t),e})();function wl(e){var t;return null!==(t=e??ht.Promise)&&void 0!==t?t:Promise}const Yr=lc(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let er=(()=>{class e extends pi{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const i=new Oa(this,this);return i.operator=n,i}_throwIfClosed(){if(this.closed)throw new Yr}next(n){ws(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(n)}})}error(n){ws(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:i}=this;for(;i.length;)i.shift().error(n)}})}complete(){ws(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:i,isStopped:r,observers:l}=this;return i||r?xe:(this.currentObservers=null,l.push(n),new ei(()=>{this.currentObservers=null,y(l,n)}))}_checkFinalizedStatuses(n){const{hasError:i,thrownError:r,isStopped:l}=this;i?n.error(r):l&&n.complete()}asObservable(){const n=new pi;return n.source=this,n}}return e.create=(t,n)=>new Oa(t,n),e})();class Oa extends er{constructor(t,n){super(),this.destination=t,this.source=n}next(t){var n,i;null===(i=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===i||i.call(n,t)}error(t){var n,i;null===(i=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===i||i.call(n,t)}complete(){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===n||n.call(t)}_subscribe(t){var n,i;return null!==(i=null===(n=this.source)||void 0===n?void 0:n.subscribe(t))&&void 0!==i?i:xe}}function Na(e){return xn(e?.lift)}function Wn(e){return t=>{if(Na(t))return t.lift(function(n){try{return e(n,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function kn(e,t,n,i,r){return new Cs(e,t,n,i,r)}class Cs extends Ue{constructor(t,n,i,r,l,h){super(t),this.onFinalize=l,this.shouldUnsubscribe=h,this._next=n?function(f){try{n(f)}catch(_){t.error(_)}}:super._next,this._error=r?function(f){try{r(f)}catch(_){t.error(_)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(f){t.error(f)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function pn(e,t){return Wn((n,i)=>{let r=0;n.subscribe(kn(i,l=>{i.next(e.call(t,l,r++))}))})}function ke(e){return this instanceof ke?(this.v=e,this):new ke(e)}function ra(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,t=e[Symbol.asyncIterator];return t?t.call(e):(e=function js(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(l){n[l]=e[l]&&function(h){return new Promise(function(f,_){!function r(l,h,f,_){Promise.resolve(_).then(function(C){l({value:C,done:f})},h)}(f,_,(h=e[l](h)).done,h.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const q=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function J(e){return xn(e?.then)}function ne(e){return xn(e[as])}function de(e){return Symbol.asyncIterator&&xn(e?.[Symbol.asyncIterator])}function ae(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const ue=function se(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Ce(e){return xn(e?.[ue])}function Se(e){return function $s(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),l=[];return r={},h("next"),h("throw"),h("return"),r[Symbol.asyncIterator]=function(){return this},r;function h(F){i[F]&&(r[F]=function($){return new Promise(function(Q,ee){l.push([F,$,Q,ee])>1||f(F,$)})})}function f(F,$){try{!function _(F){F.value instanceof ke?Promise.resolve(F.value.v).then(C,A):R(l[0][2],F)}(i[F]($))}catch(Q){R(l[0][3],Q)}}function C(F){f("next",F)}function A(F){f("throw",F)}function R(F,$){F($),l.shift(),l.length&&f(l[0][0],l[0][1])}}(this,arguments,function*(){const n=e.getReader();try{for(;;){const{value:i,done:r}=yield ke(n.read());if(r)return yield ke(void 0);yield yield ke(i)}}finally{n.releaseLock()}})}function De(e){return xn(e?.getReader)}function Je(e){if(e instanceof pi)return e;if(null!=e){if(ne(e))return function Ct(e){return new pi(t=>{const n=e[as]();if(xn(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(q(e))return function it(e){return new pi(t=>{for(let n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(J(e))return function gt(e){return new pi(t=>{e.then(n=>{t.closed||(t.next(n),t.complete())},n=>t.error(n)).then(null,So)})}(e);if(de(e))return _n(e);if(Ce(e))return function Pt(e){return new pi(t=>{for(const n of e)if(t.next(n),t.closed)return;t.complete()})}(e);if(De(e))return function Nn(e){return _n(Se(e))}(e)}throw ae(e)}function _n(e){return new pi(t=>{(function hn(e,t){var n,i,r,l;return function On(e,t,n,i){return new(n||(n=Promise))(function(l,h){function f(A){try{C(i.next(A))}catch(R){h(R)}}function _(A){try{C(i.throw(A))}catch(R){h(R)}}function C(A){A.done?l(A.value):function r(l){return l instanceof n?l:new n(function(h){h(l)})}(A.value).then(f,_)}C((i=i.apply(e,t||[])).next())})}(this,void 0,void 0,function*(){try{for(n=ra(e);!(i=yield n.next()).done;)if(t.next(i.value),t.closed)return}catch(h){r={error:h}}finally{try{i&&!i.done&&(l=n.return)&&(yield l.call(n))}finally{if(r)throw r.error}}t.complete()})})(e,t).catch(n=>t.error(n))})}function zt(e,t,n,i=0,r=!1){const l=t.schedule(function(){n(),r?e.add(this.schedule(null,i)):this.unsubscribe()},i);if(e.add(l),!r)return l}function Ut(e,t,n=1/0){return xn(t)?Ut((i,r)=>pn((l,h)=>t(i,l,r,h))(Je(e(i,r))),n):("number"==typeof t&&(n=t),Wn((i,r)=>function xr(e,t,n,i,r,l,h,f){const _=[];let C=0,A=0,R=!1;const F=()=>{R&&!_.length&&!C&&t.complete()},$=ee=>C<i?Q(ee):_.push(ee),Q=ee=>{l&&t.next(ee),C++;let me=!1;Je(n(ee,A++)).subscribe(kn(t,ve=>{r?.(ve),l?$(ve):t.next(ve)},()=>{me=!0},void 0,()=>{if(me)try{for(C--;_.length&&C<i;){const ve=_.shift();h?zt(t,h,()=>Q(ve)):Q(ve)}F()}catch(ve){t.error(ve)}}))};return e.subscribe(kn(t,$,()=>{R=!0,F()})),()=>{f?.()}}(i,r,e,n)))}function ti(e=1/0){return Ut(ji,e)}const Zn=new pi(e=>e.complete());function sa(e){return e[e.length-1]}function gn(e){return function Dl(e){return e&&xn(e.schedule)}(sa(e))?e.pop():void 0}function hc(e,t=0){return Wn((n,i)=>{n.subscribe(kn(i,r=>zt(i,e,()=>i.next(r),t),()=>zt(i,e,()=>i.complete(),t),r=>zt(i,e,()=>i.error(r),t)))})}function ur(e,t=0){return Wn((n,i)=>{i.add(e.schedule(()=>n.subscribe(i),t))})}function dc(e,t){if(!e)throw new Error("Iterable cannot be null");return new pi(n=>{zt(n,t,()=>{const i=e[Symbol.asyncIterator]();zt(n,t,()=>{i.next().then(r=>{r.done?n.complete():n.next(r.value)})},0,!0)})})}function It(e,t){return t?function oi(e,t){if(null!=e){if(ne(e))return function cs(e,t){return Je(e).pipe(ur(t),hc(t))}(e,t);if(q(e))return function Ts(e,t){return new pi(n=>{let i=0;return t.schedule(function(){i===e.length?n.complete():(n.next(e[i++]),n.closed||this.schedule())})})}(e,t);if(J(e))return function Ip(e,t){return Je(e).pipe(ur(t),hc(t))}(e,t);if(de(e))return dc(e,t);if(Ce(e))return function hr(e,t){return new pi(n=>{let i;return zt(n,t,()=>{i=e[ue](),zt(n,t,()=>{let r,l;try{({value:r,done:l}=i.next())}catch(h){return void n.error(h)}l?n.complete():n.next(r)},0,!0)}),()=>xn(i?.return)&&i.return()})}(e,t);if(De(e))return function Il(e,t){return dc(Se(e),t)}(e,t)}throw ae(e)}(e,t):Je(e)}class yn extends er{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const n=super._subscribe(t);return!n.closed&&t.next(this._value),n}getValue(){const{hasError:t,thrownError:n,_value:i}=this;if(t)throw n;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}}function Et(...e){return It(e,gn(e))}function us(e={}){const{connector:t=(()=>new er),resetOnError:n=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=e;return l=>{let h,f,_,C=0,A=!1,R=!1;const F=()=>{f?.unsubscribe(),f=void 0},$=()=>{F(),h=_=void 0,A=R=!1},Q=()=>{const ee=h;$(),ee?.unsubscribe()};return Wn((ee,me)=>{C++,!R&&!A&&F();const ve=_=_??t();me.add(()=>{C--,0===C&&!R&&!A&&(f=fc(Q,r))}),ve.subscribe(me),!h&&C>0&&(h=new ln({next:pe=>ve.next(pe),error:pe=>{R=!0,F(),f=fc($,n,pe),ve.error(pe)},complete:()=>{A=!0,F(),f=fc($,i),ve.complete()}}),Je(ee).subscribe(h))})(l)}}function fc(e,t,...n){if(!0===t)return void e();if(!1===t)return;const i=new ln({next:()=>{i.unsubscribe(),e()}});return Je(t(...n)).subscribe(i)}function tr(e,t){return Wn((n,i)=>{let r=null,l=0,h=!1;const f=()=>h&&!r&&i.complete();n.subscribe(kn(i,_=>{r?.unsubscribe();let C=0;const A=l++;Je(e(_,A)).subscribe(r=kn(i,R=>i.next(t?t(_,R,A,C++):R),()=>{r=null,f()}))},()=>{h=!0,f()}))})}function fh(e,t){return e===t}function wn(e){for(let t in e)if(e[t]===wn)return t;throw Error("Could not find renamed property on target object.")}function Va(e,t){for(const n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function Kn(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(Kn).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function pc(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const mc=wn({__forward_ref__:wn});function yu(e){return e.__forward_ref__=yu,e.toString=function(){return Kn(this())},e}function Ot(e){return gc(e)?e():e}function gc(e){return"function"==typeof e&&e.hasOwnProperty(mc)&&e.__forward_ref__===yu}function yc(e){return e&&!!e.\u0275providers}class Ie extends Error{constructor(t,n){super(function _c(e,t){return`NG0${Math.abs(e)}${t?": "+t:""}`}(t,n)),this.code=t}}function Lt(e){return"string"==typeof e?e:null==e?"":String(e)}function Io(e,t){throw new Ie(-201,!1)}function Nr(e,t){null==e&&function St(e,t,n,i){throw new Error(`ASSERTION ERROR: ${e}`+(null==i?"":` [Expected=> ${n} ${i} ${t} <=Actual]`))}(t,e,null,"!=")}function ft(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function $i(e){return{providers:e.providers||[],imports:e.imports||[]}}function bc(e){return $a(e,xu)||$a(e,Hd)}function $a(e,t){return e.hasOwnProperty(t)?e[t]:null}function bu(e){return e&&(e.hasOwnProperty(_h)||e.hasOwnProperty(Pp))?e[_h]:null}const xu=wn({\u0275prov:wn}),_h=wn({\u0275inj:wn}),Hd=wn({ngInjectableDef:wn}),Pp=wn({ngInjectorDef:wn});var en=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}(en||{});let Al;function Cr(e){const t=Al;return Al=e,t}function Ha(e,t,n){const i=bc(e);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:n&en.Optional?null:void 0!==t?t:void Io(Kn(e))}const Vn=globalThis;class ut{constructor(t,n){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=ft({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Ao={},Cu="__NG_DI_FLAG__",Rl="ngTempTokenPath",Su=/\n/gm,wc="__source";let aa;function Is(e){const t=aa;return aa=e,t}function Ec(e,t=en.Default){if(void 0===aa)throw new Ie(-203,!1);return null===aa?Ha(e,void 0,t):aa.get(e,t&en.Optional?null:void 0,t)}function lt(e,t=en.Default){return(function wu(){return Al}()||Ec)(Ot(e),t)}function tt(e,t=en.Default){return lt(e,Sc(t))}function Sc(e){return typeof e>"u"||"number"==typeof e?e:0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function Ll(e){const t=[];for(let n=0;n<e.length;n++){const i=Ot(e[n]);if(Array.isArray(i)){if(0===i.length)throw new Ie(900,!1);let r,l=en.Default;for(let h=0;h<i.length;h++){const f=i[h],_=Gd(f);"number"==typeof _?-1===_?r=f.token:l|=_:r=f}t.push(lt(r,l))}else t.push(lt(i))}return t}function qa(e,t){return e[Cu]=t,e.prototype[Cu]=t,e}function Gd(e){return e[Cu]}function As(e){return{toString:e}.toString()}var Ga=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(Ga||{}),ds=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}(ds||{});const Cn={},nn=[],dr=wn({\u0275cmp:wn}),la=wn({\u0275dir:wn}),Wa=wn({\u0275pipe:wn}),Dc=wn({\u0275mod:wn}),Fr=wn({\u0275fac:wn}),Mo=wn({__NG_ELEMENT_ID__:wn}),Za=wn({__NG_ENV_ID__:wn});function xh(e,t,n){let i=e.length;for(;;){const r=e.indexOf(t,n);if(-1===r)return r;if(0===r||e.charCodeAt(r-1)<=32){const l=t.length;if(r+l===i||e.charCodeAt(r+l)<=32)return r}n=r+1}}function Du(e,t,n){let i=0;for(;i<n.length;){const r=n[i];if("number"==typeof r){if(0!==r)break;i++;const l=n[i++],h=n[i++],f=n[i++];e.setAttribute(t,h,f,l)}else{const l=r,h=n[++i];Ch(l)?e.setProperty(t,l,h):e.setAttribute(t,l,h),i++}}return i}function wh(e){return 3===e||4===e||6===e}function Ch(e){return 64===e.charCodeAt(0)}function kl(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else{let n=-1;for(let i=0;i<t.length;i++){const r=t[i];"number"==typeof r?n=r:0===n||Ws(e,n,r,null,-1===n||2===n?t[++i]:null)}}return e}function Ws(e,t,n,i,r){let l=0,h=e.length;if(-1===t)h=-1;else for(;l<e.length;){const f=e[l++];if("number"==typeof f){if(f===t){h=-1;break}if(f>t){h=l-1;break}}}for(;l<e.length;){const f=e[l];if("number"==typeof f)break;if(f===n){if(null===i)return void(null!==r&&(e[l+1]=r));if(i===e[l+1])return void(e[l+2]=r)}l++,null!==i&&l++,null!==r&&l++}-1!==h&&(e.splice(h,0,t),l=h+1),e.splice(l++,0,n),null!==i&&e.splice(l++,0,i),null!==r&&e.splice(l++,0,r)}const Ol="ng-template";function fs(e,t,n){let i=0,r=!0;for(;i<e.length;){let l=e[i++];if("string"==typeof l&&r){const h=e[i++];if(n&&"class"===l&&-1!==xh(h.toLowerCase(),t,0))return!0}else{if(1===l){for(;i<e.length&&"string"==typeof(l=e[i++]);)if(l.toLowerCase()===t)return!0;return!1}"number"==typeof l&&(r=!1)}}return!1}function Nl(e){return 4===e.type&&e.value!==Ol}function Zd(e,t,n){return t===(4!==e.type||n?e.value:Ol)}function Kd(e,t,n){let i=4;const r=e.attrs||[],l=function Ro(e){for(let t=0;t<e.length;t++)if(wh(e[t]))return t;return e.length}(r);let h=!1;for(let f=0;f<t.length;f++){const _=t[f];if("number"!=typeof _){if(!h)if(4&i){if(i=2|1&i,""!==_&&!Zd(e,_,n)||""===_&&1===t.length){if(Ms(i))return!1;h=!0}}else{const C=8&i?_:t[++f];if(8&i&&null!==e.attrs){if(!fs(e.attrs,C,n)){if(Ms(i))return!1;h=!0}continue}const R=Po(8&i?"class":_,r,Nl(e),n);if(-1===R){if(Ms(i))return!1;h=!0;continue}if(""!==C){let F;F=R>l?"":r[R+1].toLowerCase();const $=8&i?F:null;if($&&-1!==xh($,C,0)||2&i&&C!==F){if(Ms(i))return!1;h=!0}}}}else{if(!h&&!Ms(i)&&!Ms(_))return!1;if(h&&Ms(_))continue;h=!1,i=_|1&i}}return Ms(i)||h}function Ms(e){return 0==(1&e)}function Po(e,t,n,i){if(null===t)return-1;let r=0;if(i||!n){let l=!1;for(;r<t.length;){const h=t[r];if(h===e)return r;if(3===h||6===h)l=!0;else{if(1===h||2===h){let f=t[++r];for(;"string"==typeof f;)f=t[++r];continue}if(4===h)break;if(0===h){r+=4;continue}}r+=l?1:2}return-1}return function Iu(e,t){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){const i=e[n];if("number"==typeof i)return-1;if(i===t)return n;n++}return-1}(t,e)}function Eh(e,t,n=!1){for(let i=0;i<t.length;i++)if(Kd(e,t[i],n))return!0;return!1}function Lo(e,t){e:for(let n=0;n<t.length;n++){const i=t[n];if(e.length===i.length){for(let r=0;r<e.length;r++)if(e[r]!==i[r])continue e;return!0}}return!1}function lo(e,t){return e?":not("+t.trim()+")":t}function Lp(e){let t=e[0],n=1,i=2,r="",l=!1;for(;n<e.length;){let h=e[n];if("string"==typeof h)if(2&i){const f=e[++n];r+="["+h+(f.length>0?'="'+f+'"':"")+"]"}else 8&i?r+="."+h:4&i&&(r+=" "+h);else""!==r&&!Ms(h)&&(t+=lo(l,r),r=""),i=h,l=l||!Ms(i);n++}return""!==r&&(t+=lo(l,r)),t}function Er(e){return As(()=>{const t=Th(e),n={...t,decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===Ga.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&e.dependencies||null,getStandaloneInjector:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||ds.Emulated,styles:e.styles||nn,_:null,schemas:e.schemas||null,tView:null,id:""};Dh(n);const i=e.dependencies;return n.directiveDefs=Au(i,!1),n.pipeDefs=Au(i,!0),n.id=function Ah(e){let t=0;const n=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,e.consts,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery].join("|");for(const r of n)t=Math.imul(31,t)+r.charCodeAt(0)<<0;return t+=2147483648,"c"+t}(n),n})}function ko(e){return dn(e)||qi(e)}function Ye(e){return null!==e}function nr(e){return As(()=>({type:e.type,bootstrap:e.bootstrap||nn,declarations:e.declarations||nn,imports:e.imports||nn,exports:e.exports||nn,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function Ka(e,t){if(null==e)return Cn;const n={};for(const i in e)if(e.hasOwnProperty(i)){let r=e[i],l=r;Array.isArray(r)&&(l=r[1],r=r[0]),n[r]=i,t&&(t[r]=l)}return n}function Hi(e){return As(()=>{const t=Th(e);return Dh(t),t})}function dn(e){return e[dr]||null}function qi(e){return e[la]||null}function zr(e){return e[Wa]||null}function Qr(e,t){const n=e[Dc]||null;if(!n&&!0===t)throw new Error(`Type ${Kn(e)} does not have '\u0275mod' property.`);return n}function Th(e){const t={};return{type:e.type,providersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputTransforms:null,inputConfig:e.inputs||Cn,exportAs:e.exportAs||null,standalone:!0===e.standalone,signals:!0===e.signals,selectors:e.selectors||nn,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Ka(e.inputs,t),outputs:Ka(e.outputs)}}function Dh(e){e.features?.forEach(t=>t(e))}function Au(e,t){if(!e)return null;const n=t?zr:ko;return()=>("function"==typeof e?e():e).map(i=>n(i)).filter(Ye)}const li=0,Qe=1,bt=2,Dn=3,Br=4,Xa=5,Oi=6,ha=7,xi=8,Ni=9,In=10,kt=11,Ya=12,Mh=13,Qa=14,wi=15,Ic=16,Fi=17,ps=18,rt=19,_t=20,Rs=21,Zs=22,Ja=23,ni=24,tn=25,Mu=1,da=2,En=7,Xs=9,Ii=11;function Sr(e){return Array.isArray(e)&&"object"==typeof e[Mu]}function fr(e){return Array.isArray(e)&&!0===e[Mu]}function fa(e){return 0!=(4&e.flags)}function No(e){return e.componentOffset>-1}function Bl(e){return 1==(1&e.flags)}function Vt(e){return!!e.template}function v(e){return 0!=(512&e[bt])}function Ee(e,t){return e.hasOwnProperty(Fr)?e[Fr]:null}let We=null,jt=!1;function Oe(e){const t=We;return We=e,t}const vt={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function An(e){if(!Rn(e)||e.dirty){if(!e.producerMustRecompute(e)&&!ir(e))return void(e.dirty=!1);e.producerRecomputeValue(e),e.dirty=!1}}function Zt(e){e.dirty=!0,function qt(e){if(void 0===e.liveConsumerNode)return;const t=jt;jt=!0;try{for(const n of e.liveConsumerNode)n.dirty||Zt(n)}finally{jt=t}}(e),e.consumerMarkedDirty?.(e)}function ci(e){return e&&(e.nextProducerIndex=0),Oe(e)}function Fn(e,t){if(Oe(t),e&&void 0!==e.producerNode&&void 0!==e.producerIndexOfThis&&void 0!==e.producerLastReadVersion){if(Rn(e))for(let n=e.nextProducerIndex;n<e.producerNode.length;n++)Tr(e.producerNode[n],e.producerIndexOfThis[n]);for(;e.producerNode.length>e.nextProducerIndex;)e.producerNode.pop(),e.producerLastReadVersion.pop(),e.producerIndexOfThis.pop()}}function ir(e){Ur(e);for(let t=0;t<e.producerNode.length;t++){const n=e.producerNode[t],i=e.producerLastReadVersion[t];if(i!==n.version||(An(n),i!==n.version))return!0}return!1}function zi(e){if(Ur(e),Rn(e))for(let t=0;t<e.producerNode.length;t++)Tr(e.producerNode[t],e.producerIndexOfThis[t]);e.producerNode.length=e.producerLastReadVersion.length=e.producerIndexOfThis.length=0,e.liveConsumerNode&&(e.liveConsumerNode.length=e.liveConsumerIndexOfThis.length=0)}function Tr(e,t){if(function Ys(e){e.liveConsumerNode??=[],e.liveConsumerIndexOfThis??=[]}(e),Ur(e),1===e.liveConsumerNode.length)for(let i=0;i<e.producerNode.length;i++)Tr(e.producerNode[i],e.producerIndexOfThis[i]);const n=e.liveConsumerNode.length-1;if(e.liveConsumerNode[t]=e.liveConsumerNode[n],e.liveConsumerIndexOfThis[t]=e.liveConsumerIndexOfThis[n],e.liveConsumerNode.length--,e.liveConsumerIndexOfThis.length--,t<e.liveConsumerNode.length){const i=e.liveConsumerIndexOfThis[t],r=e.liveConsumerNode[t];Ur(r),r.producerIndexOfThis[i]=t}}function Rn(e){return e.consumerIsAlwaysLive||(e?.liveConsumerNode?.length??0)>0}function Ur(e){e.producerNode??=[],e.producerIndexOfThis??=[],e.producerLastReadVersion??=[]}let pa=null;const ms=()=>{},ho=(()=>({...vt,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:e=>{e.schedule(e.ref)},hasRun:!1,cleanupFn:ms}))();class Fo{constructor(t,n,i){this.previousValue=t,this.currentValue=n,this.firstChange=i}isFirstChange(){return this.firstChange}}function Mc(){return Op}function Op(e){return e.type.prototype.ngOnChanges&&(e.setInput=Np),Bi}function Bi(){const e=jl(this),t=e?.current;if(t){const n=e.previous;if(n===Cn)e.previous=t;else for(let i in t)n[i]=t[i];e.current=null,this.ngOnChanges(t)}}function Np(e,t,n,i){const r=this.declaredInputs[n],l=jl(e)||function Pc(e,t){return e[Fp]=t}(e,{previous:Cn,current:null}),h=l.current||(l.current={}),f=l.previous,_=f[r];h[r]=new Fo(_&&_.currentValue,t,f===Cn),e[i]=t}Mc.ngInherit=!0;const Fp="__ngSimpleChanges__";function jl(e){return e[Fp]||null}const zo=function(e,t,n){};function hi(e){for(;Array.isArray(e);)e=e[li];return e}function Qd(e,t){return hi(t[e])}function es(e,t){return hi(t[e.index])}function Up(e,t){return e.data[t]}function Qs(e,t){const n=t[e];return Sr(n)?n:n[li]}function tl(e,t){return null==t?null:e[t]}function Vp(e){e[Fi]=0}function Wv(e){1024&e[bt]||(e[bt]|=1024,Rc(e,1))}function Vr(e){1024&e[bt]&&(e[bt]&=-1025,Rc(e,-1))}function Rc(e,t){let n=e[Dn];if(null===n)return;n[Xa]+=t;let i=n;for(n=n[Dn];null!==n&&(1===t&&1===i[Xa]||-1===t&&0===i[Xa]);)n[Xa]+=t,i=n,n=n[Dn]}const At={lFrame:Zp(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function $p(){return At.bindingsEnabled}function Lu(){return null!==At.skipHydrationRootTNode}function Pe(){return At.lFrame.lView}function Sn(){return At.lFrame.tView}function fo(e){return At.lFrame.contextLView=e,e[xi]}function Uo(e){return At.lFrame.contextLView=null,e}function jr(){let e=Zg();for(;null!==e&&64===e.type;)e=e.parent;return e}function Zg(){return At.lFrame.currentTNode}function po(e,t){const n=At.lFrame;n.currentTNode=e,n.isParent=t}function ku(){return At.lFrame.isParent}function nf(){At.lFrame.isParent=!1}function gs(){const e=At.lFrame;let t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function Ou(){return At.lFrame.bindingIndex++}function Xv(e,t){const n=At.lFrame;n.bindingIndex=n.bindingRootIndex=e,Gp(t)}function Gp(e){At.lFrame.currentDirectiveIndex=e}function zh(){return At.lFrame.currentQueryIndex}function af(e){At.lFrame.currentQueryIndex=e}function lf(e){const t=e[Qe];return 2===t.type?t.declTNode:1===t.type?e[Oi]:null}function Bh(e,t,n){if(n&en.SkipSelf){let r=t,l=e;for(;!(r=r.parent,null!==r||n&en.Host||(r=lf(l),null===r||(l=l[Qa],10&r.type))););if(null===r)return!1;t=r,e=l}const i=At.lFrame=Wp();return i.currentTNode=t,i.lView=e,!0}function kc(e){const t=Wp(),n=e[Qe];At.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function Wp(){const e=At.lFrame,t=null===e?null:e.child;return null===t?Zp(e):t}function Zp(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function Fu(){const e=At.lFrame;return At.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const cf=Fu;function Uh(){const e=Fu();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function ts(){return At.lFrame.selectedIndex}function Vo(e){At.lFrame.selectedIndex=e}function Mi(){const e=At.lFrame;return Up(e.tView,e.selectedIndex)}function Oc(){At.lFrame.currentNamespace="svg"}let Yp=!0;function Vh(){return Yp}function $l(e){Yp=e}function hf(e,t){for(let n=t.directiveStart,i=t.directiveEnd;n<i;n++){const l=e.data[n].type.prototype,{ngAfterContentInit:h,ngAfterContentChecked:f,ngAfterViewInit:_,ngAfterViewChecked:C,ngOnDestroy:A}=l;h&&(e.contentHooks??=[]).push(-n,h),f&&((e.contentHooks??=[]).push(n,f),(e.contentCheckHooks??=[]).push(n,f)),_&&(e.viewHooks??=[]).push(-n,_),C&&((e.viewHooks??=[]).push(n,C),(e.viewCheckHooks??=[]).push(n,C)),null!=A&&(e.destroyHooks??=[]).push(n,A)}}function df(e,t,n){Qg(e,t,3,n)}function ff(e,t,n,i){(3&e[bt])===n&&Qg(e,t,n,i)}function ga(e,t){let n=e[bt];(3&n)===t&&(n&=8191,n+=1,e[bt]=n)}function Qg(e,t,n,i){const l=i??-1,h=t.length-1;let f=0;for(let _=void 0!==i?65535&e[Fi]:0;_<h;_++)if("number"==typeof t[_+1]){if(f=t[_],null!=i&&f>=i)break}else t[_]<0&&(e[Fi]+=65536),(f<l||-1==l)&&(zu(e,n,t,_),e[Fi]=(4294901760&e[Fi])+_+2),_++}function Qp(e,t){zo(4,e,t);const n=Oe(null);try{t.call(e)}finally{Oe(n),zo(5,e,t)}}function zu(e,t,n,i){const r=n[i]<0,l=n[i+1],f=e[r?-n[i]:n[i]];r?e[bt]>>13<e[Fi]>>16&&(3&e[bt])===t&&(e[bt]+=8192,Qp(f,l)):Qp(f,l)}const Bu=-1;class jh{constructor(t,n,i){this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=i}}function Nc(e){return e!==Bu}function Fc(e){return 32767&e}function $h(e,t){let n=function s0(e){return e>>16}(e),i=t;for(;n>0;)i=i[Qa],n--;return i}let mf=!0;function gf(e){const t=mf;return mf=e,t}const Uu=255,Jp=5;let o0=0;const ya={};function yf(e,t){const n=ey(e,t);if(-1!==n)return n;const i=t[Qe];i.firstCreatePass&&(e.injectorIndex=t.length,em(i.data,e),em(t,null),em(i.blueprint,null));const r=Hh(e,t),l=e.injectorIndex;if(Nc(r)){const h=Fc(r),f=$h(r,t),_=f[Qe].data;for(let C=0;C<8;C++)t[l+C]=f[h+C]|_[h+C]}return t[l+8]=r,l}function em(e,t){e.push(0,0,0,0,0,0,0,0,t)}function ey(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function Hh(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let n=0,i=null,r=t;for(;null!==r;){if(i=Ln(r),null===i)return Bu;if(n++,r=r[Qa],-1!==i.injectorIndex)return i.injectorIndex|n<<16}return Bu}function qh(e,t,n){!function a0(e,t,n){let i;"string"==typeof n?i=n.charCodeAt(0)||0:n.hasOwnProperty(Mo)&&(i=n[Mo]),null==i&&(i=n[Mo]=o0++);const r=i&Uu;t.data[e+(r>>Jp)]|=1<<r}(e,t,n)}function tm(e,t,n){if(n&en.Optional||void 0!==e)return e;Io()}function nm(e,t,n,i){if(n&en.Optional&&void 0===i&&(i=null),!(n&(en.Self|en.Host))){const r=e[Ni],l=Cr(void 0);try{return r?r.get(t,i,n&en.Optional):Ha(t,i,n&en.Optional)}finally{Cr(l)}}return tm(i,0,n)}function ny(e,t,n,i=en.Default,r){if(null!==e){if(2048&t[bt]&&!(i&en.Self)){const h=function ry(e,t,n,i,r){let l=e,h=t;for(;null!==l&&null!==h&&2048&h[bt]&&!(512&h[bt]);){const f=Gh(l,h,n,i|en.Self,ya);if(f!==ya)return f;let _=l.parent;if(!_){const C=h[_t];if(C){const A=C.get(n,ya,i);if(A!==ya)return A}_=Ln(h),h=h[Qa]}l=_}return r}(e,t,n,i,ya);if(h!==ya)return h}const l=Gh(e,t,n,i,ya);if(l!==ya)return l}return nm(t,n,i,r)}function Gh(e,t,n,i,r){const l=function c0(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(Mo)?e[Mo]:void 0;return"number"==typeof t?t>=0?t&Uu:Wi:t}(n);if("function"==typeof l){if(!Bh(t,e,i))return i&en.Host?tm(r,0,i):nm(t,n,i,r);try{let h;if(h=l(i),null!=h||i&en.Optional)return h;Io()}finally{cf()}}else if("number"==typeof l){let h=null,f=ey(e,t),_=Bu,C=i&en.Host?t[wi][Oi]:null;for((-1===f||i&en.SkipSelf)&&(_=-1===f?Hh(e,t):t[f+8],_!==Bu&&im(i,!1)?(h=t[Qe],f=Fc(_),t=$h(_,t)):f=-1);-1!==f;){const A=t[Qe];if(iy(l,f,A.data)){const R=l0(f,t,n,h,i,C);if(R!==ya)return R}_=t[f+8],_!==Bu&&im(i,t[Qe].data[f+8]===C)&&iy(l,f,t)?(h=A,f=Fc(_),t=$h(_,t)):f=-1}}return r}function l0(e,t,n,i,r,l){const h=t[Qe],f=h.data[e+8],A=Wh(f,h,n,null==i?No(f)&&mf:i!=h&&0!=(3&f.type),r&en.Host&&l===f);return null!==A?zc(t,h,A,f):ya}function Wh(e,t,n,i,r){const l=e.providerIndexes,h=t.data,f=1048575&l,_=e.directiveStart,A=l>>20,F=r?f+A:e.directiveEnd;for(let $=i?f:f+A;$<F;$++){const Q=h[$];if($<_&&n===Q||$>=_&&Q.type===n)return $}if(r){const $=h[_];if($&&Vt($)&&$.type===n)return _}return null}function zc(e,t,n,i){let r=e[n];const l=t.data;if(function e0(e){return e instanceof jh}(r)){const h=r;h.resolving&&function Fd(e,t){const n=t?`. Dependency path: ${t.join(" > ")} > ${e}`:"";throw new Ie(-200,`Circular dependency in DI detected for ${e}${n}`)}(function Tn(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Lt(e)}(l[n]));const f=gf(h.canSeeViewProviders);h.resolving=!0;const C=h.injectImpl?Cr(h.injectImpl):null;Bh(e,i,en.Default);try{r=e[n]=h.factory(void 0,l,e,i),t.firstCreatePass&&n>=i.directiveStart&&function Jv(e,t,n){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:l}=t.type.prototype;if(i){const h=Op(t);(n.preOrderHooks??=[]).push(e,h),(n.preOrderCheckHooks??=[]).push(e,h)}r&&(n.preOrderHooks??=[]).push(0-e,r),l&&((n.preOrderHooks??=[]).push(e,l),(n.preOrderCheckHooks??=[]).push(e,l))}(n,l[n],t)}finally{null!==C&&Cr(C),gf(f),h.resolving=!1,cf()}}return r}function iy(e,t,n){return!!(n[t+(e>>Jp)]&1<<e)}function im(e,t){return!(e&en.Self||e&en.Host&&t)}class mr{constructor(t,n){this._tNode=t,this._lView=n}get(t,n,i){return ny(this._tNode,this._lView,t,Sc(i),n)}}function Wi(){return new mr(jr(),Pe())}function Bc(e){return As(()=>{const t=e.prototype.constructor,n=t[Fr]||_f(t),i=Object.prototype;let r=Object.getPrototypeOf(e.prototype).constructor;for(;r&&r!==i;){const l=r[Fr]||_f(r);if(l&&l!==n)return l;r=Object.getPrototypeOf(r)}return l=>new l})}function _f(e){return gc(e)?()=>{const t=_f(Ot(e));return t&&t()}:Ee(e)}function Ln(e){const t=e[Qe],n=t.type;return 2===n?t.declTNode:1===n?e[Oi]:null}const Vc="__parameters__";function ju(e,t,n){return As(()=>{const i=function vf(e){return function(...n){if(e){const i=e(...n);for(const r in i)this[r]=i[r]}}}(t);function r(...l){if(this instanceof r)return i.apply(this,l),this;const h=new r(...l);return f.annotation=h,f;function f(_,C,A){const R=_.hasOwnProperty(Vc)?_[Vc]:Object.defineProperty(_,Vc,{value:[]})[Vc];for(;R.length<=A;)R.push(null);return(R[A]=R[A]||[]).push(h),_}}return n&&(r.prototype=Object.create(n.prototype)),r.prototype.ngMetadataName=e,r.annotationCls=r,r})}function $c(e,t){e.forEach(n=>Array.isArray(n)?$c(n,t):t(n))}function sm(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function Ar(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function Hc(e,t){const n=[];for(let i=0;i<e;i++)n.push(t);return n}function Mr(e,t,n){let i=sl(e,t);return i>=0?e[1|i]=n:(i=~i,function Xh(e,t,n,i){let r=e.length;if(r==t)e.push(n,i);else if(1===r)e.push(i,e[0]),e[0]=n;else{for(r--,e.push(e[r-1],e[r]);r>t;)e[r]=e[r-2],r--;e[t]=n,e[t+1]=i}}(e,i,t,n)),i}function Hu(e,t){const n=sl(e,t);if(n>=0)return e[1|n]}function sl(e,t){return function om(e,t,n){let i=0,r=e.length>>n;for(;r!==i;){const l=i+(r-i>>1),h=e[l<<n];if(t===h)return l<<n;h>t?r=l:i=l+1}return~(r<<n)}(e,t,1)}const Hl=qa(ju("Optional"),8),jo=qa(ju("SkipSelf"),4);function Jh(e){return 128==(128&e.flags)}var ol=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}(ol||{});const by=/^>|^->|<!--|-->|--!>|<!-$/g,xy=/(<|>)/g,wy="\u200b$1\u200b";const bm=new Map;let Ey=0;const xm="__ngContext__";function ns(e,t){Sr(t)?(e[xm]=t[rt],function Sy(e){bm.set(e[rt],e)}(t)):e[xm]=t}let Em;function Mf(e,t){return Em(e,t)}function Kc(e){const t=e[Dn];return fr(t)?t[Dn]:t}function Pf(e){return Rf(e[Ya])}function Tm(e){return Rf(e[Br])}function Rf(e){for(;null!==e&&!fr(e);)e=e[Br];return e}function al(e,t,n,i,r){if(null!=i){let l,h=!1;fr(i)?l=i:Sr(i)&&(h=!0,i=i[li]);const f=hi(i);0===e&&null!==n?null==r?H(t,n,f):j(t,n,f,r||null,!0):1===e&&null!==n?j(t,n,f,r||null,!0):2===e?function Be(e,t,n){const i=ce(e,t);i&&function te(e,t,n,i){e.removeChild(t,n,i)}(e,i,t,n)}(t,f,h):3===e&&t.destroyNode(f),null!=l&&function ii(e,t,n,i,r){const l=n[En];l!==hi(n)&&al(t,e,i,l,r);for(let f=Ii;f<n.length;f++){const _=n[f];et(_[Qe],_,e,t,i,l)}}(t,e,l,n,r)}}function id(e,t){return e.createComment(function Cy(e){return e.replace(by,t=>t.replace(xy,wy))}(t))}function Zu(e,t,n){return e.createElement(t,n)}function b(e,t){const n=e[Xs],i=n.indexOf(t);Vr(t),n.splice(i,1)}function w(e,t){if(e.length<=Ii)return;const n=Ii+t,i=e[n];if(i){const r=i[Ic];null!==r&&r!==e&&b(r,i),t>0&&(e[n-1][Br]=i[Br]);const l=Ar(e,Ii+t);!function C0(e,t){et(e,t,t[kt],2,null,null),t[li]=null,t[Oi]=null}(i[Qe],i);const h=l[ps];null!==h&&h.detachView(l[Qe]),i[Dn]=null,i[Br]=null,i[bt]&=-129}return i}function E(e,t){if(!(256&t[bt])){const n=t[kt];t[Ja]&&zi(t[Ja]),t[ni]&&zi(t[ni]),n.destroyNode&&et(e,t,n,3,null,null),function c(e){let t=e[Ya];if(!t)return D(e[Qe],e);for(;t;){let n=null;if(Sr(t))n=t[Ya];else{const i=t[Ii];i&&(n=i)}if(!n){for(;t&&!t[Br]&&t!==e;)Sr(t)&&D(t[Qe],t),t=t[Dn];null===t&&(t=e),Sr(t)&&D(t[Qe],t),n=t&&t[Br]}t=n}}(t)}}function D(e,t){if(!(256&t[bt])){t[bt]&=-129,t[bt]|=256,function L(e,t){let n;if(null!=e&&null!=(n=e.destroyHooks))for(let i=0;i<n.length;i+=2){const r=t[n[i]];if(!(r instanceof jh)){const l=n[i+1];if(Array.isArray(l))for(let h=0;h<l.length;h+=2){const f=r[l[h]],_=l[h+1];zo(4,f,_);try{_.call(f)}finally{zo(5,f,_)}}else{zo(4,r,l);try{l.call(r)}finally{zo(5,r,l)}}}}}(e,t),function M(e,t){const n=e.cleanup,i=t[ha];if(null!==n)for(let l=0;l<n.length-1;l+=2)if("string"==typeof n[l]){const h=n[l+3];h>=0?i[h]():i[-h].unsubscribe(),l+=2}else n[l].call(i[n[l+1]]);null!==i&&(t[ha]=null);const r=t[Rs];if(null!==r){t[Rs]=null;for(let l=0;l<r.length;l++)(0,r[l])()}}(e,t),1===t[Qe].type&&t[kt].destroy();const n=t[Ic];if(null!==n&&fr(t[Dn])){n!==t[Dn]&&b(n,t);const i=t[ps];null!==i&&i.detachView(e)}!function Ty(e){bm.delete(e[rt])}(t)}}function N(e,t,n){return function B(e,t,n){let i=t;for(;null!==i&&40&i.type;)i=(t=i).parent;if(null===i)return n[li];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:l}=e.data[i.directiveStart+r];if(l===ds.None||l===ds.Emulated)return null}return es(i,n)}}(e,t.parent,n)}function j(e,t,n,i,r){e.insertBefore(t,n,i,r)}function H(e,t,n){e.appendChild(t,n)}function W(e,t,n,i,r){null!==i?j(e,t,n,i,r):H(e,t,n)}function ce(e,t){return e.parentNode(t)}function fe(e,t,n){return Te(e,t,n)}let Ze,Pr,Te=function ye(e,t,n){return 40&e.type?es(e,n):null};function Ge(e,t,n,i){const r=N(e,i,t),l=t[kt],f=fe(i.parent||t[Oi],i,t);if(null!=r)if(Array.isArray(n))for(let _=0;_<n.length;_++)W(l,r,n[_],f,!1);else W(l,r,n,f,!1);void 0!==Ze&&Ze(l,i,t,n,r)}function Ve(e,t){if(null!==t){const n=t.type;if(3&n)return es(t,e);if(4&n)return Xe(-1,e[t.index]);if(8&n){const i=t.child;if(null!==i)return Ve(e,i);{const r=e[t.index];return fr(r)?Xe(-1,r):hi(r)}}if(32&n)return Mf(t,e)()||hi(e[t.index]);{const i=ze(e,t);return null!==i?Array.isArray(i)?i[0]:Ve(Kc(e[wi]),i):Ve(e,t.next)}}return null}function ze(e,t){return null!==t?e[wi][Oi].projection[t.projection]:null}function Xe(e,t){const n=Ii+e+1;if(n<t.length){const i=t[n],r=i[Qe].firstChild;if(null!==r)return Ve(i,r)}return t[En]}function dt(e,t,n,i,r,l,h){for(;null!=n;){const f=i[n.index],_=n.type;if(h&&0===t&&(f&&ns(hi(f),i),n.flags|=2),32!=(32&n.flags))if(8&_)dt(e,t,n.child,i,r,l,!1),al(t,e,r,f,l);else if(32&_){const C=Mf(n,i);let A;for(;A=C();)al(t,e,r,A,l);al(t,e,r,f,l)}else 16&_?$n(e,t,i,n,r,l):al(t,e,r,f,l);n=h?n.projectionNext:n.next}}function et(e,t,n,i,r,l){dt(n,i,e.firstChild,t,r,l,!1)}function $n(e,t,n,i,r,l){const h=n[wi],_=h[Oi].projection[i.projection];if(Array.isArray(_))for(let C=0;C<_.length;C++)al(t,e,r,_[C],l);else{let C=_;const A=h[Dn];Jh(i)&&(C.flags|=128),dt(e,t,C,A,r,l,!0)}}function Hr(e,t,n){""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n)}function Pi(e,t,n){const{mergedAttrs:i,classes:r,styles:l}=n;null!==i&&Du(e,t,i),null!==r&&Hr(e,t,r),null!==l&&function ks(e,t,n){e.setAttribute(t,"style",n)}(e,t,l)}class Vi{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function ar(e){return e instanceof Vi?e.changingThisBreaksApplicationSecurity:e}const Lm=new ut("ENVIRONMENT_INITIALIZER"),jw=new ut("INJECTOR",-1),$w=new ut("INJECTOR_DEF_TYPES");class M0{get(t,n=Ao){if(n===Ao){const i=new Error(`NullInjectorError: No provider for ${Kn(t)}!`);throw i.name="NullInjectorError",i}return n}}function mP(...e){return{\u0275providers:Hw(0,e),\u0275fromNgModule:!0}}function Hw(e,...t){const n=[],i=new Set;let r;const l=h=>{n.push(h)};return $c(t,h=>{const f=h;By(f,l,[],i)&&(r||=[],r.push(f))}),void 0!==r&&qw(r,l),n}function qw(e,t){for(let n=0;n<e.length;n++){const{ngModule:i,providers:r}=e[n];R0(r,l=>{t(l,i)})}}function By(e,t,n,i){if(!(e=Ot(e)))return!1;let r=null,l=bu(e);const h=!l&&dn(e);if(l||h){if(h&&!h.standalone)return!1;r=e}else{const _=e.ngModule;if(l=bu(_),!l)return!1;r=_}const f=i.has(r);if(h){if(f)return!1;if(i.add(r),h.dependencies){const _="function"==typeof h.dependencies?h.dependencies():h.dependencies;for(const C of _)By(C,t,n,i)}}else{if(!l)return!1;{if(null!=l.imports&&!f){let C;i.add(r);try{$c(l.imports,A=>{By(A,t,n,i)&&(C||=[],C.push(A))})}finally{}void 0!==C&&qw(C,t)}if(!f){const C=Ee(r)||(()=>new r);t({provide:r,useFactory:C,deps:nn},r),t({provide:$w,useValue:r,multi:!0},r),t({provide:Lm,useValue:()=>lt(r),multi:!0},r)}const _=l.providers;if(null!=_&&!f){const C=e;R0(_,A=>{t(A,C)})}}}return r!==e&&void 0!==e.providers}function R0(e,t){for(let n of e)yc(n)&&(n=n.\u0275providers),Array.isArray(n)?R0(n,t):t(n)}const gP=wn({provide:String,useValue:wn});function L0(e){return null!==e&&"object"==typeof e&&gP in e}function sd(e){return"function"==typeof e}const k0=new ut("Set Injector scope."),Uy={},_P={};let O0;function Vy(){return void 0===O0&&(O0=new M0),O0}class Wo{}class Nf extends Wo{get destroyed(){return this._destroyed}constructor(t,n,i,r){super(),this.parent=n,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,F0(t,h=>this.processProvider(h)),this.records.set(jw,Ff(void 0,this)),r.has("environment")&&this.records.set(Wo,Ff(void 0,this));const l=this.records.get(k0);null!=l&&"string"==typeof l.value&&this.scopes.add(l.value),this.injectorDefTypes=new Set(this.get($w.multi,nn,en.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const n of this._ngOnDestroyHooks)n.ngOnDestroy();const t=this._onDestroyHooks;this._onDestroyHooks=[];for(const n of t)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(t){return this.assertNotDestroyed(),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){this.assertNotDestroyed();const n=Is(this),i=Cr(void 0);try{return t()}finally{Is(n),Cr(i)}}get(t,n=Ao,i=en.Default){if(this.assertNotDestroyed(),t.hasOwnProperty(Za))return t[Za](this);i=Sc(i);const l=Is(this),h=Cr(void 0);try{if(!(i&en.SkipSelf)){let _=this.records.get(t);if(void 0===_){const C=function CP(e){return"function"==typeof e||"object"==typeof e&&e instanceof ut}(t)&&bc(t);_=C&&this.injectableDefInScope(C)?Ff(N0(t),Uy):null,this.records.set(t,_)}if(null!=_)return this.hydrate(t,_)}return(i&en.Self?Vy():this.parent).get(t,n=i&en.Optional&&n===Ao?null:n)}catch(f){if("NullInjectorError"===f.name){if((f[Rl]=f[Rl]||[]).unshift(Kn(t)),l)throw f;return function Wd(e,t,n,i){const r=e[Rl];throw t[wc]&&r.unshift(t[wc]),e.message=function Tc(e,t,n,i=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.slice(2):e;let r=Kn(t);if(Array.isArray(t))r=t.map(Kn).join(" -> ");else if("object"==typeof t){let l=[];for(let h in t)if(t.hasOwnProperty(h)){let f=t[h];l.push(h+":"+("string"==typeof f?JSON.stringify(f):Kn(f)))}r=`{${l.join(", ")}}`}return`${n}${i?"("+i+")":""}[${r}]: ${e.replace(Su,"\n  ")}`}("\n"+e.message,r,n,i),e.ngTokenPath=r,e[Rl]=null,e}(f,t,"R3InjectorError",this.source)}throw f}finally{Cr(h),Is(l)}}resolveInjectorInitializers(){const t=Is(this),n=Cr(void 0);try{const r=this.get(Lm.multi,nn,en.Self);for(const l of r)l()}finally{Is(t),Cr(n)}}toString(){const t=[],n=this.records;for(const i of n.keys())t.push(Kn(i));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ie(205,!1)}processProvider(t){let n=sd(t=Ot(t))?t:Ot(t&&t.provide);const i=function bP(e){return L0(e)?Ff(void 0,e.useValue):Ff(function Zw(e,t,n){let i;if(sd(e)){const r=Ot(e);return Ee(r)||N0(r)}if(L0(e))i=()=>Ot(e.useValue);else if(function Ww(e){return!(!e||!e.useFactory)}(e))i=()=>e.useFactory(...Ll(e.deps||[]));else if(function Gw(e){return!(!e||!e.useExisting)}(e))i=()=>lt(Ot(e.useExisting));else{const r=Ot(e&&(e.useClass||e.provide));if(!function xP(e){return!!e.deps}(e))return Ee(r)||N0(r);i=()=>new r(...Ll(e.deps))}return i}(e),Uy)}(t);if(sd(t)||!0!==t.multi)this.records.get(n);else{let r=this.records.get(n);r||(r=Ff(void 0,Uy,!0),r.factory=()=>Ll(r.multi),this.records.set(n,r)),n=t,r.multi.push(t)}this.records.set(n,i)}hydrate(t,n){return n.value===Uy&&(n.value=_P,n.value=n.factory()),"object"==typeof n.value&&n.value&&function wP(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(t){if(!t.providedIn)return!1;const n=Ot(t.providedIn);return"string"==typeof n?"any"===n||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(t){const n=this._onDestroyHooks.indexOf(t);-1!==n&&this._onDestroyHooks.splice(n,1)}}function N0(e){const t=bc(e),n=null!==t?t.factory:Ee(e);if(null!==n)return n;if(e instanceof ut)throw new Ie(204,!1);if(e instanceof Function)return function vP(e){const t=e.length;if(t>0)throw Hc(t,"?"),new Ie(204,!1);const n=function Mp(e){return e&&(e[xu]||e[Hd])||null}(e);return null!==n?()=>n.factory(e):()=>new e}(e);throw new Ie(204,!1)}function Ff(e,t,n=!1){return{factory:e,value:t,multi:n?[]:void 0}}function F0(e,t){for(const n of e)Array.isArray(n)?F0(n,t):n&&yc(n)?F0(n.\u0275providers,t):t(n)}const jy=new ut("AppId",{providedIn:"root",factory:()=>EP}),EP="ng",Kw=new ut("Platform Initializer"),Yc=new ut("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Xw=new ut("AnimationModuleType"),Yw=new ut("CSP nonce",{providedIn:"root",factory:()=>function or(){if(void 0!==Pr)return Pr;if(typeof document<"u")return document;throw new Ie(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let Qw=(e,t,n)=>null;function q0(e,t,n=!1){return Qw(e,t,n)}class kP{}class tC{}class NP{resolveComponentFactory(t){throw function OP(e){const t=Error(`No component factory found for ${Kn(e)}.`);return t.ngComponent=e,t}(t)}}let Zy=(()=>{class e{static#e=this.NULL=new NP}return e})();function FP(){return Uf(jr(),Pe())}function Uf(e,t){return new hl(es(e,t))}let hl=(()=>{class e{constructor(n){this.nativeElement=n}static#e=this.__NG_ELEMENT_ID__=FP}return e})();function zP(e){return e instanceof hl?e.nativeElement:e}class Nm{}let Vf=(()=>{class e{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function BP(){const e=Pe(),n=Qs(jr().index,e);return(Sr(n)?n:e)[kt]}()}return e})(),UP=(()=>{class e{static#e=this.\u0275prov=ft({token:e,providedIn:"root",factory:()=>null})}return e})();class Ky{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const VP=new Ky("16.2.11"),Z0={};function oC(e,t=null,n=null,i){const r=aC(e,t,n,i);return r.resolveInjectorInitializers(),r}function aC(e,t=null,n=null,i,r=new Set){const l=[n||nn,mP(e)];return i=i||("object"==typeof e?void 0:Kn(e)),new Nf(l,t||Vy(),i||null,r)}let ba=(()=>{class e{static#e=this.THROW_IF_NOT_FOUND=Ao;static#t=this.NULL=new M0;static create(n,i){if(Array.isArray(n))return oC({name:""},i,n,"");{const r=n.name??"";return oC({name:r},n.parent,n.providers,r)}}static#n=this.\u0275prov=ft({token:e,providedIn:"any",factory:()=>lt(jw)});static#i=this.__NG_ELEMENT_ID__=-1}return e})();function X0(e){return e.ngOriginalError}class Qc{constructor(){this._console=console}handleError(t){const n=this._findOriginalError(t);this._console.error("ERROR",t),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(t){let n=t&&X0(t);for(;n&&X0(n);)n=X0(n);return n||null}}function Q0(e){return t=>{setTimeout(e,void 0,t)}}const lr=class ZP extends er{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,n,i){let r=t,l=n||(()=>null),h=i;if(t&&"object"==typeof t){const _=t;r=_.next?.bind(_),l=_.error?.bind(_),h=_.complete?.bind(_)}this.__isAsync&&(l=Q0(l),r&&(r=Q0(r)),h&&(h=Q0(h)));const f=super.subscribe({next:r,error:l,complete:h});return t instanceof ei&&t.add(f),f}};function cC(...e){}class Yn{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new lr(!1),this.onMicrotaskEmpty=new lr(!1),this.onStable=new lr(!1),this.onError=new lr(!1),typeof Zone>"u")throw new Ie(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&n,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function KP(){const e="function"==typeof Vn.requestAnimationFrame;let t=Vn[e?"requestAnimationFrame":"setTimeout"],n=Vn[e?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&t&&n){const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i);const r=n[Zone.__symbol__("OriginalDelegate")];r&&(n=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function QP(e){const t=()=>{!function YP(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Vn,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,e1(e),e.isCheckStableRunning=!0,J0(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),e1(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,i,r,l,h,f)=>{if(function eR(e){return!(!Array.isArray(e)||1!==e.length)&&!0===e[0].data?.__ignore_ng_zone__}(f))return n.invokeTask(r,l,h,f);try{return uC(e),n.invokeTask(r,l,h,f)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===l.type||e.shouldCoalesceRunChangeDetection)&&t(),hC(e)}},onInvoke:(n,i,r,l,h,f,_)=>{try{return uC(e),n.invoke(r,l,h,f,_)}finally{e.shouldCoalesceRunChangeDetection&&t(),hC(e)}},onHasTask:(n,i,r,l)=>{n.hasTask(r,l),i===r&&("microTask"==l.change?(e._hasPendingMicrotasks=l.microTask,e1(e),J0(e)):"macroTask"==l.change&&(e.hasPendingMacrotasks=l.macroTask))},onHandleError:(n,i,r,l)=>(n.handleError(r,l),e.runOutsideAngular(()=>e.onError.emit(l)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Yn.isInAngularZone())throw new Ie(909,!1)}static assertNotInAngularZone(){if(Yn.isInAngularZone())throw new Ie(909,!1)}run(t,n,i){return this._inner.run(t,n,i)}runTask(t,n,i,r){const l=this._inner,h=l.scheduleEventTask("NgZoneEvent: "+r,t,XP,cC,cC);try{return l.runTask(h,n,i)}finally{l.cancelTask(h)}}runGuarded(t,n,i){return this._inner.runGuarded(t,n,i)}runOutsideAngular(t){return this._outer.run(t)}}const XP={};function J0(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function e1(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function uC(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function hC(e){e._nesting--,J0(e)}class JP{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new lr,this.onMicrotaskEmpty=new lr,this.onStable=new lr,this.onError=new lr}run(t,n,i){return t.apply(n,i)}runGuarded(t,n,i){return t.apply(n,i)}runOutsideAngular(t){return t()}runTask(t,n,i,r){return t.apply(n,i)}}const dC=new ut("",{providedIn:"root",factory:fC});function fC(){const e=tt(Yn);let t=!0;return function Ua(...e){const t=gn(e),n=function dh(e,t){return"number"==typeof sa(e)?e.pop():t}(e,1/0),i=e;return i.length?1===i.length?Je(i[0]):ti(n)(It(i,t)):Zn}(new pi(r=>{t=e.isStable&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks,e.runOutsideAngular(()=>{r.next(t),r.complete()})}),new pi(r=>{let l;e.runOutsideAngular(()=>{l=e.onStable.subscribe(()=>{Yn.assertNotInAngularZone(),queueMicrotask(()=>{!t&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks&&(t=!0,r.next(!0))})})});const h=e.onUnstable.subscribe(()=>{Yn.assertInAngularZone(),t&&(t=!1,e.runOutsideAngular(()=>{r.next(!1)}))});return()=>{l.unsubscribe(),h.unsubscribe()}}).pipe(us()))}function Jc(e){return e instanceof Function?e():e}let t1=(()=>{class e{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=ft({token:e,providedIn:"root",factory:()=>new e})}return e})();function Fm(e){for(;e;){e[bt]|=64;const t=Kc(e);if(v(e)&&!t)return e;e=t}return null}const _C=new ut("",{providedIn:"root",factory:()=>!1});let Yy=null;function wC(e,t){return e[t]??SC()}function CC(e,t){const n=SC();n.producerNode?.length&&(e[t]=Yy,n.lView=e,Yy=EC())}const uR={...vt,consumerIsAlwaysLive:!0,consumerMarkedDirty:e=>{Fm(e.lView)},lView:null};function EC(){return Object.create(uR)}function SC(){return Yy??=EC(),Yy}const Jt={};function Kt(e){TC(Sn(),Pe(),ts()+e,!1)}function TC(e,t,n,i){if(!i)if(3==(3&t[bt])){const l=e.preOrderCheckHooks;null!==l&&df(t,l,n)}else{const l=e.preOrderHooks;null!==l&&ff(t,l,0,n)}Vo(n)}function pt(e,t=en.Default){const n=Pe();return null===n?lt(e,t):ny(jr(),n,Ot(e),t)}function Qy(e,t,n,i,r,l,h,f,_,C,A){const R=t.blueprint.slice();return R[li]=r,R[bt]=140|i,(null!==C||e&&2048&e[bt])&&(R[bt]|=2048),Vp(R),R[Dn]=R[Qa]=e,R[xi]=n,R[In]=h||e&&e[In],R[kt]=f||e&&e[kt],R[Ni]=_||e&&e[Ni]||null,R[Oi]=l,R[rt]=function Gu(){return Ey++}(),R[Zs]=A,R[_t]=C,R[wi]=2==t.type?e[wi]:R,R}function Hf(e,t,n,i,r){let l=e.data[t];if(null===l)l=function n1(e,t,n,i,r){const l=Zg(),h=ku(),_=e.data[t]=function _R(e,t,n,i,r,l){let h=t?t.injectorIndex:-1,f=0;return Lu()&&(f|=128),{type:n,index:i,insertBeforeIndex:null,injectorIndex:h,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:f,providerIndexes:0,value:r,attrs:l,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,h?l:l&&l.parent,n,t,i,r);return null===e.firstChild&&(e.firstChild=_),null!==l&&(h?null==l.child&&null!==_.parent&&(l.child=_):null===l.next&&(l.next=_,_.prev=l)),_}(e,t,n,i,r),function Kv(){return At.lFrame.inI18n}()&&(l.flags|=32);else if(64&l.type){l.type=n,l.value=i,l.attrs=r;const h=function Fh(){const e=At.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}();l.injectorIndex=null===h?-1:h.injectorIndex}return po(l,!0),l}function zm(e,t,n,i){if(0===n)return-1;const r=t.length;for(let l=0;l<n;l++)t.push(i),e.blueprint.push(i),e.data.push(null);return r}function IC(e,t,n,i,r){const l=wC(t,Ja),h=ts(),f=2&i;try{Vo(-1),f&&t.length>tn&&TC(e,t,tn,!1),zo(f?2:0,r);const C=f?l:null,A=ci(C);try{null!==C&&(C.dirty=!1),n(i,r)}finally{Fn(C,A)}}finally{f&&null===t[Ja]&&CC(t,Ja),Vo(h),zo(f?3:1,r)}}function r1(e,t,n){if(fa(t)){const i=Oe(null);try{const l=t.directiveEnd;for(let h=t.directiveStart;h<l;h++){const f=e.data[h];f.contentQueries&&f.contentQueries(1,n[h],h)}}finally{Oe(i)}}}function s1(e,t,n){$p()&&(function SR(e,t,n,i){const r=n.directiveStart,l=n.directiveEnd;No(n)&&function RR(e,t,n){const i=es(t,e),r=AC(n);let h=16;n.signals?h=4096:n.onPush&&(h=64);const f=Jy(e,Qy(e,r,null,h,i,t,null,e[In].rendererFactory.createRenderer(i,n),null,null,null));e[t.index]=f}(t,n,e.data[r+n.componentOffset]),e.firstCreatePass||yf(n,t),ns(i,t);const h=n.initialInputs;for(let f=r;f<l;f++){const _=e.data[f],C=zc(t,e,f,n);ns(C,t),null!==h&&LR(0,f-r,C,_,0,h),Vt(_)&&(Qs(n.index,t)[xi]=zc(t,e,f,n))}}(e,t,n,es(n,t)),64==(64&n.flags)&&kC(e,t,n))}function o1(e,t,n=es){const i=t.localNames;if(null!==i){let r=t.index+1;for(let l=0;l<i.length;l+=2){const h=i[l+1],f=-1===h?n(t,e):e[h];e[r++]=f}}}function AC(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=a1(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):t}function a1(e,t,n,i,r,l,h,f,_,C,A){const R=tn+i,F=R+r,$=function dR(e,t){const n=[];for(let i=0;i<t;i++)n.push(i<e?null:Jt);return n}(R,F),Q="function"==typeof C?C():C;return $[Qe]={type:e,blueprint:$,template:n,queries:null,viewQuery:f,declTNode:t,data:$.slice().fill(null,R),bindingStartIndex:R,expandoStartIndex:F,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof l?l():l,pipeRegistry:"function"==typeof h?h():h,firstChild:null,schemas:_,consts:Q,incompleteFirstPass:!1,ssrId:A}}let MC=e=>null;function PC(e,t,n,i){for(let r in e)if(e.hasOwnProperty(r)){n=null===n?{}:n;const l=e[r];null===i?RC(n,t,r,l):i.hasOwnProperty(r)&&RC(n,t,i[r],l)}return n}function RC(e,t,n,i){e.hasOwnProperty(n)?e[n].push(t,i):e[n]=[t,i]}function l1(e,t,n,i){if($p()){const r=null===i?null:{"":-1},l=function DR(e,t){const n=e.directiveRegistry;let i=null,r=null;if(n)for(let l=0;l<n.length;l++){const h=n[l];if(Eh(t,h.selectors,!1))if(i||(i=[]),Vt(h))if(null!==h.findHostDirectiveDefs){const f=[];r=r||new Map,h.findHostDirectiveDefs(h,f,r),i.unshift(...f,h),c1(e,t,f.length)}else i.unshift(h),c1(e,t,0);else r=r||new Map,h.findHostDirectiveDefs?.(h,i,r),i.push(h)}return null===i?null:[i,r]}(e,n);let h,f;null===l?h=f=null:[h,f]=l,null!==h&&LC(e,t,n,h,r,f),r&&function IR(e,t,n){if(t){const i=e.localNames=[];for(let r=0;r<t.length;r+=2){const l=n[t[r+1]];if(null==l)throw new Ie(-301,!1);i.push(t[r],l)}}}(n,i,r)}n.mergedAttrs=kl(n.mergedAttrs,n.attrs)}function LC(e,t,n,i,r,l){for(let C=0;C<i.length;C++)qh(yf(n,t),e,i[C].type);!function MR(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}(n,e.data.length,i.length);for(let C=0;C<i.length;C++){const A=i[C];A.providersResolver&&A.providersResolver(A)}let h=!1,f=!1,_=zm(e,t,i.length,null);for(let C=0;C<i.length;C++){const A=i[C];n.mergedAttrs=kl(n.mergedAttrs,A.hostAttrs),PR(e,n,t,_,A),AR(_,A,r),null!==A.contentQueries&&(n.flags|=4),(null!==A.hostBindings||null!==A.hostAttrs||0!==A.hostVars)&&(n.flags|=64);const R=A.type.prototype;!h&&(R.ngOnChanges||R.ngOnInit||R.ngDoCheck)&&((e.preOrderHooks??=[]).push(n.index),h=!0),!f&&(R.ngOnChanges||R.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(n.index),f=!0),_++}!function vR(e,t,n){const r=t.directiveEnd,l=e.data,h=t.attrs,f=[];let _=null,C=null;for(let A=t.directiveStart;A<r;A++){const R=l[A],F=n?n.get(R):null,Q=F?F.outputs:null;_=PC(R.inputs,A,_,F?F.inputs:null),C=PC(R.outputs,A,C,Q);const ee=null===_||null===h||Nl(t)?null:kR(_,A,h);f.push(ee)}null!==_&&(_.hasOwnProperty("class")&&(t.flags|=8),_.hasOwnProperty("style")&&(t.flags|=16)),t.initialInputs=f,t.inputs=_,t.outputs=C}(e,n,l)}function kC(e,t,n){const i=n.directiveStart,r=n.directiveEnd,l=n.index,h=function Nu(){return At.lFrame.currentDirectiveIndex}();try{Vo(l);for(let f=i;f<r;f++){const _=e.data[f],C=t[f];Gp(f),(null!==_.hostBindings||0!==_.hostVars||null!==_.hostAttrs)&&TR(_,C)}}finally{Vo(-1),Gp(h)}}function TR(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function c1(e,t,n){t.componentOffset=n,(e.components??=[]).push(t.index)}function AR(e,t,n){if(n){if(t.exportAs)for(let i=0;i<t.exportAs.length;i++)n[t.exportAs[i]]=e;Vt(t)&&(n[""]=e)}}function PR(e,t,n,i,r){e.data[i]=r;const l=r.factory||(r.factory=Ee(r.type)),h=new jh(l,Vt(r),pt);e.blueprint[i]=h,n[i]=h,function CR(e,t,n,i,r){const l=r.hostBindings;if(l){let h=e.hostBindingOpCodes;null===h&&(h=e.hostBindingOpCodes=[]);const f=~t.index;(function ER(e){let t=e.length;for(;t>0;){const n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(h)!=f&&h.push(f),h.push(n,i,l)}}(e,t,i,zm(e,n,r.hostVars,Jt),r)}function Ql(e,t,n,i,r,l){const h=es(e,t);!function u1(e,t,n,i,r,l,h){if(null==l)e.removeAttribute(t,r,n);else{const f=null==h?Lt(l):h(l,i||"",r);e.setAttribute(t,r,f,n)}}(t[kt],h,l,e.value,n,i,r)}function LR(e,t,n,i,r,l){const h=l[t];if(null!==h)for(let f=0;f<h.length;)OC(i,n,h[f++],h[f++],h[f++])}function OC(e,t,n,i,r){const l=Oe(null);try{const h=e.inputTransforms;null!==h&&h.hasOwnProperty(i)&&(r=h[i].call(t,r)),null!==e.setInput?e.setInput(t,r,n,i):t[i]=r}finally{Oe(l)}}function kR(e,t,n){let i=null,r=0;for(;r<n.length;){const l=n[r];if(0!==l)if(5!==l){if("number"==typeof l)break;if(e.hasOwnProperty(l)){null===i&&(i=[]);const h=e[l];for(let f=0;f<h.length;f+=2)if(h[f]===t){i.push(l,h[f+1],n[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function NC(e,t,n,i){return[e,!0,!1,t,null,0,i,n,null,null,null]}function FC(e,t){const n=e.contentQueries;if(null!==n)for(let i=0;i<n.length;i+=2){const l=n[i+1];if(-1!==l){const h=e.data[l];af(n[i]),h.contentQueries(2,t[l],l)}}}function Jy(e,t){return e[Ya]?e[Mh][Br]=t:e[Ya]=t,e[Mh]=t,t}function h1(e,t,n){af(0);const i=Oe(null);try{t(e,n)}finally{Oe(i)}}function zC(e){return e[ha]||(e[ha]=[])}function BC(e){return e.cleanup||(e.cleanup=[])}function VC(e,t){const n=e[Ni],i=n?n.get(Qc,null):null;i&&i.handleError(t)}function d1(e,t,n,i,r){for(let l=0;l<n.length;){const h=n[l++],f=n[l++];OC(e.data[h],t[h],i,f,r)}}function OR(e,t){const n=Qs(t,e),i=n[Qe];!function NR(e,t){for(let n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])}(i,n);const r=n[li];null!==r&&null===n[Zs]&&(n[Zs]=q0(r,n[Ni])),f1(i,n,n[xi])}function f1(e,t,n){kc(t);try{const i=e.viewQuery;null!==i&&h1(1,i,n);const r=e.template;null!==r&&IC(e,t,r,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&FC(e,t),e.staticViewQueries&&h1(2,e.viewQuery,n);const l=e.components;null!==l&&function FR(e,t){for(let n=0;n<t.length;n++)OR(e,t[n])}(t,l)}catch(i){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),i}finally{t[bt]&=-5,Uh()}}let jC=(()=>{class e{constructor(){this.all=new Set,this.queue=new Map}create(n,i,r){const l=typeof Zone>"u"?null:Zone.current,h=function uo(e,t,n){const i=Object.create(ho);n&&(i.consumerAllowSignalWrites=!0),i.fn=e,i.schedule=t;const r=h=>{i.cleanupFn=h};return i.ref={notify:()=>Zt(i),run:()=>{if(i.dirty=!1,i.hasRun&&!ir(i))return;i.hasRun=!0;const h=ci(i);try{i.cleanupFn(),i.cleanupFn=ms,i.fn(r)}finally{Fn(i,h)}},cleanup:()=>i.cleanupFn()},i.ref}(n,C=>{this.all.has(C)&&this.queue.set(C,l)},r);let f;this.all.add(h),h.notify();const _=()=>{h.cleanup(),f?.(),this.all.delete(h),this.queue.delete(h)};return f=i?.onDestroy(_),{destroy:_}}flush(){if(0!==this.queue.size)for(const[n,i]of this.queue)this.queue.delete(n),i?i.run(()=>n.run()):n.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=ft({token:e,providedIn:"root",factory:()=>new e})}return e})();function e_(e,t,n){let i=n?e.styles:null,r=n?e.classes:null,l=0;if(null!==t)for(let h=0;h<t.length;h++){const f=t[h];"number"==typeof f?l=f:1==l?r=pc(r,f):2==l&&(i=pc(i,f+": "+t[++h]+";"))}n?e.styles=i:e.stylesWithoutHost=i,n?e.classes=r:e.classesWithoutHost=r}function Bm(e,t,n,i,r=!1){for(;null!==n;){const l=t[n.index];null!==l&&i.push(hi(l)),fr(l)&&$C(l,i);const h=n.type;if(8&h)Bm(e,t,n.child,i);else if(32&h){const f=Mf(n,t);let _;for(;_=f();)i.push(_)}else if(16&h){const f=ze(t,n);if(Array.isArray(f))i.push(...f);else{const _=Kc(t[wi]);Bm(_[Qe],_,f,i,!0)}}n=r?n.projectionNext:n.next}return i}function $C(e,t){for(let n=Ii;n<e.length;n++){const i=e[n],r=i[Qe].firstChild;null!==r&&Bm(i[Qe],i,r,t)}e[En]!==e[li]&&t.push(e[En])}function t_(e,t,n,i=!0){const r=t[In],l=r.rendererFactory,h=r.afterRenderEventManager;l.begin?.(),h?.begin();try{HC(e,t,e.template,n)}catch(_){throw i&&VC(t,_),_}finally{l.end?.(),r.effectManager?.flush(),h?.end()}}function HC(e,t,n,i){const r=t[bt];if(256!=(256&r)){t[In].effectManager?.flush(),kc(t);try{Vp(t),function Xg(e){return At.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&IC(e,t,n,2,i);const h=3==(3&r);if(h){const C=e.preOrderCheckHooks;null!==C&&df(t,C,null)}else{const C=e.preOrderHooks;null!==C&&ff(t,C,0,null),ga(t,0)}if(function UR(e){for(let t=Pf(e);null!==t;t=Tm(t)){if(!t[da])continue;const n=t[Xs];for(let i=0;i<n.length;i++){Wv(n[i])}}}(t),qC(t,2),null!==e.contentQueries&&FC(e,t),h){const C=e.contentCheckHooks;null!==C&&df(t,C)}else{const C=e.contentHooks;null!==C&&ff(t,C,1),ga(t,1)}!function hR(e,t){const n=e.hostBindingOpCodes;if(null===n)return;const i=wC(t,ni);try{for(let r=0;r<n.length;r++){const l=n[r];if(l<0)Vo(~l);else{const h=l,f=n[++r],_=n[++r];Xv(f,h),i.dirty=!1;const C=ci(i);try{_(2,t[h])}finally{Fn(i,C)}}}}finally{null===t[ni]&&CC(t,ni),Vo(-1)}}(e,t);const f=e.components;null!==f&&WC(t,f,0);const _=e.viewQuery;if(null!==_&&h1(2,_,i),h){const C=e.viewCheckHooks;null!==C&&df(t,C)}else{const C=e.viewHooks;null!==C&&ff(t,C,2),ga(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),t[bt]&=-73,Vr(t)}finally{Uh()}}}function qC(e,t){for(let n=Pf(e);null!==n;n=Tm(n))for(let i=Ii;i<n.length;i++)GC(n[i],t)}function VR(e,t,n){GC(Qs(t,e),n)}function GC(e,t){if(!function Jd(e){return 128==(128&e[bt])}(e))return;const n=e[Qe],i=e[bt];if(80&i&&0===t||1024&i||2===t)HC(n,e,n.template,e[xi]);else if(e[Xa]>0){qC(e,1);const r=n.components;null!==r&&WC(e,r,1)}}function WC(e,t,n){for(let i=0;i<t.length;i++)VR(e,t[i],n)}class Um{get rootNodes(){const t=this._lView,n=t[Qe];return Bm(n,t,n.firstChild,[])}constructor(t,n){this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[xi]}set context(t){this._lView[xi]=t}get destroyed(){return 256==(256&this._lView[bt])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[Dn];if(fr(t)){const n=t[8],i=n?n.indexOf(this):-1;i>-1&&(w(t,i),Ar(n,i))}this._attachedToViewContainer=!1}E(this._lView[Qe],this._lView)}onDestroy(t){!function tf(e,t){if(256==(256&e[bt]))throw new Ie(911,!1);null===e[Rs]&&(e[Rs]=[]),e[Rs].push(t)}(this._lView,t)}markForCheck(){Fm(this._cdRefInjectingView||this._lView)}detach(){this._lView[bt]&=-129}reattach(){this._lView[bt]|=128}detectChanges(){t_(this._lView[Qe],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ie(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function s(e,t){et(e,t,t[kt],2,null,null)}(this._lView[Qe],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Ie(902,!1);this._appRef=t}}class jR extends Um{constructor(t){super(t),this._view=t}detectChanges(){const t=this._view;t_(t[Qe],t,t[xi],!1)}checkNoChanges(){}get context(){return null}}class ZC extends Zy{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const n=dn(t);return new Vm(n,this.ngModule)}}function KC(e){const t=[];for(let n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}class HR{constructor(t,n){this.injector=t,this.parentInjector=n}get(t,n,i){i=Sc(i);const r=this.injector.get(t,Z0,i);return r!==Z0||n===Z0?r:this.parentInjector.get(t,n,i)}}class Vm extends tC{get inputs(){const t=this.componentDef,n=t.inputTransforms,i=KC(t.inputs);if(null!==n)for(const r of i)n.hasOwnProperty(r.propName)&&(r.transform=n[r.propName]);return i}get outputs(){return KC(this.componentDef.outputs)}constructor(t,n){super(),this.componentDef=t,this.ngModule=n,this.componentType=t.type,this.selector=function Sh(e){return e.map(Lp).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!n}create(t,n,i,r){let l=(r=r||this.ngModule)instanceof Wo?r:r?.injector;l&&null!==this.componentDef.getStandaloneInjector&&(l=this.componentDef.getStandaloneInjector(l)||l);const h=l?new HR(t,l):t,f=h.get(Nm,null);if(null===f)throw new Ie(407,!1);const R={rendererFactory:f,sanitizer:h.get(UP,null),effectManager:h.get(jC,null),afterRenderEventManager:h.get(t1,null)},F=f.createRenderer(null,this.componentDef),$=this.componentDef.selectors[0][0]||"div",Q=i?function fR(e,t,n,i){const l=i.get(_C,!1)||n===ds.ShadowDom,h=e.selectRootElement(t,l);return function pR(e){MC(e)}(h),h}(F,i,this.componentDef.encapsulation,h):Zu(F,$,function $R(e){const t=e.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}($)),ve=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let pe=null;null!==Q&&(pe=q0(Q,h,!0));const Le=a1(0,null,null,1,0,null,null,null,null,null,null),qe=Qy(null,Le,null,ve,null,null,R,F,h,null,pe);let at,xt;kc(qe);try{const wt=this.componentDef;let Rt,Ht=null;wt.findHostDirectiveDefs?(Rt=[],Ht=new Map,wt.findHostDirectiveDefs(wt,Rt,Ht),Rt.push(wt)):Rt=[wt];const Xt=function GR(e,t){const n=e[Qe],i=tn;return e[i]=t,Hf(n,i,2,"#host",null)}(qe,Q),Ti=function WR(e,t,n,i,r,l,h){const f=r[Qe];!function ZR(e,t,n,i){for(const r of e)t.mergedAttrs=kl(t.mergedAttrs,r.hostAttrs);null!==t.mergedAttrs&&(e_(t,t.mergedAttrs,!0),null!==n&&Pi(i,n,t))}(i,e,t,h);let _=null;null!==t&&(_=q0(t,r[Ni]));const C=l.rendererFactory.createRenderer(t,n);let A=16;n.signals?A=4096:n.onPush&&(A=64);const R=Qy(r,AC(n),null,A,r[e.index],e,l,C,null,null,_);return f.firstCreatePass&&c1(f,e,i.length-1),Jy(r,R),r[e.index]=R}(Xt,Q,wt,Rt,qe,R,F);xt=Up(Le,tn),Q&&function XR(e,t,n,i){if(i)Du(e,n,["ng-version",VP.full]);else{const{attrs:r,classes:l}=function Xd(e){const t=[],n=[];let i=1,r=2;for(;i<e.length;){let l=e[i];if("string"==typeof l)2===r?""!==l&&t.push(l,e[++i]):8===r&&n.push(l);else{if(!Ms(r))break;r=l}i++}return{attrs:t,classes:n}}(t.selectors[0]);r&&Du(e,n,r),l&&l.length>0&&Hr(e,n,l.join(" "))}}(F,wt,Q,i),void 0!==n&&function YR(e,t,n){const i=e.projection=[];for(let r=0;r<t.length;r++){const l=n[r];i.push(null!=l?Array.from(l):null)}}(xt,this.ngContentSelectors,n),at=function KR(e,t,n,i,r,l){const h=jr(),f=r[Qe],_=es(h,r);LC(f,r,h,n,null,i);for(let A=0;A<n.length;A++)ns(zc(r,f,h.directiveStart+A,h),r);kC(f,r,h),_&&ns(_,r);const C=zc(r,f,h.directiveStart+h.componentOffset,h);if(e[xi]=r[xi]=C,null!==l)for(const A of l)A(C,t);return r1(f,h,e),C}(Ti,wt,Rt,Ht,qe,[QR]),f1(Le,qe,null)}finally{Uh()}return new qR(this.componentType,at,Uf(xt,qe),qe,xt)}}class qR extends kP{constructor(t,n,i,r,l){super(),this.location=i,this._rootLView=r,this._tNode=l,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new jR(r),this.componentType=t}setInput(t,n){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[t])){if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),n))return;const l=this._rootLView;d1(l[Qe],l,r,t,n),this.previousInputValues.set(t,n),Fm(Qs(this._tNode.index,l))}}get injector(){return new mr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function QR(){const e=jr();hf(Pe()[Qe],e)}function qf(e){let t=function XC(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0;const i=[e];for(;t;){let r;if(Vt(e))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Ie(903,!1);r=t.\u0275dir}if(r){if(n){i.push(r);const h=e;h.inputs=n_(e.inputs),h.inputTransforms=n_(e.inputTransforms),h.declaredInputs=n_(e.declaredInputs),h.outputs=n_(e.outputs);const f=r.hostBindings;f&&nL(e,f);const _=r.viewQuery,C=r.contentQueries;if(_&&eL(e,_),C&&tL(e,C),Va(e.inputs,r.inputs),Va(e.declaredInputs,r.declaredInputs),Va(e.outputs,r.outputs),null!==r.inputTransforms&&(null===h.inputTransforms&&(h.inputTransforms={}),Va(h.inputTransforms,r.inputTransforms)),Vt(r)&&r.data.animation){const A=e.data;A.animation=(A.animation||[]).concat(r.data.animation)}}const l=r.features;if(l)for(let h=0;h<l.length;h++){const f=l[h];f&&f.ngInherit&&f(e),f===qf&&(n=!1)}}t=Object.getPrototypeOf(t)}!function JR(e){let t=0,n=null;for(let i=e.length-1;i>=0;i--){const r=e[i];r.hostVars=t+=r.hostVars,r.hostAttrs=kl(r.hostAttrs,n=kl(n,r.hostAttrs))}}(i)}function n_(e){return e===Cn?{}:e===nn?[]:e}function eL(e,t){const n=e.viewQuery;e.viewQuery=n?(i,r)=>{t(i,r),n(i,r)}:t}function tL(e,t){const n=e.contentQueries;e.contentQueries=n?(i,r,l)=>{t(i,r,l),n(i,r,l)}:t}function nL(e,t){const n=e.hostBindings;e.hostBindings=n?(i,r)=>{t(i,r),n(i,r)}:t}function i_(e){return!!p1(e)&&(Array.isArray(e)||!(e instanceof Map)&&Symbol.iterator in e)}function p1(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function Jl(e,t,n){return e[t]=n}function Os(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function od(e,t,n,i){const r=Os(e,t,n);return Os(e,t+1,i)||r}function wa(e,t,n,i){const r=Pe();return Os(r,Ou(),t)&&(Sn(),Ql(Mi(),r,e,t,n,i)),wa}function zn(e,t,n,i,r,l,h,f){const _=Pe(),C=Sn(),A=e+tn,R=C.firstCreatePass?function DL(e,t,n,i,r,l,h,f,_){const C=t.consts,A=Hf(t,e,4,h||null,tl(C,f));l1(t,n,A,tl(C,_)),hf(t,A);const R=A.tView=a1(2,A,i,r,l,t.directiveRegistry,t.pipeRegistry,null,t.schemas,C,null);return null!==t.queries&&(t.queries.template(t,A),R.queries=t.queries.embeddedTView(A)),A}(A,C,_,t,n,i,r,l,h):C.data[A];po(R,!1);const F=fE(C,_,R,e);Vh()&&Ge(C,_,F,R),ns(F,_),Jy(_,_[A]=NC(F,_,F,R)),Bl(R)&&s1(C,_,R),null!=h&&o1(_,R,f)}let fE=function pE(e,t,n,i){return $l(!0),t[kt].createComment("")};function $t(e,t,n){const i=Pe();return Os(i,Ou(),t)&&function Zo(e,t,n,i,r,l,h,f){const _=es(t,n);let A,C=t.inputs;!f&&null!=C&&(A=C[i])?(d1(e,n,A,i,r),No(t)&&function xR(e,t){const n=Qs(t,e);16&n[bt]||(n[bt]|=64)}(n,t.index)):3&t.type&&(i=function bR(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(i),r=null!=h?h(r,t.value||"",i):r,l.setProperty(_,i,r))}(Sn(),Mi(),i,e,t,i[kt],n,!1),$t}function b1(e,t,n,i,r){const h=r?"class":"style";d1(e,n,t.inputs[h],h,i)}function bn(e,t,n,i){const r=Pe(),l=Sn(),h=tn+e,f=r[kt],_=l.firstCreatePass?function RL(e,t,n,i,r,l){const h=t.consts,_=Hf(t,e,2,i,tl(h,r));return l1(t,n,_,tl(h,l)),null!==_.attrs&&e_(_,_.attrs,!1),null!==_.mergedAttrs&&e_(_,_.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,_),_}(h,l,r,t,n,i):l.data[h],C=mE(l,r,_,f,t,e);r[h]=C;const A=Bl(_);return po(_,!0),Pi(f,C,_),32!=(32&_.flags)&&Vh()&&Ge(l,r,C,_),0===function Zv(){return At.lFrame.elementDepthCount}()&&ns(C,r),function qg(){At.lFrame.elementDepthCount++}(),A&&(s1(l,r,_),r1(l,_,r)),null!==i&&o1(r,_),bn}function Mn(){let e=jr();ku()?nf():(e=e.parent,po(e,!1));const t=e;(function Hp(e){return At.skipHydrationRootTNode===e})(t)&&function Js(){At.skipHydrationRootTNode=null}(),function Gg(){At.lFrame.elementDepthCount--}();const n=Sn();return n.firstCreatePass&&(hf(n,e),fa(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function n0(e){return 0!=(8&e.flags)}(t)&&b1(n,t,Pe(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function r0(e){return 0!=(16&e.flags)}(t)&&b1(n,t,Pe(),t.stylesWithoutHost,!1),Mn}function Wr(e,t,n,i){return bn(e,t,n,i),Mn(),Wr}let mE=(e,t,n,i,r,l)=>($l(!0),Zu(i,r,function uf(){return At.lFrame.currentNamespace}()));function ad(e,t,n){const i=Pe(),r=Sn(),l=e+tn,h=r.firstCreatePass?function OL(e,t,n,i,r){const l=t.consts,h=tl(l,i),f=Hf(t,e,8,"ng-container",h);return null!==h&&e_(f,h,!0),l1(t,n,f,tl(l,r)),null!==t.queries&&t.queries.elementStart(t,f),f}(l,r,i,t,n):r.data[l];po(h,!0);const f=gE(r,i,h,e);return i[l]=f,Vh()&&Ge(r,i,f,h),ns(f,i),Bl(h)&&(s1(r,i,h),r1(r,h,i)),null!=n&&o1(i,h),ad}function ld(){let e=jr();const t=Sn();return ku()?nf():(e=e.parent,po(e,!1)),t.firstCreatePass&&(hf(t,e),fa(e)&&t.queries.elementEnd(e)),ld}function Gm(e,t,n){return ad(e,t,n),ld(),Gm}let gE=(e,t,n,i)=>($l(!0),id(t[kt],""));function Ku(){return Pe()}function l_(e){return!!e&&"function"==typeof e.then}function yE(e){return!!e&&"function"==typeof e.subscribe}function Ca(e,t,n,i){const r=Pe(),l=Sn(),h=jr();return function vE(e,t,n,i,r,l,h){const f=Bl(i),C=e.firstCreatePass&&BC(e),A=t[xi],R=zC(t);let F=!0;if(3&i.type||h){const ee=es(i,t),me=h?h(ee):ee,ve=R.length,pe=h?qe=>h(hi(qe[i.index])):i.index;let Le=null;if(!h&&f&&(Le=function zL(e,t,n,i){const r=e.cleanup;if(null!=r)for(let l=0;l<r.length-1;l+=2){const h=r[l];if(h===n&&r[l+1]===i){const f=t[ha],_=r[l+2];return f.length>_?f[_]:null}"string"==typeof h&&(l+=2)}return null}(e,t,r,i.index)),null!==Le)(Le.__ngLastListenerFn__||Le).__ngNextListenerFn__=l,Le.__ngLastListenerFn__=l,F=!1;else{l=xE(i,t,A,l,!1);const qe=n.listen(me,r,l);R.push(l,qe),C&&C.push(r,pe,ve,ve+1)}}else l=xE(i,t,A,l,!1);const $=i.outputs;let Q;if(F&&null!==$&&(Q=$[r])){const ee=Q.length;if(ee)for(let me=0;me<ee;me+=2){const at=t[Q[me]][Q[me+1]].subscribe(l),xt=R.length;R.push(l,at),C&&C.push(r,i.index,xt,-(xt+1))}}}(l,r,r[kt],h,e,t,i),Ca}function bE(e,t,n,i){try{return zo(6,t,n),!1!==n(i)}catch(r){return VC(e,r),!1}finally{zo(7,t,n)}}function xE(e,t,n,i,r){return function l(h){if(h===Function)return i;Fm(e.componentOffset>-1?Qs(e.index,t):t);let _=bE(t,n,i,h),C=l.__ngNextListenerFn__;for(;C;)_=bE(t,n,C,h)&&_,C=C.__ngNextListenerFn__;return r&&!1===_&&h.preventDefault(),_}}function ri(e=1){return function Yg(e){return(At.lFrame.contextLView=function Yv(e,t){for(;e>0;)t=t[Qa],e--;return t}(e,At.lFrame.contextLView))[xi]}(e)}function BL(e,t){let n=null;const i=function Ps(e){const t=e.attrs;if(null!=t){const n=t.indexOf(5);if(!(1&n))return t[n+1]}return null}(e);for(let r=0;r<t.length;r++){const l=t[r];if("*"!==l){if(null===i?Eh(e,l,!0):Lo(i,l))return r}else n=r}return n}function Wm(e){const t=Pe()[wi][Oi];if(!t.projection){const i=t.projection=Hc(e?e.length:1,null),r=i.slice();let l=t.child;for(;null!==l;){const h=e?BL(l,e):0;null!==h&&(r[h]?r[h].projectionNext=l:i[h]=l,r[h]=l),l=l.next}}}function cd(e,t=0,n){const i=Pe(),r=Sn(),l=Hf(r,tn+e,16,null,n||null);null===l.projection&&(l.projection=t),nf(),(!i[Zs]||Lu())&&32!=(32&l.flags)&&function Gt(e,t,n){$n(t[kt],0,t,n,N(e,n,t),fe(n.parent||t[Oi],n,t))}(r,i,l)}function c_(e,t){return e<<17|t<<2}function Xu(e){return e>>17&32767}function w1(e){return 2|e}function ud(e){return(131068&e)>>2}function C1(e,t){return-131069&e|t<<2}function E1(e){return 1|e}function PE(e,t,n,i,r){const l=e[n+1],h=null===t;let f=i?Xu(l):ud(l),_=!1;for(;0!==f&&(!1===_||h);){const A=e[f+1];qL(e[f],t)&&(_=!0,e[f+1]=i?E1(A):w1(A)),f=i?Xu(A):ud(A)}_&&(e[n+1]=i?w1(l):E1(l))}function qL(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&sl(e,t)>=0}const Zr={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function RE(e){return e.substring(Zr.key,Zr.keyEnd)}function GL(e){return e.substring(Zr.value,Zr.valueEnd)}function LE(e,t){const n=Zr.textEnd;return n===t?-1:(t=Zr.keyEnd=function KL(e,t,n){for(;t<n&&e.charCodeAt(t)>32;)t++;return t}(e,Zr.key=t,n),tp(e,t,n))}function kE(e,t){const n=Zr.textEnd;let i=Zr.key=tp(e,t,n);return n===i?-1:(i=Zr.keyEnd=function XL(e,t,n){let i;for(;t<n&&(45===(i=e.charCodeAt(t))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)t++;return t}(e,i,n),i=NE(e,i,n),i=Zr.value=tp(e,i,n),i=Zr.valueEnd=function YL(e,t,n){let i=-1,r=-1,l=-1,h=t,f=h;for(;h<n;){const _=e.charCodeAt(h++);if(59===_)return f;34===_||39===_?f=h=FE(e,_,h,n):t===h-4&&85===l&&82===r&&76===i&&40===_?f=h=FE(e,41,h,n):_>32&&(f=h),l=r,r=i,i=-33&_}return f}(e,i,n),NE(e,i,n))}function OE(e){Zr.key=0,Zr.keyEnd=0,Zr.value=0,Zr.valueEnd=0,Zr.textEnd=e.length}function tp(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function NE(e,t,n,i){return(t=tp(e,t,n))<n&&t++,t}function FE(e,t,n,i){let r=-1,l=n;for(;l<i;){const h=e.charCodeAt(l++);if(h==t&&92!==r)return l;r=92==h&&92===r?0:h}throw new Error}function QL(e,t){for(let n=function ZL(e){return OE(e),kE(e,tp(e,0,Zr.textEnd))}(t);n>=0;n=kE(t,n))jE(e,RE(t),GL(t))}function Yu(e){pl(rk,ec,e,!0)}function ec(e,t){for(let n=function WL(e){return OE(e),LE(e,tp(e,0,Zr.textEnd))}(t);n>=0;n=LE(t,n))Mr(e,RE(t),!0)}function pl(e,t,n,i){const r=Sn(),l=function il(e){const t=At.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}(2);r.firstUpdatePass&&function VE(e,t,n,i){const r=e.data;if(null===r[n+1]){const l=r[ts()],h=UE(e,n);qE(l,i)&&null===t&&!h&&(t=!1),t=function JL(e,t,n,i){const r=function yi(e){const t=At.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e);let l=i?t.residualClasses:t.residualStyles;if(null===r)0===(i?t.classBindings:t.styleBindings)&&(n=Zm(n=S1(null,e,t,n,i),t.attrs,i),l=null);else{const h=t.directiveStylingLast;if(-1===h||e[h]!==r)if(n=S1(r,e,t,n,i),null===l){let _=function ek(e,t,n){const i=n?t.classBindings:t.styleBindings;if(0!==ud(i))return e[Xu(i)]}(e,t,i);void 0!==_&&Array.isArray(_)&&(_=S1(null,e,t,_[1],i),_=Zm(_,t.attrs,i),function tk(e,t,n,i){e[Xu(n?t.classBindings:t.styleBindings)]=i}(e,t,i,_))}else l=function nk(e,t,n){let i;const r=t.directiveEnd;for(let l=1+t.directiveStylingLast;l<r;l++)i=Zm(i,e[l].hostAttrs,n);return Zm(i,t.attrs,n)}(e,t,i)}return void 0!==l&&(i?t.residualClasses=l:t.residualStyles=l),n}(r,l,t,i),function $L(e,t,n,i,r,l){let h=l?t.classBindings:t.styleBindings,f=Xu(h),_=ud(h);e[i]=n;let A,C=!1;if(Array.isArray(n)?(A=n[1],(null===A||sl(n,A)>0)&&(C=!0)):A=n,r)if(0!==_){const F=Xu(e[f+1]);e[i+1]=c_(F,f),0!==F&&(e[F+1]=C1(e[F+1],i)),e[f+1]=function VL(e,t){return 131071&e|t<<17}(e[f+1],i)}else e[i+1]=c_(f,0),0!==f&&(e[f+1]=C1(e[f+1],i)),f=i;else e[i+1]=c_(_,0),0===f?f=i:e[_+1]=C1(e[_+1],i),_=i;C&&(e[i+1]=w1(e[i+1])),PE(e,A,i,!0),PE(e,A,i,!1),function HL(e,t,n,i,r){const l=r?e.residualClasses:e.residualStyles;null!=l&&"string"==typeof t&&sl(l,t)>=0&&(n[i+1]=E1(n[i+1]))}(t,A,e,i,l),h=c_(f,_),l?t.classBindings=h:t.styleBindings=h}(r,l,t,n,h,i)}}(r,null,l,i);const h=Pe();if(n!==Jt&&Os(h,l,n)){const f=r.data[ts()];if(qE(f,i)&&!UE(r,l)){let _=i?f.classesWithoutHost:f.stylesWithoutHost;null!==_&&(n=pc(_,n||"")),b1(r,f,h,n,i)}else!function sk(e,t,n,i,r,l,h,f){r===Jt&&(r=nn);let _=0,C=0,A=0<r.length?r[0]:null,R=0<l.length?l[0]:null;for(;null!==A||null!==R;){const F=_<r.length?r[_+1]:void 0,$=C<l.length?l[C+1]:void 0;let ee,Q=null;A===R?(_+=2,C+=2,F!==$&&(Q=R,ee=$)):null===R||null!==A&&A<R?(_+=2,Q=A):(C+=2,Q=R,ee=$),null!==Q&&$E(e,t,n,i,Q,ee,h,f),A=_<r.length?r[_]:null,R=C<l.length?l[C]:null}}(r,f,h,h[kt],h[l+1],h[l+1]=function ik(e,t,n){if(null==n||""===n)return nn;const i=[],r=ar(n);if(Array.isArray(r))for(let l=0;l<r.length;l++)e(i,r[l],!0);else if("object"==typeof r)for(const l in r)r.hasOwnProperty(l)&&e(i,l,r[l]);else"string"==typeof r&&t(i,r);return i}(e,t,n),i,l)}}function UE(e,t){return t>=e.expandoStartIndex}function S1(e,t,n,i,r){let l=null;const h=n.directiveEnd;let f=n.directiveStylingLast;for(-1===f?f=n.directiveStart:f++;f<h&&(l=t[f],i=Zm(i,l.hostAttrs,r),l!==e);)f++;return null!==e&&(n.directiveStylingLast=f),i}function Zm(e,t,n){const i=n?1:2;let r=-1;if(null!==t)for(let l=0;l<t.length;l++){const h=t[l];"number"==typeof h?r=h:r===i&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),Mr(e,h,!!n||t[++l]))}return void 0===e?null:e}function jE(e,t,n){Mr(e,t,ar(n))}function rk(e,t,n){const i=String(t);""!==i&&!i.includes(" ")&&Mr(e,i,n)}function $E(e,t,n,i,r,l,h,f){if(!(3&t.type))return;const _=e.data,C=_[f+1],A=function jL(e){return 1==(1&e)}(C)?HE(_,t,n,r,ud(C),h):void 0;u_(A)||(u_(l)||function UL(e){return 2==(2&e)}(C)&&(l=HE(_,null,n,r,f,h)),function Ki(e,t,n,i,r){if(t)r?e.addClass(n,i):e.removeClass(n,i);else{let l=-1===i.indexOf("-")?void 0:ol.DashCase;null==r?e.removeStyle(n,i,l):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),l|=ol.Important),e.setStyle(n,i,r,l))}}(i,h,Qd(ts(),n),r,l))}function HE(e,t,n,i,r,l){const h=null===t;let f;for(;r>0;){const _=e[r],C=Array.isArray(_),A=C?_[1]:_,R=null===A;let F=n[r+1];F===Jt&&(F=R?nn:void 0);let $=R?Hu(F,i):A===i?F:void 0;if(C&&!u_($)&&($=Hu(_,i)),u_($)&&(f=$,h))return f;const Q=e[r+1];r=h?Xu(Q):ud(Q)}if(null!==t){let _=l?t.residualClasses:t.residualStyles;null!=_&&(f=Hu(_,i))}return f}function u_(e){return void 0!==e}function qE(e,t){return 0!=(e.flags&(t?8:16))}function Ea(e,t=""){const n=Pe(),i=Sn(),r=e+tn,l=i.firstCreatePass?Hf(i,r,1,t,null):i.data[r],h=GE(i,n,l,t,e);n[r]=h,Vh()&&Ge(i,n,h,l),po(l,!1)}let GE=(e,t,n,i,r)=>($l(!0),function Kl(e,t){return e.createText(t)}(t[kt],i));function h_(e){return tu("",e,""),h_}function tu(e,t,n){const i=Pe(),r=function Wf(e,t,n,i){return Os(e,Ou(),n)?t+Lt(n)+i:Jt}(i,e,t,n);return r!==Jt&&function eu(e,t,n){const i=Qd(t,e);!function Lf(e,t,n){e.setValue(t,n)}(e[kt],i,n)}(i,ts(),r),tu}const ip="en-US";let pS=ip;class dd{}class US{}class R1 extends dd{constructor(t,n,i){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new ZC(this);const r=Qr(t);this._bootstrapComponents=Jc(r.bootstrap),this._r3Injector=aC(t,n,[{provide:dd,useValue:this},{provide:Zy,useValue:this.componentFactoryResolver},...i],Kn(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class L1 extends US{constructor(t){super(),this.moduleType=t}create(t){return new R1(this.moduleType,t,[])}}class VS extends dd{constructor(t){super(),this.componentFactoryResolver=new ZC(this),this.instance=null;const n=new Nf([...t.providers,{provide:dd,useValue:this},{provide:Zy,useValue:this.componentFactoryResolver}],t.parent||Vy(),t.debugName,new Set(["environment"]));this.injector=n,t.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function k1(e,t,n=null){return new VS({providers:e,parent:t,debugName:n,runEnvironmentInitializers:!0}).injector}let PO=(()=>{class e{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){const i=Hw(0,n.type),r=i.length>0?k1([i],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,r)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=ft({token:e,providedIn:"environment",factory:()=>new e(lt(Wo))})}return e})();function fd(e){e.getStandaloneInjector=t=>t.get(PO).getOrCreateStandaloneInjector(e)}function g_(e,t,n){const i=gs()+e,r=Pe();return r[i]===Jt?Jl(r,i,n?t.call(n):t()):function jm(e,t){return e[t]}(r,i)}function ZS(e,t,n,i){return function QS(e,t,n,i,r,l){const h=t+n;return Os(e,h,r)?Jl(e,h+1,l?i.call(l,r):i(r)):eg(e,h+1)}(Pe(),gs(),e,t,n,i)}function KS(e,t,n,i,r){return function JS(e,t,n,i,r,l,h){const f=t+n;return od(e,f,r,l)?Jl(e,f+2,h?i.call(h,r,l):i(r,l)):eg(e,f+2)}(Pe(),gs(),e,t,n,i,r)}function XS(e,t,n,i,r,l,h){return function tT(e,t,n,i,r,l,h,f,_){const C=t+n;return function xa(e,t,n,i,r,l){const h=od(e,t,n,i);return od(e,t+2,r,l)||h}(e,C,r,l,h,f)?Jl(e,C+4,_?i.call(_,r,l,h,f):i(r,l,h,f)):eg(e,C+4)}(Pe(),gs(),e,t,n,i,r,l,h)}function YS(e,t,n,i){return function nT(e,t,n,i,r,l){let h=t+n,f=!1;for(let _=0;_<r.length;_++)Os(e,h++,r[_])&&(f=!0);return f?Jl(e,h,i.apply(l,r)):eg(e,h)}(Pe(),gs(),e,t,n,i)}function eg(e,t){const n=e[t];return n===Jt?void 0:n}function QO(){return this._results[Symbol.iterator]()}class N1{static#e=Symbol.iterator;get changes(){return this._changes||(this._changes=new lr)}constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const n=N1.prototype;n[Symbol.iterator]||(n[Symbol.iterator]=QO)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,n){return this._results.reduce(t,n)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,n){const i=this;i.dirty=!1;const r=function mo(e){return e.flat(Number.POSITIVE_INFINITY)}(t);(this._changesDetected=!function d0(e,t,n){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++){let r=e[i],l=t[i];if(n&&(r=n(r),l=n(l)),l!==r)return!1}return!0}(i._results,r,n))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function eN(e,t,n,i=!0){const r=t[Qe];if(function d(e,t,n,i){const r=Ii+i,l=n.length;i>0&&(n[r-1][Br]=t),i<l-Ii?(t[Br]=n[r],sm(n,Ii+i,t)):(n.push(t),t[Br]=null),t[Dn]=n;const h=t[Ic];null!==h&&n!==h&&function m(e,t){const n=e[Xs];t[wi]!==t[Dn][Dn][wi]&&(e[da]=!0),null===n?e[Xs]=[t]:n.push(t)}(h,t);const f=t[ps];null!==f&&f.insertView(e),t[bt]|=128}(r,t,e,n),i){const l=Xe(n,e),h=t[kt],f=ce(h,e[En]);null!==f&&function a(e,t,n,i,r,l){i[li]=r,i[Oi]=t,et(e,i,n,1,r,l)}(r,e[Oi],h,t,f,l)}}let tc=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=iN}return e})();const tN=tc,nN=class extends tN{constructor(t,n,i){super(),this._declarationLView=t,this._declarationTContainer=n,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,n){return this.createEmbeddedViewImpl(t,n)}createEmbeddedViewImpl(t,n,i){const r=function JO(e,t,n,i){const r=t.tView,f=Qy(e,r,n,4096&e[bt]?4096:16,null,t,null,null,null,i?.injector??null,i?.hydrationInfo??null);f[Ic]=e[t.index];const C=e[ps];return null!==C&&(f[ps]=C.createEmbeddedView(r)),f1(r,f,n),f}(this._declarationLView,this._declarationTContainer,t,{injector:n,hydrationInfo:i});return new Um(r)}};function iN(){return y_(jr(),Pe())}function y_(e,t){return 4&e.type?new nN(t,e,Uf(e,t)):null}let ml=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=cN}return e})();function cN(){return cT(jr(),Pe())}const uN=ml,aT=class extends uN{constructor(t,n,i){super(),this._lContainer=t,this._hostTNode=n,this._hostLView=i}get element(){return Uf(this._hostTNode,this._hostLView)}get injector(){return new mr(this._hostTNode,this._hostLView)}get parentInjector(){const t=Hh(this._hostTNode,this._hostLView);if(Nc(t)){const n=$h(t,this._hostLView),i=Fc(t);return new mr(n[Qe].data[i+8],n)}return new mr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const n=lT(this._lContainer);return null!==n&&n[t]||null}get length(){return this._lContainer.length-Ii}createEmbeddedView(t,n,i){let r,l;"number"==typeof i?r=i:null!=i&&(r=i.index,l=i.injector);const f=t.createEmbeddedViewImpl(n||{},l,null);return this.insertImpl(f,r,false),f}createComponent(t,n,i,r,l){const h=t&&!function Kh(e){return"function"==typeof e}(t);let f;if(h)f=n;else{const ee=n||{};f=ee.index,i=ee.injector,r=ee.projectableNodes,l=ee.environmentInjector||ee.ngModuleRef}const _=h?t:new Vm(dn(t)),C=i||this.parentInjector;if(!l&&null==_.ngModule){const me=(h?C:this.parentInjector).get(Wo,null);me&&(l=me)}dn(_.componentType??{});const $=_.create(C,r,null,l);return this.insertImpl($.hostView,f,false),$}insert(t,n){return this.insertImpl(t,n,!1)}insertImpl(t,n,i){const r=t._lView;if(function ef(e){return fr(e[Dn])}(r)){const _=this.indexOf(t);if(-1!==_)this.detach(_);else{const C=r[Dn],A=new aT(C,C[Oi],C[Dn]);A.detach(A.indexOf(t))}}const h=this._adjustIndex(n),f=this._lContainer;return eN(f,r,h,!i),t.attachToViewContainerRef(),sm(F1(f),h,t),t}move(t,n){return this.insert(t,n)}indexOf(t){const n=lT(this._lContainer);return null!==n?n.indexOf(t):-1}remove(t){const n=this._adjustIndex(t,-1),i=w(this._lContainer,n);i&&(Ar(F1(this._lContainer),n),E(i[Qe],i))}detach(t){const n=this._adjustIndex(t,-1),i=w(this._lContainer,n);return i&&null!=Ar(F1(this._lContainer),n)?new Um(i):null}_adjustIndex(t,n=0){return t??this.length+n}};function lT(e){return e[8]}function F1(e){return e[8]||(e[8]=[])}function cT(e,t){let n;const i=t[e.index];return fr(i)?n=i:(n=NC(i,t,null,e),t[e.index]=n,Jy(t,n)),uT(n,t,e,i),new aT(n,e,t)}let uT=function hT(e,t,n,i){if(e[En])return;let r;r=8&n.type?hi(i):function hN(e,t){const n=e[kt],i=n.createComment(""),r=es(t,e);return j(n,ce(n,r),i,function oe(e,t){return e.nextSibling(t)}(n,r),!1),i}(t,n),e[En]=r};class z1{constructor(t){this.queryList=t,this.matches=null}clone(){return new z1(this.queryList)}setDirty(){this.queryList.setDirty()}}class B1{constructor(t=[]){this.queries=t}createEmbeddedView(t){const n=t.queries;if(null!==n){const i=null!==t.contentQueries?t.contentQueries[0]:n.length,r=[];for(let l=0;l<i;l++){const h=n.getByIndex(l);r.push(this.queries[h.indexInDeclarationView].clone())}return new B1(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let n=0;n<this.queries.length;n++)null!==gT(t,n).matches&&this.queries[n].setDirty()}}class dT{constructor(t,n,i=null){this.predicate=t,this.flags=n,this.read=i}}class U1{constructor(t=[]){this.queries=t}elementStart(t,n){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(t,n)}elementEnd(t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(t)}embeddedTView(t){let n=null;for(let i=0;i<this.length;i++){const r=null!==n?n.length:0,l=this.getByIndex(i).embeddedTView(t,r);l&&(l.indexInDeclarationView=i,null!==n?n.push(l):n=[l])}return null!==n?new U1(n):null}template(t,n){for(let i=0;i<this.queries.length;i++)this.queries[i].template(t,n)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class V1{constructor(t,n=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(t,n){this.isApplyingToNode(n)&&this.matchTNode(t,n)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,n){this.elementStart(t,n)}embeddedTView(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new V1(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const n=this._declarationNodeIndex;let i=t.parent;for(;null!==i&&8&i.type&&i.index!==n;)i=i.parent;return n===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(t,n){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const l=i[r];this.matchTNodeWithReadOption(t,n,pN(n,l)),this.matchTNodeWithReadOption(t,n,Wh(n,t,l,!1,!1))}else i===tc?4&n.type&&this.matchTNodeWithReadOption(t,n,-1):this.matchTNodeWithReadOption(t,n,Wh(n,t,i,!1,!1))}matchTNodeWithReadOption(t,n,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===hl||r===ml||r===tc&&4&n.type)this.addMatch(n.index,-2);else{const l=Wh(n,t,r,!1,!1);null!==l&&this.addMatch(n.index,l)}else this.addMatch(n.index,i)}}addMatch(t,n){null===this.matches?this.matches=[t,n]:this.matches.push(t,n)}}function pN(e,t){const n=e.localNames;if(null!==n)for(let i=0;i<n.length;i+=2)if(n[i]===t)return n[i+1];return null}function gN(e,t,n,i){return-1===n?function mN(e,t){return 11&e.type?Uf(e,t):4&e.type?y_(e,t):null}(t,e):-2===n?function yN(e,t,n){return n===hl?Uf(t,e):n===tc?y_(t,e):n===ml?cT(t,e):void 0}(e,t,i):zc(e,e[Qe],n,t)}function fT(e,t,n,i){const r=t[ps].queries[i];if(null===r.matches){const l=e.data,h=n.matches,f=[];for(let _=0;_<h.length;_+=2){const C=h[_];f.push(C<0?null:gN(t,l[C],h[_+1],n.metadata.read))}r.matches=f}return r.matches}function j1(e,t,n,i){const r=e.queries.getByIndex(n),l=r.matches;if(null!==l){const h=fT(e,t,r,n);for(let f=0;f<l.length;f+=2){const _=l[f];if(_>0)i.push(h[f/2]);else{const C=l[f+1],A=t[-_];for(let R=Ii;R<A.length;R++){const F=A[R];F[Ic]===F[Dn]&&j1(F[Qe],F,C,i)}if(null!==A[Xs]){const R=A[Xs];for(let F=0;F<R.length;F++){const $=R[F];j1($[Qe],$,C,i)}}}}}return i}function nu(e){const t=Pe(),n=Sn(),i=zh();af(i+1);const r=gT(n,i);if(e.dirty&&function Oh(e){return 4==(4&e[bt])}(t)===(2==(2&r.metadata.flags))){if(null===r.matches)e.reset([]);else{const l=r.crossesNgTemplate?j1(n,t,i,[]):fT(n,t,r,i);e.reset(l,zP),e.notifyOnChanges()}return!0}return!1}function ng(e,t,n){const i=Sn();i.firstCreatePass&&(mT(i,new dT(e,t,n),-1),2==(2&t)&&(i.staticViewQueries=!0)),pT(i,Pe(),t)}function ig(e,t,n,i){const r=Sn();if(r.firstCreatePass){const l=jr();mT(r,new dT(t,n,i),l.index),function vN(e,t){const n=e.contentQueries||(e.contentQueries=[]);t!==(n.length?n[n.length-1]:-1)&&n.push(e.queries.length-1,t)}(r,e),2==(2&n)&&(r.staticContentQueries=!0)}pT(r,Pe(),n)}function iu(){return function _N(e,t){return e[ps].queries[t].queryList}(Pe(),zh())}function pT(e,t,n){const i=new N1(4==(4&n));(function yR(e,t,n,i){const r=zC(t);r.push(n),e.firstCreatePass&&BC(e).push(i,r.length-1)})(e,t,i,i.destroy),null===t[ps]&&(t[ps]=new B1),t[ps].queries.push(new z1(i))}function mT(e,t,n){null===e.queries&&(e.queries=new U1),e.queries.track(new V1(t,n))}function gT(e,t){return e.queries.getByIndex(t)}const Z1=new ut("Application Initializer");let K1=(()=>{class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,i)=>{this.resolve=n,this.reject=i}),this.appInits=tt(Z1,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const n=[];for(const r of this.appInits){const l=r();if(l_(l))n.push(l);else if(yE(l)){const h=new Promise((f,_)=>{l.subscribe({complete:f,error:_})});n.push(h)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{i()}).catch(r=>{this.reject(r)}),0===n.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),LT=(()=>{class e{log(n){console.log(n)}warn(n){console.warn(n)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();const ru=new ut("LocaleId",{providedIn:"root",factory:()=>tt(ru,en.Optional|en.SkipSelf)||function VN(){return typeof $localize<"u"&&$localize.locale||ip}()});let b_=(()=>{class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new yn(!1)}add(){this.hasPendingTasks.next(!0);const n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class HN{constructor(t,n){this.ngModuleFactory=t,this.componentFactories=n}}let kT=(()=>{class e{compileModuleSync(n){return new L1(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const i=this.compileModuleSync(n),l=Jc(Qr(n).declarations).reduce((h,f)=>{const _=dn(f);return _&&h.push(new Vm(_)),h},[]);return new HN(i,l)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const zT=new ut(""),w_=new ut("");let eb,Q1=(()=>{class e{constructor(n,i,r){this._ngZone=n,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,eb||(function dF(e){eb=e}(r),r.addToWindow(i)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Yn.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(n)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,i,r){let l=-1;i&&i>0&&(l=setTimeout(()=>{this._callbacks=this._callbacks.filter(h=>h.timeoutId!==l),n(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:n,timeoutId:l,updateCb:r})}whenStable(n,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,i,r){return[]}static#e=this.\u0275fac=function(i){return new(i||e)(lt(Yn),lt(J1),lt(w_))};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac})}return e})(),J1=(()=>{class e{constructor(){this._applications=new Map}registerApplication(n,i){this._applications.set(n,i)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,i=!0){return eb?.findTestabilityInTree(this,n,i)??null}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})(),Qu=null;const BT=new ut("AllowMultipleToken"),tb=new ut("PlatformDestroyListeners"),nb=new ut("appBootstrapListener");class VT{constructor(t,n){this.name=t,this.token=n}}function $T(e,t,n=[]){const i=`Platform: ${t}`,r=new ut(i);return(l=[])=>{let h=ib();if(!h||h.injector.get(BT,!1)){const f=[...n,...l,{provide:r,useValue:!0}];e?e(f):function mF(e){if(Qu&&!Qu.get(BT,!1))throw new Ie(400,!1);(function UT(){!function Gi(e){pa=e}(()=>{throw new Ie(600,!1)})})(),Qu=e;const t=e.get(qT);(function jT(e){e.get(Kw,null)?.forEach(n=>n())})(e)}(function HT(e=[],t){return ba.create({name:t,providers:[{provide:k0,useValue:"platform"},{provide:tb,useValue:new Set([()=>Qu=null])},...e]})}(f,i))}return function yF(e){const t=ib();if(!t)throw new Ie(401,!1);return t}()}}function ib(){return Qu?.get(qT)??null}let qT=(()=>{class e{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,i){const r=function _F(e="zone.js",t){return"noop"===e?new JP:"zone.js"===e?new Yn(t):e}(i?.ngZone,function GT(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:e?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:e?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const l=function MO(e,t,n){return new R1(e,t,n)}(n.moduleType,this.injector,function YT(e){return[{provide:Yn,useFactory:e},{provide:Lm,multi:!0,useFactory:()=>{const t=tt(bF,{optional:!0});return()=>t.initialize()}},{provide:XT,useFactory:vF},{provide:dC,useFactory:fC}]}(()=>r)),h=l.injector.get(Qc,null);return r.runOutsideAngular(()=>{const f=r.onError.subscribe({next:_=>{h.handleError(_)}});l.onDestroy(()=>{C_(this._modules,l),f.unsubscribe()})}),function WT(e,t,n){try{const i=n();return l_(i)?i.catch(r=>{throw t.runOutsideAngular(()=>e.handleError(r)),r}):i}catch(i){throw t.runOutsideAngular(()=>e.handleError(i)),i}}(h,r,()=>{const f=l.injector.get(K1);return f.runInitializers(),f.donePromise.then(()=>(function mS(e){Nr(e,"Expected localeId to be defined"),"string"==typeof e&&(pS=e.toLowerCase().replace(/_/g,"-"))}(l.injector.get(ru,ip)||ip),this._moduleDoBootstrap(l),l))})})}bootstrapModule(n,i=[]){const r=ZT({},i);return function fF(e,t,n){const i=new L1(n);return Promise.resolve(i)}(0,0,n).then(l=>this.bootstrapModuleFactory(l,r))}_moduleDoBootstrap(n){const i=n.injector.get(pd);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!n.instance.ngDoBootstrap)throw new Ie(-403,!1);n.instance.ngDoBootstrap(i)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ie(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const n=this._injector.get(tb,null);n&&(n.forEach(i=>i()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(i){return new(i||e)(lt(ba))};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();function ZT(e,t){return Array.isArray(t)?t.reduce(ZT,e):{...e,...t}}let pd=(()=>{class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=tt(XT),this.zoneIsStable=tt(dC),this.componentTypes=[],this.components=[],this.isStable=tt(b_).hasPendingTasks.pipe(tr(n=>n?Et(!1):this.zoneIsStable),function Od(e,t=ji){return e=e??fh,Wn((n,i)=>{let r,l=!0;n.subscribe(kn(i,h=>{const f=t(h);(l||!e(r,f))&&(l=!1,r=f,i.next(h))}))})}(),us()),this._injector=tt(Wo)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,i){const r=n instanceof tC;if(!this._injector.get(K1).done)throw!r&&function ua(e){const t=dn(e)||qi(e)||zr(e);return null!==t&&t.standalone}(n),new Ie(405,!1);let h;h=r?n:this._injector.get(Zy).resolveComponentFactory(n),this.componentTypes.push(h.componentType);const f=function pF(e){return e.isBoundToModule}(h)?void 0:this._injector.get(dd),C=h.create(ba.NULL,[],i||h.selector,f),A=C.location.nativeElement,R=C.injector.get(zT,null);return R?.registerApplication(A),C.onDestroy(()=>{this.detachView(C.hostView),C_(this.components,C),R?.unregisterApplication(A)}),this._loadComponent(C),C}tick(){if(this._runningTick)throw new Ie(101,!1);try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this.internalErrorHandler(n)}finally{this._runningTick=!1}}attachView(n){const i=n;this._views.push(i),i.attachToAppRef(this)}detachView(n){const i=n;C_(this._views,i),i.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);const i=this._injector.get(nb,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>C_(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new Ie(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function C_(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const XT=new ut("",{providedIn:"root",factory:()=>tt(Qc).handleError.bind(void 0)});function vF(){const e=tt(Yn),t=tt(Qc);return n=>e.runOutsideAngular(()=>t.handleError(n))}let bF=(()=>{class e{constructor(){this.zone=tt(Yn),this.applicationRef=tt(pd)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();let E_=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=wF}return e})();function wF(e){return function CF(e,t,n){if(No(e)&&!n){const i=Qs(e.index,t);return new Um(i,i)}return 47&e.type?new Um(t[wi],t):null}(jr(),Pe(),16==(16&e))}class tD{constructor(){}supports(t){return i_(t)}create(t){return new AF(t)}}const IF=(e,t)=>t;class AF{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||IF}forEachItem(t){let n;for(n=this._itHead;null!==n;n=n._next)t(n)}forEachOperation(t){let n=this._itHead,i=this._removalsHead,r=0,l=null;for(;n||i;){const h=!i||n&&n.currentIndex<iD(i,r,l)?n:i,f=iD(h,r,l),_=h.currentIndex;if(h===i)r--,i=i._nextRemoved;else if(n=n._next,null==h.previousIndex)r++;else{l||(l=[]);const C=f-r,A=_-r;if(C!=A){for(let F=0;F<C;F++){const $=F<l.length?l[F]:l[F]=0,Q=$+F;A<=Q&&Q<C&&(l[F]=$+1)}l[h.previousIndex]=A-C}}f!==_&&t(h,f,_)}}forEachPreviousItem(t){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachMovedItem(t){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}forEachIdentityChange(t){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)t(n)}diff(t){if(null==t&&(t=[]),!i_(t))throw new Ie(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let r,l,h,n=this._itHead,i=!1;if(Array.isArray(t)){this.length=t.length;for(let f=0;f<this.length;f++)l=t[f],h=this._trackByFn(f,l),null!==n&&Object.is(n.trackById,h)?(i&&(n=this._verifyReinsertion(n,l,h,f)),Object.is(n.item,l)||this._addIdentityChange(n,l)):(n=this._mismatch(n,l,h,f),i=!0),n=n._next}else r=0,function cL(e,t){if(Array.isArray(e))for(let n=0;n<e.length;n++)t(e[n]);else{const n=e[Symbol.iterator]();let i;for(;!(i=n.next()).done;)t(i.value)}}(t,f=>{h=this._trackByFn(r,f),null!==n&&Object.is(n.trackById,h)?(i&&(n=this._verifyReinsertion(n,f,h,r)),Object.is(n.item,f)||this._addIdentityChange(n,f)):(n=this._mismatch(n,f,h,r),i=!0),n=n._next,r++}),this.length=r;return this._truncate(n),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,n,i,r){let l;return null===t?l=this._itTail:(l=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._reinsertAfter(t,l,r)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._moveAfter(t,l,r)):t=this._addAfter(new MF(n,i),l,r),t}_verifyReinsertion(t,n,i,r){let l=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==l?t=this._reinsertAfter(l,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const n=t._next;this._addToRemovals(this._unlink(t)),t=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,n,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,l=t._nextRemoved;return null===r?this._removalsHead=l:r._nextRemoved=l,null===l?this._removalsTail=r:l._prevRemoved=r,this._insertAfter(t,n,i),this._addToMoves(t,i),t}_moveAfter(t,n,i){return this._unlink(t),this._insertAfter(t,n,i),this._addToMoves(t,i),t}_addAfter(t,n,i){return this._insertAfter(t,n,i),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,n,i){const r=null===n?this._itHead:n._next;return t._next=r,t._prev=n,null===r?this._itTail=t:r._prev=t,null===n?this._itHead=t:n._next=t,null===this._linkedRecords&&(this._linkedRecords=new nD),this._linkedRecords.put(t),t.currentIndex=i,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const n=t._prev,i=t._next;return null===n?this._itHead=i:n._next=i,null===i?this._itTail=n:i._prev=n,t}_addToMoves(t,n){return t.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new nD),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,n){return t.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class MF{constructor(t,n){this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class PF{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,n){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===n||n<=i.currentIndex)&&Object.is(i.trackById,t))return i;return null}remove(t){const n=t._prevDup,i=t._nextDup;return null===n?this._head=i:n._nextDup=i,null===i?this._tail=n:i._prevDup=n,null===this._head}}class nD{constructor(){this.map=new Map}put(t){const n=t.trackById;let i=this.map.get(n);i||(i=new PF,this.map.set(n,i)),i.add(t)}get(t,n){const r=this.map.get(t);return r?r.get(t,n):null}remove(t){const n=t.trackById;return this.map.get(n).remove(t)&&this.map.delete(n),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function iD(e,t,n){const i=e.previousIndex;if(null===i)return i;let r=0;return n&&i<n.length&&(r=n[i]),i+t+r}class rD{constructor(){}supports(t){return t instanceof Map||p1(t)}create(){return new RF}}class RF{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let n;for(n=this._mapHead;null!==n;n=n._next)t(n)}forEachPreviousItem(t){let n;for(n=this._previousMapHead;null!==n;n=n._nextPrevious)t(n)}forEachChangedItem(t){let n;for(n=this._changesHead;null!==n;n=n._nextChanged)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}diff(t){if(t){if(!(t instanceof Map||p1(t)))throw new Ie(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(t,(i,r)=>{if(n&&n.key===r)this._maybeAddToChanges(n,i),this._appendAfter=n,n=n._next;else{const l=this._getOrCreateRecordForKey(r,i);n=this._insertBeforeOrAppend(n,l)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let i=n;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,n){if(t){const i=t._prev;return n._next=t,n._prev=i,t._prev=n,i&&(i._next=n),t===this._mapHead&&(this._mapHead=n),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(t,n){if(this._records.has(t)){const r=this._records.get(t);this._maybeAddToChanges(r,n);const l=r._prev,h=r._next;return l&&(l._next=h),h&&(h._prev=l),r._next=null,r._prev=null,r}const i=new LF(t);return this._records.set(t,i),i.currentValue=n,this._addToAdditions(i),i}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,n){Object.is(n,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=n,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,n){t instanceof Map?t.forEach(n):Object.keys(t).forEach(i=>n(t[i],i))}}class LF{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function sD(){return new D_([new tD])}let D_=(()=>{class e{static#e=this.\u0275prov=ft({token:e,providedIn:"root",factory:sD});constructor(n){this.factories=n}static create(n,i){if(null!=i){const r=i.factories.slice();n=n.concat(r)}return new e(n)}static extend(n){return{provide:e,useFactory:i=>e.create(n,i||sD()),deps:[[e,new jo,new Hl]]}}find(n){const i=this.factories.find(r=>r.supports(n));if(null!=i)return i;throw new Ie(901,!1)}}return e})();function oD(){return new og([new rD])}let og=(()=>{class e{static#e=this.\u0275prov=ft({token:e,providedIn:"root",factory:oD});constructor(n){this.factories=n}static create(n,i){if(i){const r=i.factories.slice();n=n.concat(r)}return new e(n)}static extend(n){return{provide:e,useFactory:i=>e.create(n,i||oD()),deps:[[e,new jo,new Hl]]}}find(n){const i=this.factories.find(r=>r.supports(n));if(i)return i;throw new Ie(901,!1)}}return e})();const NF=$T(null,"core",[]);let FF=(()=>{class e{constructor(n){}static#e=this.\u0275fac=function(i){return new(i||e)(lt(pd))};static#t=this.\u0275mod=nr({type:e});static#n=this.\u0275inj=$i({})}return e})(),ub=null;function op(){return ub}class YF{}const ys=new ut("DocumentToken");let hb=(()=>{class e{historyGo(n){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:function(){return tt(JF)},providedIn:"platform"})}return e})();const QF=new ut("Location Initialized");let JF=(()=>{class e extends hb{constructor(){super(),this._doc=tt(ys),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return op().getBaseHref(this._doc)}onPopState(n){const i=op().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",n,!1),()=>i.removeEventListener("popstate",n)}onHashChange(n){const i=op().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",n,!1),()=>i.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,i,r){this._history.pushState(n,i,r)}replaceState(n,i,r){this._history.replaceState(n,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:function(){return new e},providedIn:"platform"})}return e})();function db(e,t){if(0==e.length)return t;if(0==t.length)return e;let n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function mD(e){const t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function su(e){return e&&"?"!==e[0]?"?"+e:e}let gd=(()=>{class e{historyGo(n){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:function(){return tt(yD)},providedIn:"root"})}return e})();const gD=new ut("appBaseHref");let yD=(()=>{class e extends gd{constructor(n,i){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??tt(ys).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return db(this._baseHref,n)}path(n=!1){const i=this._platformLocation.pathname+su(this._platformLocation.search),r=this._platformLocation.hash;return r&&n?`${i}${r}`:i}pushState(n,i,r,l){const h=this.prepareExternalUrl(r+su(l));this._platformLocation.pushState(n,i,h)}replaceState(n,i,r,l){const h=this.prepareExternalUrl(r+su(l));this._platformLocation.replaceState(n,i,h)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static#e=this.\u0275fac=function(i){return new(i||e)(lt(hb),lt(gD,8))};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),e3=(()=>{class e extends gd{constructor(n,i){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(n){const i=db(this._baseHref,n);return i.length>0?"#"+i:i}pushState(n,i,r,l){let h=this.prepareExternalUrl(r+su(l));0==h.length&&(h=this._platformLocation.pathname),this._platformLocation.pushState(n,i,h)}replaceState(n,i,r,l){let h=this.prepareExternalUrl(r+su(l));0==h.length&&(h=this._platformLocation.pathname),this._platformLocation.replaceState(n,i,h)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static#e=this.\u0275fac=function(i){return new(i||e)(lt(hb),lt(gD,8))};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac})}return e})(),fb=(()=>{class e{constructor(n){this._subject=new lr,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;const i=this._locationStrategy.getBaseHref();this._basePath=function i3(e){if(new RegExp("^(https?:)?//").test(e)){const[,n]=e.split(/\/\/[^\/]+/);return n}return e}(mD(_D(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,i=""){return this.path()==this.normalize(n+su(i))}normalize(n){return e.stripTrailingSlash(function n3(e,t){if(!e||!t.startsWith(e))return t;const n=t.substring(e.length);return""===n||["/",";","?","#"].includes(n[0])?n:t}(this._basePath,_D(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,i="",r=null){this._locationStrategy.pushState(r,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+su(i)),r)}replaceState(n,i="",r=null){this._locationStrategy.replaceState(r,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+su(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",i){this._urlChangeListeners.forEach(r=>r(n,i))}subscribe(n,i,r){return this._subject.subscribe({next:n,error:i,complete:r})}static#e=this.normalizeQueryParams=su;static#t=this.joinWithSlash=db;static#n=this.stripTrailingSlash=mD;static#i=this.\u0275fac=function(i){return new(i||e)(lt(gd))};static#r=this.\u0275prov=ft({token:e,factory:function(){return function t3(){return new fb(lt(gd))}()},providedIn:"root"})}return e})();function _D(e){return e.replace(/\/index.html$/,"")}function DD(e,t){t=encodeURIComponent(t);for(const n of e.split(";")){const i=n.indexOf("="),[r,l]=-1==i?[n,""]:[n.slice(0,i),n.slice(i+1)];if(r.trim()===t)return decodeURIComponent(l)}return null}const Cb=/\s+/,ID=[];let AD=(()=>{class e{constructor(n,i,r,l){this._iterableDiffers=n,this._keyValueDiffers=i,this._ngEl=r,this._renderer=l,this.initialClasses=ID,this.stateMap=new Map}set klass(n){this.initialClasses=null!=n?n.trim().split(Cb):ID}set ngClass(n){this.rawClass="string"==typeof n?n.trim().split(Cb):n}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const n=this.rawClass;if(Array.isArray(n)||n instanceof Set)for(const i of n)this._updateState(i,!0);else if(null!=n)for(const i of Object.keys(n))this._updateState(i,!!n[i]);this._applyStateDiff()}_updateState(n,i){const r=this.stateMap.get(n);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(n,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const n of this.stateMap){const i=n[0],r=n[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(n,i){(n=n.trim()).length>0&&n.split(Cb).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static#e=this.\u0275fac=function(i){return new(i||e)(pt(D_),pt(og),pt(hl),pt(Vf))};static#t=this.\u0275dir=Hi({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0})}return e})();class j3{constructor(t,n,i,r){this.$implicit=t,this.ngForOf=n,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let PD=(()=>{class e{set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}constructor(n,i,r){this._viewContainer=n,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const i=this._viewContainer;n.forEachOperation((r,l,h)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new j3(r.item,this._ngForOf,-1,-1),null===h?void 0:h);else if(null==h)i.remove(null===l?void 0:l);else if(null!==l){const f=i.get(l);i.move(f,h),RD(f,r)}});for(let r=0,l=i.length;r<l;r++){const f=i.get(r).context;f.index=r,f.count=l,f.ngForOf=this._ngForOf}n.forEachIdentityChange(r=>{RD(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(n,i){return!0}static#e=this.\u0275fac=function(i){return new(i||e)(pt(ml),pt(tc),pt(D_))};static#t=this.\u0275dir=Hi({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return e})();function RD(e,t){e.context.$implicit=t.item}let Eb=(()=>{class e{constructor(n,i){this._viewContainer=n,this._context=new $3,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){LD("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){LD("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,i){return!0}static#e=this.\u0275fac=function(i){return new(i||e)(pt(ml),pt(tc))};static#t=this.\u0275dir=Hi({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return e})();class $3{constructor(){this.$implicit=null,this.ngIf=null}}function LD(e,t){if(t&&!t.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${Kn(t)}'.`)}let OD=(()=>{class e{constructor(n,i,r){this._ngEl=n,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(n){this._ngStyle=n,!this._differ&&n&&(this._differ=this._differs.find(n).create())}ngDoCheck(){if(this._differ){const n=this._differ.diff(this._ngStyle);n&&this._applyChanges(n)}}_setStyle(n,i){const[r,l]=n.split("."),h=-1===r.indexOf("-")?void 0:ol.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,l?`${i}${l}`:i,h):this._renderer.removeStyle(this._ngEl.nativeElement,r,h)}_applyChanges(n){n.forEachRemovedItem(i=>this._setStyle(i.key,null)),n.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),n.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}static#e=this.\u0275fac=function(i){return new(i||e)(pt(hl),pt(og),pt(Vf))};static#t=this.\u0275dir=Hi({type:e,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}return e})(),ND=(()=>{class e{constructor(n){this._viewContainerRef=n,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(n){if(n.ngTemplateOutlet||n.ngTemplateOutletInjector){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:r,ngTemplateOutletContext:l,ngTemplateOutletInjector:h}=this;this._viewRef=i.createEmbeddedView(r,l,h?{injector:h}:void 0)}else this._viewRef=null}else this._viewRef&&n.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}static#e=this.\u0275fac=function(i){return new(i||e)(pt(ml))};static#t=this.\u0275dir=Hi({type:e,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[Mc]})}return e})(),yd=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=nr({type:e});static#n=this.\u0275inj=$i({})}return e})();const zD="browser";function BD(e){return e===zD}function UD(e){return"server"===e}let _5=(()=>{class e{static#e=this.\u0275prov=ft({token:e,providedIn:"root",factory:()=>new v5(lt(ys),window)})}return e})();class v5{constructor(t,n){this.document=t,this.window=n,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const n=function b5(e,t){const n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&"function"==typeof e.body.attachShadow){const i=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const l=r.shadowRoot;if(l){const h=l.getElementById(t)||l.querySelector(`[name="${t}"]`);if(h)return h}r=i.nextNode()}}return null}(this.document,t);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(t){this.supportsScrolling()&&(this.window.history.scrollRestoration=t)}scrollToElement(t){const n=t.getBoundingClientRect(),i=n.left+this.window.pageXOffset,r=n.top+this.window.pageYOffset,l=this.offset();this.window.scrollTo(i-l[0],r-l[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class VD{}class $5 extends YF{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Pb extends $5{static makeCurrent(){!function XF(e){ub||(ub=e)}(new Pb)}onAndCancel(t,n,i){return t.addEventListener(n,i),()=>{t.removeEventListener(n,i)}}dispatchEvent(t,n){t.dispatchEvent(n)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,n){return(n=n||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,n){return"window"===n?window:"document"===n?t:"body"===n?t.body:null}getBaseHref(t){const n=function H5(){return ug=ug||document.querySelector("base"),ug?ug.getAttribute("href"):null}();return null==n?null:function q5(e){V_=V_||document.createElement("a"),V_.setAttribute("href",e);const t=V_.pathname;return"/"===t.charAt(0)?t:`/${t}`}(n)}resetBaseElement(){ug=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return DD(document.cookie,t)}}let V_,ug=null,W5=(()=>{class e{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac})}return e})();const Rb=new ut("EventManagerPlugins");let GD=(()=>{class e{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(r=>{r.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,i,r){return this._findPluginFor(i).addEventListener(n,i,r)}getZone(){return this._zone}_findPluginFor(n){let i=this._eventNameToPlugin.get(n);if(i)return i;if(i=this._plugins.find(l=>l.supports(n)),!i)throw new Ie(5101,!1);return this._eventNameToPlugin.set(n,i),i}static#e=this.\u0275fac=function(i){return new(i||e)(lt(Rb),lt(Yn))};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac})}return e})();class WD{constructor(t){this._doc=t}}const Lb="ng-app-id";let ZD=(()=>{class e{constructor(n,i,r,l={}){this.doc=n,this.appId=i,this.nonce=r,this.platformId=l,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=UD(l),this.resetHostNodes()}addStyles(n){for(const i of n)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(n){for(const i of n)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const n=this.styleNodesInDOM;n&&(n.forEach(i=>i.remove()),n.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(const i of this.getAllStyles())this.addStyleToHost(n,i)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(const i of this.hostNodes)this.addStyleToHost(i,n)}onStyleRemoved(n){const i=this.styleRef;i.get(n)?.elements?.forEach(r=>r.remove()),i.delete(n)}collectServerRenderedStyles(){const n=this.doc.head?.querySelectorAll(`style[${Lb}="${this.appId}"]`);if(n?.length){const i=new Map;return n.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(n,i){const r=this.styleRef;if(r.has(n)){const l=r.get(n);return l.usage+=i,l.usage}return r.set(n,{usage:i,elements:[]}),i}getStyleElement(n,i){const r=this.styleNodesInDOM,l=r?.get(i);if(l?.parentNode===n)return r.delete(i),l.removeAttribute(Lb),l;{const h=this.doc.createElement("style");return this.nonce&&h.setAttribute("nonce",this.nonce),h.textContent=i,this.platformIsServer&&h.setAttribute(Lb,this.appId),h}}addStyleToHost(n,i){const r=this.getStyleElement(n,i);n.appendChild(r);const l=this.styleRef,h=l.get(i)?.elements;h?h.push(r):l.set(i,{elements:[r],usage:1})}resetHostNodes(){const n=this.hostNodes;n.clear(),n.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||e)(lt(ys),lt(jy),lt(Yw,8),lt(Yc))};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac})}return e})();const kb={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Ob=/%COMP%/g,Y5=new ut("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function XD(e,t){return t.map(n=>n.replace(Ob,e))}let Nb=(()=>{class e{constructor(n,i,r,l,h,f,_,C=null){this.eventManager=n,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=l,this.doc=h,this.platformId=f,this.ngZone=_,this.nonce=C,this.rendererByCompId=new Map,this.platformIsServer=UD(f),this.defaultRenderer=new Fb(n,h,_,this.platformIsServer)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===ds.ShadowDom&&(i={...i,encapsulation:ds.Emulated});const r=this.getOrCreateRenderer(n,i);return r instanceof QD?r.applyToHost(n):r instanceof zb&&r.applyStyles(),r}getOrCreateRenderer(n,i){const r=this.rendererByCompId;let l=r.get(i.id);if(!l){const h=this.doc,f=this.ngZone,_=this.eventManager,C=this.sharedStylesHost,A=this.removeStylesOnCompDestroy,R=this.platformIsServer;switch(i.encapsulation){case ds.Emulated:l=new QD(_,C,i,this.appId,A,h,f,R);break;case ds.ShadowDom:return new tz(_,C,n,i,h,f,this.nonce,R);default:l=new zb(_,C,i,A,h,f,R)}r.set(i.id,l)}return l}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||e)(lt(GD),lt(ZD),lt(jy),lt(Y5),lt(ys),lt(Yc),lt(Yn),lt(Yw))};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac})}return e})();class Fb{constructor(t,n,i,r){this.eventManager=t,this.doc=n,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,n){return n?this.doc.createElementNS(kb[n]||n,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,n){(YD(t)?t.content:t).appendChild(n)}insertBefore(t,n,i){t&&(YD(t)?t.content:t).insertBefore(n,i)}removeChild(t,n){t&&t.removeChild(n)}selectRootElement(t,n){let i="string"==typeof t?this.doc.querySelector(t):t;if(!i)throw new Ie(-5104,!1);return n||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,n,i,r){if(r){n=r+":"+n;const l=kb[r];l?t.setAttributeNS(l,n,i):t.setAttribute(n,i)}else t.setAttribute(n,i)}removeAttribute(t,n,i){if(i){const r=kb[i];r?t.removeAttributeNS(r,n):t.removeAttribute(`${i}:${n}`)}else t.removeAttribute(n)}addClass(t,n){t.classList.add(n)}removeClass(t,n){t.classList.remove(n)}setStyle(t,n,i,r){r&(ol.DashCase|ol.Important)?t.style.setProperty(n,i,r&ol.Important?"important":""):t.style[n]=i}removeStyle(t,n,i){i&ol.DashCase?t.style.removeProperty(n):t.style[n]=""}setProperty(t,n,i){t[n]=i}setValue(t,n){t.nodeValue=n}listen(t,n,i){if("string"==typeof t&&!(t=op().getGlobalEventTarget(this.doc,t)))throw new Error(`Unsupported event target ${t} for event ${n}`);return this.eventManager.addEventListener(t,n,this.decoratePreventDefault(i))}decoratePreventDefault(t){return n=>{if("__ngUnwrap__"===n)return t;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>t(n)):t(n))&&n.preventDefault()}}}function YD(e){return"TEMPLATE"===e.tagName&&void 0!==e.content}class tz extends Fb{constructor(t,n,i,r,l,h,f,_){super(t,l,h,_),this.sharedStylesHost=n,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const C=XD(r.id,r.styles);for(const A of C){const R=document.createElement("style");f&&R.setAttribute("nonce",f),R.textContent=A,this.shadowRoot.appendChild(R)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,n){return super.appendChild(this.nodeOrShadowRoot(t),n)}insertBefore(t,n,i){return super.insertBefore(this.nodeOrShadowRoot(t),n,i)}removeChild(t,n){return super.removeChild(this.nodeOrShadowRoot(t),n)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class zb extends Fb{constructor(t,n,i,r,l,h,f,_){super(t,l,h,f),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=r,this.styles=_?XD(_,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class QD extends zb{constructor(t,n,i,r,l,h,f,_){const C=r+"-"+i.id;super(t,n,i,l,h,f,_,C),this.contentAttr=function Q5(e){return"_ngcontent-%COMP%".replace(Ob,e)}(C),this.hostAttr=function J5(e){return"_nghost-%COMP%".replace(Ob,e)}(C)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,n){const i=super.createElement(t,n);return super.setAttribute(i,this.contentAttr,""),i}}let nz=(()=>{class e extends WD{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,r){return n.addEventListener(i,r,!1),()=>this.removeEventListener(n,i,r)}removeEventListener(n,i,r){return n.removeEventListener(i,r)}static#e=this.\u0275fac=function(i){return new(i||e)(lt(ys))};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac})}return e})();const JD=["alt","control","meta","shift"],iz={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},rz={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let sz=(()=>{class e extends WD{constructor(n){super(n)}supports(n){return null!=e.parseEventName(n)}addEventListener(n,i,r){const l=e.parseEventName(i),h=e.eventCallback(l.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>op().onAndCancel(n,l.domEventName,h))}static parseEventName(n){const i=n.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const l=e._normalizeKey(i.pop());let h="",f=i.indexOf("code");if(f>-1&&(i.splice(f,1),h="code."),JD.forEach(C=>{const A=i.indexOf(C);A>-1&&(i.splice(A,1),h+=C+".")}),h+=l,0!=i.length||0===l.length)return null;const _={};return _.domEventName=r,_.fullKey=h,_}static matchEventFullKeyCode(n,i){let r=iz[n.key]||n.key,l="";return i.indexOf("code.")>-1&&(r=n.code,l="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),JD.forEach(h=>{h!==r&&(0,rz[h])(n)&&(l+=h+".")}),l+=r,l===i)}static eventCallback(n,i,r){return l=>{e.matchEventFullKeyCode(l,n)&&r.runGuarded(()=>i(l))}}static _normalizeKey(n){return"esc"===n?"escape":n}static#e=this.\u0275fac=function(i){return new(i||e)(lt(ys))};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac})}return e})();const cz=$T(NF,"browser",[{provide:Yc,useValue:zD},{provide:Kw,useValue:function oz(){Pb.makeCurrent()},multi:!0},{provide:ys,useFactory:function lz(){return function Gr(e){Pr=e}(document),document},deps:[]}]),uz=new ut(""),nI=[{provide:w_,useClass:class G5{addToWindow(t){Vn.getAngularTestability=(i,r=!0)=>{const l=t.findTestabilityInTree(i,r);if(null==l)throw new Ie(5103,!1);return l},Vn.getAllAngularTestabilities=()=>t.getAllTestabilities(),Vn.getAllAngularRootElements=()=>t.getAllRootElements(),Vn.frameworkStabilizers||(Vn.frameworkStabilizers=[]),Vn.frameworkStabilizers.push(i=>{const r=Vn.getAllAngularTestabilities();let l=r.length,h=!1;const f=function(_){h=h||_,l--,0==l&&i(h)};r.forEach(_=>{_.whenStable(f)})})}findTestabilityInTree(t,n,i){return null==n?null:t.getTestability(n)??(i?op().isShadowRoot(n)?this.findTestabilityInTree(t,n.host,!0):this.findTestabilityInTree(t,n.parentElement,!0):null)}},deps:[]},{provide:zT,useClass:Q1,deps:[Yn,J1,w_]},{provide:Q1,useClass:Q1,deps:[Yn,J1,w_]}],iI=[{provide:k0,useValue:"root"},{provide:Qc,useFactory:function az(){return new Qc},deps:[]},{provide:Rb,useClass:nz,multi:!0,deps:[ys,Yn,Yc]},{provide:Rb,useClass:sz,multi:!0,deps:[ys]},Nb,ZD,GD,{provide:Nm,useExisting:Nb},{provide:VD,useClass:W5,deps:[]},[]];let rI=(()=>{class e{constructor(n){}static withServerTransition(n){return{ngModule:e,providers:[{provide:jy,useValue:n.appId}]}}static#e=this.\u0275fac=function(i){return new(i||e)(lt(uz,12))};static#t=this.\u0275mod=nr({type:e});static#n=this.\u0275inj=$i({providers:[...iI,...nI],imports:[yd,FF]})}return e})(),sI=(()=>{class e{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}static#e=this.\u0275fac=function(i){return new(i||e)(lt(ys))};static#t=this.\u0275prov=ft({token:e,factory:function(i){let r=null;return r=i?new i:function dz(){return new sI(lt(ys))}(),r},providedIn:"root"})}return e})();typeof window<"u"&&window;class cI{}class yz{}const lu="*";function _z(e,t){return{type:7,name:e,definitions:t,options:{}}}function uI(e,t=null){return{type:4,styles:t,timings:e}}function hI(e,t=null){return{type:2,steps:e,options:t}}function j_(e){return{type:6,styles:e,offset:null}}function dI(e,t,n=null){return{type:1,expr:e,animation:t,options:n}}function fI(e,t=null){return{type:8,animation:e,options:t}}function pI(e,t=null){return{type:10,animation:e,options:t}}class hg{constructor(t=0,n=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+n}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const n="start"==t?this._onStartFns:this._onDoneFns;n.forEach(i=>i()),n.length=0}}class mI{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let n=0,i=0,r=0;const l=this.players.length;0==l?queueMicrotask(()=>this._onFinish()):this.players.forEach(h=>{h.onDone(()=>{++n==l&&this._onFinish()}),h.onDestroy(()=>{++i==l&&this._onDestroy()}),h.onStart(()=>{++r==l&&this._onStart()})}),this.totalTime=this.players.reduce((h,f)=>Math.max(h,f.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const n=t*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,n/i.totalTime):1;i.setPosition(r)})}getPosition(){const t=this.players.reduce((n,i)=>null===n||i.totalTime>n.totalTime?i:n,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const n="start"==t?this._onStartFns:this._onDoneFns;n.forEach(i=>i()),n.length=0}}function gI(e){return new Ie(3e3,!1)}function eh(e){switch(e.length){case 0:return new hg;case 1:return e[0];default:return new mI(e)}}function yI(e,t,n=new Map,i=new Map){const r=[],l=[];let h=-1,f=null;if(t.forEach(_=>{const C=_.get("offset"),A=C==h,R=A&&f||new Map;_.forEach((F,$)=>{let Q=$,ee=F;if("offset"!==$)switch(Q=e.normalizePropertyName(Q,r),ee){case"!":ee=n.get($);break;case lu:ee=i.get($);break;default:ee=e.normalizeStyleValue($,Q,ee,r)}R.set(Q,ee)}),A||l.push(R),f=R,h=C}),r.length)throw function Vz(e){return new Ie(3502,!1)}();return l}function Vb(e,t,n,i){switch(t){case"start":e.onStart(()=>i(n&&jb(n,"start",e)));break;case"done":e.onDone(()=>i(n&&jb(n,"done",e)));break;case"destroy":e.onDestroy(()=>i(n&&jb(n,"destroy",e)))}}function jb(e,t,n){const l=$b(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,n.totalTime??e.totalTime,!!n.disabled),h=e._data;return null!=h&&(l._data=h),l}function $b(e,t,n,i,r="",l=0,h){return{element:e,triggerName:t,fromState:n,toState:i,phaseName:r,totalTime:l,disabled:!!h}}function Xo(e,t,n){let i=e.get(t);return i||e.set(t,i=n),i}function _I(e){const t=e.indexOf(":");return[e.substring(1,t),e.slice(t+1)]}const Jz=(()=>typeof document>"u"?null:document.documentElement)();function Hb(e){const t=e.parentNode||e.host||null;return t===Jz?null:t}let _d=null,vI=!1;function bI(e,t){for(;t;){if(t===e)return!0;t=Hb(t)}return!1}function xI(e,t,n){if(n)return Array.from(e.querySelectorAll(t));const i=e.querySelector(t);return i?[i]:[]}let wI=(()=>{class e{validateStyleProperty(n){return function t4(e){_d||(_d=function n4(){return typeof document<"u"?document.body:null}()||{},vI=!!_d.style&&"WebkitAppearance"in _d.style);let t=!0;return _d.style&&!function e4(e){return"ebkit"==e.substring(1,6)}(e)&&(t=e in _d.style,!t&&vI&&(t="Webkit"+e.charAt(0).toUpperCase()+e.slice(1)in _d.style)),t}(n)}matchesElement(n,i){return!1}containsElement(n,i){return bI(n,i)}getParentElement(n){return Hb(n)}query(n,i,r){return xI(n,i,r)}computeStyle(n,i,r){return r||""}animate(n,i,r,l,h,f=[],_){return new hg(r,l)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac})}return e})(),qb=(()=>{class e{static#e=this.NOOP=new wI}return e})();const i4=1e3,Gb="ng-enter",$_="ng-leave",H_="ng-trigger",q_=".ng-trigger",EI="ng-animating",Wb=".ng-animating";function cu(e){if("number"==typeof e)return e;const t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:Zb(parseFloat(t[1]),t[2])}function Zb(e,t){return"s"===t?e*i4:e}function G_(e,t,n){return e.hasOwnProperty("duration")?e:function s4(e,t,n){let r,l=0,h="";if("string"==typeof e){const f=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===f)return t.push(gI()),{duration:0,delay:0,easing:""};r=Zb(parseFloat(f[1]),f[2]);const _=f[3];null!=_&&(l=Zb(parseFloat(_),f[4]));const C=f[5];C&&(h=C)}else r=e;if(!n){let f=!1,_=t.length;r<0&&(t.push(function vz(){return new Ie(3100,!1)}()),f=!0),l<0&&(t.push(function bz(){return new Ie(3101,!1)}()),f=!0),f&&t.splice(_,0,gI())}return{duration:r,delay:l,easing:h}}(e,t,n)}function dg(e,t={}){return Object.keys(e).forEach(n=>{t[n]=e[n]}),t}function SI(e){const t=new Map;return Object.keys(e).forEach(n=>{t.set(n,e[n])}),t}function th(e,t=new Map,n){if(n)for(let[i,r]of n)t.set(i,r);for(let[i,r]of e)t.set(i,r);return t}function nc(e,t,n){t.forEach((i,r)=>{const l=Xb(r);n&&!n.has(r)&&n.set(r,e.style[l]),e.style[l]=i})}function vd(e,t){t.forEach((n,i)=>{const r=Xb(i);e.style[r]=""})}function fg(e){return Array.isArray(e)?1==e.length?e[0]:hI(e):e}const Kb=new RegExp("{{\\s*(.+?)\\s*}}","g");function DI(e){let t=[];if("string"==typeof e){let n;for(;n=Kb.exec(e);)t.push(n[1]);Kb.lastIndex=0}return t}function pg(e,t,n){const i=e.toString(),r=i.replace(Kb,(l,h)=>{let f=t[h];return null==f&&(n.push(function wz(e){return new Ie(3003,!1)}()),f=""),f.toString()});return r==i?e:r}function W_(e){const t=[];let n=e.next();for(;!n.done;)t.push(n.value),n=e.next();return t}const l4=/-+([a-z0-9])/g;function Xb(e){return e.replace(l4,(...t)=>t[1].toUpperCase())}function Yo(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw function Cz(e){return new Ie(3004,!1)}()}}function II(e,t){return window.getComputedStyle(e)[t]}const Z_="*";function h4(e,t){const n=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(i=>function d4(e,t,n){if(":"==e[0]){const _=function f4(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(n,i)=>parseFloat(i)>parseFloat(n);case":decrement":return(n,i)=>parseFloat(i)<parseFloat(n);default:return t.push(function Fz(e){return new Ie(3016,!1)}()),"* => *"}}(e,n);if("function"==typeof _)return void t.push(_);e=_}const i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return n.push(function Nz(e){return new Ie(3015,!1)}()),t;const r=i[1],l=i[2],h=i[3];t.push(AI(r,h));"<"==l[0]&&!(r==Z_&&h==Z_)&&t.push(AI(h,r))}(i,n,t)):n.push(e),n}const K_=new Set(["true","1"]),X_=new Set(["false","0"]);function AI(e,t){const n=K_.has(e)||X_.has(e),i=K_.has(t)||X_.has(t);return(r,l)=>{let h=e==Z_||e==r,f=t==Z_||t==l;return!h&&n&&"boolean"==typeof r&&(h=r?K_.has(e):X_.has(e)),!f&&i&&"boolean"==typeof l&&(f=l?K_.has(t):X_.has(t)),h&&f}}const p4=new RegExp("s*:selfs*,?","g");function Yb(e,t,n,i){return new m4(e).build(t,n,i)}class m4{constructor(t){this._driver=t}build(t,n,i){const r=new _4(n);return this._resetContextStyleTimingState(r),Yo(this,fg(t),r)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,n){let i=n.queryCount=0,r=n.depCount=0;const l=[],h=[];return"@"==t.name.charAt(0)&&n.errors.push(function Sz(){return new Ie(3006,!1)}()),t.definitions.forEach(f=>{if(this._resetContextStyleTimingState(n),0==f.type){const _=f,C=_.name;C.toString().split(/\s*,\s*/).forEach(A=>{_.name=A,l.push(this.visitState(_,n))}),_.name=C}else if(1==f.type){const _=this.visitTransition(f,n);i+=_.queryCount,r+=_.depCount,h.push(_)}else n.errors.push(function Tz(){return new Ie(3007,!1)}())}),{type:7,name:t.name,states:l,transitions:h,queryCount:i,depCount:r,options:null}}visitState(t,n){const i=this.visitStyle(t.styles,n),r=t.options&&t.options.params||null;if(i.containsDynamicStyles){const l=new Set,h=r||{};i.styles.forEach(f=>{f instanceof Map&&f.forEach(_=>{DI(_).forEach(C=>{h.hasOwnProperty(C)||l.add(C)})})}),l.size&&(W_(l.values()),n.errors.push(function Dz(e,t){return new Ie(3008,!1)}()))}return{type:0,name:t.name,style:i,options:r?{params:r}:null}}visitTransition(t,n){n.queryCount=0,n.depCount=0;const i=Yo(this,fg(t.animation),n);return{type:1,matchers:h4(t.expr,n.errors),animation:i,queryCount:n.queryCount,depCount:n.depCount,options:bd(t.options)}}visitSequence(t,n){return{type:2,steps:t.steps.map(i=>Yo(this,i,n)),options:bd(t.options)}}visitGroup(t,n){const i=n.currentTime;let r=0;const l=t.steps.map(h=>{n.currentTime=i;const f=Yo(this,h,n);return r=Math.max(r,n.currentTime),f});return n.currentTime=r,{type:3,steps:l,options:bd(t.options)}}visitAnimate(t,n){const i=function b4(e,t){if(e.hasOwnProperty("duration"))return e;if("number"==typeof e)return Qb(G_(e,t).duration,0,"");const n=e;if(n.split(/\s+/).some(l=>"{"==l.charAt(0)&&"{"==l.charAt(1))){const l=Qb(0,0,"");return l.dynamic=!0,l.strValue=n,l}const r=G_(n,t);return Qb(r.duration,r.delay,r.easing)}(t.timings,n.errors);n.currentAnimateTimings=i;let r,l=t.styles?t.styles:j_({});if(5==l.type)r=this.visitKeyframes(l,n);else{let h=t.styles,f=!1;if(!h){f=!0;const C={};i.easing&&(C.easing=i.easing),h=j_(C)}n.currentTime+=i.duration+i.delay;const _=this.visitStyle(h,n);_.isEmptyStep=f,r=_}return n.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(t,n){const i=this._makeStyleAst(t,n);return this._validateStyleAst(i,n),i}_makeStyleAst(t,n){const i=[],r=Array.isArray(t.styles)?t.styles:[t.styles];for(let f of r)"string"==typeof f?f===lu?i.push(f):n.errors.push(new Ie(3002,!1)):i.push(SI(f));let l=!1,h=null;return i.forEach(f=>{if(f instanceof Map&&(f.has("easing")&&(h=f.get("easing"),f.delete("easing")),!l))for(let _ of f.values())if(_.toString().indexOf("{{")>=0){l=!0;break}}),{type:6,styles:i,easing:h,offset:t.offset,containsDynamicStyles:l,options:null}}_validateStyleAst(t,n){const i=n.currentAnimateTimings;let r=n.currentTime,l=n.currentTime;i&&l>0&&(l-=i.duration+i.delay),t.styles.forEach(h=>{"string"!=typeof h&&h.forEach((f,_)=>{const C=n.collectedStyles.get(n.currentQuerySelector),A=C.get(_);let R=!0;A&&(l!=r&&l>=A.startTime&&r<=A.endTime&&(n.errors.push(function Az(e,t,n,i,r){return new Ie(3010,!1)}()),R=!1),l=A.startTime),R&&C.set(_,{startTime:l,endTime:r}),n.options&&function a4(e,t,n){const i=t.params||{},r=DI(e);r.length&&r.forEach(l=>{i.hasOwnProperty(l)||n.push(function xz(e){return new Ie(3001,!1)}())})}(f,n.options,n.errors)})})}visitKeyframes(t,n){const i={type:5,styles:[],options:null};if(!n.currentAnimateTimings)return n.errors.push(function Mz(){return new Ie(3011,!1)}()),i;let l=0;const h=[];let f=!1,_=!1,C=0;const A=t.steps.map(ve=>{const pe=this._makeStyleAst(ve,n);let Le=null!=pe.offset?pe.offset:function v4(e){if("string"==typeof e)return null;let t=null;if(Array.isArray(e))e.forEach(n=>{if(n instanceof Map&&n.has("offset")){const i=n;t=parseFloat(i.get("offset")),i.delete("offset")}});else if(e instanceof Map&&e.has("offset")){const n=e;t=parseFloat(n.get("offset")),n.delete("offset")}return t}(pe.styles),qe=0;return null!=Le&&(l++,qe=pe.offset=Le),_=_||qe<0||qe>1,f=f||qe<C,C=qe,h.push(qe),pe});_&&n.errors.push(function Pz(){return new Ie(3012,!1)}()),f&&n.errors.push(function Rz(){return new Ie(3200,!1)}());const R=t.steps.length;let F=0;l>0&&l<R?n.errors.push(function Lz(){return new Ie(3202,!1)}()):0==l&&(F=1/(R-1));const $=R-1,Q=n.currentTime,ee=n.currentAnimateTimings,me=ee.duration;return A.forEach((ve,pe)=>{const Le=F>0?pe==$?1:F*pe:h[pe],qe=Le*me;n.currentTime=Q+ee.delay+qe,ee.duration=qe,this._validateStyleAst(ve,n),ve.offset=Le,i.styles.push(ve)}),i}visitReference(t,n){return{type:8,animation:Yo(this,fg(t.animation),n),options:bd(t.options)}}visitAnimateChild(t,n){return n.depCount++,{type:9,options:bd(t.options)}}visitAnimateRef(t,n){return{type:10,animation:this.visitReference(t.animation,n),options:bd(t.options)}}visitQuery(t,n){const i=n.currentQuerySelector,r=t.options||{};n.queryCount++,n.currentQuery=t;const[l,h]=function g4(e){const t=!!e.split(/\s*,\s*/).find(n=>":self"==n);return t&&(e=e.replace(p4,"")),e=e.replace(/@\*/g,q_).replace(/@\w+/g,n=>q_+"-"+n.slice(1)).replace(/:animating/g,Wb),[e,t]}(t.selector);n.currentQuerySelector=i.length?i+" "+l:l,Xo(n.collectedStyles,n.currentQuerySelector,new Map);const f=Yo(this,fg(t.animation),n);return n.currentQuery=null,n.currentQuerySelector=i,{type:11,selector:l,limit:r.limit||0,optional:!!r.optional,includeSelf:h,animation:f,originalSelector:t.selector,options:bd(t.options)}}visitStagger(t,n){n.currentQuery||n.errors.push(function kz(){return new Ie(3013,!1)}());const i="full"===t.timings?{duration:0,delay:0,easing:"full"}:G_(t.timings,n.errors,!0);return{type:12,animation:Yo(this,fg(t.animation),n),timings:i,options:null}}}class _4{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function bd(e){return e?(e=dg(e)).params&&(e.params=function y4(e){return e?dg(e):null}(e.params)):e={},e}function Qb(e,t,n){return{duration:e,delay:t,easing:n}}function Jb(e,t,n,i,r,l,h=null,f=!1){return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:i,duration:r,delay:l,totalTime:r+l,easing:h,subTimeline:f}}class Y_{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,n){let i=this._map.get(t);i||this._map.set(t,i=[]),i.push(...n)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const C4=new RegExp(":enter","g"),S4=new RegExp(":leave","g");function ex(e,t,n,i,r,l=new Map,h=new Map,f,_,C=[]){return(new T4).buildKeyframes(e,t,n,i,r,l,h,f,_,C)}class T4{buildKeyframes(t,n,i,r,l,h,f,_,C,A=[]){C=C||new Y_;const R=new tx(t,n,C,r,l,A,[]);R.options=_;const F=_.delay?cu(_.delay):0;R.currentTimeline.delayNextStep(F),R.currentTimeline.setStyles([h],null,R.errors,_),Yo(this,i,R);const $=R.timelines.filter(Q=>Q.containsAnimation());if($.length&&f.size){let Q;for(let ee=$.length-1;ee>=0;ee--){const me=$[ee];if(me.element===n){Q=me;break}}Q&&!Q.allowOnlyTimelineStyles()&&Q.setStyles([f],null,R.errors,_)}return $.length?$.map(Q=>Q.buildKeyframes()):[Jb(n,[],[],[],0,F,"",!1)]}visitTrigger(t,n){}visitState(t,n){}visitTransition(t,n){}visitAnimateChild(t,n){const i=n.subInstructions.get(n.element);if(i){const r=n.createSubContext(t.options),l=n.currentTimeline.currentTime,h=this._visitSubInstructions(i,r,r.options);l!=h&&n.transformIntoNewTimeline(h)}n.previousNode=t}visitAnimateRef(t,n){const i=n.createSubContext(t.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],n,i),this.visitReference(t.animation,i),n.transformIntoNewTimeline(i.currentTimeline.currentTime),n.previousNode=t}_applyAnimationRefDelays(t,n,i){for(const r of t){const l=r?.delay;if(l){const h="number"==typeof l?l:cu(pg(l,r?.params??{},n.errors));i.delayNextStep(h)}}}_visitSubInstructions(t,n,i){let l=n.currentTimeline.currentTime;const h=null!=i.duration?cu(i.duration):null,f=null!=i.delay?cu(i.delay):null;return 0!==h&&t.forEach(_=>{const C=n.appendInstructionToTimeline(_,h,f);l=Math.max(l,C.duration+C.delay)}),l}visitReference(t,n){n.updateOptions(t.options,!0),Yo(this,t.animation,n),n.previousNode=t}visitSequence(t,n){const i=n.subContextCount;let r=n;const l=t.options;if(l&&(l.params||l.delay)&&(r=n.createSubContext(l),r.transformIntoNewTimeline(),null!=l.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Q_);const h=cu(l.delay);r.delayNextStep(h)}t.steps.length&&(t.steps.forEach(h=>Yo(this,h,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),n.previousNode=t}visitGroup(t,n){const i=[];let r=n.currentTimeline.currentTime;const l=t.options&&t.options.delay?cu(t.options.delay):0;t.steps.forEach(h=>{const f=n.createSubContext(t.options);l&&f.delayNextStep(l),Yo(this,h,f),r=Math.max(r,f.currentTimeline.currentTime),i.push(f.currentTimeline)}),i.forEach(h=>n.currentTimeline.mergeTimelineCollectedStyles(h)),n.transformIntoNewTimeline(r),n.previousNode=t}_visitTiming(t,n){if(t.dynamic){const i=t.strValue;return G_(n.params?pg(i,n.params,n.errors):i,n.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,n){const i=n.currentAnimateTimings=this._visitTiming(t.timings,n),r=n.currentTimeline;i.delay&&(n.incrementTime(i.delay),r.snapshotCurrentStyles());const l=t.style;5==l.type?this.visitKeyframes(l,n):(n.incrementTime(i.duration),this.visitStyle(l,n),r.applyStylesToKeyframe()),n.currentAnimateTimings=null,n.previousNode=t}visitStyle(t,n){const i=n.currentTimeline,r=n.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const l=r&&r.easing||t.easing;t.isEmptyStep?i.applyEmptyStep(l):i.setStyles(t.styles,l,n.errors,n.options),n.previousNode=t}visitKeyframes(t,n){const i=n.currentAnimateTimings,r=n.currentTimeline.duration,l=i.duration,f=n.createSubContext().currentTimeline;f.easing=i.easing,t.styles.forEach(_=>{f.forwardTime((_.offset||0)*l),f.setStyles(_.styles,_.easing,n.errors,n.options),f.applyStylesToKeyframe()}),n.currentTimeline.mergeTimelineCollectedStyles(f),n.transformIntoNewTimeline(r+l),n.previousNode=t}visitQuery(t,n){const i=n.currentTimeline.currentTime,r=t.options||{},l=r.delay?cu(r.delay):0;l&&(6===n.previousNode.type||0==i&&n.currentTimeline.hasCurrentStyleProperties())&&(n.currentTimeline.snapshotCurrentStyles(),n.previousNode=Q_);let h=i;const f=n.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,n.errors);n.currentQueryTotal=f.length;let _=null;f.forEach((C,A)=>{n.currentQueryIndex=A;const R=n.createSubContext(t.options,C);l&&R.delayNextStep(l),C===n.element&&(_=R.currentTimeline),Yo(this,t.animation,R),R.currentTimeline.applyStylesToKeyframe(),h=Math.max(h,R.currentTimeline.currentTime)}),n.currentQueryIndex=0,n.currentQueryTotal=0,n.transformIntoNewTimeline(h),_&&(n.currentTimeline.mergeTimelineCollectedStyles(_),n.currentTimeline.snapshotCurrentStyles()),n.previousNode=t}visitStagger(t,n){const i=n.parentContext,r=n.currentTimeline,l=t.timings,h=Math.abs(l.duration),f=h*(n.currentQueryTotal-1);let _=h*n.currentQueryIndex;switch(l.duration<0?"reverse":l.easing){case"reverse":_=f-_;break;case"full":_=i.currentStaggerTime}const A=n.currentTimeline;_&&A.delayNextStep(_);const R=A.currentTime;Yo(this,t.animation,n),n.previousNode=t,i.currentStaggerTime=r.currentTime-R+(r.startTime-i.currentTimeline.startTime)}}const Q_={};class tx{constructor(t,n,i,r,l,h,f,_){this._driver=t,this.element=n,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=l,this.errors=h,this.timelines=f,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Q_,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=_||new J_(this._driver,n,0),f.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,n){if(!t)return;const i=t;let r=this.options;null!=i.duration&&(r.duration=cu(i.duration)),null!=i.delay&&(r.delay=cu(i.delay));const l=i.params;if(l){let h=r.params;h||(h=this.options.params={}),Object.keys(l).forEach(f=>{(!n||!h.hasOwnProperty(f))&&(h[f]=pg(l[f],h,this.errors))})}}_copyOptions(){const t={};if(this.options){const n=this.options.params;if(n){const i=t.params={};Object.keys(n).forEach(r=>{i[r]=n[r]})}}return t}createSubContext(t=null,n,i){const r=n||this.element,l=new tx(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return l.previousNode=this.previousNode,l.currentAnimateTimings=this.currentAnimateTimings,l.options=this._copyOptions(),l.updateOptions(t),l.currentQueryIndex=this.currentQueryIndex,l.currentQueryTotal=this.currentQueryTotal,l.parentContext=this,this.subContextCount++,l}transformIntoNewTimeline(t){return this.previousNode=Q_,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,n,i){const r={duration:n??t.duration,delay:this.currentTimeline.currentTime+(i??0)+t.delay,easing:""},l=new D4(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(l),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,n,i,r,l,h){let f=[];if(r&&f.push(this.element),t.length>0){t=(t=t.replace(C4,"."+this._enterClassName)).replace(S4,"."+this._leaveClassName);let C=this._driver.query(this.element,t,1!=i);0!==i&&(C=i<0?C.slice(C.length+i,C.length):C.slice(0,i)),f.push(...C)}return!l&&0==f.length&&h.push(function Oz(e){return new Ie(3014,!1)}()),f}}class J_{constructor(t,n,i,r){this._driver=t,this.element=n,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const n=1===this._keyframes.size&&this._pendingStyles.size;this.duration||n?(this.forwardTime(this.currentTime+t),n&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,n){return this.applyStylesToKeyframe(),new J_(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,n){this._localTimelineStyles.set(t,n),this._globalTimelineStyles.set(t,n),this._styleSummary.set(t,{time:this.currentTime,value:n})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[n,i]of this._globalTimelineStyles)this._backFill.set(n,i||lu),this._currentKeyframe.set(n,lu);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,n,i,r){n&&this._previousKeyframe.set("easing",n);const l=r&&r.params||{},h=function I4(e,t){const n=new Map;let i;return e.forEach(r=>{if("*"===r){i=i||t.keys();for(let l of i)n.set(l,lu)}else th(r,n)}),n}(t,this._globalTimelineStyles);for(let[f,_]of h){const C=pg(_,l,i);this._pendingStyles.set(f,C),this._localTimelineStyles.has(f)||this._backFill.set(f,this._globalTimelineStyles.get(f)??lu),this._updateStyle(f,C)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,n)=>{this._currentKeyframe.set(n,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,n)=>{this._currentKeyframe.has(n)||this._currentKeyframe.set(n,t)}))}snapshotCurrentStyles(){for(let[t,n]of this._localTimelineStyles)this._pendingStyles.set(t,n),this._updateStyle(t,n)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let n in this._currentKeyframe)t.push(n);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((n,i)=>{const r=this._styleSummary.get(i);(!r||n.time>r.time)&&this._updateStyle(i,n.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,n=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((f,_)=>{const C=th(f,new Map,this._backFill);C.forEach((A,R)=>{"!"===A?t.add(R):A===lu&&n.add(R)}),i||C.set("offset",_/this.duration),r.push(C)});const l=t.size?W_(t.values()):[],h=n.size?W_(n.values()):[];if(i){const f=r[0],_=new Map(f);f.set("offset",0),_.set("offset",1),r=[f,_]}return Jb(this.element,r,l,h,this.duration,this.startTime,this.easing,!1)}}class D4 extends J_{constructor(t,n,i,r,l,h,f=!1){super(t,n,h.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=l,this._stretchStartingKeyframe=f,this.timings={duration:h.duration,delay:h.delay,easing:h.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:n,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&n){const l=[],h=i+n,f=n/h,_=th(t[0]);_.set("offset",0),l.push(_);const C=th(t[0]);C.set("offset",RI(f)),l.push(C);const A=t.length-1;for(let R=1;R<=A;R++){let F=th(t[R]);const $=F.get("offset");F.set("offset",RI((n+$*i)/h)),l.push(F)}i=h,n=0,r="",t=l}return Jb(this.element,t,this.preStyleProps,this.postStyleProps,i,n,r,!0)}}function RI(e,t=3){const n=Math.pow(10,t-1);return Math.round(e*n)/n}class nx{}const A4=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class M4 extends nx{normalizePropertyName(t,n){return Xb(t)}normalizeStyleValue(t,n,i,r){let l="";const h=i.toString().trim();if(A4.has(n)&&0!==i&&"0"!==i)if("number"==typeof i)l="px";else{const f=i.match(/^[+-]?[\d\.]+([a-z]*)$/);f&&0==f[1].length&&r.push(function Ez(e,t){return new Ie(3005,!1)}())}return h+l}}function LI(e,t,n,i,r,l,h,f,_,C,A,R,F){return{type:0,element:e,triggerName:t,isRemovalTransition:r,fromState:n,fromStyles:l,toState:i,toStyles:h,timelines:f,queriedElements:_,preStyleProps:C,postStyleProps:A,totalTime:R,errors:F}}const ix={};class kI{constructor(t,n,i){this._triggerName=t,this.ast=n,this._stateStyles=i}match(t,n,i,r){return function P4(e,t,n,i,r){return e.some(l=>l(t,n,i,r))}(this.ast.matchers,t,n,i,r)}buildStyles(t,n,i){let r=this._stateStyles.get("*");return void 0!==t&&(r=this._stateStyles.get(t?.toString())||r),r?r.buildStyles(n,i):new Map}build(t,n,i,r,l,h,f,_,C,A){const R=[],F=this.ast.options&&this.ast.options.params||ix,Q=this.buildStyles(i,f&&f.params||ix,R),ee=_&&_.params||ix,me=this.buildStyles(r,ee,R),ve=new Set,pe=new Map,Le=new Map,qe="void"===r,at={params:R4(ee,F),delay:this.ast.options?.delay},xt=A?[]:ex(t,n,this.ast.animation,l,h,Q,me,at,C,R);let wt=0;if(xt.forEach(Ht=>{wt=Math.max(Ht.duration+Ht.delay,wt)}),R.length)return LI(n,this._triggerName,i,r,qe,Q,me,[],[],pe,Le,wt,R);xt.forEach(Ht=>{const Xt=Ht.element,Ti=Xo(pe,Xt,new Set);Ht.preStyleProps.forEach(an=>Ti.add(an));const on=Xo(Le,Xt,new Set);Ht.postStyleProps.forEach(an=>on.add(an)),Xt!==n&&ve.add(Xt)});const Rt=W_(ve.values());return LI(n,this._triggerName,i,r,qe,Q,me,xt,Rt,pe,Le,wt)}}function R4(e,t){const n=dg(t);for(const i in e)e.hasOwnProperty(i)&&null!=e[i]&&(n[i]=e[i]);return n}class L4{constructor(t,n,i){this.styles=t,this.defaultParams=n,this.normalizer=i}buildStyles(t,n){const i=new Map,r=dg(this.defaultParams);return Object.keys(t).forEach(l=>{const h=t[l];null!==h&&(r[l]=h)}),this.styles.styles.forEach(l=>{"string"!=typeof l&&l.forEach((h,f)=>{h&&(h=pg(h,r,n));const _=this.normalizer.normalizePropertyName(f,n);h=this.normalizer.normalizeStyleValue(f,_,h,n),i.set(f,h)})}),i}}class O4{constructor(t,n,i){this.name=t,this.ast=n,this._normalizer=i,this.transitionFactories=[],this.states=new Map,n.states.forEach(r=>{this.states.set(r.name,new L4(r.style,r.options&&r.options.params||{},i))}),OI(this.states,"true","1"),OI(this.states,"false","0"),n.transitions.forEach(r=>{this.transitionFactories.push(new kI(t,r,this.states))}),this.fallbackTransition=function N4(e,t,n){return new kI(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[(h,f)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,n,i,r){return this.transitionFactories.find(h=>h.match(t,n,i,r))||null}matchStyles(t,n,i){return this.fallbackTransition.buildStyles(t,n,i)}}function OI(e,t,n){e.has(t)?e.has(n)||e.set(n,e.get(t)):e.has(n)&&e.set(t,e.get(n))}const F4=new Y_;class z4{constructor(t,n,i){this.bodyNode=t,this._driver=n,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,n){const i=[],l=Yb(this._driver,n,i,[]);if(i.length)throw function jz(e){return new Ie(3503,!1)}();this._animations.set(t,l)}_buildPlayer(t,n,i){const r=t.element,l=yI(this._normalizer,t.keyframes,n,i);return this._driver.animate(r,l,t.duration,t.delay,t.easing,[],!0)}create(t,n,i={}){const r=[],l=this._animations.get(t);let h;const f=new Map;if(l?(h=ex(this._driver,n,l,Gb,$_,new Map,new Map,i,F4,r),h.forEach(A=>{const R=Xo(f,A.element,new Map);A.postStyleProps.forEach(F=>R.set(F,null))})):(r.push(function $z(){return new Ie(3300,!1)}()),h=[]),r.length)throw function Hz(e){return new Ie(3504,!1)}();f.forEach((A,R)=>{A.forEach((F,$)=>{A.set($,this._driver.computeStyle(R,$,lu))})});const C=eh(h.map(A=>{const R=f.get(A.element);return this._buildPlayer(A,new Map,R)}));return this._playersById.set(t,C),C.onDestroy(()=>this.destroy(t)),this.players.push(C),C}destroy(t){const n=this._getPlayer(t);n.destroy(),this._playersById.delete(t);const i=this.players.indexOf(n);i>=0&&this.players.splice(i,1)}_getPlayer(t){const n=this._playersById.get(t);if(!n)throw function qz(e){return new Ie(3301,!1)}();return n}listen(t,n,i,r){const l=$b(n,"","","");return Vb(this._getPlayer(t),i,l,r),()=>{}}command(t,n,i,r){if("register"==i)return void this.register(t,r[0]);if("create"==i)return void this.create(t,n,r[0]||{});const l=this._getPlayer(t);switch(i){case"play":l.play();break;case"pause":l.pause();break;case"reset":l.reset();break;case"restart":l.restart();break;case"finish":l.finish();break;case"init":l.init();break;case"setPosition":l.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const NI="ng-animate-queued",rx="ng-animate-disabled",$4=[],FI={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},H4={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},_l="__ng_removed";class sx{get params(){return this.options.params}constructor(t,n=""){this.namespaceId=n;const i=t&&t.hasOwnProperty("value");if(this.value=function Z4(e){return e??null}(i?t.value:t),i){const l=dg(t);delete l.value,this.options=l}else this.options={};this.options.params||(this.options.params={})}absorbOptions(t){const n=t.params;if(n){const i=this.options.params;Object.keys(n).forEach(r=>{null==i[r]&&(i[r]=n[r])})}}}const mg="void",ox=new sx(mg);class q4{constructor(t,n,i){this.id=t,this.hostElement=n,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,Da(n,this._hostClassName)}listen(t,n,i,r){if(!this._triggers.has(n))throw function Gz(e,t){return new Ie(3302,!1)}();if(null==i||0==i.length)throw function Wz(e){return new Ie(3303,!1)}();if(!function K4(e){return"start"==e||"done"==e}(i))throw function Zz(e,t){return new Ie(3400,!1)}();const l=Xo(this._elementListeners,t,[]),h={name:n,phase:i,callback:r};l.push(h);const f=Xo(this._engine.statesByElement,t,new Map);return f.has(n)||(Da(t,H_),Da(t,H_+"-"+n),f.set(n,ox)),()=>{this._engine.afterFlush(()=>{const _=l.indexOf(h);_>=0&&l.splice(_,1),this._triggers.has(n)||f.delete(n)})}}register(t,n){return!this._triggers.has(t)&&(this._triggers.set(t,n),!0)}_getTrigger(t){const n=this._triggers.get(t);if(!n)throw function Kz(e){return new Ie(3401,!1)}();return n}trigger(t,n,i,r=!0){const l=this._getTrigger(n),h=new ax(this.id,n,t);let f=this._engine.statesByElement.get(t);f||(Da(t,H_),Da(t,H_+"-"+n),this._engine.statesByElement.set(t,f=new Map));let _=f.get(n);const C=new sx(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&_&&C.absorbOptions(_.options),f.set(n,C),_||(_=ox),C.value!==mg&&_.value===C.value){if(!function Q4(e,t){const n=Object.keys(e),i=Object.keys(t);if(n.length!=i.length)return!1;for(let r=0;r<n.length;r++){const l=n[r];if(!t.hasOwnProperty(l)||e[l]!==t[l])return!1}return!0}(_.params,C.params)){const ee=[],me=l.matchStyles(_.value,_.params,ee),ve=l.matchStyles(C.value,C.params,ee);ee.length?this._engine.reportError(ee):this._engine.afterFlush(()=>{vd(t,me),nc(t,ve)})}return}const F=Xo(this._engine.playersByElement,t,[]);F.forEach(ee=>{ee.namespaceId==this.id&&ee.triggerName==n&&ee.queued&&ee.destroy()});let $=l.matchTransition(_.value,C.value,t,C.params),Q=!1;if(!$){if(!r)return;$=l.fallbackTransition,Q=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:n,transition:$,fromState:_,toState:C,player:h,isFallbackTransition:Q}),Q||(Da(t,NI),h.onStart(()=>{lp(t,NI)})),h.onDone(()=>{let ee=this.players.indexOf(h);ee>=0&&this.players.splice(ee,1);const me=this._engine.playersByElement.get(t);if(me){let ve=me.indexOf(h);ve>=0&&me.splice(ve,1)}}),this.players.push(h),F.push(h),h}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(n=>n.delete(t)),this._elementListeners.forEach((n,i)=>{this._elementListeners.set(i,n.filter(r=>r.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const n=this._engine.playersByElement.get(t);n&&(n.forEach(i=>i.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,n){const i=this._engine.driver.query(t,q_,!0);i.forEach(r=>{if(r[_l])return;const l=this._engine.fetchNamespacesByElement(r);l.size?l.forEach(h=>h.triggerLeaveAnimation(r,n,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(t,n,i,r){const l=this._engine.statesByElement.get(t),h=new Map;if(l){const f=[];if(l.forEach((_,C)=>{if(h.set(C,_.value),this._triggers.has(C)){const A=this.trigger(t,C,mg,r);A&&f.push(A)}}),f.length)return this._engine.markElementAsRemoved(this.id,t,!0,n,h),i&&eh(f).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const n=this._elementListeners.get(t),i=this._engine.statesByElement.get(t);if(n&&i){const r=new Set;n.forEach(l=>{const h=l.name;if(r.has(h))return;r.add(h);const _=this._triggers.get(h).fallbackTransition,C=i.get(h)||ox,A=new sx(mg),R=new ax(this.id,h,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:h,transition:_,fromState:C,toState:A,player:R,isFallbackTransition:!0})})}}removeNode(t,n){const i=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,n),this.triggerLeaveAnimation(t,n,!0))return;let r=!1;if(i.totalAnimations){const l=i.players.length?i.playersByQueriedElement.get(t):[];if(l&&l.length)r=!0;else{let h=t;for(;h=h.parentNode;)if(i.statesByElement.get(h)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)i.markElementAsRemoved(this.id,t,!1,n);else{const l=t[_l];(!l||l===FI)&&(i.afterFlush(()=>this.clearElementCache(t)),i.destroyInnerAnimations(t),i._onRemovalComplete(t,n))}}insertNode(t,n){Da(t,this._hostClassName)}drainQueuedTransitions(t){const n=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const l=i.element,h=this._elementListeners.get(l);h&&h.forEach(f=>{if(f.name==i.triggerName){const _=$b(l,i.triggerName,i.fromState.value,i.toState.value);_._data=t,Vb(i.player,f.phase,_,f.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):n.push(i)}),this._queue=[],n.sort((i,r)=>{const l=i.transition.ast.depCount,h=r.transition.ast.depCount;return 0==l||0==h?l-h:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(t){this.players.forEach(n=>n.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}}class G4{_onRemovalComplete(t,n){this.onRemovalComplete(t,n)}constructor(t,n,i){this.bodyNode=t,this.driver=n,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,l)=>{}}get queuedPlayers(){const t=[];return this._namespaceList.forEach(n=>{n.players.forEach(i=>{i.queued&&t.push(i)})}),t}createNamespace(t,n){const i=new q4(t,n,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,n)?this._balanceNamespaceList(i,n):(this.newHostElements.set(n,i),this.collectEnterElement(n)),this._namespaceLookup[t]=i}_balanceNamespaceList(t,n){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let h=!1,f=this.driver.getParentElement(n);for(;f;){const _=r.get(f);if(_){const C=i.indexOf(_);i.splice(C+1,0,t),h=!0;break}f=this.driver.getParentElement(f)}h||i.unshift(t)}else i.push(t);return r.set(n,t),t}register(t,n){let i=this._namespaceLookup[t];return i||(i=this.createNamespace(t,n)),i}registerTrigger(t,n,i){let r=this._namespaceLookup[t];r&&r.register(n,i)&&this.totalAnimations++}destroy(t,n){t&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(t);this.namespacesByHostElement.delete(i.hostElement);const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1),i.destroy(n),delete this._namespaceLookup[t]}))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const n=new Set,i=this.statesByElement.get(t);if(i)for(let r of i.values())if(r.namespaceId){const l=this._fetchNamespace(r.namespaceId);l&&n.add(l)}return n}trigger(t,n,i,r){if(ev(n)){const l=this._fetchNamespace(t);if(l)return l.trigger(n,i,r),!0}return!1}insertNode(t,n,i,r){if(!ev(n))return;const l=n[_l];if(l&&l.setForRemoval){l.setForRemoval=!1,l.setForMove=!0;const h=this.collectedLeaveElements.indexOf(n);h>=0&&this.collectedLeaveElements.splice(h,1)}if(t){const h=this._fetchNamespace(t);h&&h.insertNode(n,i)}r&&this.collectEnterElement(n)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,n){n?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Da(t,rx)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),lp(t,rx))}removeNode(t,n,i){if(ev(n)){const r=t?this._fetchNamespace(t):null;r?r.removeNode(n,i):this.markElementAsRemoved(t,n,!1,i);const l=this.namespacesByHostElement.get(n);l&&l.id!==t&&l.removeNode(n,i)}else this._onRemovalComplete(n,i)}markElementAsRemoved(t,n,i,r,l){this.collectedLeaveElements.push(n),n[_l]={namespaceId:t,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:l}}listen(t,n,i,r,l){return ev(n)?this._fetchNamespace(t).listen(n,i,r,l):()=>{}}_buildInstruction(t,n,i,r,l){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,i,r,t.fromState.options,t.toState.options,n,l)}destroyInnerAnimations(t){let n=this.driver.query(t,q_,!0);n.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(n=this.driver.query(t,Wb,!0),n.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(t){const n=this.playersByElement.get(t);n&&n.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(t){const n=this.playersByQueriedElement.get(t);n&&n.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return eh(this.players).onDone(()=>t());t()})}processLeaveNode(t){const n=t[_l];if(n&&n.setForRemoval){if(t[_l]=FI,n.namespaceId){this.destroyInnerAnimations(t);const i=this._fetchNamespace(n.namespaceId);i&&i.clearElementCache(t)}this._onRemovalComplete(t,n.setForRemoval)}t.classList?.contains(rx)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(t=-1){let n=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Da(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{n=this._flushAnimations(i,t)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],n.length?eh(n).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(t){throw function Xz(e){return new Ie(3402,!1)}()}_flushAnimations(t,n){const i=new Y_,r=[],l=new Map,h=[],f=new Map,_=new Map,C=new Map,A=new Set;this.disabledNodes.forEach(Ke=>{A.add(Ke);const ct=this.driver.query(Ke,".ng-animate-queued",!0);for(let mt=0;mt<ct.length;mt++)A.add(ct[mt])});const R=this.bodyNode,F=Array.from(this.statesByElement.keys()),$=UI(F,this.collectedEnterElements),Q=new Map;let ee=0;$.forEach((Ke,ct)=>{const mt=Gb+ee++;Q.set(ct,mt),Ke.forEach(Yt=>Da(Yt,mt))});const me=[],ve=new Set,pe=new Set;for(let Ke=0;Ke<this.collectedLeaveElements.length;Ke++){const ct=this.collectedLeaveElements[Ke],mt=ct[_l];mt&&mt.setForRemoval&&(me.push(ct),ve.add(ct),mt.hasAnimation?this.driver.query(ct,".ng-star-inserted",!0).forEach(Yt=>ve.add(Yt)):pe.add(ct))}const Le=new Map,qe=UI(F,Array.from(ve));qe.forEach((Ke,ct)=>{const mt=$_+ee++;Le.set(ct,mt),Ke.forEach(Yt=>Da(Yt,mt))}),t.push(()=>{$.forEach((Ke,ct)=>{const mt=Q.get(ct);Ke.forEach(Yt=>lp(Yt,mt))}),qe.forEach((Ke,ct)=>{const mt=Le.get(ct);Ke.forEach(Yt=>lp(Yt,mt))}),me.forEach(Ke=>{this.processLeaveNode(Ke)})});const at=[],xt=[];for(let Ke=this._namespaceList.length-1;Ke>=0;Ke--)this._namespaceList[Ke].drainQueuedTransitions(n).forEach(mt=>{const Yt=mt.player,Di=mt.element;if(at.push(Yt),this.collectedEnterElements.length){const zs=Di[_l];if(zs&&zs.setForMove){if(zs.previousTriggersValues&&zs.previousTriggersValues.has(mt.triggerName)){const Ld=zs.previousTriggersValues.get(mt.triggerName),La=this.statesByElement.get(mt.element);if(La&&La.has(mt.triggerName)){const Gv=La.get(mt.triggerName);Gv.value=Ld,La.set(mt.triggerName,Gv)}}return void Yt.destroy()}}const Li=!R||!this.driver.containsElement(R,Di),Kr=Le.get(Di),Eo=Q.get(Di),vi=this._buildInstruction(mt,i,Eo,Kr,Li);if(vi.errors&&vi.errors.length)return void xt.push(vi);if(Li)return Yt.onStart(()=>vd(Di,vi.fromStyles)),Yt.onDestroy(()=>nc(Di,vi.toStyles)),void r.push(Yt);if(mt.isFallbackTransition)return Yt.onStart(()=>vd(Di,vi.fromStyles)),Yt.onDestroy(()=>nc(Di,vi.toStyles)),void r.push(Yt);const Bg=[];vi.timelines.forEach(zs=>{zs.stretchStartingKeyframe=!0,this.disabledNodes.has(zs.element)||Bg.push(zs)}),vi.timelines=Bg,i.append(Di,vi.timelines),h.push({instruction:vi,player:Yt,element:Di}),vi.queriedElements.forEach(zs=>Xo(f,zs,[]).push(Yt)),vi.preStyleProps.forEach((zs,Ld)=>{if(zs.size){let La=_.get(Ld);La||_.set(Ld,La=new Set),zs.forEach((Gv,Ew)=>La.add(Ew))}}),vi.postStyleProps.forEach((zs,Ld)=>{let La=C.get(Ld);La||C.set(Ld,La=new Set),zs.forEach((Gv,Ew)=>La.add(Ew))})});if(xt.length){const Ke=[];xt.forEach(ct=>{Ke.push(function Yz(e,t){return new Ie(3505,!1)}())}),at.forEach(ct=>ct.destroy()),this.reportError(Ke)}const wt=new Map,Rt=new Map;h.forEach(Ke=>{const ct=Ke.element;i.has(ct)&&(Rt.set(ct,ct),this._beforeAnimationBuild(Ke.player.namespaceId,Ke.instruction,wt))}),r.forEach(Ke=>{const ct=Ke.element;this._getPreviousPlayers(ct,!1,Ke.namespaceId,Ke.triggerName,null).forEach(Yt=>{Xo(wt,ct,[]).push(Yt),Yt.destroy()})});const Ht=me.filter(Ke=>jI(Ke,_,C)),Xt=new Map;BI(Xt,this.driver,pe,C,lu).forEach(Ke=>{jI(Ke,_,C)&&Ht.push(Ke)});const on=new Map;$.forEach((Ke,ct)=>{BI(on,this.driver,new Set(Ke),_,"!")}),Ht.forEach(Ke=>{const ct=Xt.get(Ke),mt=on.get(Ke);Xt.set(Ke,new Map([...ct?.entries()??[],...mt?.entries()??[]]))});const an=[],Un=[],di={};h.forEach(Ke=>{const{element:ct,player:mt,instruction:Yt}=Ke;if(i.has(ct)){if(A.has(ct))return mt.onDestroy(()=>nc(ct,Yt.toStyles)),mt.disabled=!0,mt.overrideTotalTime(Yt.totalTime),void r.push(mt);let Di=di;if(Rt.size>1){let Kr=ct;const Eo=[];for(;Kr=Kr.parentNode;){const vi=Rt.get(Kr);if(vi){Di=vi;break}Eo.push(Kr)}Eo.forEach(vi=>Rt.set(vi,Di))}const Li=this._buildAnimation(mt.namespaceId,Yt,wt,l,on,Xt);if(mt.setRealPlayer(Li),Di===di)an.push(mt);else{const Kr=this.playersByElement.get(Di);Kr&&Kr.length&&(mt.parentPlayer=eh(Kr)),r.push(mt)}}else vd(ct,Yt.fromStyles),mt.onDestroy(()=>nc(ct,Yt.toStyles)),Un.push(mt),A.has(ct)&&r.push(mt)}),Un.forEach(Ke=>{const ct=l.get(Ke.element);if(ct&&ct.length){const mt=eh(ct);Ke.setRealPlayer(mt)}}),r.forEach(Ke=>{Ke.parentPlayer?Ke.syncPlayerEvents(Ke.parentPlayer):Ke.destroy()});for(let Ke=0;Ke<me.length;Ke++){const ct=me[Ke],mt=ct[_l];if(lp(ct,$_),mt&&mt.hasAnimation)continue;let Yt=[];if(f.size){let Li=f.get(ct);Li&&Li.length&&Yt.push(...Li);let Kr=this.driver.query(ct,Wb,!0);for(let Eo=0;Eo<Kr.length;Eo++){let vi=f.get(Kr[Eo]);vi&&vi.length&&Yt.push(...vi)}}const Di=Yt.filter(Li=>!Li.destroyed);Di.length?X4(this,ct,Di):this.processLeaveNode(ct)}return me.length=0,an.forEach(Ke=>{this.players.push(Ke),Ke.onDone(()=>{Ke.destroy();const ct=this.players.indexOf(Ke);this.players.splice(ct,1)}),Ke.play()}),an}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,n,i,r,l){let h=[];if(n){const f=this.playersByQueriedElement.get(t);f&&(h=f)}else{const f=this.playersByElement.get(t);if(f){const _=!l||l==mg;f.forEach(C=>{C.queued||!_&&C.triggerName!=r||h.push(C)})}}return(i||r)&&(h=h.filter(f=>!(i&&i!=f.namespaceId||r&&r!=f.triggerName))),h}_beforeAnimationBuild(t,n,i){const l=n.element,h=n.isRemovalTransition?void 0:t,f=n.isRemovalTransition?void 0:n.triggerName;for(const _ of n.timelines){const C=_.element,A=C!==l,R=Xo(i,C,[]);this._getPreviousPlayers(C,A,h,f,n.toState).forEach($=>{const Q=$.getRealPlayer();Q.beforeDestroy&&Q.beforeDestroy(),$.destroy(),R.push($)})}vd(l,n.fromStyles)}_buildAnimation(t,n,i,r,l,h){const f=n.triggerName,_=n.element,C=[],A=new Set,R=new Set,F=n.timelines.map(Q=>{const ee=Q.element;A.add(ee);const me=ee[_l];if(me&&me.removedBeforeQueried)return new hg(Q.duration,Q.delay);const ve=ee!==_,pe=function Y4(e){const t=[];return VI(e,t),t}((i.get(ee)||$4).map(wt=>wt.getRealPlayer())).filter(wt=>!!wt.element&&wt.element===ee),Le=l.get(ee),qe=h.get(ee),at=yI(this._normalizer,Q.keyframes,Le,qe),xt=this._buildPlayer(Q,at,pe);if(Q.subTimeline&&r&&R.add(ee),ve){const wt=new ax(t,f,ee);wt.setRealPlayer(xt),C.push(wt)}return xt});C.forEach(Q=>{Xo(this.playersByQueriedElement,Q.element,[]).push(Q),Q.onDone(()=>function W4(e,t,n){let i=e.get(t);if(i){if(i.length){const r=i.indexOf(n);i.splice(r,1)}0==i.length&&e.delete(t)}return i}(this.playersByQueriedElement,Q.element,Q))}),A.forEach(Q=>Da(Q,EI));const $=eh(F);return $.onDestroy(()=>{A.forEach(Q=>lp(Q,EI)),nc(_,n.toStyles)}),R.forEach(Q=>{Xo(r,Q,[]).push($)}),$}_buildPlayer(t,n,i){return n.length>0?this.driver.animate(t.element,n,t.duration,t.delay,t.easing,i):new hg(t.duration,t.delay)}}class ax{constructor(t,n,i){this.namespaceId=t,this.triggerName=n,this.element=i,this._player=new hg,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((n,i)=>{n.forEach(r=>Vb(t,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const n=this._player;n.triggerCallback&&t.onStart(()=>n.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,n){Xo(this._queuedCallbacks,t,[]).push(n)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const n=this._player;n.triggerCallback&&n.triggerCallback(t)}}function ev(e){return e&&1===e.nodeType}function zI(e,t){const n=e.style.display;return e.style.display=t??"none",n}function BI(e,t,n,i,r){const l=[];n.forEach(_=>l.push(zI(_)));const h=[];i.forEach((_,C)=>{const A=new Map;_.forEach(R=>{const F=t.computeStyle(C,R,r);A.set(R,F),(!F||0==F.length)&&(C[_l]=H4,h.push(C))}),e.set(C,A)});let f=0;return n.forEach(_=>zI(_,l[f++])),h}function UI(e,t){const n=new Map;if(e.forEach(f=>n.set(f,[])),0==t.length)return n;const r=new Set(t),l=new Map;function h(f){if(!f)return 1;let _=l.get(f);if(_)return _;const C=f.parentNode;return _=n.has(C)?C:r.has(C)?1:h(C),l.set(f,_),_}return t.forEach(f=>{const _=h(f);1!==_&&n.get(_).push(f)}),n}function Da(e,t){e.classList?.add(t)}function lp(e,t){e.classList?.remove(t)}function X4(e,t,n){eh(n).onDone(()=>e.processLeaveNode(t))}function VI(e,t){for(let n=0;n<e.length;n++){const i=e[n];i instanceof mI?VI(i.players,t):t.push(i)}}function jI(e,t,n){const i=n.get(e);if(!i)return!1;let r=t.get(e);return r?i.forEach(l=>r.add(l)):t.set(e,i),n.delete(e),!0}class tv{constructor(t,n,i){this.bodyNode=t,this._driver=n,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,l)=>{},this._transitionEngine=new G4(t,n,i),this._timelineEngine=new z4(t,n,i),this._transitionEngine.onRemovalComplete=(r,l)=>this.onRemovalComplete(r,l)}registerTrigger(t,n,i,r,l){const h=t+"-"+r;let f=this._triggerCache[h];if(!f){const _=[],A=Yb(this._driver,l,_,[]);if(_.length)throw function Uz(e,t){return new Ie(3404,!1)}();f=function k4(e,t,n){return new O4(e,t,n)}(r,A,this._normalizer),this._triggerCache[h]=f}this._transitionEngine.registerTrigger(n,r,f)}register(t,n){this._transitionEngine.register(t,n)}destroy(t,n){this._transitionEngine.destroy(t,n)}onInsert(t,n,i,r){this._transitionEngine.insertNode(t,n,i,r)}onRemove(t,n,i){this._transitionEngine.removeNode(t,n,i)}disableAnimations(t,n){this._transitionEngine.markElementAsDisabled(t,n)}process(t,n,i,r){if("@"==i.charAt(0)){const[l,h]=_I(i);this._timelineEngine.command(l,n,h,r)}else this._transitionEngine.trigger(t,n,i,r)}listen(t,n,i,r,l){if("@"==i.charAt(0)){const[h,f]=_I(i);return this._timelineEngine.listen(h,n,f,l)}return this._transitionEngine.listen(t,n,i,r,l)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(t){this._transitionEngine.afterFlushAnimationsDone(t)}}let eB=(()=>{class e{static#e=this.initialStylesByElement=new WeakMap;constructor(n,i,r){this._element=n,this._startStyles=i,this._endStyles=r,this._state=0;let l=e.initialStylesByElement.get(n);l||e.initialStylesByElement.set(n,l=new Map),this._initialStyles=l}start(){this._state<1&&(this._startStyles&&nc(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(nc(this._element,this._initialStyles),this._endStyles&&(nc(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(vd(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(vd(this._element,this._endStyles),this._endStyles=null),nc(this._element,this._initialStyles),this._state=3)}}return e})();function lx(e){let t=null;return e.forEach((n,i)=>{(function tB(e){return"display"===e||"position"===e})(i)&&(t=t||new Map,t.set(i,n))}),t}class $I{constructor(t,n,i,r){this.element=t,this.keyframes=n,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const n=[];return t.forEach(i=>{n.push(Object.fromEntries(i))}),n}_triggerWebAnimation(t,n,i){return t.animate(this._convertKeyframesToObject(n),i)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&t.set(r,this._finished?i:II(this.element,r))}),this.currentSnapshot=t}triggerCallback(t){const n="start"===t?this._onStartFns:this._onDoneFns;n.forEach(i=>i()),n.length=0}}class nB{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,n){return!1}containsElement(t,n){return bI(t,n)}getParentElement(t){return Hb(t)}query(t,n,i){return xI(t,n,i)}computeStyle(t,n,i){return window.getComputedStyle(t)[n]}animate(t,n,i,r,l,h=[]){const _={duration:i,delay:r,fill:0==r?"both":"forwards"};l&&(_.easing=l);const C=new Map,A=h.filter($=>$ instanceof $I);(function c4(e,t){return 0===e||0===t})(i,r)&&A.forEach($=>{$.currentSnapshot.forEach((Q,ee)=>C.set(ee,Q))});let R=function o4(e){return e.length?e[0]instanceof Map?e:e.map(t=>SI(t)):[]}(n).map($=>th($));R=function u4(e,t,n){if(n.size&&t.length){let i=t[0],r=[];if(n.forEach((l,h)=>{i.has(h)||r.push(h),i.set(h,l)}),r.length)for(let l=1;l<t.length;l++){let h=t[l];r.forEach(f=>h.set(f,II(e,f)))}}return t}(t,R,C);const F=function J4(e,t){let n=null,i=null;return Array.isArray(t)&&t.length?(n=lx(t[0]),t.length>1&&(i=lx(t[t.length-1]))):t instanceof Map&&(n=lx(t)),n||i?new eB(e,n,i):null}(t,R);return new $I(t,R,_,F)}}let iB=(()=>{class e extends cI{constructor(n,i){super(),this._nextAnimationId=0,this._renderer=n.createRenderer(i.body,{id:"0",encapsulation:ds.None,styles:[],data:{animation:[]}})}build(n){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(n)?hI(n):n;return HI(this._renderer,null,i,"register",[r]),new rB(i,this._renderer)}static#e=this.\u0275fac=function(i){return new(i||e)(lt(Nm),lt(ys))};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac})}return e})();class rB extends yz{constructor(t,n){super(),this._id=t,this._renderer=n}create(t,n){return new sB(this._id,t,n||{},this._renderer)}}class sB{constructor(t,n,i,r){this.id=t,this.element=n,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(t,n){return this._renderer.listen(this.element,`@@${this.id}:${t}`,n)}_command(t,...n){return HI(this._renderer,this.element,this.id,t,n)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function HI(e,t,n,i,r){return e.setProperty(t,`@@${n}:${i}`,r)}const qI="@.disabled";let oB=(()=>{class e{constructor(n,i,r){this.delegate=n,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,i.onRemovalComplete=(l,h)=>{const f=h?.parentNode(l);f&&h.removeChild(f,l)}}createRenderer(n,i){const l=this.delegate.createRenderer(n,i);if(!(n&&i&&i.data&&i.data.animation)){let A=this._rendererCache.get(l);return A||(A=new GI("",l,this.engine,()=>this._rendererCache.delete(l)),this._rendererCache.set(l,A)),A}const h=i.id,f=i.id+"-"+this._currentId;this._currentId++,this.engine.register(f,n);const _=A=>{Array.isArray(A)?A.forEach(_):this.engine.registerTrigger(h,f,n,A.name,A)};return i.data.animation.forEach(_),new aB(this,f,l,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(n,i,r){n>=0&&n<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(l=>{const[h,f]=l;h(f)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}static#e=this.\u0275fac=function(i){return new(i||e)(lt(Nm),lt(tv),lt(Yn))};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac})}return e})();class GI{constructor(t,n,i,r){this.namespaceId=t,this.delegate=n,this.engine=i,this._onDestroy=r}get data(){return this.delegate.data}destroyNode(t){this.delegate.destroyNode?.(t)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(t,n){return this.delegate.createElement(t,n)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,n){this.delegate.appendChild(t,n),this.engine.onInsert(this.namespaceId,n,t,!1)}insertBefore(t,n,i,r=!0){this.delegate.insertBefore(t,n,i),this.engine.onInsert(this.namespaceId,n,t,r)}removeChild(t,n,i){this.engine.onRemove(this.namespaceId,n,this.delegate)}selectRootElement(t,n){return this.delegate.selectRootElement(t,n)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,n,i,r){this.delegate.setAttribute(t,n,i,r)}removeAttribute(t,n,i){this.delegate.removeAttribute(t,n,i)}addClass(t,n){this.delegate.addClass(t,n)}removeClass(t,n){this.delegate.removeClass(t,n)}setStyle(t,n,i,r){this.delegate.setStyle(t,n,i,r)}removeStyle(t,n,i){this.delegate.removeStyle(t,n,i)}setProperty(t,n,i){"@"==n.charAt(0)&&n==qI?this.disableAnimations(t,!!i):this.delegate.setProperty(t,n,i)}setValue(t,n){this.delegate.setValue(t,n)}listen(t,n,i){return this.delegate.listen(t,n,i)}disableAnimations(t,n){this.engine.disableAnimations(t,n)}}class aB extends GI{constructor(t,n,i,r,l){super(n,i,r,l),this.factory=t,this.namespaceId=n}setProperty(t,n,i){"@"==n.charAt(0)?"."==n.charAt(1)&&n==qI?this.disableAnimations(t,i=void 0===i||!!i):this.engine.process(this.namespaceId,t,n.slice(1),i):this.delegate.setProperty(t,n,i)}listen(t,n,i){if("@"==n.charAt(0)){const r=function lB(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(t);let l=n.slice(1),h="";return"@"!=l.charAt(0)&&([l,h]=function cB(e){const t=e.indexOf(".");return[e.substring(0,t),e.slice(t+1)]}(l)),this.engine.listen(this.namespaceId,r,l,h,f=>{this.factory.scheduleListenerCallback(f._data||-1,i,f)})}return this.delegate.listen(t,n,i)}}const WI=[{provide:cI,useClass:iB},{provide:nx,useFactory:function hB(){return new M4}},{provide:tv,useClass:(()=>{class e extends tv{constructor(n,i,r,l){super(n.body,i,r)}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(i){return new(i||e)(lt(ys),lt(qb),lt(nx),lt(pd))};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac})}return e})()},{provide:Nm,useFactory:function dB(e,t,n){return new oB(e,t,n)},deps:[Nb,tv,Yn]}],cx=[{provide:qb,useFactory:()=>new nB},{provide:Xw,useValue:"BrowserAnimations"},...WI],ZI=[{provide:qb,useClass:wI},{provide:Xw,useValue:"NoopAnimations"},...WI];let fB=(()=>{class e{static withConfig(n){return{ngModule:e,providers:n.disableAnimations?ZI:cx}}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=nr({type:e});static#n=this.\u0275inj=$i({providers:cx,imports:[rI]})}return e})();const{isArray:mB}=Array,{getPrototypeOf:gB,prototype:yB,keys:_B}=Object;const{isArray:xB}=Array;function ux(...e){const t=gn(e),n=function Dp(e){return xn(sa(e))?e.pop():void 0}(e),{args:i,keys:r}=function vB(e){if(1===e.length){const t=e[0];if(mB(t))return{args:t,keys:null};if(function bB(e){return e&&"object"==typeof e&&gB(e)===yB}(t)){const n=_B(t);return{args:n.map(i=>t[i]),keys:n}}}return{args:e,keys:null}}(e);if(0===i.length)return It([],t);const l=new pi(function SB(e,t,n=ji){return i=>{KI(t,()=>{const{length:r}=e,l=new Array(r);let h=r,f=r;for(let _=0;_<r;_++)KI(t,()=>{const C=It(e[_],t);let A=!1;C.subscribe(kn(i,R=>{l[_]=R,A||(A=!0,f--),f||i.next(n(l.slice()))},()=>{--h||i.complete()}))},i)},i)}}(i,t,r?h=>function EB(e,t){return e.reduce((n,i,r)=>(n[i]=t[r],n),{})}(r,h):ji));return n?l.pipe(function CB(e){return pn(t=>function wB(e,t){return xB(t)?e(...t):e(t)}(e,t))}(n)):l}function KI(e,t,n){e?zt(n,e,t):t()}const iv=lc(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function hx(...e){return function TB(){return ti(1)}()(It(e,gn(e)))}function XI(e){return new pi(t=>{Je(e()).subscribe(t)})}function gg(e,t){const n=xn(e)?e:()=>e,i=r=>r.error(n());return new pi(t?r=>t.schedule(i,0,r):i)}function dx(){return Wn((e,t)=>{let n=null;e._refCount++;const i=kn(t,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(n=null);const r=e._connection,l=n;n=null,r&&(!l||r===l)&&r.unsubscribe(),t.unsubscribe()});e.subscribe(i),i.closed||(n=e.connect())})}class YI extends pi{constructor(t,n){super(),this.source=t,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Na(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new ei;const n=this.getSubject();t.add(this.source.subscribe(kn(n,void 0,()=>{this._teardown(),n.complete()},i=>{this._teardown(),n.error(i)},()=>this._teardown()))),t.closed&&(this._connection=null,t=ei.EMPTY)}return t}refCount(){return dx()(this)}}function cp(e){return e<=0?()=>Zn:Wn((t,n)=>{let i=0;t.subscribe(kn(n,r=>{++i<=e&&(n.next(r),e<=i&&n.complete())}))})}function uu(e,t){return Wn((n,i)=>{let r=0;n.subscribe(kn(i,l=>e.call(t,l,r++)&&i.next(l)))})}function rv(e){return Wn((t,n)=>{let i=!1;t.subscribe(kn(n,r=>{i=!0,n.next(r)},()=>{i||n.next(e),n.complete()}))})}function QI(e=IB){return Wn((t,n)=>{let i=!1;t.subscribe(kn(n,r=>{i=!0,n.next(r)},()=>i?n.complete():n.error(e())))})}function IB(){return new iv}function xd(e,t){const n=arguments.length>=2;return i=>i.pipe(e?uu((r,l)=>e(r,l,i)):ji,cp(1),n?rv(t):QI(()=>new iv))}function up(e,t){return xn(t)?Ut(e,t,1):Ut(e,1)}function Ns(e,t,n){const i=xn(e)||t||n?{next:e,error:t,complete:n}:e;return i?Wn((r,l)=>{var h;null===(h=i.subscribe)||void 0===h||h.call(i);let f=!0;r.subscribe(kn(l,_=>{var C;null===(C=i.next)||void 0===C||C.call(i,_),l.next(_)},()=>{var _;f=!1,null===(_=i.complete)||void 0===_||_.call(i),l.complete()},_=>{var C;f=!1,null===(C=i.error)||void 0===C||C.call(i,_),l.error(_)},()=>{var _,C;f&&(null===(_=i.unsubscribe)||void 0===_||_.call(i)),null===(C=i.finalize)||void 0===C||C.call(i)}))}):ji}function wd(e){return Wn((t,n)=>{let l,i=null,r=!1;i=t.subscribe(kn(n,void 0,void 0,h=>{l=Je(e(h,wd(e)(t))),i?(i.unsubscribe(),i=null,l.subscribe(n)):r=!0})),r&&(i.unsubscribe(),i=null,l.subscribe(n))})}function fx(e){return e<=0?()=>Zn:Wn((t,n)=>{let i=[];t.subscribe(kn(n,r=>{i.push(r),e<i.length&&i.shift()},()=>{for(const r of i)n.next(r);n.complete()},void 0,()=>{i=null}))})}function yg(e){return Wn((t,n)=>{try{t.subscribe(n)}finally{n.add(e)}})}const rn="primary",_g=Symbol("RouteTitle");class kB{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n[0]:n}return null}getAll(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function hp(e){return new kB(e)}function OB(e,t,n){const i=n.path.split("/");if(i.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||i.length<e.length))return null;const r={};for(let l=0;l<i.length;l++){const h=i[l],f=e[l];if(h.startsWith(":"))r[h.substring(1)]=f;else if(h!==f.path)return null}return{consumed:e.slice(0,i.length),posParams:r}}function ic(e,t){const n=e?Object.keys(e):void 0,i=t?Object.keys(t):void 0;if(!n||!i||n.length!=i.length)return!1;let r;for(let l=0;l<n.length;l++)if(r=n[l],!JI(e[r],t[r]))return!1;return!0}function JI(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;const n=[...e].sort(),i=[...t].sort();return n.every((r,l)=>i[l]===r)}return e===t}function e2(e){return e.length>0?e[e.length-1]:null}function nh(e){return function pB(e){return!!e&&(e instanceof pi||xn(e.lift)&&xn(e.subscribe))}(e)?e:l_(e)?It(Promise.resolve(e)):Et(e)}const FB={exact:function r2(e,t,n){if(!Cd(e.segments,t.segments)||!sv(e.segments,t.segments,n)||e.numberOfChildren!==t.numberOfChildren)return!1;for(const i in t.children)if(!e.children[i]||!r2(e.children[i],t.children[i],n))return!1;return!0},subset:s2},t2={exact:function zB(e,t){return ic(e,t)},subset:function BB(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(n=>JI(e[n],t[n]))},ignored:()=>!0};function n2(e,t,n){return FB[n.paths](e.root,t.root,n.matrixParams)&&t2[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function s2(e,t,n){return o2(e,t,t.segments,n)}function o2(e,t,n,i){if(e.segments.length>n.length){const r=e.segments.slice(0,n.length);return!(!Cd(r,n)||t.hasChildren()||!sv(r,n,i))}if(e.segments.length===n.length){if(!Cd(e.segments,n)||!sv(e.segments,n,i))return!1;for(const r in t.children)if(!e.children[r]||!s2(e.children[r],t.children[r],i))return!1;return!0}{const r=n.slice(0,e.segments.length),l=n.slice(e.segments.length);return!!(Cd(e.segments,r)&&sv(e.segments,r,i)&&e.children[rn])&&o2(e.children[rn],t,l,i)}}function sv(e,t,n){return t.every((i,r)=>t2[n](e[r].parameters,i.parameters))}class dp{constructor(t=new si([],{}),n={},i=null){this.root=t,this.queryParams=n,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=hp(this.queryParams)),this._queryParamMap}toString(){return jB.serialize(this)}}class si{constructor(t,n){this.segments=t,this.children=n,this.parent=null,Object.values(n).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ov(this)}}class vg{constructor(t,n){this.path=t,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=hp(this.parameters)),this._parameterMap}toString(){return c2(this)}}function Cd(e,t){return e.length===t.length&&e.every((n,i)=>n.path===t[i].path)}let bg=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:function(){return new px},providedIn:"root"})}return e})();class px{parse(t){const n=new JB(t);return new dp(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(t){const n=`/${xg(t.root,!0)}`,i=function qB(e){const t=Object.keys(e).map(n=>{const i=e[n];return Array.isArray(i)?i.map(r=>`${av(n)}=${av(r)}`).join("&"):`${av(n)}=${av(i)}`}).filter(n=>!!n);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${n}${i}${"string"==typeof t.fragment?`#${function $B(e){return encodeURI(e)}(t.fragment)}`:""}`}}const jB=new px;function ov(e){return e.segments.map(t=>c2(t)).join("/")}function xg(e,t){if(!e.hasChildren())return ov(e);if(t){const n=e.children[rn]?xg(e.children[rn],!1):"",i=[];return Object.entries(e.children).forEach(([r,l])=>{r!==rn&&i.push(`${r}:${xg(l,!1)}`)}),i.length>0?`${n}(${i.join("//")})`:n}{const n=function VB(e,t){let n=[];return Object.entries(e.children).forEach(([i,r])=>{i===rn&&(n=n.concat(t(r,i)))}),Object.entries(e.children).forEach(([i,r])=>{i!==rn&&(n=n.concat(t(r,i)))}),n}(e,(i,r)=>r===rn?[xg(e.children[rn],!1)]:[`${r}:${xg(i,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[rn]?`${ov(e)}/${n[0]}`:`${ov(e)}/(${n.join("//")})`}}function a2(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function av(e){return a2(e).replace(/%3B/gi,";")}function mx(e){return a2(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function lv(e){return decodeURIComponent(e)}function l2(e){return lv(e.replace(/\+/g,"%20"))}function c2(e){return`${mx(e.path)}${function HB(e){return Object.keys(e).map(t=>`;${mx(t)}=${mx(e[t])}`).join("")}(e.parameters)}`}const GB=/^[^\/()?;#]+/;function gx(e){const t=e.match(GB);return t?t[0]:""}const WB=/^[^\/()?;=#]+/,KB=/^[^=?&#]+/,YB=/^[^&#]+/;class JB{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new si([],{}):new si([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(t.length>0||Object.keys(n).length>0)&&(i[rn]=new si(t,n)),i}parseSegment(){const t=gx(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Ie(4009,!1);return this.capture(t),new vg(lv(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const n=function ZB(e){const t=e.match(WB);return t?t[0]:""}(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){const r=gx(this.remaining);r&&(i=r,this.capture(i))}t[lv(n)]=lv(i)}parseQueryParam(t){const n=function XB(e){const t=e.match(KB);return t?t[0]:""}(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){const h=function QB(e){const t=e.match(YB);return t?t[0]:""}(this.remaining);h&&(i=h,this.capture(i))}const r=l2(n),l=l2(i);if(t.hasOwnProperty(r)){let h=t[r];Array.isArray(h)||(h=[h],t[r]=h),h.push(l)}else t[r]=l}parseParens(t){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=gx(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new Ie(4010,!1);let l;i.indexOf(":")>-1?(l=i.slice(0,i.indexOf(":")),this.capture(l),this.capture(":")):t&&(l=rn);const h=this.parseChildren();n[l]=1===Object.keys(h).length?h[rn]:new si([],h),this.consumeOptional("//")}return n}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Ie(4011,!1)}}function u2(e){return e.segments.length>0?new si([],{[rn]:e}):e}function h2(e){const t={};for(const i of Object.keys(e.children)){const l=h2(e.children[i]);if(i===rn&&0===l.segments.length&&l.hasChildren())for(const[h,f]of Object.entries(l.children))t[h]=f;else(l.segments.length>0||l.hasChildren())&&(t[i]=l)}return function e6(e){if(1===e.numberOfChildren&&e.children[rn]){const t=e.children[rn];return new si(e.segments.concat(t.segments),t.children)}return e}(new si(e.segments,t))}function Ed(e){return e instanceof dp}function d2(e){let t;const r=u2(function n(l){const h={};for(const _ of l.children){const C=n(_);h[_.outlet]=C}const f=new si(l.url,h);return l===e&&(t=f),f}(e.root));return t??r}function f2(e,t,n,i){let r=e;for(;r.parent;)r=r.parent;if(0===t.length)return yx(r,r,r,n,i);const l=function n6(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new m2(!0,0,e);let t=0,n=!1;const i=e.reduce((r,l,h)=>{if("object"==typeof l&&null!=l){if(l.outlets){const f={};return Object.entries(l.outlets).forEach(([_,C])=>{f[_]="string"==typeof C?C.split("/"):C}),[...r,{outlets:f}]}if(l.segmentPath)return[...r,l.segmentPath]}return"string"!=typeof l?[...r,l]:0===h?(l.split("/").forEach((f,_)=>{0==_&&"."===f||(0==_&&""===f?n=!0:".."===f?t++:""!=f&&r.push(f))}),r):[...r,l]},[]);return new m2(n,t,i)}(t);if(l.toRoot())return yx(r,r,new si([],{}),n,i);const h=function i6(e,t,n){if(e.isAbsolute)return new uv(t,!0,0);if(!n)return new uv(t,!1,NaN);if(null===n.parent)return new uv(n,!0,0);const i=cv(e.commands[0])?0:1;return function r6(e,t,n){let i=e,r=t,l=n;for(;l>r;){if(l-=r,i=i.parent,!i)throw new Ie(4005,!1);r=i.segments.length}return new uv(i,!1,r-l)}(n,n.segments.length-1+i,e.numberOfDoubleDots)}(l,r,e),f=h.processChildren?Cg(h.segmentGroup,h.index,l.commands):g2(h.segmentGroup,h.index,l.commands);return yx(r,h.segmentGroup,f,n,i)}function cv(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function wg(e){return"object"==typeof e&&null!=e&&e.outlets}function yx(e,t,n,i,r){let h,l={};i&&Object.entries(i).forEach(([_,C])=>{l[_]=Array.isArray(C)?C.map(A=>`${A}`):`${C}`}),h=e===t?n:p2(e,t,n);const f=u2(h2(h));return new dp(f,l,r)}function p2(e,t,n){const i={};return Object.entries(e.children).forEach(([r,l])=>{i[r]=l===t?n:p2(l,t,n)}),new si(e.segments,i)}class m2{constructor(t,n,i){if(this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=i,t&&i.length>0&&cv(i[0]))throw new Ie(4003,!1);const r=i.find(wg);if(r&&r!==e2(i))throw new Ie(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class uv{constructor(t,n,i){this.segmentGroup=t,this.processChildren=n,this.index=i}}function g2(e,t,n){if(e||(e=new si([],{})),0===e.segments.length&&e.hasChildren())return Cg(e,t,n);const i=function o6(e,t,n){let i=0,r=t;const l={match:!1,pathIndex:0,commandIndex:0};for(;r<e.segments.length;){if(i>=n.length)return l;const h=e.segments[r],f=n[i];if(wg(f))break;const _=`${f}`,C=i<n.length-1?n[i+1]:null;if(r>0&&void 0===_)break;if(_&&C&&"object"==typeof C&&void 0===C.outlets){if(!_2(_,C,h))return l;i+=2}else{if(!_2(_,{},h))return l;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(e,t,n),r=n.slice(i.commandIndex);if(i.match&&i.pathIndex<e.segments.length){const l=new si(e.segments.slice(0,i.pathIndex),{});return l.children[rn]=new si(e.segments.slice(i.pathIndex),e.children),Cg(l,0,r)}return i.match&&0===r.length?new si(e.segments,{}):i.match&&!e.hasChildren()?_x(e,t,n):i.match?Cg(e,0,r):_x(e,t,n)}function Cg(e,t,n){if(0===n.length)return new si(e.segments,{});{const i=function s6(e){return wg(e[0])?e[0].outlets:{[rn]:e}}(n),r={};if(Object.keys(i).some(l=>l!==rn)&&e.children[rn]&&1===e.numberOfChildren&&0===e.children[rn].segments.length){const l=Cg(e.children[rn],t,n);return new si(e.segments,l.children)}return Object.entries(i).forEach(([l,h])=>{"string"==typeof h&&(h=[h]),null!==h&&(r[l]=g2(e.children[l],t,h))}),Object.entries(e.children).forEach(([l,h])=>{void 0===i[l]&&(r[l]=h)}),new si(e.segments,r)}}function _x(e,t,n){const i=e.segments.slice(0,t);let r=0;for(;r<n.length;){const l=n[r];if(wg(l)){const _=a6(l.outlets);return new si(i,_)}if(0===r&&cv(n[0])){i.push(new vg(e.segments[t].path,y2(n[0]))),r++;continue}const h=wg(l)?l.outlets[rn]:`${l}`,f=r<n.length-1?n[r+1]:null;h&&f&&cv(f)?(i.push(new vg(h,y2(f))),r+=2):(i.push(new vg(h,{})),r++)}return new si(i,{})}function a6(e){const t={};return Object.entries(e).forEach(([n,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(t[n]=_x(new si([],{}),0,i))}),t}function y2(e){const t={};return Object.entries(e).forEach(([n,i])=>t[n]=`${i}`),t}function _2(e,t,n){return e==n.path&&ic(t,n.parameters)}const Eg="imperative";class rc{constructor(t,n){this.id=t,this.url=n}}class hv extends rc{constructor(t,n,i="imperative",r=null){super(t,n),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class ih extends rc{constructor(t,n,i){super(t,n),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Sg extends rc{constructor(t,n,i,r){super(t,n),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class fp extends rc{constructor(t,n,i,r){super(t,n),this.reason=i,this.code=r,this.type=16}}class dv extends rc{constructor(t,n,i,r){super(t,n),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class v2 extends rc{constructor(t,n,i,r){super(t,n),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class l6 extends rc{constructor(t,n,i,r){super(t,n),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class c6 extends rc{constructor(t,n,i,r,l){super(t,n),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=l,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class u6 extends rc{constructor(t,n,i,r){super(t,n),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class h6 extends rc{constructor(t,n,i,r){super(t,n),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class d6{constructor(t){this.route=t,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class f6{constructor(t){this.route=t,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class p6{constructor(t){this.snapshot=t,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class m6{constructor(t){this.snapshot=t,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class g6{constructor(t){this.snapshot=t,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class y6{constructor(t){this.snapshot=t,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class b2{constructor(t,n,i){this.routerEvent=t,this.position=n,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class vx{}class bx{constructor(t){this.url=t}}class _6{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Tg,this.attachRef=null}}let Tg=(()=>{class e{constructor(){this.contexts=new Map}onChildOutletCreated(n,i){const r=this.getOrCreateContext(n);r.outlet=i,this.contexts.set(n,r)}onChildOutletDestroyed(n){const i=this.getContext(n);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let i=this.getContext(n);return i||(i=new _6,this.contexts.set(n,i)),i}getContext(n){return this.contexts.get(n)||null}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class x2{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const n=this.pathFromRoot(t);return n.length>1?n[n.length-2]:null}children(t){const n=xx(t,this._root);return n?n.children.map(i=>i.value):[]}firstChild(t){const n=xx(t,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(t){const n=wx(t,this._root);return n.length<2?[]:n[n.length-2].children.map(r=>r.value).filter(r=>r!==t)}pathFromRoot(t){return wx(t,this._root).map(n=>n.value)}}function xx(e,t){if(e===t.value)return t;for(const n of t.children){const i=xx(e,n);if(i)return i}return null}function wx(e,t){if(e===t.value)return[t];for(const n of t.children){const i=wx(e,n);if(i.length)return i.unshift(t),i}return[]}class hu{constructor(t,n){this.value=t,this.children=n}toString(){return`TreeNode(${this.value})`}}function pp(e){const t={};return e&&e.children.forEach(n=>t[n.value.outlet]=n),t}class w2 extends x2{constructor(t,n){super(t),this.snapshot=n,Cx(this,t)}toString(){return this.snapshot.toString()}}function C2(e,t){const n=function v6(e,t){const h=new fv([],{},{},"",{},rn,t,null,{});return new S2("",new hu(h,[]))}(0,t),i=new yn([new vg("",{})]),r=new yn({}),l=new yn({}),h=new yn({}),f=new yn(""),_=new mp(i,r,h,f,l,rn,t,n.root);return _.snapshot=n.root,new w2(new hu(_,[]),n)}class mp{constructor(t,n,i,r,l,h,f,_){this.urlSubject=t,this.paramsSubject=n,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=l,this.outlet=h,this.component=f,this._futureSnapshot=_,this.title=this.dataSubject?.pipe(pn(C=>C[_g]))??Et(void 0),this.url=t,this.params=n,this.queryParams=i,this.fragment=r,this.data=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(pn(t=>hp(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(pn(t=>hp(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function E2(e,t="emptyOnly"){const n=e.pathFromRoot;let i=0;if("always"!==t)for(i=n.length-1;i>=1;){const r=n[i],l=n[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(l.component)break;i--}}return function b6(e){return e.reduce((t,n)=>({params:{...t.params,...n.params},data:{...t.data,...n.data},resolve:{...n.data,...t.resolve,...n.routeConfig?.data,...n._resolvedData}}),{params:{},data:{},resolve:{}})}(n.slice(i))}class fv{get title(){return this.data?.[_g]}constructor(t,n,i,r,l,h,f,_,C){this.url=t,this.params=n,this.queryParams=i,this.fragment=r,this.data=l,this.outlet=h,this.component=f,this.routeConfig=_,this._resolve=C}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=hp(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=hp(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class S2 extends x2{constructor(t,n){super(n),this.url=t,Cx(this,n)}toString(){return T2(this._root)}}function Cx(e,t){t.value._routerState=e,t.children.forEach(n=>Cx(e,n))}function T2(e){const t=e.children.length>0?` { ${e.children.map(T2).join(", ")} } `:"";return`${e.value}${t}`}function Ex(e){if(e.snapshot){const t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,ic(t.queryParams,n.queryParams)||e.queryParamsSubject.next(n.queryParams),t.fragment!==n.fragment&&e.fragmentSubject.next(n.fragment),ic(t.params,n.params)||e.paramsSubject.next(n.params),function NB(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!ic(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.urlSubject.next(n.url),ic(t.data,n.data)||e.dataSubject.next(n.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function Sx(e,t){const n=ic(e.params,t.params)&&function UB(e,t){return Cd(e,t)&&e.every((n,i)=>ic(n.parameters,t[i].parameters))}(e.url,t.url);return n&&!(!e.parent!=!t.parent)&&(!e.parent||Sx(e.parent,t.parent))}let D2=(()=>{class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=rn,this.activateEvents=new lr,this.deactivateEvents=new lr,this.attachEvents=new lr,this.detachEvents=new lr,this.parentContexts=tt(Tg),this.location=tt(ml),this.changeDetector=tt(E_),this.environmentInjector=tt(Wo),this.inputBinder=tt(pv,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){const{firstChange:i,previousValue:r}=n.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Ie(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Ie(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Ie(4012,!1);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,i){this.activated=n,this._activatedRoute=i,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,i){if(this.isActivated)throw new Ie(4013,!1);this._activatedRoute=n;const r=this.location,h=n.snapshot.component,f=this.parentContexts.getOrCreateContext(this.name).children,_=new x6(n,f,r.injector);this.activated=r.createComponent(h,{index:r.length,injector:_,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275dir=Hi({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Mc]})}return e})();class x6{constructor(t,n,i){this.route=t,this.childContexts=n,this.parent=i}get(t,n){return t===mp?this.route:t===Tg?this.childContexts:this.parent.get(t,n)}}const pv=new ut("");let I2=(()=>{class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){const{activatedRoute:i}=n,r=ux([i.queryParams,i.params,i.data]).pipe(tr(([l,h,f],_)=>(f={...l,...h,...f},0===_?Et(f):Promise.resolve(f)))).subscribe(l=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(n);const h=function KF(e){const t=dn(e);if(!t)return null;const n=new Vm(t);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return t.standalone},get isSignal(){return t.signals}}}(i.component);if(h)for(const{templateName:f}of h.inputs)n.activatedComponentRef.setInput(f,l[f]);else this.unsubscribeFromRouteData(n)});this.outletDataSubscriptions.set(n,r)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac})}return e})();function Dg(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){const i=n.value;i._futureSnapshot=t.value;const r=function C6(e,t,n){return t.children.map(i=>{for(const r of n.children)if(e.shouldReuseRoute(i.value,r.value.snapshot))return Dg(e,i,r);return Dg(e,i)})}(e,t,n);return new hu(i,r)}{if(e.shouldAttach(t.value)){const l=e.retrieve(t.value);if(null!==l){const h=l.route;return h.value._futureSnapshot=t.value,h.children=t.children.map(f=>Dg(e,f)),h}}const i=function E6(e){return new mp(new yn(e.url),new yn(e.params),new yn(e.queryParams),new yn(e.fragment),new yn(e.data),e.outlet,e.component,e)}(t.value),r=t.children.map(l=>Dg(e,l));return new hu(i,r)}}const Tx="ngNavigationCancelingError";function A2(e,t){const{redirectTo:n,navigationBehaviorOptions:i}=Ed(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,r=M2(!1,0,t);return r.url=n,r.navigationBehaviorOptions=i,r}function M2(e,t,n){const i=new Error("NavigationCancelingError: "+(e||""));return i[Tx]=!0,i.cancellationCode=t,n&&(i.url=n),i}function P2(e){return e&&e[Tx]}let R2=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Er({type:e,selectors:[["ng-component"]],standalone:!0,features:[fd],decls:1,vars:0,template:function(i,r){1&i&&Wr(0,"router-outlet")},dependencies:[D2],encapsulation:2})}return e})();function Dx(e){const t=e.children&&e.children.map(Dx),n=t?{...e,children:t}:{...e};return!n.component&&!n.loadComponent&&(t||n.loadChildren)&&n.outlet&&n.outlet!==rn&&(n.component=R2),n}function vl(e){return e.outlet||rn}function Ig(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let t=e.parent;t;t=t.parent){const n=t.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}class R6{constructor(t,n,i,r,l){this.routeReuseStrategy=t,this.futureState=n,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=l}activate(t){const n=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,i,t),Ex(this.futureState.root),this.activateChildRoutes(n,i,t)}deactivateChildRoutes(t,n,i){const r=pp(n);t.children.forEach(l=>{const h=l.value.outlet;this.deactivateRoutes(l,r[h],i),delete r[h]}),Object.values(r).forEach(l=>{this.deactivateRouteAndItsChildren(l,i)})}deactivateRoutes(t,n,i){const r=t.value,l=n?n.value:null;if(r===l)if(r.component){const h=i.getContext(r.outlet);h&&this.deactivateChildRoutes(t,n,h.children)}else this.deactivateChildRoutes(t,n,i);else l&&this.deactivateRouteAndItsChildren(n,i)}deactivateRouteAndItsChildren(t,n){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,n):this.deactivateRouteAndOutlet(t,n)}detachAndStoreRouteSubtree(t,n){const i=n.getContext(t.value.outlet),r=i&&t.value.component?i.children:n,l=pp(t);for(const h of Object.keys(l))this.deactivateRouteAndItsChildren(l[h],r);if(i&&i.outlet){const h=i.outlet.detach(),f=i.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:h,route:t,contexts:f})}}deactivateRouteAndOutlet(t,n){const i=n.getContext(t.value.outlet),r=i&&t.value.component?i.children:n,l=pp(t);for(const h of Object.keys(l))this.deactivateRouteAndItsChildren(l[h],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(t,n,i){const r=pp(n);t.children.forEach(l=>{this.activateRoutes(l,r[l.value.outlet],i),this.forwardEvent(new y6(l.value.snapshot))}),t.children.length&&this.forwardEvent(new m6(t.value.snapshot))}activateRoutes(t,n,i){const r=t.value,l=n?n.value:null;if(Ex(r),r===l)if(r.component){const h=i.getOrCreateContext(r.outlet);this.activateChildRoutes(t,n,h.children)}else this.activateChildRoutes(t,n,i);else if(r.component){const h=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const f=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),h.children.onOutletReAttached(f.contexts),h.attachRef=f.componentRef,h.route=f.route.value,h.outlet&&h.outlet.attach(f.componentRef,f.route.value),Ex(f.route.value),this.activateChildRoutes(t,null,h.children)}else{const f=Ig(r.snapshot);h.attachRef=null,h.route=r,h.injector=f,h.outlet&&h.outlet.activateWith(r,h.injector),this.activateChildRoutes(t,null,h.children)}}else this.activateChildRoutes(t,null,i)}}class L2{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class mv{constructor(t,n){this.component=t,this.route=n}}function L6(e,t,n){const i=e._root;return Ag(i,t?t._root:null,n,[i.value])}function gp(e,t){const n=Symbol(),i=t.get(e,n);return i===n?"function"!=typeof e||function $d(e){return null!==bc(e)}(e)?t.get(e):e:i}function Ag(e,t,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const l=pp(t);return e.children.forEach(h=>{(function O6(e,t,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const l=e.value,h=t?t.value:null,f=n?n.getContext(e.value.outlet):null;if(h&&l.routeConfig===h.routeConfig){const _=function N6(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!Cd(e.url,t.url);case"pathParamsOrQueryParamsChange":return!Cd(e.url,t.url)||!ic(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Sx(e,t)||!ic(e.queryParams,t.queryParams);default:return!Sx(e,t)}}(h,l,l.routeConfig.runGuardsAndResolvers);_?r.canActivateChecks.push(new L2(i)):(l.data=h.data,l._resolvedData=h._resolvedData),Ag(e,t,l.component?f?f.children:null:n,i,r),_&&f&&f.outlet&&f.outlet.isActivated&&r.canDeactivateChecks.push(new mv(f.outlet.component,h))}else h&&Mg(t,f,r),r.canActivateChecks.push(new L2(i)),Ag(e,null,l.component?f?f.children:null:n,i,r)})(h,l[h.value.outlet],n,i.concat([h.value]),r),delete l[h.value.outlet]}),Object.entries(l).forEach(([h,f])=>Mg(f,n.getContext(h),r)),r}function Mg(e,t,n){const i=pp(e),r=e.value;Object.entries(i).forEach(([l,h])=>{Mg(h,r.component?t?t.children.getContext(l):null:t,n)}),n.canDeactivateChecks.push(new mv(r.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,r))}function Pg(e){return"function"==typeof e}function k2(e){return e instanceof iv||"EmptyError"===e?.name}const gv=Symbol("INITIAL_VALUE");function yp(){return tr(e=>ux(e.map(t=>t.pipe(cp(1),function DB(...e){const t=gn(e);return Wn((n,i)=>{(t?hx(e,n,t):hx(e,n)).subscribe(i)})}(gv)))).pipe(pn(t=>{for(const n of t)if(!0!==n){if(n===gv)return gv;if(!1===n||n instanceof dp)return n}return!0}),uu(t=>t!==gv),cp(1)))}function O2(e){return function ka(...e){return xl(e)}(Ns(t=>{if(Ed(t))throw A2(0,t)}),pn(t=>!0===t))}class yv{constructor(t){this.segmentGroup=t||null}}class N2{constructor(t){this.urlTree=t}}function _p(e){return gg(new yv(e))}function F2(e){return gg(new N2(e))}class n8{constructor(t,n){this.urlSerializer=t,this.urlTree=n}noMatchError(t){return new Ie(4002,!1)}lineralizeSegments(t,n){let i=[],r=n.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return Et(i);if(r.numberOfChildren>1||!r.children[rn])return gg(new Ie(4e3,!1));r=r.children[rn]}}applyRedirectCommands(t,n,i){return this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),t,i)}applyRedirectCreateUrlTree(t,n,i,r){const l=this.createSegmentGroup(t,n.root,i,r);return new dp(l,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(t,n){const i={};return Object.entries(t).forEach(([r,l])=>{if("string"==typeof l&&l.startsWith(":")){const f=l.substring(1);i[r]=n[f]}else i[r]=l}),i}createSegmentGroup(t,n,i,r){const l=this.createSegments(t,n.segments,i,r);let h={};return Object.entries(n.children).forEach(([f,_])=>{h[f]=this.createSegmentGroup(t,_,i,r)}),new si(l,h)}createSegments(t,n,i,r){return n.map(l=>l.path.startsWith(":")?this.findPosParam(t,l,r):this.findOrReturn(l,i))}findPosParam(t,n,i){const r=i[n.path.substring(1)];if(!r)throw new Ie(4001,!1);return r}findOrReturn(t,n){let i=0;for(const r of n){if(r.path===t.path)return n.splice(i),r;i++}return t}}const Ix={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function i8(e,t,n,i,r){const l=Ax(e,t,n);return l.matched?(i=function T6(e,t){return e.providers&&!e._injector&&(e._injector=k1(e.providers,t,`Route: ${e.path}`)),e._injector??t}(t,i),function J6(e,t,n,i){const r=t.canMatch;return r&&0!==r.length?Et(r.map(h=>{const f=gp(h,e);return nh(function j6(e){return e&&Pg(e.canMatch)}(f)?f.canMatch(t,n):e.runInContext(()=>f(t,n)))})).pipe(yp(),O2()):Et(!0)}(i,t,n).pipe(pn(h=>!0===h?l:{...Ix}))):Et(l)}function Ax(e,t,n){if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?{...Ix}:{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};const r=(t.matcher||OB)(n,e,t);if(!r)return{...Ix};const l={};Object.entries(r.posParams??{}).forEach(([f,_])=>{l[f]=_.path});const h=r.consumed.length>0?{...l,...r.consumed[r.consumed.length-1].parameters}:l;return{matched:!0,consumedSegments:r.consumed,remainingSegments:n.slice(r.consumed.length),parameters:h,positionalParamSegments:r.posParams??{}}}function z2(e,t,n,i){return n.length>0&&function o8(e,t,n){return n.some(i=>_v(e,t,i)&&vl(i)!==rn)}(e,n,i)?{segmentGroup:new si(t,s8(i,new si(n,e.children))),slicedSegments:[]}:0===n.length&&function a8(e,t,n){return n.some(i=>_v(e,t,i))}(e,n,i)?{segmentGroup:new si(e.segments,r8(e,0,n,i,e.children)),slicedSegments:n}:{segmentGroup:new si(e.segments,e.children),slicedSegments:n}}function r8(e,t,n,i,r){const l={};for(const h of i)if(_v(e,n,h)&&!r[vl(h)]){const f=new si([],{});l[vl(h)]=f}return{...r,...l}}function s8(e,t){const n={};n[rn]=t;for(const i of e)if(""===i.path&&vl(i)!==rn){const r=new si([],{});n[vl(i)]=r}return n}function _v(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}class h8{constructor(t,n,i,r,l,h,f){this.injector=t,this.configLoader=n,this.rootComponentType=i,this.config=r,this.urlTree=l,this.paramsInheritanceStrategy=h,this.urlSerializer=f,this.allowRedirects=!0,this.applyRedirects=new n8(this.urlSerializer,this.urlTree)}noMatchError(t){return new Ie(4002,!1)}recognize(){const t=z2(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,t,rn).pipe(wd(n=>{if(n instanceof N2)return this.allowRedirects=!1,this.urlTree=n.urlTree,this.match(n.urlTree);throw n instanceof yv?this.noMatchError(n):n}),pn(n=>{const i=new fv([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},rn,this.rootComponentType,null,{}),r=new hu(i,n),l=new S2("",r),h=function t6(e,t,n=null,i=null){return f2(d2(e),t,n,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return h.queryParams=this.urlTree.queryParams,l.url=this.urlSerializer.serialize(h),this.inheritParamsAndData(l._root),{state:l,tree:h}}))}match(t){return this.processSegmentGroup(this.injector,this.config,t.root,rn).pipe(wd(i=>{throw i instanceof yv?this.noMatchError(i):i}))}inheritParamsAndData(t){const n=t.value,i=E2(n,this.paramsInheritanceStrategy);n.params=Object.freeze(i.params),n.data=Object.freeze(i.data),t.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(t,n,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(t,n,i):this.processSegment(t,n,i,i.segments,r,!0)}processChildren(t,n,i){const r=[];for(const l of Object.keys(i.children))"primary"===l?r.unshift(l):r.push(l);return It(r).pipe(up(l=>{const h=i.children[l],f=function M6(e,t){const n=e.filter(i=>vl(i)===t);return n.push(...e.filter(i=>vl(i)!==t)),n}(n,l);return this.processSegmentGroup(t,f,h,l)}),function MB(e,t){return Wn(function AB(e,t,n,i,r){return(l,h)=>{let f=n,_=t,C=0;l.subscribe(kn(h,A=>{const R=C++;_=f?e(_,A,R):(f=!0,A),i&&h.next(_)},r&&(()=>{f&&h.next(_),h.complete()})))}}(e,t,arguments.length>=2,!0))}((l,h)=>(l.push(...h),l)),rv(null),function PB(e,t){const n=arguments.length>=2;return i=>i.pipe(e?uu((r,l)=>e(r,l,i)):ji,fx(1),n?rv(t):QI(()=>new iv))}(),Ut(l=>{if(null===l)return _p(i);const h=B2(l);return function d8(e){e.sort((t,n)=>t.value.outlet===rn?-1:n.value.outlet===rn?1:t.value.outlet.localeCompare(n.value.outlet))}(h),Et(h)}))}processSegment(t,n,i,r,l,h){return It(n).pipe(up(f=>this.processSegmentAgainstRoute(f._injector??t,n,f,i,r,l,h).pipe(wd(_=>{if(_ instanceof yv)return Et(null);throw _}))),xd(f=>!!f),wd(f=>{if(k2(f))return function c8(e,t,n){return 0===t.length&&!e.children[n]}(i,r,l)?Et([]):_p(i);throw f}))}processSegmentAgainstRoute(t,n,i,r,l,h,f){return function l8(e,t,n,i){return!!(vl(e)===i||i!==rn&&_v(t,n,e))&&("**"===e.path||Ax(t,e,n).matched)}(i,r,l,h)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(t,r,i,l,h,f):f&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,r,n,i,l,h):_p(r):_p(r)}expandSegmentAgainstRouteUsingRedirect(t,n,i,r,l,h){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,i,r,h):this.expandRegularSegmentAgainstRouteUsingRedirect(t,n,i,r,l,h)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,i,r){const l=this.applyRedirects.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?F2(l):this.applyRedirects.lineralizeSegments(i,l).pipe(Ut(h=>{const f=new si(h,{});return this.processSegment(t,n,f,h,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,n,i,r,l,h){const{matched:f,consumedSegments:_,remainingSegments:C,positionalParamSegments:A}=Ax(n,r,l);if(!f)return _p(n);const R=this.applyRedirects.applyRedirectCommands(_,r.redirectTo,A);return r.redirectTo.startsWith("/")?F2(R):this.applyRedirects.lineralizeSegments(r,R).pipe(Ut(F=>this.processSegment(t,i,n,F.concat(C),h,!1)))}matchSegmentAgainstRoute(t,n,i,r,l,h){let f;if("**"===i.path){const _=r.length>0?e2(r).parameters:{};f=Et({snapshot:new fv(r,_,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,U2(i),vl(i),i.component??i._loadedComponent??null,i,V2(i)),consumedSegments:[],remainingSegments:[]}),n.children={}}else f=i8(n,i,r,t).pipe(pn(({matched:_,consumedSegments:C,remainingSegments:A,parameters:R})=>_?{snapshot:new fv(C,R,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,U2(i),vl(i),i.component??i._loadedComponent??null,i,V2(i)),consumedSegments:C,remainingSegments:A}:null));return f.pipe(tr(_=>null===_?_p(n):this.getChildConfig(t=i._injector??t,i,r).pipe(tr(({routes:C})=>{const A=i._loadedInjector??t,{snapshot:R,consumedSegments:F,remainingSegments:$}=_,{segmentGroup:Q,slicedSegments:ee}=z2(n,F,$,C);if(0===ee.length&&Q.hasChildren())return this.processChildren(A,C,Q).pipe(pn(ve=>null===ve?null:[new hu(R,ve)]));if(0===C.length&&0===ee.length)return Et([new hu(R,[])]);const me=vl(i)===l;return this.processSegment(A,C,Q,ee,me?rn:l,!0).pipe(pn(ve=>[new hu(R,ve)]))}))))}getChildConfig(t,n,i){return n.children?Et({routes:n.children,injector:t}):n.loadChildren?void 0!==n._loadedRoutes?Et({routes:n._loadedRoutes,injector:n._loadedInjector}):function Q6(e,t,n,i){const r=t.canLoad;return void 0===r||0===r.length?Et(!0):Et(r.map(h=>{const f=gp(h,e);return nh(function z6(e){return e&&Pg(e.canLoad)}(f)?f.canLoad(t,n):e.runInContext(()=>f(t,n)))})).pipe(yp(),O2())}(t,n,i).pipe(Ut(r=>r?this.configLoader.loadChildren(t,n).pipe(Ns(l=>{n._loadedRoutes=l.routes,n._loadedInjector=l.injector})):function t8(e){return gg(M2(!1,3))}())):Et({routes:[],injector:t})}}function f8(e){const t=e.value.routeConfig;return t&&""===t.path}function B2(e){const t=[],n=new Set;for(const i of e){if(!f8(i)){t.push(i);continue}const r=t.find(l=>i.value.routeConfig===l.value.routeConfig);void 0!==r?(r.children.push(...i.children),n.add(r)):t.push(i)}for(const i of n){const r=B2(i.children);t.push(new hu(i.value,r))}return t.filter(i=>!n.has(i))}function U2(e){return e.data||{}}function V2(e){return e.resolve||{}}function j2(e){return"string"==typeof e.title||null===e.title}function Mx(e){return tr(t=>{const n=e(t);return n?It(n).pipe(pn(()=>t)):Et(t)})}const vp=new ut("ROUTES");let Px=(()=>{class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=tt(kT)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return Et(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);const i=nh(n.loadComponent()).pipe(pn($2),Ns(l=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=l}),yg(()=>{this.componentLoaders.delete(n)})),r=new YI(i,()=>new er).pipe(dx());return this.componentLoaders.set(n,r),r}loadChildren(n,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Et({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const l=function b8(e,t,n,i){return nh(e.loadChildren()).pipe(pn($2),Ut(r=>r instanceof US||Array.isArray(r)?Et(r):It(t.compileModuleAsync(r))),pn(r=>{i&&i(e);let l,h,f=!1;return Array.isArray(r)?(h=r,!0):(l=r.create(n).injector,h=l.get(vp,[],{optional:!0,self:!0}).flat()),{routes:h.map(Dx),injector:l}}))}(i,this.compiler,n,this.onLoadEndListener).pipe(yg(()=>{this.childrenLoaders.delete(i)})),h=new YI(l,()=>new er).pipe(dx());return this.childrenLoaders.set(i,h),h}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function $2(e){return function x8(e){return e&&"object"==typeof e&&"default"in e}(e)?e.default:e}let vv=(()=>{class e{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new er,this.transitionAbortSubject=new er,this.configLoader=tt(Px),this.environmentInjector=tt(Wo),this.urlSerializer=tt(bg),this.rootContexts=tt(Tg),this.inputBindingEnabled=null!==tt(pv,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Et(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new f6(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new d6(r))}complete(){this.transitions?.complete()}handleNavigationRequest(n){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...n,id:i})}setupNavigations(n,i,r){return this.transitions=new yn({id:0,currentUrlTree:i,currentRawUrl:i,currentBrowserUrl:i,extractedUrl:n.urlHandlingStrategy.extract(i),urlAfterRedirects:n.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Eg,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(uu(l=>0!==l.id),pn(l=>({...l,extractedUrl:n.urlHandlingStrategy.extract(l.rawUrl)})),tr(l=>{this.currentTransition=l;let h=!1,f=!1;return Et(l).pipe(Ns(_=>{this.currentNavigation={id:_.id,initialUrl:_.rawUrl,extractedUrl:_.extractedUrl,trigger:_.source,extras:_.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),tr(_=>{const C=_.currentBrowserUrl.toString(),A=!n.navigated||_.extractedUrl.toString()!==C||C!==_.currentUrlTree.toString();if(!A&&"reload"!==(_.extras.onSameUrlNavigation??n.onSameUrlNavigation)){const F="";return this.events.next(new fp(_.id,this.urlSerializer.serialize(_.rawUrl),F,0)),_.resolve(null),Zn}if(n.urlHandlingStrategy.shouldProcessUrl(_.rawUrl))return Et(_).pipe(tr(F=>{const $=this.transitions?.getValue();return this.events.next(new hv(F.id,this.urlSerializer.serialize(F.extractedUrl),F.source,F.restoredState)),$!==this.transitions?.getValue()?Zn:Promise.resolve(F)}),function p8(e,t,n,i,r,l){return Ut(h=>function u8(e,t,n,i,r,l,h="emptyOnly"){return new h8(e,t,n,i,r,h,l).recognize()}(e,t,n,i,h.extractedUrl,r,l).pipe(pn(({state:f,tree:_})=>({...h,targetSnapshot:f,urlAfterRedirects:_}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,n.paramsInheritanceStrategy),Ns(F=>{l.targetSnapshot=F.targetSnapshot,l.urlAfterRedirects=F.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:F.urlAfterRedirects};const $=new v2(F.id,this.urlSerializer.serialize(F.extractedUrl),this.urlSerializer.serialize(F.urlAfterRedirects),F.targetSnapshot);this.events.next($)}));if(A&&n.urlHandlingStrategy.shouldProcessUrl(_.currentRawUrl)){const{id:F,extractedUrl:$,source:Q,restoredState:ee,extras:me}=_,ve=new hv(F,this.urlSerializer.serialize($),Q,ee);this.events.next(ve);const pe=C2(0,this.rootComponentType).snapshot;return this.currentTransition=l={..._,targetSnapshot:pe,urlAfterRedirects:$,extras:{...me,skipLocationChange:!1,replaceUrl:!1}},Et(l)}{const F="";return this.events.next(new fp(_.id,this.urlSerializer.serialize(_.extractedUrl),F,1)),_.resolve(null),Zn}}),Ns(_=>{const C=new l6(_.id,this.urlSerializer.serialize(_.extractedUrl),this.urlSerializer.serialize(_.urlAfterRedirects),_.targetSnapshot);this.events.next(C)}),pn(_=>(this.currentTransition=l={..._,guards:L6(_.targetSnapshot,_.currentSnapshot,this.rootContexts)},l)),function H6(e,t){return Ut(n=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:l,canDeactivateChecks:h}}=n;return 0===h.length&&0===l.length?Et({...n,guardsResult:!0}):function q6(e,t,n,i){return It(e).pipe(Ut(r=>function Y6(e,t,n,i,r){const l=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return l&&0!==l.length?Et(l.map(f=>{const _=Ig(t)??r,C=gp(f,_);return nh(function V6(e){return e&&Pg(e.canDeactivate)}(C)?C.canDeactivate(e,t,n,i):_.runInContext(()=>C(e,t,n,i))).pipe(xd())})).pipe(yp()):Et(!0)}(r.component,r.route,n,t,i)),xd(r=>!0!==r,!0))}(h,i,r,e).pipe(Ut(f=>f&&function F6(e){return"boolean"==typeof e}(f)?function G6(e,t,n,i){return It(t).pipe(up(r=>hx(function Z6(e,t){return null!==e&&t&&t(new p6(e)),Et(!0)}(r.route.parent,i),function W6(e,t){return null!==e&&t&&t(new g6(e)),Et(!0)}(r.route,i),function X6(e,t,n){const i=t[t.length-1],l=t.slice(0,t.length-1).reverse().map(h=>function k6(e){const t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(h)).filter(h=>null!==h).map(h=>XI(()=>Et(h.guards.map(_=>{const C=Ig(h.node)??n,A=gp(_,C);return nh(function U6(e){return e&&Pg(e.canActivateChild)}(A)?A.canActivateChild(i,e):C.runInContext(()=>A(i,e))).pipe(xd())})).pipe(yp())));return Et(l).pipe(yp())}(e,r.path,n),function K6(e,t,n){const i=t.routeConfig?t.routeConfig.canActivate:null;if(!i||0===i.length)return Et(!0);const r=i.map(l=>XI(()=>{const h=Ig(t)??n,f=gp(l,h);return nh(function B6(e){return e&&Pg(e.canActivate)}(f)?f.canActivate(t,e):h.runInContext(()=>f(t,e))).pipe(xd())}));return Et(r).pipe(yp())}(e,r.route,n))),xd(r=>!0!==r,!0))}(i,l,e,t):Et(f)),pn(f=>({...n,guardsResult:f})))})}(this.environmentInjector,_=>this.events.next(_)),Ns(_=>{if(l.guardsResult=_.guardsResult,Ed(_.guardsResult))throw A2(0,_.guardsResult);const C=new c6(_.id,this.urlSerializer.serialize(_.extractedUrl),this.urlSerializer.serialize(_.urlAfterRedirects),_.targetSnapshot,!!_.guardsResult);this.events.next(C)}),uu(_=>!!_.guardsResult||(this.cancelNavigationTransition(_,"",3),!1)),Mx(_=>{if(_.guards.canActivateChecks.length)return Et(_).pipe(Ns(C=>{const A=new u6(C.id,this.urlSerializer.serialize(C.extractedUrl),this.urlSerializer.serialize(C.urlAfterRedirects),C.targetSnapshot);this.events.next(A)}),tr(C=>{let A=!1;return Et(C).pipe(function m8(e,t){return Ut(n=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=n;if(!r.length)return Et(n);let l=0;return It(r).pipe(up(h=>function g8(e,t,n,i){const r=e.routeConfig,l=e._resolve;return void 0!==r?.title&&!j2(r)&&(l[_g]=r.title),function y8(e,t,n,i){const r=function _8(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}(e);if(0===r.length)return Et({});const l={};return It(r).pipe(Ut(h=>function v8(e,t,n,i){const r=Ig(t)??i,l=gp(e,r);return nh(l.resolve?l.resolve(t,n):r.runInContext(()=>l(t,n)))}(e[h],t,n,i).pipe(xd(),Ns(f=>{l[h]=f}))),fx(1),function RB(e){return pn(()=>e)}(l),wd(h=>k2(h)?Zn:gg(h)))}(l,e,t,i).pipe(pn(h=>(e._resolvedData=h,e.data=E2(e,n).resolve,r&&j2(r)&&(e.data[_g]=r.title),null)))}(h.route,i,e,t)),Ns(()=>l++),fx(1),Ut(h=>l===r.length?Et(n):Zn))})}(n.paramsInheritanceStrategy,this.environmentInjector),Ns({next:()=>A=!0,complete:()=>{A||this.cancelNavigationTransition(C,"",2)}}))}),Ns(C=>{const A=new h6(C.id,this.urlSerializer.serialize(C.extractedUrl),this.urlSerializer.serialize(C.urlAfterRedirects),C.targetSnapshot);this.events.next(A)}))}),Mx(_=>{const C=A=>{const R=[];A.routeConfig?.loadComponent&&!A.routeConfig._loadedComponent&&R.push(this.configLoader.loadComponent(A.routeConfig).pipe(Ns(F=>{A.component=F}),pn(()=>{})));for(const F of A.children)R.push(...C(F));return R};return ux(C(_.targetSnapshot.root)).pipe(rv(),cp(1))}),Mx(()=>this.afterPreactivation()),pn(_=>{const C=function w6(e,t,n){const i=Dg(e,t._root,n?n._root:void 0);return new w2(i,t)}(n.routeReuseStrategy,_.targetSnapshot,_.currentRouterState);return this.currentTransition=l={..._,targetRouterState:C},l}),Ns(()=>{this.events.next(new vx)}),((e,t,n,i)=>pn(r=>(new R6(t,r.targetRouterState,r.currentRouterState,n,i).activate(e),r)))(this.rootContexts,n.routeReuseStrategy,_=>this.events.next(_),this.inputBindingEnabled),cp(1),Ns({next:_=>{h=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new ih(_.id,this.urlSerializer.serialize(_.extractedUrl),this.urlSerializer.serialize(_.urlAfterRedirects))),n.titleStrategy?.updateTitle(_.targetRouterState.snapshot),_.resolve(!0)},complete:()=>{h=!0}}),function LB(e){return Wn((t,n)=>{Je(e).subscribe(kn(n,()=>n.complete(),Us)),!n.closed&&t.subscribe(n)})}(this.transitionAbortSubject.pipe(Ns(_=>{throw _}))),yg(()=>{h||f||this.cancelNavigationTransition(l,"",1),this.currentNavigation?.id===l.id&&(this.currentNavigation=null)}),wd(_=>{if(f=!0,P2(_))this.events.next(new Sg(l.id,this.urlSerializer.serialize(l.extractedUrl),_.message,_.cancellationCode)),function S6(e){return P2(e)&&Ed(e.url)}(_)?this.events.next(new bx(_.url)):l.resolve(!1);else{this.events.next(new dv(l.id,this.urlSerializer.serialize(l.extractedUrl),_,l.targetSnapshot??void 0));try{l.resolve(n.errorHandler(_))}catch(C){l.reject(C)}}return Zn}))}))}cancelNavigationTransition(n,i,r){const l=new Sg(n.id,this.urlSerializer.serialize(n.extractedUrl),i,r);this.events.next(l),n.resolve(!1)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function H2(e){return e!==Eg}let q2=(()=>{class e{buildTitle(n){let i,r=n.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(l=>l.outlet===rn);return i}getResolvedTitleForRoute(n){return n.data[_g]}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:function(){return tt(w8)},providedIn:"root"})}return e})(),w8=(()=>{class e extends q2{constructor(n){super(),this.title=n}updateTitle(n){const i=this.buildTitle(n);void 0!==i&&this.title.setTitle(i)}static#e=this.\u0275fac=function(i){return new(i||e)(lt(sI))};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),C8=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:function(){return tt(S8)},providedIn:"root"})}return e})();class E8{shouldDetach(t){return!1}store(t,n){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,n){return t.routeConfig===n.routeConfig}}let S8=(()=>{class e extends E8{static#e=this.\u0275fac=function(){let n;return function(r){return(n||(n=Bc(e)))(r||e)}}();static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const bv=new ut("",{providedIn:"root",factory:()=>({})});let T8=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:function(){return tt(D8)},providedIn:"root"})}return e})(),D8=(()=>{class e{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,i){return n}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var Rg=function(e){return e[e.COMPLETE=0]="COMPLETE",e[e.FAILED=1]="FAILED",e[e.REDIRECTING=2]="REDIRECTING",e}(Rg||{});function G2(e,t){e.events.pipe(uu(n=>n instanceof ih||n instanceof Sg||n instanceof dv||n instanceof fp),pn(n=>n instanceof ih||n instanceof fp?Rg.COMPLETE:n instanceof Sg&&(0===n.code||1===n.code)?Rg.REDIRECTING:Rg.FAILED),uu(n=>n!==Rg.REDIRECTING),cp(1)).subscribe(()=>{t()})}function I8(e){throw e}function A8(e,t,n){return t.parse("/")}const M8={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},P8={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ia=(()=>{class e{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=tt(LT),this.isNgZoneEnabled=!1,this._events=new er,this.options=tt(bv,{optional:!0})||{},this.pendingTasks=tt(b_),this.errorHandler=this.options.errorHandler||I8,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||A8,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=tt(T8),this.routeReuseStrategy=tt(C8),this.titleStrategy=tt(q2),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=tt(vp,{optional:!0})?.flat()??[],this.navigationTransitions=tt(vv),this.urlSerializer=tt(bg),this.location=tt(fb),this.componentInputBindingEnabled=!!tt(pv,{optional:!0}),this.eventsSubscription=new ei,this.isNgZoneEnabled=tt(Yn)instanceof Yn&&Yn.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new dp,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=C2(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(n=>{this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const n=this.navigationTransitions.events.subscribe(i=>{try{const{currentTransition:r}=this.navigationTransitions;if(null===r)return void(W2(i)&&this._events.next(i));if(i instanceof hv)H2(r.source)&&(this.browserUrlTree=r.extractedUrl);else if(i instanceof fp)this.rawUrlTree=r.rawUrl;else if(i instanceof v2){if("eager"===this.urlUpdateStrategy){if(!r.extras.skipLocationChange){const l=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl);this.setBrowserUrl(l,r)}this.browserUrlTree=r.urlAfterRedirects}}else if(i instanceof vx)this.currentUrlTree=r.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl),this.routerState=r.targetRouterState,"deferred"===this.urlUpdateStrategy&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r),this.browserUrlTree=r.urlAfterRedirects);else if(i instanceof Sg)0!==i.code&&1!==i.code&&(this.navigated=!0),(3===i.code||2===i.code)&&this.restoreHistory(r);else if(i instanceof bx){const l=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),h={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||H2(r.source)};this.scheduleNavigation(l,Eg,null,h,{resolve:r.resolve,reject:r.reject,promise:r.promise})}i instanceof dv&&this.restoreHistory(r,!0),i instanceof ih&&(this.navigated=!0),W2(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const n=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Eg,n)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const i="popstate"===n.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(n.url,i,n.state)},0)}))}navigateToSyncWithBrowser(n,i,r){const l={replaceUrl:!0},h=r?.navigationId?r:null;if(r){const _={...r};delete _.navigationId,delete _.\u0275routerPageId,0!==Object.keys(_).length&&(l.state=_)}const f=this.parseUrl(n);this.scheduleNavigation(f,i,h,l)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(Dx),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,i={}){const{relativeTo:r,queryParams:l,fragment:h,queryParamsHandling:f,preserveFragment:_}=i,C=_?this.currentUrlTree.fragment:h;let R,A=null;switch(f){case"merge":A={...this.currentUrlTree.queryParams,...l};break;case"preserve":A=this.currentUrlTree.queryParams;break;default:A=l||null}null!==A&&(A=this.removeEmptyProps(A));try{R=d2(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof n[0]||!n[0].startsWith("/"))&&(n=[]),R=this.currentUrlTree.root}return f2(R,n,A,C??null)}navigateByUrl(n,i={skipLocationChange:!1}){const r=Ed(n)?n:this.parseUrl(n),l=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(l,Eg,null,i)}navigate(n,i={skipLocationChange:!1}){return function R8(e){for(let t=0;t<e.length;t++)if(null==e[t])throw new Ie(4008,!1)}(n),this.navigateByUrl(this.createUrlTree(n,i),i)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let i;try{i=this.urlSerializer.parse(n)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,n)}return i}isActive(n,i){let r;if(r=!0===i?{...M8}:!1===i?{...P8}:i,Ed(n))return n2(this.currentUrlTree,n,r);const l=this.parseUrl(n);return n2(this.currentUrlTree,l,r)}removeEmptyProps(n){return Object.keys(n).reduce((i,r)=>{const l=n[r];return null!=l&&(i[r]=l),i},{})}scheduleNavigation(n,i,r,l,h){if(this.disposed)return Promise.resolve(!1);let f,_,C;h?(f=h.resolve,_=h.reject,C=h.promise):C=new Promise((R,F)=>{f=R,_=F});const A=this.pendingTasks.add();return G2(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(A))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:n,extras:l,resolve:f,reject:_,promise:C,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),C.catch(R=>Promise.reject(R))}setBrowserUrl(n,i){const r=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const h={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",h)}else{const l={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId+1)};this.location.go(r,"",l)}}restoreHistory(n,i=!1){if("computed"===this.canceledNavigationResolution){const l=this.currentPageId-this.browserPageId;0!==l?this.location.historyGo(l):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===l&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,i){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:i}:{navigationId:n}}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function W2(e){return!(e instanceof vx||e instanceof bx)}class Z2{}let O8=(()=>{class e{constructor(n,i,r,l,h){this.router=n,this.injector=r,this.preloadingStrategy=l,this.loader=h}setUpPreloading(){this.subscription=this.router.events.pipe(uu(n=>n instanceof ih),up(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,i){const r=[];for(const l of i){l.providers&&!l._injector&&(l._injector=k1(l.providers,n,`Route: ${l.path}`));const h=l._injector??n,f=l._loadedInjector??h;(l.loadChildren&&!l._loadedRoutes&&void 0===l.canLoad||l.loadComponent&&!l._loadedComponent)&&r.push(this.preloadConfig(h,l)),(l.children||l._loadedRoutes)&&r.push(this.processRoutes(f,l.children??l._loadedRoutes))}return It(r).pipe(ti())}preloadConfig(n,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(n,i):Et(null);const l=r.pipe(Ut(h=>null===h?Et(void 0):(i._loadedRoutes=h.routes,i._loadedInjector=h.injector,this.processRoutes(h.injector??n,h.routes))));return i.loadComponent&&!i._loadedComponent?It([l,this.loader.loadComponent(i)]).pipe(ti()):l})}static#e=this.\u0275fac=function(i){return new(i||e)(lt(Ia),lt(kT),lt(Wo),lt(Z2),lt(Px))};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Lx=new ut("");let K2=(()=>{class e{constructor(n,i,r,l,h={}){this.urlSerializer=n,this.transitions=i,this.viewportScroller=r,this.zone=l,this.options=h,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},h.scrollPositionRestoration=h.scrollPositionRestoration||"disabled",h.anchorScrolling=h.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof hv?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof ih?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof fp&&0===n.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof b2&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new b2(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){!function DC(){throw new Error("invalid")}()};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac})}return e})();function du(e,t){return{\u0275kind:e,\u0275providers:t}}function Y2(){const e=tt(ba);return t=>{const n=e.get(pd);if(t!==n.components[0])return;const i=e.get(Ia),r=e.get(Q2);1===e.get(kx)&&i.initialNavigation(),e.get(J2,null,en.Optional)?.setUpPreloading(),e.get(Lx,null,en.Optional)?.init(),i.resetRootComponentType(n.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const Q2=new ut("",{factory:()=>new er}),kx=new ut("",{providedIn:"root",factory:()=>1}),J2=new ut("");function B8(e){return du(0,[{provide:J2,useExisting:O8},{provide:Z2,useExisting:e}])}const eA=new ut("ROUTER_FORROOT_GUARD"),V8=[fb,{provide:bg,useClass:px},Ia,Tg,{provide:mp,useFactory:function X2(e){return e.routerState.root},deps:[Ia]},Px,[]];function j8(){return new VT("Router",Ia)}let tA=(()=>{class e{constructor(n){}static forRoot(n,i){return{ngModule:e,providers:[V8,[],{provide:vp,multi:!0,useValue:n},{provide:eA,useFactory:G8,deps:[[Ia,new Hl,new jo]]},{provide:bv,useValue:i||{}},i?.useHash?{provide:gd,useClass:e3}:{provide:gd,useClass:yD},{provide:Lx,useFactory:()=>{const e=tt(_5),t=tt(Yn),n=tt(bv),i=tt(vv),r=tt(bg);return n.scrollOffset&&e.setOffset(n.scrollOffset),new K2(r,i,e,t,n)}},i?.preloadingStrategy?B8(i.preloadingStrategy).\u0275providers:[],{provide:VT,multi:!0,useFactory:j8},i?.initialNavigation?W8(i):[],i?.bindToComponentInputs?du(8,[I2,{provide:pv,useExisting:I2}]).\u0275providers:[],[{provide:nA,useFactory:Y2},{provide:nb,multi:!0,useExisting:nA}]]}}static forChild(n){return{ngModule:e,providers:[{provide:vp,multi:!0,useValue:n}]}}static#e=this.\u0275fac=function(i){return new(i||e)(lt(eA,8))};static#t=this.\u0275mod=nr({type:e});static#n=this.\u0275inj=$i({})}return e})();function G8(e){return"guarded"}function W8(e){return["disabled"===e.initialNavigation?du(3,[{provide:Z1,multi:!0,useFactory:()=>{const t=tt(Ia);return()=>{t.setUpLocationChangeListener()}}},{provide:kx,useValue:2}]).\u0275providers:[],"enabledBlocking"===e.initialNavigation?du(2,[{provide:kx,useValue:0},{provide:Z1,multi:!0,deps:[ba],useFactory:t=>{const n=t.get(QF,Promise.resolve());return()=>n.then(()=>new Promise(i=>{const r=t.get(Ia),l=t.get(Q2);G2(r,()=>{i(!0)}),t.get(vv).afterPreactivation=()=>(i(!0),l.closed?Et(void 0):l),r.initialNavigation()}))}}]).\u0275providers:[]]}const nA=new ut(""),K8=[];let X8=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=nr({type:e});static#n=this.\u0275inj=$i({imports:[tA.forRoot(K8),tA]})}return e})();var sn=ta(624);const J8="function"==typeof btoa,bp="function"==typeof Buffer,Lg=("function"==typeof TextDecoder&&new TextDecoder,"function"==typeof TextEncoder&&new TextEncoder,Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=")),_s=((e=>{let t={};e.forEach((n,i)=>t[n]=i)})(Lg),String.fromCharCode.bind(String)),aA=("function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array),e=>e.replace(/=/g,"").replace(/[+\/]/g,t=>"+"==t?"-":"_")),Ox=J8?e=>btoa(e):bp?e=>Buffer.from(e,"binary").toString("base64"):e=>{let t,n,i,r,l="";const h=e.length%3;for(let f=0;f<e.length;){if((n=e.charCodeAt(f++))>255||(i=e.charCodeAt(f++))>255||(r=e.charCodeAt(f++))>255)throw new TypeError("invalid character found");t=n<<16|i<<8|r,l+=Lg[t>>18&63]+Lg[t>>12&63]+Lg[t>>6&63]+Lg[63&t]}return h?l.slice(0,h-3)+"===".substring(h):l},Nx=bp?e=>Buffer.from(e).toString("base64"):e=>{let n=[];for(let i=0,r=e.length;i<r;i+=4096)n.push(_s.apply(null,e.subarray(i,i+4096)));return Ox(n.join(""))},lU_fromUint8Array=(e,t=!1)=>t?aA(Nx(e)):Nx(e);var cU=ta(16);function xA(e,t,n,i,r,l,h){try{var f=e[l](h),_=f.value}catch(C){return void n(C)}f.done?t(_):Promise.resolve(_).then(i,r)}function fu(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var l=e.apply(t,n);function h(_){xA(l,i,r,h,f,"next",_)}function f(_){xA(l,i,r,h,f,"throw",_)}h(void 0)})}}Math;const wo=new class mU{constructor(){this._apiKey="",this._fetch=function pU(){return typeof self<"u"?fetch.bind(self):typeof global<"u"&&global.fetch?global.fetch:null}()}set apiKey(t){this._apiKey=t}get apiKey(){return this._apiKey}set fetch(t){this._fetch=t}get fetch(){return this._fetch}};function Vx(){return(Vx=fu(function*(e,t={}){if(null===wo.fetch)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");if(""===new URL(e).searchParams.get("key").trim())throw new Error("The MapTiler Cloud API key is missing. Set it in `config.apiKey` or get one for free at https://maptiler.com");return wo.fetch(e,t)})).apply(this,arguments)}new Set(Object.values({AUTO:"auto",ALBANIAN:"sq",ARABIC:"ar",ARMENIAN:"hy",AZERBAIJANI:"az",BELORUSSIAN:"be",BOSNIAN:"bs",BRETON:"br",BULGARIAN:"bg",CATALAN:"ca",CHINESE:"zh",CROATIAN:"hr",CZECH:"cs",DANISH:"da",DUTCH:"nl",ENGLISH:"en",ESPERANTO:"eo",ESTONIAN:"et",FINNISH:"fi",FRENCH:"fr",FRISIAN:"fy",GEORGIAN:"ka",GERMAN:"de",GREEK:"el",HEBREW:"he",HUNGARIAN:"hu",ICELANDIC:"is",IRISH:"ga",ITALIAN:"it",JAPANESE:"ja",KANNADA:"kn",KAZAKH:"kk",KOREAN:"ko",ROMAN_LATIN:"la",LATVIAN:"lv",LITHUANIAN:"lt",LUXEMBOURGISH:"lb",MACEDONIAN:"mk",MALTESE:"mt",NORWEGIAN:"no",POLISH:"pl",PORTUGUESE:"pt",ROMANIAN:"ro",ROMANSH:"rm",RUSSIAN:"ru",SCOTTISH_GAELIC:"gd",SERBIAN_CYRILLIC:"sr",SLOVAK:"sk",SLOVENE:"sl",SPANISH:"es",SWEDISH:"sv",THAI:"th",TURKISH:"tr",UKRAINIAN:"uk",WELSH:"cy"}));const Aa={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(Aa);class oh extends Error{constructor(t,n=""){super(`Call to enpoint ${t.url} failed with the status code ${t.status}. ${n}`),this.res=t}}const PA={403:"Key is missing, invalid or restricted"};function Gx(){return(Gx=fu(function*(e={}){const t=new URL("geolocation/ip.json",Aa.maptilerApiURL);t.searchParams.set("key",e.apiKey??wo.apiKey);const n=t.toString(),i=yield function sh(e){return Vx.apply(this,arguments)}(n);if(!i.ok)throw new oh(i,i.status in PA?PA[i.status]:"");return yield i.json()})).apply(this,arguments)}const RA={info:function wU(){return Gx.apply(this,arguments)}};function kA(e){let n;const i=e.trim();let r;return r=i.startsWith("http://")||i.startsWith("https://")?i:null!==(n=/^maptiler:\/\/(.*)/.exec(i))?`https://api.maptiler.com/maps/${n[1]}/style.json`:`https://api.maptiler.com/maps/${i}/style.json`,r}class Xx{constructor(t,n,i,r,l,h){this.name=t,this.variantType=n,this.id=i,this.referenceStyle=r,this.description=l,this.imageURL=h}getName(){return this.name}getFullName(){return`${this.referenceStyle.getName()} ${this.name}`}getType(){return this.variantType}getId(){return this.id}getDescription(){return this.description}getReferenceStyle(){return this.referenceStyle}hasVariant(t){return this.referenceStyle.hasVariant(t)}getVariant(t){return this.referenceStyle.getVariant(t)}getVariants(){return this.referenceStyle.getVariants().filter(t=>t!==this)}getImageURL(){return this.imageURL}getExpandedStyleURL(){return kA(this.getId())}}class Yx{constructor(t,n){this.name=t,this.id=n,this.variants={},this.orderedVariants=[]}getName(){return this.name}getId(){return this.id}addVariant(t){this.variants[t.getType()]=t,this.orderedVariants.push(t)}hasVariant(t){return t in this.variants}getVariant(t){return t in this.variants?this.variants[t]:this.orderedVariants[0]}getVariants(){return Object.values(this.variants)}getDefaultVariant(){return this.orderedVariants[0]}}const Iv=[{referenceStyleID:"STREETS",name:"Streets",description:"",variants:[{id:"streets-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"streets-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"streets-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"streets-v2-night",name:"Night",variantType:"NIGHT",description:"",imageURL:""},{id:"streets-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OUTDOOR",name:"Outdoor",description:"",variants:[{id:"outdoor-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"outdoor-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"WINTER",name:"Winter",description:"",variants:[{id:"winter-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"winter-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"SATELLITE",name:"Satellite",description:"",variants:[{id:"satellite",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"HYBRID",name:"Hybrid",description:"",variants:[{id:"hybrid",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"BASIC",name:"Basic",description:"",variants:[{id:"basic-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"basic-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"basic-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BRIGHT",name:"Bright",description:"",variants:[{id:"bright-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"bright-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"bright-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"bright-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OPENSTREETMAP",name:"OpenStreetMap",description:"",variants:[{id:"openstreetmap",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"TOPO",name:"Topo",description:"",variants:[{id:"topo-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"topo-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"topo-v2-shiny",name:"Shiny",variantType:"SHINY",description:"",imageURL:""},{id:"topo-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""},{id:"topo-v2-topographique",name:"Topographique",variantType:"TOPOGRAPHIQUE",description:"",imageURL:""}]},{referenceStyleID:"VOYAGER",name:"Voyager",description:"",variants:[{id:"voyager-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"voyager-v2-darkmatter",name:"Darkmatter",variantType:"DARK",description:"",imageURL:""},{id:"voyager-v2-positron",name:"Positron",variantType:"LIGHT",description:"",imageURL:""},{id:"voyager-v2-vintage",name:"Vintage",variantType:"VINTAGE",description:"",imageURL:""}]},{referenceStyleID:"TONER",name:"Toner",description:"",variants:[{id:"toner-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"toner-v2-background",name:"Background",variantType:"BACKGROUND",description:"",imageURL:""},{id:"toner-v2-lite",name:"Lite",variantType:"LITE",description:"",imageURL:""},{id:"toner-v2-lines",name:"Lines",variantType:"LINES",description:"",imageURL:""}]},{referenceStyleID:"DATAVIZ",name:"Dataviz",description:"",variants:[{id:"dataviz",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"dataviz-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"dataviz-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BACKDROP",name:"Backdrop",description:"",variants:[{id:"backdrop",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"backdrop-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"backdrop-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"OCEAN",name:"Ocean",description:"",variants:[{id:"ocean",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]}];function TU(e){return new Proxy(e,{get:(t,n,i)=>t.hasVariant(n)?t.getVariant(n):n.toString().toUpperCase()===n?e.getDefaultVariant():Reflect.get(t,n,i)})}const Av=function DU(){const e={};for(let t=0;t<Iv.length;t+=1){const n=Iv[t],i=TU(new Yx(n.name,n.referenceStyleID));for(let r=0;r<n.variants.length;r+=1){const l=n.variants[r],h=new Xx(l.name,l.variantType,l.id,i,l.description,l.imageURL);i.addVariant(h)}e[n.referenceStyleID]=i}return e}(),FA={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let Mv;const WU=new Uint8Array(16);function ZU(){if(!Mv&&(Mv=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Mv))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Mv(WU)}const vs=[];for(let e=0;e<256;++e)vs.push((e+256).toString(16).slice(1));const Bn={VISITOR:"visitor",VISITOR_ENGLISH:"visitor_en",STYLE:"style",AUTO:"auto",STYLE_LOCK:"style_lock",LATIN:"name:latin",NON_LATIN:"name:nonlatin",LOCAL:"name",INTERNATIONAL:"name_int",ALBANIAN:"name:sq",AMHARIC:"name:am",ARABIC:"name:ar",ARMENIAN:"name:hy",AZERBAIJANI:"name:az",BASQUE:"name:eu",BELORUSSIAN:"name:be",BENGALI:"name:bn",BOSNIAN:"name:bs",BRETON:"name:br",BULGARIAN:"name:bg",CATALAN:"name:ca",CHINESE:"name:zh",TRADITIONAL_CHINESE:"name:zh-Hant",SIMPLIFIED_CHINESE:"name:zh-Hans",CORSICAN:"name:co",CROATIAN:"name:hr",CZECH:"name:cs",DANISH:"name:da",DUTCH:"name:nl",ENGLISH:"name:en",ESPERANTO:"name:eo",ESTONIAN:"name:et",FINNISH:"name:fi",FRENCH:"name:fr",FRISIAN:"name:fy",GEORGIAN:"name:ka",GERMAN:"name:de",GREEK:"name:el",HEBREW:"name:he",HINDI:"name:hi",HUNGARIAN:"name:hu",ICELANDIC:"name:is",INDONESIAN:"name:id",IRISH:"name:ga",ITALIAN:"name:it",JAPANESE:"name:ja",JAPANESE_HIRAGANA:"name:ja-Hira",JAPANESE_KANA:"name:ja_kana",JAPANESE_LATIN:"name:ja_rm",JAPANESE_2018:"name:ja-Latn",KANNADA:"name:kn",KAZAKH:"name:kk",KOREAN:"name:ko",KOREAN_LATIN:"name:ko-Latn",KURDISH:"name:ku",ROMAN_LATIN:"name:la",LATVIAN:"name:lv",LITHUANIAN:"name:lt",LUXEMBOURGISH:"name:lb",MACEDONIAN:"name:mk",MALAYALAM:"name:ml",MALTESE:"name:mt",NORWEGIAN:"name:no",OCCITAN:"name:oc",PERSIAN:"name:fa",POLISH:"name:pl",PORTUGUESE:"name:pt",PUNJABI:"name:pa",WESTERN_PUNJABI:"name:pnb",ROMANIAN:"name:ro",ROMANSH:"name:rm",RUSSIAN:"name:ru",SCOTTISH_GAELIC:"name:gd",SERBIAN_CYRILLIC:"name:sr",SERBIAN_LATIN:"name:sr-Latn",SLOVAK:"name:sk",SLOVENE:"name:sl",SPANISH:"name:es",SWEDISH:"name:sv",TAMIL:"name:ta",TELUGU:"name:te",THAI:"name:th",TURKISH:"name:tr",UKRAINIAN:"name:uk",URDU:"name:ur",VIETNAMIAN_LATIN:"name:vi",WELSH:"name:cy"},YU=new Set(Object.values(Bn));function BA(e){return YU.has(e)}const QU=new Set(Object.values(Bn));function UA(){if(typeof navigator>"u")return`name:${Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0]}`;const e=Array.from(new Set(navigator.languages.map(t=>`name:${t.split("-")[0]}`))).filter(t=>QU.has(t));return e.length?e[0]:Bn.LOCAL}const Ma={maptilerLogoURL:"https://api.maptiler.com/resources/logo.svg",maptilerURL:"https://www.maptiler.com/",maptilerApiHost:"api.maptiler.com",rtlPluginURL:"https://cdn.maptiler.com/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.min.js",primaryLanguage:Bn.STYLE,secondaryLanguage:Bn.LOCAL,terrainSourceURL:"https://api.maptiler.com/tiles/terrain-rgb-v2/tiles.json",terrainSourceId:"maptiler-terrain"};Object.freeze(Ma);var JU=Object.defineProperty,Og=(e,t,n)=>(((e,t,n)=>{t in e?JU(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const VA=function KU(e,t,n){if(FA.randomUUID&&!t&&!e)return FA.randomUUID();const i=(e=e||{}).random||(e.rng||ZU)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(let r=0;r<16;++r)t[n+r]=i[r];return t}return function zA(e,t=0){return vs[e[t+0]]+vs[e[t+1]]+vs[e[t+2]]+vs[e[t+3]]+"-"+vs[e[t+4]]+vs[e[t+5]]+"-"+vs[e[t+6]]+vs[e[t+7]]+"-"+vs[e[t+8]]+vs[e[t+9]]+"-"+vs[e[t+10]]+vs[e[t+11]]+vs[e[t+12]]+vs[e[t+13]]+vs[e[t+14]]+vs[e[t+15]]}(i)}(),Co=new class tV extends cU{constructor(){super(),Og(this,"primaryLanguage",Ma.primaryLanguage),Og(this,"secondaryLanguage"),Og(this,"session",!0),Og(this,"_unit","metric"),Og(this,"_apiKey","")}set unit(t){this._unit=t,this.emit("unit",t)}get unit(){return this._unit}set apiKey(t){this._apiKey=t,wo.apiKey=t,this.emit("apiKey",t)}get apiKey(){return this._apiKey}set fetch(t){wo.fetch=t}get fetch(){return wo.fetch}};class nV extends sn.LogoControl{onAdd(t){return super.onAdd(t)}}var iV=Object.defineProperty,jA=(e,t,n)=>(((e,t,n)=>{t in e?iV(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class $A extends nV{constructor(t={}){var n,i;super(t),jA(this,"logoURL",""),jA(this,"linkURL",""),this.logoURL=null!=(n=t.logoURL)?n:Ma.maptilerLogoURL,this.linkURL=null!=(i=t.linkURL)?i:Ma.maptilerURL}onAdd(t){var n;this._map=t,this._compact=null!=(n=this.options.compact)&&n,this._container=window.document.createElement("div"),this._container.className="maplibregl-ctrl";const i=window.document.createElement("a");return i.style.backgroundRepeat="no-repeat",i.style.cursor="pointer",i.style.display="block",i.style.height="23px",i.style.margin="0 0 -4px -4px",i.style.overflow="hidden",i.style.width="88px",i.style.backgroundImage=`url(${this.logoURL})`,i.style.backgroundSize="100px 30px",i.style.width="100px",i.style.height="30px",i.target="_blank",i.rel="noopener",i.href=this.linkURL,i.setAttribute("aria-label","MapTiler logo"),i.setAttribute("rel","noopener"),this._container.appendChild(i),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}}var sV=Object.defineProperty,HA=Object.getOwnPropertySymbols,oV=Object.prototype.hasOwnProperty,aV=Object.prototype.propertyIsEnumerable,qA=(e,t,n)=>t in e?sV(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,GA=(e,t)=>{for(var n in t||(t={}))oV.call(t,n)&&qA(e,n,t[n]);if(HA)for(var n of HA(t))aV.call(t,n)&&qA(e,n,t[n]);return e};function lh(e,t,n){const i=window.document.createElement(e);return void 0!==t&&(i.className=t),n&&n.appendChild(i),i}function WA(e){e.parentNode&&e.parentNode.removeChild(e)}function ZA(e,t){let n=null;try{n=new URL(e)}catch{return{url:e}}return n.host===Ma.maptilerApiHost&&(n.searchParams.has("key")||n.searchParams.append("key",Co.apiKey),Co.session&&n.searchParams.append("mtsid",VA)),{url:n.href}}function KA(e){return function(t,n){var i;if(void 0!==e){const r=e(t,n),l=ZA(null!=(i=r?.url)?i:"");return GA(GA({},r),l)}return ZA(t)}}function YA(e){return e?"string"==typeof e||e instanceof String?!e.startsWith("http")&&e.toLowerCase().includes(".json")?e:kA(e):e instanceof Xx?e.getExpandedStyleURL():e instanceof Yx?e.getDefaultVariant().getExpandedStyleURL():e:Av[Iv[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL()}var hV=Object.defineProperty,ow=(e,t,n)=>(((e,t,n)=>{t in e?hV(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class fV{constructor(){ow(this,"_map"),ow(this,"_container"),ow(this,"_terrainButton"),function cV(e,t){e.forEach(n=>{"function"==typeof t[n]&&(t[n]=t[n].bind(t))})}(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(t){return this._map=t,this._container=lh("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=lh("button","maplibregl-ctrl-terrain",this._container),lh("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){WA(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.hasTerrain()?this._map.disableTerrain():this._map.enableTerrain(),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.hasTerrain()?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}}class pV extends sn.NavigationControl{onAdd(t){return super.onAdd(t)}}var mV=Object.defineProperty;class _V extends pV{constructor(){var t,n;super({showCompass:!0,showZoom:!0,visualizePitch:!0}),n=()=>{const t=this.options.visualizePitch?`scale(${Math.min(1.5,1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5))}) rotateX(${Math.min(70,this._map.transform.pitch)}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=t},((e,t,n)=>{t in e?mV(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(this,"symbol"!=typeof(t="_rotateCompassArrow")?t+"":t,n),this._compass.removeEventListener("click",this._compass.clickFunction),this._compass.addEventListener("click",t=>{0===this._map.getPitch()?this._map.easeTo({pitch:Math.min(this._map.getMaxPitch(),80)}):this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})})}_createButton(t,n){const i=super._createButton(t,n);return i.clickFunction=n,i}}class vV extends sn.GeolocateControl{onAdd(t){return super.onAdd(t)}}var bV=Object.defineProperty,xV=Object.defineProperties,wV=Object.getOwnPropertyDescriptors,QA=Object.getOwnPropertySymbols,CV=Object.prototype.hasOwnProperty,EV=Object.prototype.propertyIsEnumerable,aw=(e,t,n)=>t in e?bV(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Rv=(e,t,n)=>(aw(e,"symbol"!=typeof t?t+"":t,n),n);const JA=sn.Marker,eM=sn.LngLat,DV=sn.LngLatBounds;class IV extends vV{constructor(){super(...arguments),Rv(this,"lastUpdatedCenter",new eM(0,0)),Rv(this,"_updateCamera",t=>{var n,i,r;const l=new eM(t.coords.longitude,t.coords.latitude),h=t.coords.accuracy,_=(e=((e,t)=>{for(var n in t||(t={}))CV.call(t,n)&&aw(e,n,t[n]);if(QA)for(var n of QA(t))EV.call(t,n)&&aw(e,n,t[n]);return e})({bearing:this._map.getBearing()},this.options.fitBoundsOptions),xV(e,wV({linear:!0}))),C=this._map.getZoom();var e;C>(null!=(r=null==(i=null==(n=this.options)?void 0:n.fitBoundsOptions)?void 0:i.maxZoom)?r:30)&&(_.zoom=C),this._map.fitBounds(DV.fromLngLat(l,h),_,{geolocateSource:!0});let A=!1;const R=()=>{A=!0};this._map.once("click",R),this._map.once("dblclick",R),this._map.once("dragstart",R),this._map.once("mousedown",R),this._map.once("touchstart",R),this._map.once("wheel",R),this._map.once("moveend",()=>{this._map.off("click",R),this._map.off("dblclick",R),this._map.off("dragstart",R),this._map.off("mousedown",R),this._map.off("touchstart",R),this._map.off("wheel",R),!A&&(this.lastUpdatedCenter=this._map.getCenter())})}),Rv(this,"_setupUI",t=>{if(this.lastUpdatedCenter=this._map.getCenter(),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=lh("button","maplibregl-ctrl-geolocate",this._container),lh("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===t){const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=lh("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new JA({element:this._dotElement}),this._circleElement=lh("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new JA({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("move",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("moveend",n=>{const i=n.originalEvent&&"resize"===n.originalEvent.type,r=this.lastUpdatedCenter.distanceTo(this._map.getCenter());!n.geolocateSource&&"ACTIVE_LOCK"===this._watchState&&!i&&r>1&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Event("trackuserlocationend")))})}),Rv(this,"_onZoom",()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()})}_updateCircleRadius(){if("BACKGROUND"!==this._watchState&&"ACTIVE_LOCK"!==this._watchState)return;const n=this._map.project([this._lastKnownPosition.coords.longitude,this._lastKnownPosition.coords.latitude]),i=this._map.unproject([n.x,n.y]),r=this._map.unproject([n.x+20,n.y]),l=i.distanceTo(r)/20,h=Math.ceil(2*this._accuracy/l);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}}class AV extends sn.AttributionControl{onAdd(t){return super.onAdd(t)}}class MV extends sn.ScaleControl{onAdd(t){return super.onAdd(t)}}class PV extends sn.FullscreenControl{onAdd(t){return super.onAdd(t)}}var Jo,oc,Td,iM,Dd,Pa,Lv,uw,rM,ea,Ra,hw,sM,RV=Object.defineProperty,LV=Object.defineProperties,kV=Object.getOwnPropertyDescriptors,tM=Object.getOwnPropertySymbols,OV=Object.prototype.hasOwnProperty,NV=Object.prototype.propertyIsEnumerable,lw=(e,t,n)=>t in e?RV(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Cp=(e,t)=>{for(var n in t||(t={}))OV.call(t,n)&&lw(e,n,t[n]);if(tM)for(var n of tM(t))NV.call(t,n)&&lw(e,n,t[n]);return e},nM=(e,t)=>LV(e,kV(t)),cw=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)},Pn=(e,t,n)=>(cw(e,t,"read from private field"),n?n.call(e):t.get(e)),sc=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},Ep=(e,t,n,i)=>(cw(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n),Qo=(e,t,n)=>(cw(e,t,"access private method"),n);class dw{constructor(t,n){var i;sc(this,uw),sc(this,ea),sc(this,hw),sc(this,Jo,void 0),((e,t,n)=>{lw(this,t+"",void 0)})(0,"map"),sc(this,oc,void 0),sc(this,Td,void 0),sc(this,iM,void 0),sc(this,Dd,void 0),sc(this,Pa,!1),sc(this,Lv,void 0),void 0!==t.style&&Ep(this,Pa,!0),Ep(this,Jo,nM(Cp(nM(Cp({zoomAdjust:-4,position:"top-right"},n),{forceNoAttributionControl:!0,attributionControl:!1,navigationControl:!1,geolocateControl:!1,maptilerLogo:!1,minimap:!1,hash:!1,pitchAdjust:!1}),t),{containerStyle:Cp({border:"1px solid #000",width:"400px",height:"300px"},null!=(i=t.containerStyle)?i:{})})),void 0!==t.lockZoom&&(Pn(this,Jo).minZoom=t.lockZoom,Pn(this,Jo).maxZoom=t.lockZoom)}setStyle(t,n){Pn(this,Pa)||this.map.setStyle(t,n),Qo(this,ea,Ra).call(this)}addLayer(t,n){return Pn(this,Pa)||this.map.addLayer(t,n),Qo(this,ea,Ra).call(this),this.map}moveLayer(t,n){return Pn(this,Pa)||this.map.moveLayer(t,n),Qo(this,ea,Ra).call(this),this.map}removeLayer(t){return Pn(this,Pa)||this.map.removeLayer(t),Qo(this,ea,Ra).call(this),this}setLayerZoomRange(t,n,i){return Pn(this,Pa)||this.map.setLayerZoomRange(t,n,i),Qo(this,ea,Ra).call(this),this}setFilter(t,n,i){return Pn(this,Pa)||this.map.setFilter(t,n,i),Qo(this,ea,Ra).call(this),this}setPaintProperty(t,n,i,r){return Pn(this,Pa)||this.map.setPaintProperty(t,n,i,r),Qo(this,ea,Ra).call(this),this}setLayoutProperty(t,n,i,r){return Pn(this,Pa)||this.map.setLayoutProperty(t,n,i,r),Qo(this,ea,Ra).call(this),this}setGlyphs(t,n){return Pn(this,Pa)||this.map.setGlyphs(t,n),Qo(this,ea,Ra).call(this),this}onAdd(t){Ep(this,oc,t),Ep(this,Td,lh("div","maplibregl-ctrl maplibregl-ctrl-group"));for(const[n,i]of Object.entries(Pn(this,Jo).containerStyle))Pn(this,Td).style.setProperty(n,i);return Pn(this,Jo).container=Pn(this,Td),Pn(this,Jo).zoom=t.getZoom()+Pn(this,Jo).zoomAdjust,this.map=new pw(Pn(this,Jo)),this.map.once("style.load",()=>{this.map.resize()}),this.map.once("load",()=>{Qo(this,uw,rM).call(this,Pn(this,Jo).parentRect),Ep(this,Lv,Qo(this,hw,sM).call(this))}),Pn(this,Td)}onRemove(){var t;null==(t=Pn(this,Lv))||t.call(this),WA(Pn(this,Td))}}Jo=new WeakMap,oc=new WeakMap,Td=new WeakMap,iM=new WeakMap,Dd=new WeakMap,Pa=new WeakMap,Lv=new WeakMap,uw=new WeakSet,rM=function(e){void 0===e||void 0===e.linePaint&&void 0===e.fillPaint||(Ep(this,Dd,{type:"Feature",properties:{name:"parentRect"},geometry:{type:"Polygon",coordinates:[[[],[],[],[],[]]]}}),this.map.addSource("parentRect",{type:"geojson",data:Pn(this,Dd)}),(void 0!==e.lineLayout||void 0!==e.linePaint)&&this.map.addLayer({id:"parentRectOutline",type:"line",source:"parentRect",layout:Cp({},e.lineLayout),paint:Cp({"line-color":"#FFF","line-width":1,"line-opacity":.85},e.linePaint)}),void 0!==e.fillPaint&&this.map.addLayer({id:"parentRectFill",type:"fill",source:"parentRect",layout:{},paint:Cp({"fill-color":"#08F","fill-opacity":.135},e.fillPaint)}),Qo(this,ea,Ra).call(this))},ea=new WeakSet,Ra=function(){if(void 0===Pn(this,Dd))return;const{devicePixelRatio:e}=window,t=Pn(this,oc).getCanvas(),n=t.width/e,i=t.height/e,r=Pn(this,oc).unproject.bind(Pn(this,oc)),l=r([0,0]),h=r([n,0]),f=r([0,i]),_=r([n,i]);Pn(this,Dd).geometry.coordinates=[[f.toArray(),_.toArray(),h.toArray(),l.toArray(),f.toArray()]],this.map.getSource("parentRect").setData(Pn(this,Dd))},hw=new WeakSet,sM=function(){const{pitchAdjust:e}=Pn(this,Jo),t=()=>{l("parent")},n=()=>{l("minimap")},i=()=>{Pn(this,oc).on("move",t),this.map.on("move",n)},r=()=>{Pn(this,oc).off("move",t),this.map.off("move",n)},l=h=>{var f;r();const _="parent"===h?Pn(this,oc):this.map,C="parent"===h?this.map:Pn(this,oc),A=_.getCenter(),R=_.getZoom()+(null!=(f=Pn(this,Jo).zoomAdjust)?f:-4)*("parent"===h?1:-1),F=_.getBearing(),$=_.getPitch();C.jumpTo({center:A,zoom:R,bearing:F,pitch:e?$:0}),Qo(this,ea,Ra).call(this),i()};return i(),()=>{r()}};var zV=Object.defineProperty,BV=Object.defineProperties,UV=Object.getOwnPropertyDescriptors,oM=Object.getOwnPropertySymbols,VV=Object.prototype.hasOwnProperty,jV=Object.prototype.propertyIsEnumerable,fw=(e,t,n)=>t in e?zV(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ch=(e,t,n)=>(fw(e,"symbol"!=typeof t?t+"":t,n),n),pu=(e,t,n)=>new Promise((i,r)=>{var l=_=>{try{f(n.next(_))}catch(C){r(C)}},h=_=>{try{f(n.throw(_))}catch(C){r(C)}},f=_=>_.done?i(_.value):Promise.resolve(_.value).then(l,h);f((n=n.apply(e,t)).next())});class pw extends sn.Map{constructor(t){var n,i,r;t.apiKey&&(Co.apiKey=t.apiKey);const l=YA(t.style),h=location.hash;Co.apiKey||console.warn("MapTiler Cloud API key is not set. Visit https://maptiler.com and try Cloud for free!"),super(((e,t)=>BV(e,UV(t)))(((e,t)=>{for(var n in t||(t={}))VV.call(t,n)&&fw(e,n,t[n]);if(oM)for(var n of oM(t))jV.call(t,n)&&fw(e,n,t[n]);return e})({},t),{style:l,maplibreLogo:!1,transformRequest:KA(t.transformRequest)})),ch(this,"isTerrainEnabled",!1),ch(this,"terrainExaggeration",1),ch(this,"primaryLanguage"),ch(this,"terrainGrowing",!1),ch(this,"terrainFlattening",!1),ch(this,"minimap"),ch(this,"forceLanguageUpdate"),ch(this,"languageAlwaysBeenStyle"),this.primaryLanguage=null!=(n=t.language)?n:Co.primaryLanguage,this.forceLanguageUpdate=!(this.primaryLanguage===Bn.STYLE||this.primaryLanguage===Bn.STYLE_LOCK),this.languageAlwaysBeenStyle=this.primaryLanguage===Bn.STYLE,this.terrainExaggeration=null!=(i=t.terrainExaggeration)?i:this.terrainExaggeration,this.once("styledata",()=>pu(this,null,function*(){if(!t.geolocate||t.center||t.hash&&h)return;try{if("COUNTRY"===t.geolocate)return void(yield this.fitToIpBounds())}catch($){console.warn($.message)}let R;try{yield this.centerOnIpPoint(t.zoom),R=this.getCameraHash()}catch($){console.warn($.message)}"granted"===(yield navigator.permissions.query({name:"geolocation"})).state&&navigator.geolocation.getCurrentPosition($=>{R===this.getCameraHash()&&(this.terrain?this.easeTo({center:[$.coords.longitude,$.coords.latitude],zoom:t.zoom||12,duration:2e3}):this.once("terrain",()=>{this.easeTo({center:[$.coords.longitude,$.coords.latitude],zoom:t.zoom||12,duration:2e3})}))},null,{maximumAge:864e5,timeout:5e3,enableHighAccuracy:!1})})),this.on("styledata",()=>{this.setPrimaryLanguage(this.primaryLanguage)}),this.on("styledata",()=>{null===this.getTerrain()&&this.isTerrainEnabled&&this.enableTerrain(this.terrainExaggeration)}),this.once("load",()=>pu(this,null,function*(){!function lV(){"unavailable"===sn.getRTLTextPluginStatus()&&sn.setRTLTextPlugin(Ma.rtlPluginURL,e=>{e&&console.error(e)},!0)}()})),this.once("load",()=>pu(this,null,function*(){let R={logo:null};try{const F=Object.keys(this.style.sourceCaches).map(ee=>this.getSource(ee)).filter(ee=>ee&&"url"in ee&&"string"==typeof ee.url&&ee?.url.includes("tiles.json")),$=new URL(F[0].url);$.searchParams.has("key")||$.searchParams.append("key",Co.apiKey),R=yield(yield fetch($.href)).json()}catch{}if(!0!==t.forceNoAttributionControl&&("logo"in R&&R.logo?(this.addControl(new $A({logoURL:R.logo}),t.logoPosition),!1===t.attributionControl&&this.addControl(new AV({customAttribution:t.customAttribution}))):t.maptilerLogo&&this.addControl(new $A,t.logoPosition)),t.scaleControl){const F=!0===t.scaleControl||void 0===t.scaleControl?"bottom-right":t.scaleControl,$=new MV({unit:Co.unit});this.addControl($,F),Co.on("unit",Q=>{$.setUnit(Q)})}if(!1!==t.navigationControl){const F=!0===t.navigationControl||void 0===t.navigationControl?"top-right":t.navigationControl;this.addControl(new _V,F)}if(!1!==t.geolocateControl){const F=!0===t.geolocateControl||void 0===t.geolocateControl?"top-right":t.geolocateControl;this.addControl(new IV({positionOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!0,showAccuracyCircle:!0,showUserLocation:!0}),F)}if(t.terrainControl){const F=!0===t.terrainControl||void 0===t.terrainControl?"top-right":t.terrainControl;this.addControl(new fV,F)}if(t.fullscreenControl){const F=!0===t.fullscreenControl||void 0===t.fullscreenControl?"top-right":t.fullscreenControl;this.addControl(new PV({}),F)}}));let C,f=!1,_=!1;this.once("load",()=>{f=!0,_&&this.fire("loadWithTerrain",C)}),this.once("style.load",()=>{var R;const{minimap:F}=t;if("object"==typeof F){const{zoom:$,center:Q,style:ee,language:me,apiKey:ve,maptilerLogo:pe,antialias:Le,refreshExpiredTiles:qe,maxBounds:at,scrollZoom:xt,minZoom:wt,maxZoom:Rt,boxZoom:Ht,locale:Xt,fadeDuration:Ti,crossSourceCollisions:on,clickTolerance:an,bounds:Un,fitBoundsOptions:di,pixelRatio:Ke,validateStyle:ct}=t;this.minimap=new dw(F,{zoom:$,center:Q,style:ee,language:me,apiKey:ve,container:"null",maptilerLogo:pe,antialias:Le,refreshExpiredTiles:qe,maxBounds:at,scrollZoom:xt,minZoom:wt,maxZoom:Rt,boxZoom:Ht,locale:Xt,fadeDuration:Ti,crossSourceCollisions:on,clickTolerance:an,bounds:Un,fitBoundsOptions:di,pixelRatio:Ke,validateStyle:ct}),this.addControl(this.minimap,null!=(R=F.position)?R:"bottom-left")}else!0===F?(this.minimap=new dw({},t),this.addControl(this.minimap,"bottom-left")):void 0!==F&&!1!==F&&(this.minimap=new dw({},t),this.addControl(this.minimap,F))});const A=R=>{R.terrain&&(_=!0,C={type:"loadWithTerrain",target:this,terrain:R.terrain},this.off("terrain",A),f&&this.fire("loadWithTerrain",C))};this.on("terrain",A),t.terrain&&this.enableTerrain(null!=(r=t.terrainExaggeration)?r:this.terrainExaggeration)}onLoadAsync(){return pu(this,null,function*(){return new Promise(t=>{if(this.loaded())return t(this);this.once("load",()=>{t(this)})})})}onLoadWithTerrainAsync(){return pu(this,null,function*(){return new Promise(t=>{if(this.loaded()&&this.terrain)return t(this);this.once("loadWithTerrain",()=>{t(this)})})})}setStyle(t,n){var i;return null==(i=this.minimap)||i.setStyle(t),this.forceLanguageUpdate=!0,this.once("idle",()=>{this.forceLanguageUpdate=!1}),super.setStyle(YA(t),n)}addLayer(t,n){var i;return null==(i=this.minimap)||i.addLayer(t,n),super.addLayer(t,n)}moveLayer(t,n){var i;return null==(i=this.minimap)||i.moveLayer(t,n),super.moveLayer(t,n)}removeLayer(t){var n;return null==(n=this.minimap)||n.removeLayer(t),super.removeLayer(t)}setLayerZoomRange(t,n,i){var r;return null==(r=this.minimap)||r.setLayerZoomRange(t,n,i),super.setLayerZoomRange(t,n,i)}setFilter(t,n,i){var r;return null==(r=this.minimap)||r.setFilter(t,n,i),super.setFilter(t,n,i)}setPaintProperty(t,n,i,r){var l;return null==(l=this.minimap)||l.setPaintProperty(t,n,i,r),super.setPaintProperty(t,n,i,r)}setLayoutProperty(t,n,i,r){var l;return null==(l=this.minimap)||l.setLayoutProperty(t,n,i,r),super.setLayoutProperty(t,n,i,r)}setGlyphs(t,n){var i;return null==(i=this.minimap)||i.setGlyphs(t,n),super.setGlyphs(t,n)}getStyleLanguage(){return this.style.stylesheet.metadata&&"object"==typeof this.style.stylesheet.metadata&&"maptiler:language"in this.style.stylesheet.metadata&&"string"==typeof this.style.stylesheet.metadata["maptiler:language"]?this.style.stylesheet.metadata["maptiler:language"]:null}setLanguage(t){var n,i;null==(i=null==(n=this.minimap)?void 0:n.map)||i.setLanguage(t),this.onStyleReady(()=>{this.setPrimaryLanguage(t)})}setPrimaryLanguage(t){const n=this.getStyleLanguage();if((t!==Bn.STYLE||n!==Bn.AUTO&&n!==Bn.VISITOR)&&(t!==Bn.STYLE&&(this.languageAlwaysBeenStyle=!1),this.languageAlwaysBeenStyle||this.primaryLanguage===t&&!this.forceLanguageUpdate))return;if(!BA(t))return void console.warn(`The language "${t}" is not supported.`);if(this.primaryLanguage===Bn.STYLE_LOCK)return void console.warn("The language cannot be changed because this map has been instantiated with the STYLE_LOCK language flag.");this.primaryLanguage=t;let i=t;if(t===Bn.STYLE){if(!n)return void console.warn("The style has no default languages.");if(!BA(n))return void console.warn("The language defined in the style is not valid.");i=n}let r=Bn.LOCAL,l=`{${r}}`;i==Bn.VISITOR?(r=UA(),l=["case",["all",["has",r],["has",Bn.LOCAL]],["case",["==",["get",r],["get",Bn.LOCAL]],["get",Bn.LOCAL],["format",["get",r],{"font-scale":.8},"\n",["get",Bn.LOCAL],{"font-scale":1.1}]],["get",Bn.LOCAL]]):i==Bn.VISITOR_ENGLISH?(r=Bn.ENGLISH,l=["case",["all",["has",r],["has",Bn.LOCAL]],["case",["==",["get",r],["get",Bn.LOCAL]],["get",Bn.LOCAL],["format",["get",r],{"font-scale":.8},"\n",["get",Bn.LOCAL],{"font-scale":1.1}]],["get",Bn.LOCAL]]):i===Bn.AUTO?(r=UA(),l=["case",["has",r],["get",r],["get",Bn.LOCAL]]):i===Bn.LOCAL?(r=Bn.LOCAL,l=`{${r}}`):(r=i,l=["case",["has",r],["get",r],["get",Bn.LOCAL]]);const{layers:h}=this.getStyle();for(const{id:f,layout:_}of h){if(!_||!("text-field"in _))continue;const C=this.getLayoutProperty(f,"text-field");"string"==typeof C&&(C.toLowerCase().includes("ref")||C.toLowerCase().includes("housenumber"))||this.setLayoutProperty(f,"text-field",l)}}getPrimaryLanguage(){return this.primaryLanguage}getTerrainExaggeration(){return this.terrainExaggeration}hasTerrain(){return this.isTerrainEnabled}growTerrain(t,n=1e3){if(!this.terrain)return;const i=performance.now(),r=this.terrain.exaggeration,l=t-r,h=()=>{if(!this.terrain||this.terrainFlattening)return;const f=(performance.now()-i)/n;if(f<.99){const _=1-Math.pow(1-f,4);this.terrain.exaggeration=r+_*l,requestAnimationFrame(h)}else this.terrainGrowing=!1,this.terrainFlattening=!1,this.terrain.exaggeration=t;this.triggerRepaint()};this.terrainGrowing=!0,this.terrainFlattening=!1,requestAnimationFrame(h)}enableTerrain(t=this.terrainExaggeration){if(t<0)return void console.warn("Terrain exaggeration cannot be negative.");const n=r=>pu(this,null,function*(){!this.terrain||"data"!==r.type||"source"!==r.dataType||!("source"in r)||"maptiler-terrain"!==r.sourceId||"raster-dem"!==r.source.type||r.isSourceLoaded&&(this.off("data",n),this.growTerrain(t))}),i=()=>{this.isTerrainEnabled=!0,this.terrainExaggeration=t,this.on("data",n),this.addSource(Ma.terrainSourceId,{type:"raster-dem",url:Ma.terrainSourceURL}),this.setTerrain({source:Ma.terrainSourceId,exaggeration:0})};if(this.getTerrain())return this.isTerrainEnabled=!0,void this.growTerrain(t);this.loaded()||this.isTerrainEnabled?i():this.once("load",()=>{this.getTerrain()&&this.getSource(Ma.terrainSourceId)||i()})}disableTerrain(){if(!this.terrain)return;this.isTerrainEnabled=!1;const n=performance.now(),i=this.terrain.exaggeration,r=()=>{if(!this.terrain||this.terrainGrowing)return;const l=(performance.now()-n)/1e3;if(l<.99){const h=Math.pow(1-l,4);this.terrain.exaggeration=i*h,requestAnimationFrame(r)}else this.terrain.exaggeration=0,this.terrainGrowing=!1,this.terrainFlattening=!1,this.setTerrain(),this.getSource(Ma.terrainSourceId)&&this.removeSource(Ma.terrainSourceId);this.triggerRepaint()};this.terrainGrowing=!1,this.terrainFlattening=!0,requestAnimationFrame(r)}setTerrainExaggeration(t,n=!0){!n&&this.terrain?(this.terrainExaggeration=t,this.terrain.exaggeration=t,this.triggerRepaint()):this.enableTerrain(t)}onStyleReady(t){this.isStyleLoaded()?t():this.once("styledata",()=>{t()})}fitToIpBounds(){return pu(this,null,function*(){const t=yield RA.info();this.fitBounds(t.country_bounds,{duration:0,padding:100})})}centerOnIpPoint(t){return pu(this,null,function*(){var n,i;const r=yield RA.info();this.jumpTo({center:[null!=(n=r?.longitude)?n:0,null!=(i=r?.latitude)?i:0],zoom:t||11})})}getCameraHash(){const t=new Float32Array(5),n=this.getCenter();return t[0]=n.lng,t[1]=n.lat,t[2]=this.getZoom(),t[3]=this.getPitch(),t[4]=this.getBearing(),lU_fromUint8Array(new Uint8Array(t.buffer))}getSdkConfig(){return Co}getMaptilerSessionId(){return VA}setTransformRequest(t){return super.setTransformRequest(KA(t)),this}loadImageAsync(t){return pu(this,null,function*(){return new Promise((n,i)=>{this.loadImage(t,(r,l)=>{r?i(r):n(l)})})})}}class aM extends sn.Marker{addTo(t){return super.addTo(t)}}var sj=Object.defineProperty,EM=(e,t,n)=>(((e,t,n)=>{t in e?sj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);function Nv(e){const t=e.toString(16);return 1==t.length?"0"+t:t}class Tt extends Array{constructor(t={}){super(),EM(this,"min",0),EM(this,"max",1),"min"in t&&(this.min=t.min),"max"in t&&(this.max=t.max),"stops"in t&&this.setStops(t.stops,{clone:!1})}static fromArrayDefinition(t){return new Tt({stops:t.map(n=>({value:n[0],color:n[1]}))})}setStops(t,n={clone:!0}){const i=n.clone?this.clone():this;i.length=0;let r=1/0,l=-1/0;for(let h=0;h<t.length;h+=1)r=Math.min(r,t[h].value),l=Math.max(l,t[h].value),i.push({value:t[h].value,color:t[h].color.slice()});return i.sort((h,f)=>h.value<f.value?-1:1),this.min=r,this.max=l,i}scale(t,n,i={clone:!0}){const r=i.clone,l=this[0].value,f=this.at(-1).value-l,_=n-t,C=[];for(let A=0;A<this.length;A+=1){const $=(this[A].value-l)/f*_+t;r?C.push({value:$,color:this[A].color.slice()}):this[A].value=$}return r?new Tt({stops:C}):this}at(t){return t<0?this[this.length+t]:this[t]}clone(){return new Tt({stops:this.getRawColorStops()})}getRawColorStops(){const t=[];for(let n=0;n<this.length;n+=1)t.push({value:this[n].value,color:this[n].color});return t}reverse(t={clone:!0}){const n=t.clone?this.clone():this;for(let i=0;i<~~(n.length/2);i+=1){const r=n[i].color;n[i].color=n.at(-(i+1)).color,n.at(-(i+1)).color=r}return n}getBounds(){return{min:this.min,max:this.max}}getColor(t,n={smooth:!0}){if(t<=this[0].value)return this[0].color;if(t>=this.at(-1).value)return this.at(-1).color;for(let i=0;i<this.length-1;i+=1){if(t>this[i+1].value)continue;const r=this[i].color;if(!n.smooth)return r.slice();const h=this[i+1].value,f=this[i+1].color,_=(h-t)/(h-this[i].value);return r.map((C,A)=>Math.round(C*_+f[A]*(1-_)))}return[0,0,0]}getColorHex(t,n={smooth:!0,withAlpha:!1}){return function aj(e){return"#"+Nv(e[0])+Nv(e[1])+Nv(e[2])+(4===e.length?Nv(e[3]):"")}(this.getColor(t,n))}getColorRelative(t,n={smooth:!0}){const i=this.getBounds();return this.getColor(i.min+t*(i.max-i.min),n)}getCanvasStrip(t={horizontal:!0,size:512,smooth:!0}){const n=document.createElement("canvas");n.width=t.horizontal?t.size:1,n.height=t.horizontal?1:t.size;const i=n.getContext("2d");if(!i)throw new Error("Canvs context is missing");const r=i.getImageData(0,0,n.width,n.height),l=r.data,h=t.size,f=this[0].value,A=(this.at(-1).value-f)/h;for(let R=0;R<h;R+=1){const F=this.getColor(f+R*A,{smooth:t.smooth});l[4*R]=F[0],l[4*R+1]=F[1],l[4*R+2]=F[2],l[4*R+3]=F.length>3?F[3]:255}return i.putImageData(r,0,0),n}resample(t,n=15){const i=this.getBounds(),r=this.scale(0,1),l=1/(n-1);let h;if("ease-in-square"===t)h=Array.from({length:n},(C,A)=>{const R=A*l,F=Math.pow(R,2);return{value:R,color:r.getColor(F)}});else if("ease-out-square"===t)h=Array.from({length:n},(C,A)=>{const R=A*l,F=1-Math.pow(1-R,2);return{value:R,color:r.getColor(F)}});else if("ease-out-sqrt"===t)h=Array.from({length:n},(C,A)=>{const R=A*l,F=Math.pow(R,.5);return{value:R,color:r.getColor(F)}});else if("ease-in-sqrt"===t)h=Array.from({length:n},(C,A)=>{const R=A*l,F=1-Math.pow(1-R,.5);return{value:R,color:r.getColor(F)}});else if("ease-out-exp"===t)h=Array.from({length:n},(C,A)=>{const R=A*l,F=1-Math.pow(2,-10*R);return{value:R,color:r.getColor(F)}});else{if("ease-in-exp"!==t)throw new Error("Invalid ressampling method.");h=Array.from({length:n},(C,A)=>{const R=A*l,F=Math.pow(2,10*R-10);return{value:R,color:r.getColor(F)}})}return new Tt({stops:h}).scale(i.min,i.max)}transparentStart(){const t=this.getRawColorStops();return t.unshift({value:t[0].value,color:t[0].color.slice()}),t[1].value+=.001,t.forEach(n=>{3===n.color.length&&n.color.push(255)}),t[0].color[3]=0,new Tt({stops:t})}hasTransparentStart(){return 4===this[0].color.length&&0===this[0].color[3]}}new Tt({stops:[{value:0,color:[0,0,0,0]},{value:1,color:[0,0,0,0]}]}),new Tt({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),new Tt({stops:[{value:0,color:[0,0,131]},{value:.125,color:[0,60,170]},{value:.375,color:[5,255,255]},{value:.625,color:[255,255,0]},{value:.875,color:[250,0,0]},{value:1,color:[128,0,0]}]}),new Tt({stops:[{value:0,color:[255,0,0]},{value:.169,color:[253,255,2]},{value:.173,color:[247,255,2]},{value:.337,color:[0,252,4]},{value:.341,color:[0,252,10]},{value:.506,color:[1,249,255]},{value:.671,color:[2,0,253]},{value:.675,color:[8,0,253]},{value:.839,color:[255,0,251]},{value:.843,color:[255,0,245]},{value:1,color:[255,0,6]}]}),new Tt({stops:[{value:0,color:[0,0,0]},{value:.3,color:[230,0,0]},{value:.6,color:[255,210,0]},{value:1,color:[255,255,255]}]}),new Tt({stops:[{value:0,color:[255,0,255]},{value:1,color:[255,255,0]}]}),new Tt({stops:[{value:0,color:[0,128,102]},{value:1,color:[255,255,102]}]}),new Tt({stops:[{value:0,color:[255,0,0]},{value:1,color:[255,255,0]}]}),new Tt({stops:[{value:0,color:[0,0,255]},{value:1,color:[0,255,128]}]}),new Tt({stops:[{value:0,color:[0,0,0]},{value:.376,color:[84,84,116]},{value:.753,color:[169,200,200]},{value:1,color:[255,255,255]}]}),new Tt({stops:[{value:0,color:[0,0,0]},{value:.804,color:[255,160,102]},{value:1,color:[255,199,127]}]}),new Tt({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),new Tt({stops:[{value:0,color:[8,29,88]},{value:.125,color:[37,52,148]},{value:.25,color:[34,94,168]},{value:.375,color:[29,145,192]},{value:.5,color:[65,182,196]},{value:.625,color:[127,205,187]},{value:.75,color:[199,233,180]},{value:.875,color:[237,248,217]},{value:1,color:[255,255,217]}]}),new Tt({stops:[{value:0,color:[0,68,27]},{value:.125,color:[0,109,44]},{value:.25,color:[35,139,69]},{value:.375,color:[65,171,93]},{value:.5,color:[116,196,118]},{value:.625,color:[161,217,155]},{value:.75,color:[199,233,192]},{value:.875,color:[229,245,224]},{value:1,color:[247,252,245]}]}),new Tt({stops:[{value:0,color:[128,0,38]},{value:.125,color:[189,0,38]},{value:.25,color:[227,26,28]},{value:.375,color:[252,78,42]},{value:.5,color:[253,141,60]},{value:.625,color:[254,178,76]},{value:.75,color:[254,217,118]},{value:.875,color:[255,237,160]},{value:1,color:[255,255,204]}]}),new Tt({stops:[{value:0,color:[0,0,255]},{value:1,color:[255,0,0]}]}),new Tt({stops:[{value:0,color:[5,10,172]},{value:.35,color:[106,137,247]},{value:.5,color:[190,190,190]},{value:.6,color:[220,170,132]},{value:.7,color:[230,145,90]},{value:1,color:[178,10,28]}]}),new Tt({stops:[{value:0,color:[0,0,255]},{value:.1,color:[51,153,255]},{value:.2,color:[102,204,255]},{value:.3,color:[153,204,255]},{value:.4,color:[204,204,255]},{value:.5,color:[255,255,255]},{value:.6,color:[255,204,255]},{value:.7,color:[255,153,255]},{value:.8,color:[255,102,204]},{value:.9,color:[255,102,102]},{value:1,color:[255,0,0]}]}),new Tt({stops:[{value:0,color:[150,0,90]},{value:.125,color:[0,0,200]},{value:.25,color:[0,25,255]},{value:.375,color:[0,152,255]},{value:.5,color:[44,255,150]},{value:.625,color:[151,255,0]},{value:.75,color:[255,234,0]},{value:.875,color:[255,111,0]},{value:1,color:[255,0,0]}]}),new Tt({stops:[{value:0,color:[12,51,131]},{value:.25,color:[10,136,186]},{value:.5,color:[242,211,56]},{value:.75,color:[242,143,56]},{value:1,color:[217,30,30]}]}),new Tt({stops:[{value:0,color:[0,0,0]},{value:.2,color:[230,0,0]},{value:.4,color:[230,210,0]},{value:.7,color:[255,255,255]},{value:1,color:[160,200,255]}]}),new Tt({stops:[{value:0,color:[0,0,130]},{value:.1,color:[0,180,180]},{value:.2,color:[40,210,40]},{value:.4,color:[230,230,50]},{value:.6,color:[120,70,20]},{value:1,color:[255,255,255]}]}),new Tt({stops:[{value:0,color:[0,0,0]},{value:.15,color:[30,0,100]},{value:.4,color:[120,0,100]},{value:.6,color:[160,90,0]},{value:.8,color:[230,200,0]},{value:1,color:[255,250,220]}]}),new Tt({stops:[{value:0,color:[68,1,84]},{value:.13,color:[71,44,122]},{value:.25,color:[59,81,139]},{value:.38,color:[44,113,142]},{value:.5,color:[33,144,141]},{value:.63,color:[39,173,129]},{value:.75,color:[92,200,99]},{value:.88,color:[170,220,50]},{value:1,color:[253,231,37]}]}),new Tt({stops:[{value:0,color:[0,0,4]},{value:.13,color:[31,12,72]},{value:.25,color:[85,15,109]},{value:.38,color:[136,34,106]},{value:.5,color:[186,54,85]},{value:.63,color:[227,89,51]},{value:.75,color:[249,140,10]},{value:.88,color:[249,201,50]},{value:1,color:[252,255,164]}]}),new Tt({stops:[{value:0,color:[0,0,4]},{value:.13,color:[28,16,68]},{value:.25,color:[79,18,123]},{value:.38,color:[129,37,129]},{value:.5,color:[181,54,122]},{value:.63,color:[229,80,100]},{value:.75,color:[251,135,97]},{value:.88,color:[254,194,135]},{value:1,color:[252,253,191]}]}),new Tt({stops:[{value:0,color:[13,8,135]},{value:.13,color:[75,3,161]},{value:.25,color:[125,3,168]},{value:.38,color:[168,34,150]},{value:.5,color:[203,70,121]},{value:.63,color:[229,107,93]},{value:.75,color:[248,148,65]},{value:.88,color:[253,195,40]},{value:1,color:[240,249,33]}]}),new Tt({stops:[{value:0,color:[125,0,179]},{value:.13,color:[172,0,187]},{value:.25,color:[219,0,170]},{value:.38,color:[255,0,130]},{value:.5,color:[255,63,74]},{value:.63,color:[255,123,0]},{value:.75,color:[234,176,0]},{value:.88,color:[190,228,0]},{value:1,color:[147,255,0]}]}),new Tt({stops:[{value:0,color:[125,0,179]},{value:.13,color:[116,0,218]},{value:.25,color:[98,74,237]},{value:.38,color:[68,146,231]},{value:.5,color:[0,204,197]},{value:.63,color:[0,247,146]},{value:.75,color:[0,255,88]},{value:.88,color:[40,255,8]},{value:1,color:[147,255,0]}]}),new Tt({stops:[{value:0,color:[125,0,179]},{value:.1,color:[199,0,180]},{value:.2,color:[255,0,121]},{value:.3,color:[255,108,0]},{value:.4,color:[222,194,0]},{value:.5,color:[150,255,0]},{value:.6,color:[0,255,55]},{value:.7,color:[0,246,150]},{value:.8,color:[50,167,222]},{value:.9,color:[103,51,235]},{value:1,color:[124,0,186]}]}),new Tt({stops:[{value:0,color:[40,26,44]},{value:.13,color:[59,49,90]},{value:.25,color:[64,76,139]},{value:.38,color:[63,110,151]},{value:.5,color:[72,142,158]},{value:.63,color:[85,174,163]},{value:.75,color:[120,206,163]},{value:.88,color:[187,230,172]},{value:1,color:[253,254,204]}]}),new Tt({stops:[{value:0,color:[47,15,62]},{value:.13,color:[87,23,86]},{value:.25,color:[130,28,99]},{value:.38,color:[171,41,96]},{value:.5,color:[206,67,86]},{value:.63,color:[230,106,84]},{value:.75,color:[242,149,103]},{value:.88,color:[249,193,135]},{value:1,color:[254,237,176]}]}),new Tt({stops:[{value:0,color:[18,36,20]},{value:.13,color:[25,63,41]},{value:.25,color:[24,91,59]},{value:.38,color:[13,119,72]},{value:.5,color:[18,148,80]},{value:.63,color:[80,173,89]},{value:.75,color:[132,196,122]},{value:.88,color:[175,221,162]},{value:1,color:[215,249,208]}]}),new Tt({stops:[{value:0,color:[54,14,36]},{value:.13,color:[89,23,80]},{value:.25,color:[110,45,132]},{value:.38,color:[120,77,178]},{value:.5,color:[120,113,213]},{value:.63,color:[115,151,228]},{value:.75,color:[134,185,227]},{value:.88,color:[177,214,227]},{value:1,color:[230,241,241]}]}),new Tt({stops:[{value:0,color:[30,4,110]},{value:.13,color:[47,14,176]},{value:.25,color:[41,45,236]},{value:.38,color:[25,99,212]},{value:.5,color:[68,131,200]},{value:.63,color:[114,156,197]},{value:.75,color:[157,181,203]},{value:.88,color:[200,208,216]},{value:1,color:[241,237,236]}]}),new Tt({stops:[{value:0,color:[60,9,18]},{value:.13,color:[100,17,27]},{value:.25,color:[142,20,29]},{value:.38,color:[177,43,27]},{value:.5,color:[192,87,63]},{value:.63,color:[205,125,105]},{value:.75,color:[216,162,148]},{value:.88,color:[227,199,193]},{value:1,color:[241,237,236]}]}),new Tt({stops:[{value:0,color:[64,5,5]},{value:.13,color:[106,6,15]},{value:.25,color:[144,26,7]},{value:.38,color:[168,64,3]},{value:.5,color:[188,100,4]},{value:.63,color:[206,136,11]},{value:.75,color:[220,174,25]},{value:.88,color:[231,215,44]},{value:1,color:[248,254,105]}]}),new Tt({stops:[{value:0,color:[51,20,24]},{value:.13,color:[90,32,35]},{value:.25,color:[129,44,34]},{value:.38,color:[159,68,25]},{value:.5,color:[182,99,19]},{value:.63,color:[199,134,22]},{value:.75,color:[212,171,35]},{value:.88,color:[221,210,54]},{value:1,color:[225,253,75]}]}),new Tt({stops:[{value:0,color:[145,105,18]},{value:.13,color:[184,71,38]},{value:.25,color:[186,58,115]},{value:.38,color:[160,71,185]},{value:.5,color:[110,97,218]},{value:.63,color:[50,123,164]},{value:.75,color:[31,131,110]},{value:.88,color:[77,129,34]},{value:1,color:[145,105,18]}]}),new Tt({stops:[{value:0,color:[42,24,108]},{value:.13,color:[33,50,162]},{value:.25,color:[15,90,145]},{value:.38,color:[40,118,137]},{value:.5,color:[59,146,135]},{value:.63,color:[79,175,126]},{value:.75,color:[120,203,104]},{value:.88,color:[193,221,100]},{value:1,color:[253,239,154]}]}),new Tt({stops:[{value:0,color:[4,35,51]},{value:.13,color:[23,51,122]},{value:.25,color:[85,59,157]},{value:.38,color:[129,79,143]},{value:.5,color:[175,95,130]},{value:.63,color:[222,112,101]},{value:.75,color:[249,146,66]},{value:.88,color:[249,196,65]},{value:1,color:[232,250,91]}]}),new Tt({stops:[{value:0,color:[34,31,27]},{value:.13,color:[65,50,41]},{value:.25,color:[98,69,52]},{value:.38,color:[131,89,57]},{value:.5,color:[161,112,59]},{value:.63,color:[185,140,66]},{value:.75,color:[202,174,88]},{value:.88,color:[216,209,126]},{value:1,color:[233,246,171]}]}),new Tt({stops:[{value:0,color:[17,32,64]},{value:.13,color:[35,52,116]},{value:.25,color:[29,81,156]},{value:.38,color:[31,113,162]},{value:.5,color:[50,144,169]},{value:.63,color:[87,173,176]},{value:.75,color:[149,196,189]},{value:.88,color:[203,221,211]},{value:1,color:[254,251,230]}]}),new Tt({stops:[{value:0,color:[23,35,19]},{value:.13,color:[24,64,38]},{value:.25,color:[11,95,45]},{value:.38,color:[39,123,35]},{value:.5,color:[95,146,12]},{value:.63,color:[152,165,18]},{value:.75,color:[201,186,69]},{value:.88,color:[233,216,137]},{value:1,color:[255,253,205]}]}),new Tt({stops:[{value:0,color:[0,0,0]},{value:.07,color:[22,5,59]},{value:.13,color:[60,4,105]},{value:.2,color:[109,1,135]},{value:.27,color:[161,0,147]},{value:.33,color:[210,2,142]},{value:.4,color:[251,11,123]},{value:.47,color:[255,29,97]},{value:.53,color:[255,54,69]},{value:.6,color:[255,85,46]},{value:.67,color:[255,120,34]},{value:.73,color:[255,157,37]},{value:.8,color:[241,191,57]},{value:.87,color:[224,220,93]},{value:.93,color:[218,241,142]},{value:1,color:[227,253,198]}]}),new Tt({stops:[{value:0,color:[0,32,77,255]},{value:.125,color:[5,54,110,255]},{value:.25,color:[65,77,108,255]},{value:.375,color:[97,100,111,255]},{value:.5,color:[125,124,121,255]},{value:.625,color:[156,149,120,255]},{value:.75,color:[190,175,111,255]},{value:.875,color:[225,204,94,255]},{value:1,color:[255,235,70,255]}]}),new Tt({stops:[{value:0,color:[48,18,59,255]},{value:.125,color:[70,107,227,255]},{value:.25,color:[40,187,236,255]},{value:.375,color:[49,242,153,255]},{value:.5,color:[162,252,60,255]},{value:.625,color:[237,208,58,255]},{value:.75,color:[251,128,34,255]},{value:.875,color:[210,49,5,255]},{value:1,color:[122,4,3,255]}]}),new Tt({stops:[{value:0,color:[250,235,221,0]},{value:.133,color:[250,235,221,255]},{value:.266,color:[246,170,130,255]},{value:.4,color:[240,96,67,255]},{value:.533,color:[203,27,79,255]},{value:.666,color:[132,30,90,255]},{value:.8,color:[63,27,68,255]},{value:1,color:[3,5,26,255]}]}),new Tt({stops:[{value:0,color:[11,4,5,255]},{value:.125,color:[43,28,53,255]},{value:.25,color:[62,53,107,255]},{value:.375,color:[59,86,152,255]},{value:.5,color:[53,123,162,255]},{value:.625,color:[53,158,170,255]},{value:.75,color:[73,193,173,255]},{value:.875,color:[150,221,181,255]},{value:1,color:[222,245,229,255]}]});class Bv{}class Uv{}class ac{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?"string"==typeof t?this.lazyInit=()=>{this.headers=new Map,t.split("\n").forEach(n=>{const i=n.indexOf(":");if(i>0){const r=n.slice(0,i),l=r.toLowerCase(),h=n.slice(i+1).trim();this.maybeSetNormalizedName(r,l),this.headers.has(l)?this.headers.get(l).push(h):this.headers.set(l,[h])}})}:typeof Headers<"u"&&t instanceof Headers?(this.headers=new Map,t.forEach((n,i)=>{this.setHeaderEntries(i,n)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(t).forEach(([n,i])=>{this.setHeaderEntries(n,i)})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const n=this.headers.get(t.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,n){return this.clone({name:t,value:n,op:"a"})}set(t,n){return this.clone({name:t,value:n,op:"s"})}delete(t,n){return this.clone({name:t,value:n,op:"d"})}maybeSetNormalizedName(t,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,t)}init(){this.lazyInit&&(this.lazyInit instanceof ac?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(n=>{this.headers.set(n,t.headers.get(n)),this.normalizedNames.set(n,t.normalizedNames.get(n))})}clone(t){const n=new ac;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof ac?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}applyUpdate(t){const n=t.name.toLowerCase();switch(t.op){case"a":case"s":let i=t.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(t.name,n);const r=("a"===t.op?this.headers.get(n):void 0)||[];r.push(...i),this.headers.set(n,r);break;case"d":const l=t.value;if(l){let h=this.headers.get(n);if(!h)return;h=h.filter(f=>-1===l.indexOf(f)),0===h.length?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,h)}else this.headers.delete(n),this.normalizedNames.delete(n)}}setHeaderEntries(t,n){const i=(Array.isArray(n)?n:[n]).map(l=>l.toString()),r=t.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(t,r)}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>t(this.normalizedNames.get(n),this.headers.get(n)))}}class Ej{encodeKey(t){return kM(t)}encodeValue(t){return kM(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const Tj=/%(\d[a-f0-9])/gi,Dj={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function kM(e){return encodeURIComponent(e).replace(Tj,(t,n)=>Dj[n]??t)}function Vv(e){return`${e}`}class uh{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new Ej,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Sj(e,t){const n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(r=>{const l=r.indexOf("="),[h,f]=-1==l?[t.decodeKey(r),""]:[t.decodeKey(r.slice(0,l)),t.decodeValue(r.slice(l+1))],_=n.get(h)||[];_.push(f),n.set(h,_)}),n}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(n=>{const i=t.fromObject[n],r=Array.isArray(i)?i.map(Vv):[Vv(i)];this.map.set(n,r)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const n=this.map.get(t);return n?n[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,n){return this.clone({param:t,value:n,op:"a"})}appendAll(t){const n=[];return Object.keys(t).forEach(i=>{const r=t[i];Array.isArray(r)?r.forEach(l=>{n.push({param:i,value:l,op:"a"})}):n.push({param:i,value:r,op:"a"})}),this.clone(n)}set(t,n){return this.clone({param:t,value:n,op:"s"})}delete(t,n){return this.clone({param:t,value:n,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const n=this.encoder.encodeKey(t);return this.map.get(t).map(i=>n+"="+this.encoder.encodeValue(i)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const n=new uh({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(t),n}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const n=("a"===t.op?this.map.get(t.param):void 0)||[];n.push(Vv(t.value)),this.map.set(t.param,n);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let i=this.map.get(t.param)||[];const r=i.indexOf(Vv(t.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(t.param,i):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class Ij{constructor(){this.map=new Map}set(t,n){return this.map.set(t,n),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function OM(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer}function NM(e){return typeof Blob<"u"&&e instanceof Blob}function FM(e){return typeof FormData<"u"&&e instanceof FormData}class Ng{constructor(t,n,i,r){let l;if(this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function Aj(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,l=r):l=i,l&&(this.reportProgress=!!l.reportProgress,this.withCredentials=!!l.withCredentials,l.responseType&&(this.responseType=l.responseType),l.headers&&(this.headers=l.headers),l.context&&(this.context=l.context),l.params&&(this.params=l.params)),this.headers||(this.headers=new ac),this.context||(this.context=new Ij),this.params){const h=this.params.toString();if(0===h.length)this.urlWithParams=n;else{const f=n.indexOf("?");this.urlWithParams=n+(-1===f?"?":f<n.length-1?"&":"")+h}}else this.params=new uh,this.urlWithParams=n}serializeBody(){return null===this.body?null:OM(this.body)||NM(this.body)||FM(this.body)||function Mj(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof uh?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||FM(this.body)?null:NM(this.body)?this.body.type||null:OM(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof uh?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const n=t.method||this.method,i=t.url||this.url,r=t.responseType||this.responseType,l=void 0!==t.body?t.body:this.body,h=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,f=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let _=t.headers||this.headers,C=t.params||this.params;const A=t.context??this.context;return void 0!==t.setHeaders&&(_=Object.keys(t.setHeaders).reduce((R,F)=>R.set(F,t.setHeaders[F]),_)),t.setParams&&(C=Object.keys(t.setParams).reduce((R,F)=>R.set(F,t.setParams[F]),C)),new Ng(n,i,l,{params:C,headers:_,context:A,reportProgress:f,responseType:r,withCredentials:h})}}var Sp=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}(Sp||{});class vw{constructor(t,n=200,i="OK"){this.headers=t.headers||new ac,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||i,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class bw extends vw{constructor(t={}){super(t),this.type=Sp.ResponseHeader}clone(t={}){return new bw({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Tp extends vw{constructor(t={}){super(t),this.type=Sp.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new Tp({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class zM extends vw{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function xw(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}let BM=(()=>{class e{constructor(n){this.handler=n}request(n,i,r={}){let l;if(n instanceof Ng)l=n;else{let _,C;_=r.headers instanceof ac?r.headers:new ac(r.headers),r.params&&(C=r.params instanceof uh?r.params:new uh({fromObject:r.params})),l=new Ng(n,i,void 0!==r.body?r.body:null,{headers:_,context:r.context,params:C,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const h=Et(l).pipe(up(_=>this.handler.handle(_)));if(n instanceof Ng||"events"===r.observe)return h;const f=h.pipe(uu(_=>_ instanceof Tp));switch(r.observe||"body"){case"body":switch(l.responseType){case"arraybuffer":return f.pipe(pn(_=>{if(null!==_.body&&!(_.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return _.body}));case"blob":return f.pipe(pn(_=>{if(null!==_.body&&!(_.body instanceof Blob))throw new Error("Response is not a Blob.");return _.body}));case"text":return f.pipe(pn(_=>{if(null!==_.body&&"string"!=typeof _.body)throw new Error("Response is not a string.");return _.body}));default:return f.pipe(pn(_=>_.body))}case"response":return f;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(n,i={}){return this.request("DELETE",n,i)}get(n,i={}){return this.request("GET",n,i)}head(n,i={}){return this.request("HEAD",n,i)}jsonp(n,i){return this.request("JSONP",n,{params:(new uh).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,i={}){return this.request("OPTIONS",n,i)}patch(n,i,r={}){return this.request("PATCH",n,xw(r,i))}post(n,i,r={}){return this.request("POST",n,xw(r,i))}put(n,i,r={}){return this.request("PUT",n,xw(r,i))}static#e=this.\u0275fac=function(i){return new(i||e)(lt(Bv))};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac})}return e})();function jM(e,t){return t(e)}function Rj(e,t){return(n,i)=>t.intercept(n,{handle:r=>e(r,i)})}const kj=new ut(""),Fg=new ut(""),$M=new ut("");function Oj(){let e=null;return(t,n)=>{null===e&&(e=(tt(kj,{optional:!0})??[]).reduceRight(Rj,jM));const i=tt(b_),r=i.add();return e(t,n).pipe(yg(()=>i.remove(r)))}}let HM=(()=>{class e extends Bv{constructor(n,i){super(),this.backend=n,this.injector=i,this.chain=null,this.pendingTasks=tt(b_)}handle(n){if(null===this.chain){const r=Array.from(new Set([...this.injector.get(Fg),...this.injector.get($M,[])]));this.chain=r.reduceRight((l,h)=>function Lj(e,t,n){return(i,r)=>n.runInContext(()=>t(i,l=>e(l,r)))}(l,h,this.injector),jM)}const i=this.pendingTasks.add();return this.chain(n,r=>this.backend.handle(r)).pipe(yg(()=>this.pendingTasks.remove(i)))}static#e=this.\u0275fac=function(i){return new(i||e)(lt(Uv),lt(Wo))};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac})}return e})();const Bj=/^\)\]\}',?\n/;let GM=(()=>{class e{constructor(n){this.xhrFactory=n}handle(n){if("JSONP"===n.method)throw new Ie(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?It(i.\u0275loadImpl()):Et(null)).pipe(tr(()=>new pi(l=>{const h=i.build();if(h.open(n.method,n.urlWithParams),n.withCredentials&&(h.withCredentials=!0),n.headers.forEach((ee,me)=>h.setRequestHeader(ee,me.join(","))),n.headers.has("Accept")||h.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){const ee=n.detectContentTypeHeader();null!==ee&&h.setRequestHeader("Content-Type",ee)}if(n.responseType){const ee=n.responseType.toLowerCase();h.responseType="json"!==ee?ee:"text"}const f=n.serializeBody();let _=null;const C=()=>{if(null!==_)return _;const ee=h.statusText||"OK",me=new ac(h.getAllResponseHeaders()),ve=function Uj(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(h)||n.url;return _=new bw({headers:me,status:h.status,statusText:ee,url:ve}),_},A=()=>{let{headers:ee,status:me,statusText:ve,url:pe}=C(),Le=null;204!==me&&(Le=typeof h.response>"u"?h.responseText:h.response),0===me&&(me=Le?200:0);let qe=me>=200&&me<300;if("json"===n.responseType&&"string"==typeof Le){const at=Le;Le=Le.replace(Bj,"");try{Le=""!==Le?JSON.parse(Le):null}catch(xt){Le=at,qe&&(qe=!1,Le={error:xt,text:Le})}}qe?(l.next(new Tp({body:Le,headers:ee,status:me,statusText:ve,url:pe||void 0})),l.complete()):l.error(new zM({error:Le,headers:ee,status:me,statusText:ve,url:pe||void 0}))},R=ee=>{const{url:me}=C(),ve=new zM({error:ee,status:h.status||0,statusText:h.statusText||"Unknown Error",url:me||void 0});l.error(ve)};let F=!1;const $=ee=>{F||(l.next(C()),F=!0);let me={type:Sp.DownloadProgress,loaded:ee.loaded};ee.lengthComputable&&(me.total=ee.total),"text"===n.responseType&&h.responseText&&(me.partialText=h.responseText),l.next(me)},Q=ee=>{let me={type:Sp.UploadProgress,loaded:ee.loaded};ee.lengthComputable&&(me.total=ee.total),l.next(me)};return h.addEventListener("load",A),h.addEventListener("error",R),h.addEventListener("timeout",R),h.addEventListener("abort",R),n.reportProgress&&(h.addEventListener("progress",$),null!==f&&h.upload&&h.upload.addEventListener("progress",Q)),h.send(f),l.next({type:Sp.Sent}),()=>{h.removeEventListener("error",R),h.removeEventListener("abort",R),h.removeEventListener("load",A),h.removeEventListener("timeout",R),n.reportProgress&&(h.removeEventListener("progress",$),null!==f&&h.upload&&h.upload.removeEventListener("progress",Q)),h.readyState!==h.DONE&&h.abort()}})))}static#e=this.\u0275fac=function(i){return new(i||e)(lt(VD))};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac})}return e})();const ww=new ut("XSRF_ENABLED"),WM=new ut("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),ZM=new ut("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class KM{}let $j=(()=>{class e{constructor(n,i,r){this.doc=n,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=DD(n,this.cookieName),this.lastCookieString=n),this.lastToken}static#e=this.\u0275fac=function(i){return new(i||e)(lt(ys),lt(Yc),lt(WM))};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac})}return e})();function Hj(e,t){const n=e.url.toLowerCase();if(!tt(ww)||"GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t(e);const i=tt(KM).getToken(),r=tt(ZM);return null!=i&&!e.headers.has(r)&&(e=e.clone({headers:e.headers.set(r,i)})),t(e)}var hh=function(e){return e[e.Interceptors=0]="Interceptors",e[e.LegacyInterceptors=1]="LegacyInterceptors",e[e.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",e[e.NoXsrfProtection=3]="NoXsrfProtection",e[e.JsonpSupport=4]="JsonpSupport",e[e.RequestsMadeViaParent=5]="RequestsMadeViaParent",e[e.Fetch=6]="Fetch",e}(hh||{});function qj(...e){const t=[BM,GM,HM,{provide:Bv,useExisting:HM},{provide:Uv,useExisting:GM},{provide:Fg,useValue:Hj,multi:!0},{provide:ww,useValue:!0},{provide:KM,useClass:$j}];for(const n of e)t.push(...n.\u0275providers);return function P0(e){return{\u0275providers:e}}(t)}const XM=new ut("LEGACY_INTERCEPTOR_FN");function Gj(){return function Rd(e,t){return{\u0275kind:e,\u0275providers:t}}(hh.LegacyInterceptors,[{provide:XM,useFactory:Oj},{provide:Fg,useExisting:XM,multi:!0}])}let Wj=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=nr({type:e});static#n=this.\u0275inj=$i({providers:[qj(Gj())]})}return e})(),Jj=(()=>{class e{constructor(n){this.http=n,this.baseUrl="http://172.17.15.127:3000"}getNearestUsers(n,i,r){return this.http.get("https://p1glxc42a8.execute-api.us-east-1.amazonaws.com/dev/api/nearest-users",{params:{latitude:n,longitude:i,maxDistance:r}})}static#e=this.\u0275fac=function(i){return new(i||e)(lt(BM))};static#t=this.\u0275prov=ft({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const YM=["*"];let Fs=(()=>class e{static STARTS_WITH="startsWith";static CONTAINS="contains";static NOT_CONTAINS="notContains";static ENDS_WITH="endsWith";static EQUALS="equals";static NOT_EQUALS="notEquals";static IN="in";static LESS_THAN="lt";static LESS_THAN_OR_EQUAL_TO="lte";static GREATER_THAN="gt";static GREATER_THAN_OR_EQUAL_TO="gte";static BETWEEN="between";static IS="is";static IS_NOT="isNot";static BEFORE="before";static AFTER="after";static DATE_IS="dateIs";static DATE_IS_NOT="dateIsNot";static DATE_BEFORE="dateBefore";static DATE_AFTER="dateAfter"})(),QM=(()=>{class e{ripple=!1;inputStyle="outlined";overlayOptions={};filterMatchModeOptions={text:[Fs.STARTS_WITH,Fs.CONTAINS,Fs.NOT_CONTAINS,Fs.ENDS_WITH,Fs.EQUALS,Fs.NOT_EQUALS],numeric:[Fs.EQUALS,Fs.NOT_EQUALS,Fs.LESS_THAN,Fs.LESS_THAN_OR_EQUAL_TO,Fs.GREATER_THAN,Fs.GREATER_THAN_OR_EQUAL_TO],date:[Fs.DATE_IS,Fs.DATE_IS_NOT,Fs.DATE_BEFORE,Fs.DATE_AFTER]};translation={startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",is:"Is",isNot:"Is not",before:"Before",after:"After",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",pending:"Pending",fileSizeTypes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],chooseYear:"Choose Year",chooseMonth:"Choose Month",chooseDate:"Choose Date",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",prevHour:"Previous Hour",nextHour:"Next Hour",prevMinute:"Previous Minute",nextMinute:"Next Minute",prevSecond:"Previous Second",nextSecond:"Next Second",am:"am",pm:"pm",dateFormat:"mm/dd/yy",firstDayOfWeek:0,today:"Today",weekHeader:"Wk",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyMessage:"No results found",searchMessage:"{0} results are available",selectionMessage:"{0} items selected",emptySelectionMessage:"No selected item",emptySearchMessage:"No results found",emptyFilterMessage:"No results found",aria:{trueLabel:"True",falseLabel:"False",nullLabel:"Not Selected",star:"1 star",stars:"{star} stars",selectAll:"All items selected",unselectAll:"All items unselected",close:"Close",previous:"Previous",next:"Next",navigation:"Navigation",scrollTop:"Scroll Top",moveTop:"Move Top",moveUp:"Move Up",moveDown:"Move Down",moveBottom:"Move Bottom",moveToTarget:"Move to Target",moveToSource:"Move to Source",moveAllToTarget:"Move All to Target",moveAllToSource:"Move All to Source",pageLabel:"{page}",firstPageLabel:"First Page",lastPageLabel:"Last Page",nextPageLabel:"Next Page",prevPageLabel:"Previous Page",rowsPerPageLabel:"Rows per page",previousPageLabel:"Previous Page",jumpToPageDropdownLabel:"Jump to Page Dropdown",jumpToPageInputLabel:"Jump to Page Input",selectRow:"Row Selected",unselectRow:"Row Unselected",expandRow:"Row Expanded",collapseRow:"Row Collapsed",showFilterMenu:"Show Filter Menu",hideFilterMenu:"Hide Filter Menu",filterOperator:"Filter Operator",filterConstraint:"Filter Constraint",editRow:"Row Edit",saveEdit:"Save Edit",cancelEdit:"Cancel Edit",listView:"List View",gridView:"Grid View",slide:"Slide",slideNumber:"{slideNumber}",zoomImage:"Zoom Image",zoomIn:"Zoom In",zoomOut:"Zoom Out",rotateRight:"Rotate Right",rotateLeft:"Rotate Left"}};zIndex={modal:1100,overlay:1e3,menu:1e3,tooltip:1100};translationSource=new er;translationObserver=this.translationSource.asObservable();getTranslation(n){return this.translation[n]}setTranslation(n){this.translation={...this.translation,...n},this.translationSource.next(this.translation)}static \u0275fac=function(i){return new(i||e)};static \u0275prov=ft({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),t$=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Er({type:e,selectors:[["p-header"]],ngContentSelectors:YM,decls:1,vars:0,template:function(i,r){1&i&&(Wm(),cd(0))},encapsulation:2})}return e})(),n$=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Er({type:e,selectors:[["p-footer"]],ngContentSelectors:YM,decls:1,vars:0,template:function(i,r){1&i&&(Wm(),cd(0))},encapsulation:2})}return e})(),i$=(()=>{class e{template;type;name;constructor(n){this.template=n}getType(){return this.name}static \u0275fac=function(i){return new(i||e)(pt(tc))};static \u0275dir=Hi({type:e,selectors:[["","pTemplate",""]],inputs:{type:"type",name:["pTemplate","name"]}})}return e})(),$v=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=nr({type:e});static \u0275inj=$i({imports:[yd]})}return e})(),fn=(()=>{class e{static zindex=1e3;static calculatedScrollbarWidth=null;static calculatedScrollbarHeight=null;static browser;static addClass(n,i){n&&i&&(n.classList?n.classList.add(i):n.className+=" "+i)}static addMultipleClasses(n,i){if(n&&i)if(n.classList){let r=i.trim().split(" ");for(let l=0;l<r.length;l++)n.classList.add(r[l])}else{let r=i.split(" ");for(let l=0;l<r.length;l++)n.className+=" "+r[l]}}static removeClass(n,i){n&&i&&(n.classList?n.classList.remove(i):n.className=n.className.replace(new RegExp("(^|\\b)"+i.split(" ").join("|")+"(\\b|$)","gi")," "))}static removeMultipleClasses(n,i){n&&i&&[i].flat().filter(Boolean).forEach(r=>r.split(" ").forEach(l=>this.removeClass(n,l)))}static hasClass(n,i){return!(!n||!i)&&(n.classList?n.classList.contains(i):new RegExp("(^| )"+i+"( |$)","gi").test(n.className))}static siblings(n){return Array.prototype.filter.call(n.parentNode.children,function(i){return i!==n})}static find(n,i){return Array.from(n.querySelectorAll(i))}static findSingle(n,i){return this.isElement(n)?n.querySelector(i):null}static index(n){let i=n.parentNode.childNodes,r=0;for(var l=0;l<i.length;l++){if(i[l]==n)return r;1==i[l].nodeType&&r++}return-1}static indexWithinGroup(n,i){let r=n.parentNode?n.parentNode.childNodes:[],l=0;for(var h=0;h<r.length;h++){if(r[h]==n)return l;r[h].attributes&&r[h].attributes[i]&&1==r[h].nodeType&&l++}return-1}static appendOverlay(n,i,r="self"){"self"!==r&&n&&i&&this.appendChild(n,i)}static alignOverlay(n,i,r="self",l=!0){n&&i&&(l&&(n.style.minWidth=`${e.getOuterWidth(i)}px`),"self"===r?this.relativePosition(n,i):this.absolutePosition(n,i))}static relativePosition(n,i){const r=ve=>{if(ve)return"relative"===getComputedStyle(ve).getPropertyValue("position")?ve:r(ve.parentElement)},l=n.offsetParent?{width:n.offsetWidth,height:n.offsetHeight}:this.getHiddenElementDimensions(n),h=i.offsetHeight,f=i.getBoundingClientRect(),_=this.getWindowScrollTop(),C=this.getWindowScrollLeft(),A=this.getViewport(),F=r(n)?.getBoundingClientRect()||{top:-1*_,left:-1*C};let $,Q;f.top+h+l.height>A.height?($=f.top-F.top-l.height,n.style.transformOrigin="bottom",f.top+$<0&&($=-1*f.top)):($=h+f.top-F.top,n.style.transformOrigin="top");const ee=f.left+l.width-A.width;Q=l.width>A.width?-1*(f.left-F.left):ee>0?f.left-F.left-ee:f.left-F.left,n.style.top=$+"px",n.style.left=Q+"px"}static absolutePosition(n,i){const r=n.offsetParent?{width:n.offsetWidth,height:n.offsetHeight}:this.getHiddenElementDimensions(n),l=r.height,h=r.width,f=i.offsetHeight,_=i.offsetWidth,C=i.getBoundingClientRect(),A=this.getWindowScrollTop(),R=this.getWindowScrollLeft(),F=this.getViewport();let $,Q;C.top+f+l>F.height?($=C.top+A-l,n.style.transformOrigin="bottom",$<0&&($=A)):($=f+C.top+A,n.style.transformOrigin="top"),Q=C.left+h>F.width?Math.max(0,C.left+R+_-h):C.left+R,n.style.top=$+"px",n.style.left=Q+"px"}static getParents(n,i=[]){return null===n.parentNode?i:this.getParents(n.parentNode,i.concat([n.parentNode]))}static getScrollableParents(n){let i=[];if(n){let r=this.getParents(n);const l=/(auto|scroll)/,h=f=>{let _=window.getComputedStyle(f,null);return l.test(_.getPropertyValue("overflow"))||l.test(_.getPropertyValue("overflowX"))||l.test(_.getPropertyValue("overflowY"))};for(let f of r){let _=1===f.nodeType&&f.dataset.scrollselectors;if(_){let C=_.split(",");for(let A of C){let R=this.findSingle(f,A);R&&h(R)&&i.push(R)}}9!==f.nodeType&&h(f)&&i.push(f)}}return i}static getHiddenElementOuterHeight(n){n.style.visibility="hidden",n.style.display="block";let i=n.offsetHeight;return n.style.display="none",n.style.visibility="visible",i}static getHiddenElementOuterWidth(n){n.style.visibility="hidden",n.style.display="block";let i=n.offsetWidth;return n.style.display="none",n.style.visibility="visible",i}static getHiddenElementDimensions(n){let i={};return n.style.visibility="hidden",n.style.display="block",i.width=n.offsetWidth,i.height=n.offsetHeight,n.style.display="none",n.style.visibility="visible",i}static scrollInView(n,i){let r=getComputedStyle(n).getPropertyValue("borderTopWidth"),l=r?parseFloat(r):0,h=getComputedStyle(n).getPropertyValue("paddingTop"),f=h?parseFloat(h):0,_=n.getBoundingClientRect(),A=i.getBoundingClientRect().top+document.body.scrollTop-(_.top+document.body.scrollTop)-l-f,R=n.scrollTop,F=n.clientHeight,$=this.getOuterHeight(i);A<0?n.scrollTop=R+A:A+$>F&&(n.scrollTop=R+A-F+$)}static fadeIn(n,i){n.style.opacity=0;let r=+new Date,l=0,h=function(){l=+n.style.opacity.replace(",",".")+((new Date).getTime()-r)/i,n.style.opacity=l,r=+new Date,+l<1&&(window.requestAnimationFrame&&requestAnimationFrame(h)||setTimeout(h,16))};h()}static fadeOut(n,i){var r=1,f=50/i;let _=setInterval(()=>{(r-=f)<=0&&(r=0,clearInterval(_)),n.style.opacity=r},50)}static getWindowScrollTop(){let n=document.documentElement;return(window.pageYOffset||n.scrollTop)-(n.clientTop||0)}static getWindowScrollLeft(){let n=document.documentElement;return(window.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}static matches(n,i){var r=Element.prototype;return(r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||function(h){return-1!==[].indexOf.call(document.querySelectorAll(h),this)}).call(n,i)}static getOuterWidth(n,i){let r=n.offsetWidth;if(i){let l=getComputedStyle(n);r+=parseFloat(l.marginLeft)+parseFloat(l.marginRight)}return r}static getHorizontalPadding(n){let i=getComputedStyle(n);return parseFloat(i.paddingLeft)+parseFloat(i.paddingRight)}static getHorizontalMargin(n){let i=getComputedStyle(n);return parseFloat(i.marginLeft)+parseFloat(i.marginRight)}static innerWidth(n){let i=n.offsetWidth,r=getComputedStyle(n);return i+=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),i}static width(n){let i=n.offsetWidth,r=getComputedStyle(n);return i-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),i}static getInnerHeight(n){let i=n.offsetHeight,r=getComputedStyle(n);return i+=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom),i}static getOuterHeight(n,i){let r=n.offsetHeight;if(i){let l=getComputedStyle(n);r+=parseFloat(l.marginTop)+parseFloat(l.marginBottom)}return r}static getHeight(n){let i=n.offsetHeight,r=getComputedStyle(n);return i-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)+parseFloat(r.borderTopWidth)+parseFloat(r.borderBottomWidth),i}static getWidth(n){let i=n.offsetWidth,r=getComputedStyle(n);return i-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)+parseFloat(r.borderLeftWidth)+parseFloat(r.borderRightWidth),i}static getViewport(){let n=window,i=document,r=i.documentElement,l=i.getElementsByTagName("body")[0];return{width:n.innerWidth||r.clientWidth||l.clientWidth,height:n.innerHeight||r.clientHeight||l.clientHeight}}static getOffset(n){var i=n.getBoundingClientRect();return{top:i.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:i.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0)}}static replaceElementWith(n,i){let r=n.parentNode;if(!r)throw"Can't replace element";return r.replaceChild(i,n)}static getUserAgent(){if(navigator&&this.isClient())return navigator.userAgent}static isIE(){var n=window.navigator.userAgent;return n.indexOf("MSIE ")>0||(n.indexOf("Trident/")>0?(n.indexOf("rv:"),!0):n.indexOf("Edge/")>0)}static isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}static isAndroid(){return/(android)/i.test(navigator.userAgent)}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}static appendChild(n,i){if(this.isElement(i))i.appendChild(n);else{if(!(i&&i.el&&i.el.nativeElement))throw"Cannot append "+i+" to "+n;i.el.nativeElement.appendChild(n)}}static removeChild(n,i){if(this.isElement(i))i.removeChild(n);else{if(!i.el||!i.el.nativeElement)throw"Cannot remove "+n+" from "+i;i.el.nativeElement.removeChild(n)}}static removeElement(n){"remove"in Element.prototype?n.remove():n.parentNode.removeChild(n)}static isElement(n){return"object"==typeof HTMLElement?n instanceof HTMLElement:n&&"object"==typeof n&&null!==n&&1===n.nodeType&&"string"==typeof n.nodeName}static calculateScrollbarWidth(n){if(n){let i=getComputedStyle(n);return n.offsetWidth-n.clientWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.borderRightWidth)}{if(null!==this.calculatedScrollbarWidth)return this.calculatedScrollbarWidth;let i=document.createElement("div");i.className="p-scrollbar-measure",document.body.appendChild(i);let r=i.offsetWidth-i.clientWidth;return document.body.removeChild(i),this.calculatedScrollbarWidth=r,r}}static calculateScrollbarHeight(){if(null!==this.calculatedScrollbarHeight)return this.calculatedScrollbarHeight;let n=document.createElement("div");n.className="p-scrollbar-measure",document.body.appendChild(n);let i=n.offsetHeight-n.clientHeight;return document.body.removeChild(n),this.calculatedScrollbarWidth=i,i}static invokeElementMethod(n,i,r){n[i].apply(n,r)}static clearSelection(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().rangeCount>0&&window.getSelection().getRangeAt(0).getClientRects().length>0&&window.getSelection().removeAllRanges();else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch{}}static getBrowser(){if(!this.browser){let n=this.resolveUserAgent();this.browser={},n.browser&&(this.browser[n.browser]=!0,this.browser.version=n.version),this.browser.chrome?this.browser.webkit=!0:this.browser.webkit&&(this.browser.safari=!0)}return this.browser}static resolveUserAgent(){let n=navigator.userAgent.toLowerCase(),i=/(chrome)[ \/]([\w.]+)/.exec(n)||/(webkit)[ \/]([\w.]+)/.exec(n)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(n)||/(msie) ([\w.]+)/.exec(n)||n.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(n)||[];return{browser:i[1]||"",version:i[2]||"0"}}static isInteger(n){return Number.isInteger?Number.isInteger(n):"number"==typeof n&&isFinite(n)&&Math.floor(n)===n}static isHidden(n){return!n||null===n.offsetParent}static isVisible(n){return n&&null!=n.offsetParent}static isExist(n){return null!==n&&typeof n<"u"&&n.nodeName&&n.parentNode}static focus(n,i){n&&document.activeElement!==n&&n.focus(i)}static getFocusableElements(n,i=""){let r=this.find(n,`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${i},\n                [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${i},\n                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${i},\n                select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${i},\n                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${i},\n                [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${i},\n                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${i}`),l=[];for(let h of r)"none"!=getComputedStyle(h).display&&"hidden"!=getComputedStyle(h).visibility&&l.push(h);return l}static getFirstFocusableElement(n,i){const r=this.getFocusableElements(n,i);return r.length>0?r[0]:null}static getLastFocusableElement(n,i){const r=this.getFocusableElements(n,i);return r.length>0?r[r.length-1]:null}static getNextFocusableElement(n,i=!1){const r=e.getFocusableElements(n);let l=0;if(r&&r.length>0){const h=r.indexOf(r[0].ownerDocument.activeElement);i?l=-1==h||0===h?r.length-1:h-1:-1!=h&&h!==r.length-1&&(l=h+1)}return r[l]}static generateZIndex(){return this.zindex=this.zindex||999,++this.zindex}static getSelection(){return window.getSelection?window.getSelection().toString():document.getSelection?document.getSelection().toString():document.selection?document.selection.createRange().text:null}static getTargetElement(n,i){if(!n)return null;switch(n){case"document":return document;case"window":return window;case"@next":return i?.nextElementSibling;case"@prev":return i?.previousElementSibling;case"@parent":return i?.parentElement;case"@grandparent":return i?.parentElement.parentElement;default:const r=typeof n;if("string"===r)return document.querySelector(n);if("object"===r&&n.hasOwnProperty("nativeElement"))return this.isExist(n.nativeElement)?n.nativeElement:void 0;const h=(f=n)&&f.constructor&&f.call&&f.apply?n():n;return h&&9===h.nodeType||this.isExist(h)?h:null}var f}static isClient(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}static getAttribute(n,i){if(n){const r=n.getAttribute(i);return isNaN(r)?"true"===r||"false"===r?"true"===r:r:+r}}static calculateBodyScrollbarWidth(){return window.innerWidth-document.documentElement.offsetWidth}static blockBodyScroll(n="p-overflow-hidden"){document.body.style.setProperty("--scrollbar-width",this.calculateBodyScrollbarWidth()+"px"),this.addClass(document.body,n)}static unblockBodyScroll(n="p-overflow-hidden"){document.body.style.removeProperty("--scrollbar-width"),this.removeClass(document.body,n)}}return e})(),r$=(()=>{class e{el;pFocusTrapDisabled=!1;constructor(n){this.el=n}onkeydown(n){if(!0!==this.pFocusTrapDisabled){n.preventDefault();const i=fn.getNextFocusableElement(this.el.nativeElement,n.shiftKey);i&&(i.focus(),i.select?.())}}static \u0275fac=function(i){return new(i||e)(pt(hl))};static \u0275dir=Hi({type:e,selectors:[["","pFocusTrap",""]],hostAttrs:[1,"p-element"],hostBindings:function(i,r){1&i&&Ca("keydown.tab",function(h){return r.onkeydown(h)})("keydown.shift.tab",function(h){return r.onkeydown(h)})},inputs:{pFocusTrapDisabled:"pFocusTrapDisabled"}})}return e})(),s$=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=nr({type:e});static \u0275inj=$i({imports:[yd]})}return e})();class Cw{static equals(t,n,i){return i?this.resolveFieldData(t,i)===this.resolveFieldData(n,i):this.equalsByValue(t,n)}static equalsByValue(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){var l,h,f,i=Array.isArray(t),r=Array.isArray(n);if(i&&r){if((h=t.length)!=n.length)return!1;for(l=h;0!=l--;)if(!this.equalsByValue(t[l],n[l]))return!1;return!0}if(i!=r)return!1;var _=this.isDate(t),C=this.isDate(n);if(_!=C)return!1;if(_&&C)return t.getTime()==n.getTime();var A=t instanceof RegExp,R=n instanceof RegExp;if(A!=R)return!1;if(A&&R)return t.toString()==n.toString();var F=Object.keys(t);if((h=F.length)!==Object.keys(n).length)return!1;for(l=h;0!=l--;)if(!Object.prototype.hasOwnProperty.call(n,F[l]))return!1;for(l=h;0!=l--;)if(!this.equalsByValue(t[f=F[l]],n[f]))return!1;return!0}return t!=t&&n!=n}static resolveFieldData(t,n){if(t&&n){if(this.isFunction(n))return n(t);if(-1==n.indexOf("."))return t[n];{let i=n.split("."),r=t;for(let l=0,h=i.length;l<h;++l){if(null==r)return null;r=r[i[l]]}return r}}return null}static isFunction(t){return!!(t&&t.constructor&&t.call&&t.apply)}static reorderArray(t,n,i){t&&n!==i&&(i>=t.length&&(i%=t.length,n%=t.length),t.splice(i,0,t.splice(n,1)[0]))}static insertIntoOrderedArray(t,n,i,r){if(i.length>0){let l=!1;for(let h=0;h<i.length;h++)if(this.findIndexInList(i[h],r)>n){i.splice(h,0,t),l=!0;break}l||i.push(t)}else i.push(t)}static findIndexInList(t,n){let i=-1;if(n)for(let r=0;r<n.length;r++)if(n[r]==t){i=r;break}return i}static contains(t,n){if(null!=t&&n&&n.length)for(let i of n)if(this.equals(t,i))return!0;return!1}static removeAccents(t){return t&&t.search(/[\xC0-\xFF]/g)>-1&&(t=t.replace(/[\xC0-\xC5]/g,"A").replace(/[\xC6]/g,"AE").replace(/[\xC7]/g,"C").replace(/[\xC8-\xCB]/g,"E").replace(/[\xCC-\xCF]/g,"I").replace(/[\xD0]/g,"D").replace(/[\xD1]/g,"N").replace(/[\xD2-\xD6\xD8]/g,"O").replace(/[\xD9-\xDC]/g,"U").replace(/[\xDD]/g,"Y").replace(/[\xDE]/g,"P").replace(/[\xE0-\xE5]/g,"a").replace(/[\xE6]/g,"ae").replace(/[\xE7]/g,"c").replace(/[\xE8-\xEB]/g,"e").replace(/[\xEC-\xEF]/g,"i").replace(/[\xF1]/g,"n").replace(/[\xF2-\xF6\xF8]/g,"o").replace(/[\xF9-\xFC]/g,"u").replace(/[\xFE]/g,"p").replace(/[\xFD\xFF]/g,"y")),t}static isDate(t){return"[object Date]"===Object.prototype.toString.call(t)}static isEmpty(t){return null==t||""===t||Array.isArray(t)&&0===t.length||!this.isDate(t)&&"object"==typeof t&&0===Object.keys(t).length}static isNotEmpty(t){return!this.isEmpty(t)}static compare(t,n,i,r=1){let l=-1;const h=this.isEmpty(t),f=this.isEmpty(n);return l=h&&f?0:h?r:f?-r:"string"==typeof t&&"string"==typeof n?t.localeCompare(n,i,{numeric:!0}):t<n?-1:t>n?1:0,l}static sort(t,n,i=1,r,l=1){return(1===l?i:l)*Cw.compare(t,n,r,i)}static merge(t,n){if(null!=t||null!=n)return null!=t&&"object"!=typeof t||null!=n&&"object"!=typeof n?null!=t&&"string"!=typeof t||null!=n&&"string"!=typeof n?n||t:[t||"",n||""].join(" "):{...t||{},...n||{}}}static isPrintableCharacter(t=""){return this.isNotEmpty(t)&&1===t.length&&t.match(/\S| /)}static getItemValue(t,...n){return this.isFunction(t)?t(...n):t}static findLastIndex(t,n){let i=-1;if(this.isNotEmpty(t))try{i=t.findLastIndex(n)}catch{i=t.lastIndexOf([...t].reverse().find(n))}return i}static findLast(t,n){let i;if(this.isNotEmpty(t))try{i=t.findLast(n)}catch{i=[...t].reverse().find(n)}return i}}var JM=0;function zg(e="pn_id_"){return`${e}${++JM}`}var eP=function o$(){let e=[];const r=l=>l&&parseInt(l.style.zIndex,10)||0;return{get:r,set:(l,h,f)=>{h&&(h.style.zIndex=String(((l,h)=>{let f=e.length>0?e[e.length-1]:{key:l,value:h},_=f.value+(f.key===l?0:h)+2;return e.push({key:l,value:_}),_})(l,f)))},clear:l=>{l&&((l=>{e=e.filter(h=>h.value!==l)})(r(l)),l.style.zIndex="")},getCurrent:()=>e.length>0?e[e.length-1].value:0}}();const a$=["*"];let Hv=(()=>{class e{label;spin=!1;styleClass;role;ariaLabel;ariaHidden;ngOnInit(){this.getAttributes()}getAttributes(){const n=Cw.isEmpty(this.label);this.role=n?void 0:"img",this.ariaLabel=n?void 0:this.label,this.ariaHidden=n}getClassNames(){return`p-icon ${this.styleClass?this.styleClass+" ":""}${this.spin?"p-icon-spin":""}`}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Er({type:e,selectors:[["ng-component"]],hostAttrs:[1,"p-element","p-icon-wrapper"],inputs:{label:"label",spin:"spin",styleClass:"styleClass"},standalone:!0,features:[fd],ngContentSelectors:a$,decls:1,vars:0,template:function(i,r){1&i&&(Wm(),cd(0))},encapsulation:2,changeDetection:0})}return e})(),tP=(()=>{class e extends Hv{static \u0275fac=function(){let n;return function(r){return(n||(n=Bc(e)))(r||e)}}();static \u0275cmp=Er({type:e,selectors:[["TimesIcon"]],standalone:!0,features:[qf,fd],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M8.01186 7.00933L12.27 2.75116C12.341 2.68501 12.398 2.60524 12.4375 2.51661C12.4769 2.42798 12.4982 2.3323 12.4999 2.23529C12.5016 2.13827 12.4838 2.0419 12.4474 1.95194C12.4111 1.86197 12.357 1.78024 12.2884 1.71163C12.2198 1.64302 12.138 1.58893 12.0481 1.55259C11.9581 1.51625 11.8617 1.4984 11.7647 1.50011C11.6677 1.50182 11.572 1.52306 11.4834 1.56255C11.3948 1.60204 11.315 1.65898 11.2488 1.72997L6.99067 5.98814L2.7325 1.72997C2.59553 1.60234 2.41437 1.53286 2.22718 1.53616C2.03999 1.53946 1.8614 1.61529 1.72901 1.74767C1.59663 1.88006 1.5208 2.05865 1.5175 2.24584C1.5142 2.43303 1.58368 2.61419 1.71131 2.75116L5.96948 7.00933L1.71131 11.2675C1.576 11.403 1.5 11.5866 1.5 11.7781C1.5 11.9696 1.576 12.1532 1.71131 12.2887C1.84679 12.424 2.03043 12.5 2.2219 12.5C2.41338 12.5 2.59702 12.424 2.7325 12.2887L6.99067 8.03052L11.2488 12.2887C11.3843 12.424 11.568 12.5 11.7594 12.5C11.9509 12.5 12.1346 12.424 12.27 12.2887C12.4053 12.1532 12.4813 11.9696 12.4813 11.7781C12.4813 11.5866 12.4053 11.403 12.27 11.2675L8.01186 7.00933Z","fill","currentColor"]],template:function(i,r){1&i&&(Oc(),bn(0,"svg",0),Wr(1,"path",1),Mn()),2&i&&(Yu(r.getClassNames()),wa("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})}return e})(),nP=(()=>{class e extends Hv{pathId;ngOnInit(){this.pathId="url(#"+zg()+")"}static \u0275fac=function(){let n;return function(r){return(n||(n=Bc(e)))(r||e)}}();static \u0275cmp=Er({type:e,selectors:[["WindowMaximizeIcon"]],standalone:!0,features:[qf,fd],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M7 14H11.8C12.3835 14 12.9431 13.7682 13.3556 13.3556C13.7682 12.9431 14 12.3835 14 11.8V2.2C14 1.61652 13.7682 1.05694 13.3556 0.644365C12.9431 0.231785 12.3835 0 11.8 0H2.2C1.61652 0 1.05694 0.231785 0.644365 0.644365C0.231785 1.05694 0 1.61652 0 2.2V7C0 7.15913 0.063214 7.31174 0.175736 7.42426C0.288258 7.53679 0.44087 7.6 0.6 7.6C0.75913 7.6 0.911742 7.53679 1.02426 7.42426C1.13679 7.31174 1.2 7.15913 1.2 7V2.2C1.2 1.93478 1.30536 1.68043 1.49289 1.49289C1.68043 1.30536 1.93478 1.2 2.2 1.2H11.8C12.0652 1.2 12.3196 1.30536 12.5071 1.49289C12.6946 1.68043 12.8 1.93478 12.8 2.2V11.8C12.8 12.0652 12.6946 12.3196 12.5071 12.5071C12.3196 12.6946 12.0652 12.8 11.8 12.8H7C6.84087 12.8 6.68826 12.8632 6.57574 12.9757C6.46321 13.0883 6.4 13.2409 6.4 13.4C6.4 13.5591 6.46321 13.7117 6.57574 13.8243C6.68826 13.9368 6.84087 14 7 14ZM9.77805 7.42192C9.89013 7.534 10.0415 7.59788 10.2 7.59995C10.3585 7.59788 10.5099 7.534 10.622 7.42192C10.7341 7.30985 10.798 7.15844 10.8 6.99995V3.94242C10.8066 3.90505 10.8096 3.86689 10.8089 3.82843C10.8079 3.77159 10.7988 3.7157 10.7824 3.6623C10.756 3.55552 10.701 3.45698 10.622 3.37798C10.5099 3.2659 10.3585 3.20202 10.2 3.19995H7.00002C6.84089 3.19995 6.68828 3.26317 6.57576 3.37569C6.46324 3.48821 6.40002 3.64082 6.40002 3.79995C6.40002 3.95908 6.46324 4.11169 6.57576 4.22422C6.68828 4.33674 6.84089 4.39995 7.00002 4.39995H8.80006L6.19997 7.00005C6.10158 7.11005 6.04718 7.25246 6.04718 7.40005C6.04718 7.54763 6.10158 7.69004 6.19997 7.80005C6.30202 7.91645 6.44561 7.98824 6.59997 8.00005C6.75432 7.98824 6.89791 7.91645 6.99997 7.80005L9.60002 5.26841V6.99995C9.6021 7.15844 9.66598 7.30985 9.77805 7.42192ZM1.4 14H3.8C4.17066 13.9979 4.52553 13.8498 4.78763 13.5877C5.04973 13.3256 5.1979 12.9707 5.2 12.6V10.2C5.1979 9.82939 5.04973 9.47452 4.78763 9.21242C4.52553 8.95032 4.17066 8.80215 3.8 8.80005H1.4C1.02934 8.80215 0.674468 8.95032 0.412371 9.21242C0.150274 9.47452 0.00210008 9.82939 0 10.2V12.6C0.00210008 12.9707 0.150274 13.3256 0.412371 13.5877C0.674468 13.8498 1.02934 13.9979 1.4 14ZM1.25858 10.0586C1.29609 10.0211 1.34696 10 1.4 10H3.8C3.85304 10 3.90391 10.0211 3.94142 10.0586C3.97893 10.0961 4 10.147 4 10.2V12.6C4 12.6531 3.97893 12.704 3.94142 12.7415C3.90391 12.779 3.85304 12.8 3.8 12.8H1.4C1.34696 12.8 1.29609 12.779 1.25858 12.7415C1.22107 12.704 1.2 12.6531 1.2 12.6V10.2C1.2 10.147 1.22107 10.0961 1.25858 10.0586Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){1&i&&(Oc(),bn(0,"svg",0)(1,"g"),Wr(2,"path",1),Mn(),bn(3,"defs")(4,"clipPath",2),Wr(5,"rect",3),Mn()()()),2&i&&(Yu(r.getClassNames()),wa("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),Kt(1),wa("clip-path",r.pathId),Kt(3),$t("id",r.pathId))},encapsulation:2})}return e})(),iP=(()=>{class e extends Hv{pathId;ngOnInit(){this.pathId="url(#"+zg()+")"}static \u0275fac=function(){let n;return function(r){return(n||(n=Bc(e)))(r||e)}}();static \u0275cmp=Er({type:e,selectors:[["WindowMinimizeIcon"]],standalone:!0,features:[qf,fd],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M11.8 0H2.2C1.61652 0 1.05694 0.231785 0.644365 0.644365C0.231785 1.05694 0 1.61652 0 2.2V7C0 7.15913 0.063214 7.31174 0.175736 7.42426C0.288258 7.53679 0.44087 7.6 0.6 7.6C0.75913 7.6 0.911742 7.53679 1.02426 7.42426C1.13679 7.31174 1.2 7.15913 1.2 7V2.2C1.2 1.93478 1.30536 1.68043 1.49289 1.49289C1.68043 1.30536 1.93478 1.2 2.2 1.2H11.8C12.0652 1.2 12.3196 1.30536 12.5071 1.49289C12.6946 1.68043 12.8 1.93478 12.8 2.2V11.8C12.8 12.0652 12.6946 12.3196 12.5071 12.5071C12.3196 12.6946 12.0652 12.8 11.8 12.8H7C6.84087 12.8 6.68826 12.8632 6.57574 12.9757C6.46321 13.0883 6.4 13.2409 6.4 13.4C6.4 13.5591 6.46321 13.7117 6.57574 13.8243C6.68826 13.9368 6.84087 14 7 14H11.8C12.3835 14 12.9431 13.7682 13.3556 13.3556C13.7682 12.9431 14 12.3835 14 11.8V2.2C14 1.61652 13.7682 1.05694 13.3556 0.644365C12.9431 0.231785 12.3835 0 11.8 0ZM6.368 7.952C6.44137 7.98326 6.52025 7.99958 6.6 8H9.8C9.95913 8 10.1117 7.93678 10.2243 7.82426C10.3368 7.71174 10.4 7.55913 10.4 7.4C10.4 7.24087 10.3368 7.08826 10.2243 6.97574C10.1117 6.86321 9.95913 6.8 9.8 6.8H8.048L10.624 4.224C10.73 4.11026 10.7877 3.95982 10.7849 3.80438C10.7822 3.64894 10.7192 3.50063 10.6093 3.3907C10.4994 3.28077 10.3511 3.2178 10.1956 3.21506C10.0402 3.21232 9.88974 3.27002 9.776 3.376L7.2 5.952V4.2C7.2 4.04087 7.13679 3.88826 7.02426 3.77574C6.91174 3.66321 6.75913 3.6 6.6 3.6C6.44087 3.6 6.28826 3.66321 6.17574 3.77574C6.06321 3.88826 6 4.04087 6 4.2V7.4C6.00042 7.47975 6.01674 7.55862 6.048 7.632C6.07656 7.70442 6.11971 7.7702 6.17475 7.82524C6.2298 7.88029 6.29558 7.92344 6.368 7.952ZM1.4 8.80005H3.8C4.17066 8.80215 4.52553 8.95032 4.78763 9.21242C5.04973 9.47452 5.1979 9.82939 5.2 10.2V12.6C5.1979 12.9707 5.04973 13.3256 4.78763 13.5877C4.52553 13.8498 4.17066 13.9979 3.8 14H1.4C1.02934 13.9979 0.674468 13.8498 0.412371 13.5877C0.150274 13.3256 0.00210008 12.9707 0 12.6V10.2C0.00210008 9.82939 0.150274 9.47452 0.412371 9.21242C0.674468 8.95032 1.02934 8.80215 1.4 8.80005ZM3.94142 12.7415C3.97893 12.704 4 12.6531 4 12.6V10.2C4 10.147 3.97893 10.0961 3.94142 10.0586C3.90391 10.0211 3.85304 10 3.8 10H1.4C1.34696 10 1.29609 10.0211 1.25858 10.0586C1.22107 10.0961 1.2 10.147 1.2 10.2V12.6C1.2 12.6531 1.22107 12.704 1.25858 12.7415C1.29609 12.779 1.34696 12.8 1.4 12.8H3.8C3.85304 12.8 3.90391 12.779 3.94142 12.7415Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){1&i&&(Oc(),bn(0,"svg",0)(1,"g"),Wr(2,"path",1),Mn(),bn(3,"defs")(4,"clipPath",2),Wr(5,"rect",3),Mn()()()),2&i&&(Yu(r.getClassNames()),wa("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),Kt(1),wa("clip-path",r.pathId),Kt(3),$t("id",r.pathId))},encapsulation:2})}return e})(),l$=(()=>{class e{document;platformId;renderer;el;zone;config;constructor(n,i,r,l,h,f){this.document=n,this.platformId=i,this.renderer=r,this.el=l,this.zone=h,this.config=f}animationListener;mouseDownListener;timeout;ngAfterViewInit(){BD(this.platformId)&&this.config&&this.config.ripple&&this.zone.runOutsideAngular(()=>{this.create(),this.mouseDownListener=this.renderer.listen(this.el.nativeElement,"mousedown",this.onMouseDown.bind(this))})}onMouseDown(n){let i=this.getInk();if(!i||"none"===this.document.defaultView?.getComputedStyle(i,null).display)return;if(fn.removeClass(i,"p-ink-active"),!fn.getHeight(i)&&!fn.getWidth(i)){let f=Math.max(fn.getOuterWidth(this.el.nativeElement),fn.getOuterHeight(this.el.nativeElement));i.style.height=f+"px",i.style.width=f+"px"}let r=fn.getOffset(this.el.nativeElement),l=n.pageX-r.left+this.document.body.scrollTop-fn.getWidth(i)/2,h=n.pageY-r.top+this.document.body.scrollLeft-fn.getHeight(i)/2;this.renderer.setStyle(i,"top",h+"px"),this.renderer.setStyle(i,"left",l+"px"),fn.addClass(i,"p-ink-active"),this.timeout=setTimeout(()=>{let f=this.getInk();f&&fn.removeClass(f,"p-ink-active")},401)}getInk(){const n=this.el.nativeElement.children;for(let i=0;i<n.length;i++)if("string"==typeof n[i].className&&-1!==n[i].className.indexOf("p-ink"))return n[i];return null}resetInk(){let n=this.getInk();n&&fn.removeClass(n,"p-ink-active")}onAnimationEnd(n){this.timeout&&clearTimeout(this.timeout),fn.removeClass(n.currentTarget,"p-ink-active")}create(){let n=this.renderer.createElement("span");this.renderer.addClass(n,"p-ink"),this.renderer.appendChild(this.el.nativeElement,n),this.renderer.setAttribute(n,"aria-hidden","true"),this.renderer.setAttribute(n,"role","presentation"),this.animationListener||(this.animationListener=this.renderer.listen(n,"animationend",this.onAnimationEnd.bind(this)))}remove(){let n=this.getInk();n&&(this.mouseDownListener&&this.mouseDownListener(),this.animationListener&&this.animationListener(),this.mouseDownListener=null,this.animationListener=null,fn.removeElement(n))}ngOnDestroy(){this.config&&this.config.ripple&&this.remove()}static \u0275fac=function(i){return new(i||e)(pt(ys),pt(Yc),pt(Vf),pt(hl),pt(Yn),pt(QM,8))};static \u0275dir=Hi({type:e,selectors:[["","pRipple",""]],hostAttrs:[1,"p-ripple","p-element"]})}return e})(),rP=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=nr({type:e});static \u0275inj=$i({imports:[yd]})}return e})();const c$=["titlebar"],u$=["content"],h$=["footer"];function d$(e,t){if(1&e){const n=Ku();bn(0,"div",11),Ca("mousedown",function(r){return fo(n),Uo(ri(3).initResize(r))}),Mn()}}function f$(e,t){if(1&e&&(bn(0,"span",18),Ea(1),Mn()),2&e){const n=ri(4);$t("id",n.getAriaLabelledBy()),Kt(1),h_(n.header)}}function p$(e,t){1&e&&(bn(0,"span",18),cd(1,1),Mn()),2&e&&$t("id",ri(4).getAriaLabelledBy())}function m$(e,t){1&e&&Gm(0)}function g$(e,t){if(1&e&&Wr(0,"span",22),2&e){const n=ri(5);$t("ngClass",n.maximized?n.minimizeIcon:n.maximizeIcon)}}function y$(e,t){1&e&&Wr(0,"WindowMaximizeIcon",24),2&e&&$t("styleClass","p-dialog-header-maximize-icon")}function _$(e,t){1&e&&Wr(0,"WindowMinimizeIcon",24),2&e&&$t("styleClass","p-dialog-header-maximize-icon")}function v$(e,t){if(1&e&&(ad(0),zn(1,y$,1,1,"WindowMaximizeIcon",23),zn(2,_$,1,1,"WindowMinimizeIcon",23),ld()),2&e){const n=ri(5);Kt(1),$t("ngIf",!n.maximized&&!n.maximizeIconTemplate),Kt(1),$t("ngIf",n.maximized&&!n.minimizeIconTemplate)}}function b$(e,t){}function x$(e,t){1&e&&zn(0,b$,0,0,"ng-template")}function w$(e,t){if(1&e&&(ad(0),zn(1,x$,1,0,null,9),ld()),2&e){const n=ri(5);Kt(1),$t("ngTemplateOutlet",n.maximizeIconTemplate)}}function C$(e,t){}function E$(e,t){1&e&&zn(0,C$,0,0,"ng-template")}function S$(e,t){if(1&e&&(ad(0),zn(1,E$,1,0,null,9),ld()),2&e){const n=ri(5);Kt(1),$t("ngTemplateOutlet",n.minimizeIconTemplate)}}const T$=function(){return{"p-dialog-header-icon p-dialog-header-maximize p-link":!0}};function D$(e,t){if(1&e){const n=Ku();bn(0,"button",19),Ca("click",function(){return fo(n),Uo(ri(4).maximize())})("keydown.enter",function(){return fo(n),Uo(ri(4).maximize())}),zn(1,g$,1,1,"span",20),zn(2,v$,3,2,"ng-container",21),zn(3,w$,2,1,"ng-container",21),zn(4,S$,2,1,"ng-container",21),Mn()}if(2&e){const n=ri(4);$t("ngClass",g_(5,T$)),Kt(1),$t("ngIf",n.maximizeIcon&&!n.maximizeIconTemplate&&!n.minimizeIconTemplate),Kt(1),$t("ngIf",!n.maximizeIcon),Kt(1),$t("ngIf",!n.maximized),Kt(1),$t("ngIf",n.maximized)}}function I$(e,t){1&e&&Wr(0,"span",27),2&e&&$t("ngClass",ri(6).closeIcon)}function A$(e,t){1&e&&Wr(0,"TimesIcon",24),2&e&&$t("styleClass","p-dialog-header-close-icon")}function M$(e,t){if(1&e&&(ad(0),zn(1,I$,1,1,"span",26),zn(2,A$,1,1,"TimesIcon",23),ld()),2&e){const n=ri(5);Kt(1),$t("ngIf",n.closeIcon),Kt(1),$t("ngIf",!n.closeIcon)}}function P$(e,t){}function R$(e,t){1&e&&zn(0,P$,0,0,"ng-template")}function L$(e,t){if(1&e&&(bn(0,"span"),zn(1,R$,1,0,null,9),Mn()),2&e){const n=ri(5);Kt(1),$t("ngTemplateOutlet",n.closeIconTemplate)}}const k$=function(){return{"p-dialog-header-icon p-dialog-header-close p-link":!0}};function O$(e,t){if(1&e){const n=Ku();bn(0,"button",25),Ca("click",function(r){return fo(n),Uo(ri(4).close(r))})("keydown.enter",function(r){return fo(n),Uo(ri(4).close(r))}),zn(1,M$,3,2,"ng-container",21),zn(2,L$,2,1,"span",21),Mn()}if(2&e){const n=ri(4);$t("ngClass",g_(5,k$)),wa("aria-label",n.closeAriaLabel)("tabindex",n.closeTabindex),Kt(1),$t("ngIf",!n.closeIconTemplate),Kt(1),$t("ngIf",n.closeIconTemplate)}}function N$(e,t){if(1&e){const n=Ku();bn(0,"div",12,13),Ca("mousedown",function(r){return fo(n),Uo(ri(3).initDrag(r))}),zn(2,f$,2,2,"span",14),zn(3,p$,2,1,"span",14),zn(4,m$,1,0,"ng-container",9),bn(5,"div",15),zn(6,D$,5,6,"button",16),zn(7,O$,3,6,"button",17),Mn()()}if(2&e){const n=ri(3);Kt(2),$t("ngIf",!n.headerFacet&&!n.headerTemplate),Kt(1),$t("ngIf",n.headerFacet),Kt(1),$t("ngTemplateOutlet",n.headerTemplate),Kt(2),$t("ngIf",n.maximizable),Kt(1),$t("ngIf",n.closable)}}function F$(e,t){1&e&&Gm(0)}function z$(e,t){1&e&&Gm(0)}function B$(e,t){if(1&e&&(bn(0,"div",28,29),cd(2,2),zn(3,z$,1,0,"ng-container",9),Mn()),2&e){const n=ri(3);Kt(3),$t("ngTemplateOutlet",n.footerTemplate)}}const U$=function(e,t,n,i){return{"p-dialog p-component":!0,"p-dialog-rtl":e,"p-dialog-draggable":t,"p-dialog-resizable":n,"p-dialog-maximized":i}},V$=function(e,t){return{transform:e,transition:t}},j$=function(e){return{value:"visible",params:e}};function $$(e,t){if(1&e){const n=Ku();bn(0,"div",3,4),Ca("@animation.start",function(r){return fo(n),Uo(ri(2).onAnimationStart(r))})("@animation.done",function(r){return fo(n),Uo(ri(2).onAnimationEnd(r))}),zn(2,d$,1,0,"div",5),zn(3,N$,8,5,"div",6),bn(4,"div",7,8),cd(6),zn(7,F$,1,0,"ng-container",9),Mn(),zn(8,B$,4,1,"div",10),Mn()}if(2&e){const n=ri(2);Yu(n.styleClass),$t("ngClass",XS(16,U$,n.rtl,n.draggable,n.resizable,n.maximized))("ngStyle",n.style)("pFocusTrapDisabled",!1===n.focusTrap)("@animation",ZS(24,j$,KS(21,V$,n.transformOptions,n.transitionOptions))),wa("aria-labelledby",n.ariaLabelledBy)("aria-modal",!0),Kt(2),$t("ngIf",n.resizable),Kt(1),$t("ngIf",n.showHeader),Kt(1),Yu(n.contentStyleClass),$t("ngClass","p-dialog-content")("ngStyle",n.contentStyle),Kt(3),$t("ngTemplateOutlet",n.contentTemplate),Kt(1),$t("ngIf",n.footerFacet||n.footerTemplate)}}const H$=function(e,t,n,i,r,l,h,f,_,C){return{"p-dialog-mask":!0,"p-component-overlay p-component-overlay-enter":e,"p-dialog-mask-scrollblocker":t,"p-dialog-left":n,"p-dialog-right":i,"p-dialog-top":r,"p-dialog-top-left":l,"p-dialog-top-right":h,"p-dialog-bottom":f,"p-dialog-bottom-left":_,"p-dialog-bottom-right":C}};function q$(e,t){if(1&e&&(bn(0,"div",1),zn(1,$$,9,26,"div",2),Mn()),2&e){const n=ri();Yu(n.maskStyleClass),$t("ngClass",YS(4,H$,[n.modal,n.modal||n.blockScroll,"left"===n.position,"right"===n.position,"top"===n.position,"topleft"===n.position||"top-left"===n.position,"topright"===n.position||"top-right"===n.position,"bottom"===n.position,"bottomleft"===n.position||"bottom-left"===n.position,"bottomright"===n.position||"bottom-right"===n.position])),Kt(1),$t("ngIf",n.visible)}}const G$=["*",[["p-header"]],[["p-footer"]]],W$=["*","p-header","p-footer"],Z$=fI([j_({transform:"{{transform}}",opacity:0}),uI("{{transition}}")]),K$=fI([uI("{{transition}}",j_({transform:"{{transform}}",opacity:0}))]);let X$=(()=>{class e{document;platformId;el;renderer;zone;cd;config;header;draggable=!0;resizable=!0;get positionLeft(){return 0}set positionLeft(n){console.log("positionLeft property is deprecated.")}get positionTop(){return 0}set positionTop(n){console.log("positionTop property is deprecated.")}contentStyle;contentStyleClass;modal=!1;closeOnEscape=!0;dismissableMask=!1;rtl=!1;closable=!0;get responsive(){return!1}set responsive(n){console.log("Responsive property is deprecated.")}appendTo;breakpoints;styleClass;maskStyleClass;showHeader=!0;get breakpoint(){return 649}set breakpoint(n){console.log("Breakpoint property is not utilized and deprecated, use breakpoints or CSS media queries instead.")}blockScroll=!1;autoZIndex=!0;baseZIndex=0;minX=0;minY=0;focusOnShow=!0;maximizable=!1;keepInViewport=!0;focusTrap=!0;transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)";closeIcon;closeAriaLabel;closeTabindex="-1";minimizeIcon;maximizeIcon;get visible(){return this._visible}set visible(n){this._visible=n,this._visible&&!this.maskVisible&&(this.maskVisible=!0)}get style(){return this._style}set style(n){n&&(this._style={...n},this.originalStyle=n)}get position(){return this._position}set position(n){switch(this._position=n,n){case"topleft":case"bottomleft":case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"topright":case"bottomright":case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break;default:this.transformOptions="scale(0.7)"}}onShow=new lr;onHide=new lr;visibleChange=new lr;onResizeInit=new lr;onResizeEnd=new lr;onDragEnd=new lr;onMaximize=new lr;headerFacet;footerFacet;templates;headerViewChild;contentViewChild;footerViewChild;headerTemplate;contentTemplate;footerTemplate;maximizeIconTemplate;closeIconTemplate;minimizeIconTemplate;_visible=!1;maskVisible;container;wrapper;dragging;ariaLabelledBy;documentDragListener;documentDragEndListener;resizing;documentResizeListener;documentResizeEndListener;documentEscapeListener;maskClickListener;lastPageX;lastPageY;preventVisibleChangePropagation;maximized;preMaximizeContentHeight;preMaximizeContainerWidth;preMaximizeContainerHeight;preMaximizePageX;preMaximizePageY;id=zg();_style={};_position="center";originalStyle;transformOptions="scale(0.7)";styleElement;window;constructor(n,i,r,l,h,f,_){this.document=n,this.platformId=i,this.el=r,this.renderer=l,this.zone=h,this.cd=f,this.config=_,this.window=this.document.defaultView}ngAfterContentInit(){this.templates?.forEach(n=>{switch(n.getType()){case"header":this.headerTemplate=n.template;break;case"content":default:this.contentTemplate=n.template;break;case"footer":this.footerTemplate=n.template;break;case"closeicon":this.closeIconTemplate=n.template;break;case"maximizeicon":this.maximizeIconTemplate=n.template;break;case"minimizeicon":this.minimizeIconTemplate=n.template}})}ngOnInit(){this.breakpoints&&this.createStyle()}getAriaLabelledBy(){return null!==this.header?zg()+"_header":null}focus(){let n=fn.findSingle(this.container,"[autofocus]");n&&this.zone.runOutsideAngular(()=>{setTimeout(()=>n.focus(),5)})}close(n){this.visibleChange.emit(!1),n.preventDefault()}enableModality(){this.closable&&this.dismissableMask&&(this.maskClickListener=this.renderer.listen(this.wrapper,"mousedown",n=>{this.wrapper&&this.wrapper.isSameNode(n.target)&&this.close(n)})),this.modal&&fn.blockBodyScroll()}disableModality(){this.wrapper&&(this.dismissableMask&&this.unbindMaskClickListener(),this.modal&&fn.unblockBodyScroll(),this.cd.destroyed||this.cd.detectChanges())}maximize(){this.maximized=!this.maximized,!this.modal&&!this.blockScroll&&(this.maximized?fn.blockBodyScroll():fn.unblockBodyScroll()),this.onMaximize.emit({maximized:this.maximized})}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}moveOnTop(){this.autoZIndex&&(eP.set("modal",this.container,this.baseZIndex+this.config.zIndex.modal),this.wrapper.style.zIndex=String(parseInt(this.container.style.zIndex,10)-1))}createStyle(){if(BD(this.platformId)&&!this.styleElement){this.styleElement=this.renderer.createElement("style"),this.styleElement.type="text/css",this.renderer.appendChild(this.document.head,this.styleElement);let n="";for(let i in this.breakpoints)n+=`\n                        @media screen and (max-width: ${i}) {\n                            .p-dialog[${this.id}]:not(.p-dialog-maximized) {\n                                width: ${this.breakpoints[i]} !important;\n                            }\n                        }\n                    `;this.renderer.setProperty(this.styleElement,"innerHTML",n)}}initDrag(n){fn.hasClass(n.target,"p-dialog-header-icon")||fn.hasClass(n.target.parentElement,"p-dialog-header-icon")||this.draggable&&(this.dragging=!0,this.lastPageX=n.pageX,this.lastPageY=n.pageY,this.container.style.margin="0",fn.addClass(this.document.body,"p-unselectable-text"))}onKeydown(n){if(this.focusTrap&&9===n.which){n.preventDefault();let i=fn.getFocusableElements(this.container);if(i&&i.length>0)if(i[0].ownerDocument.activeElement){let r=i.indexOf(i[0].ownerDocument.activeElement);n.shiftKey?-1==r||0===r?i[i.length-1].focus():i[r-1].focus():-1==r||r===i.length-1?i[0].focus():i[r+1].focus()}else i[0].focus()}}onDrag(n){if(this.dragging){const i=fn.getOuterWidth(this.container),r=fn.getOuterHeight(this.container),l=n.pageX-this.lastPageX,h=n.pageY-this.lastPageY,f=this.container.getBoundingClientRect(),_=getComputedStyle(this.container),C=parseFloat(_.marginLeft),A=parseFloat(_.marginTop),R=f.left+l-C,F=f.top+h-A,$=fn.getViewport();this.container.style.position="fixed",this.keepInViewport?(R>=this.minX&&R+i<$.width&&(this._style.left=`${R}px`,this.lastPageX=n.pageX,this.container.style.left=`${R}px`),F>=this.minY&&F+r<$.height&&(this._style.top=`${F}px`,this.lastPageY=n.pageY,this.container.style.top=`${F}px`)):(this.lastPageX=n.pageX,this.container.style.left=`${R}px`,this.lastPageY=n.pageY,this.container.style.top=`${R}px`)}}endDrag(n){this.dragging&&(this.dragging=!1,fn.removeClass(this.document.body,"p-unselectable-text"),this.cd.detectChanges(),this.onDragEnd.emit(n))}resetPosition(){this.container.style.position="",this.container.style.left="",this.container.style.top="",this.container.style.margin=""}center(){this.resetPosition()}initResize(n){this.resizable&&(this.resizing=!0,this.lastPageX=n.pageX,this.lastPageY=n.pageY,fn.addClass(this.document.body,"p-unselectable-text"),this.onResizeInit.emit(n))}onResize(n){if(this.resizing){let i=n.pageX-this.lastPageX,r=n.pageY-this.lastPageY,l=fn.getOuterWidth(this.container),h=fn.getOuterHeight(this.container),f=fn.getOuterHeight(this.contentViewChild?.nativeElement),_=l+i,C=h+r,A=this.container.style.minWidth,R=this.container.style.minHeight,F=this.container.getBoundingClientRect(),$=fn.getViewport();(!parseInt(this.container.style.top)||!parseInt(this.container.style.left))&&(_+=i,C+=r),(!A||_>parseInt(A))&&F.left+_<$.width&&(this._style.width=_+"px",this.container.style.width=this._style.width),(!R||C>parseInt(R))&&F.top+C<$.height&&(this.contentViewChild.nativeElement.style.height=f+C-h+"px",this._style.height&&(this._style.height=C+"px",this.container.style.height=this._style.height)),this.lastPageX=n.pageX,this.lastPageY=n.pageY}}resizeEnd(n){this.resizing&&(this.resizing=!1,fn.removeClass(this.document.body,"p-unselectable-text"),this.onResizeEnd.emit(n))}bindGlobalListeners(){this.draggable&&(this.bindDocumentDragListener(),this.bindDocumentDragEndListener()),this.resizable&&this.bindDocumentResizeListeners(),this.closeOnEscape&&this.closable&&this.bindDocumentEscapeListener()}unbindGlobalListeners(){this.unbindDocumentDragListener(),this.unbindDocumentDragEndListener(),this.unbindDocumentResizeListeners(),this.unbindDocumentEscapeListener()}bindDocumentDragListener(){this.documentDragListener||this.zone.runOutsideAngular(()=>{this.documentDragListener=this.renderer.listen(this.window,"mousemove",this.onDrag.bind(this))})}unbindDocumentDragListener(){this.documentDragListener&&(this.documentDragListener(),this.documentDragListener=null)}bindDocumentDragEndListener(){this.documentDragEndListener||this.zone.runOutsideAngular(()=>{this.documentDragEndListener=this.renderer.listen(this.window,"mouseup",this.endDrag.bind(this))})}unbindDocumentDragEndListener(){this.documentDragEndListener&&(this.documentDragEndListener(),this.documentDragEndListener=null)}bindDocumentResizeListeners(){!this.documentResizeListener&&!this.documentResizeEndListener&&this.zone.runOutsideAngular(()=>{this.documentResizeListener=this.renderer.listen(this.window,"mousemove",this.onResize.bind(this)),this.documentResizeEndListener=this.renderer.listen(this.window,"mouseup",this.resizeEnd.bind(this))})}unbindDocumentResizeListeners(){this.documentResizeListener&&this.documentResizeEndListener&&(this.documentResizeListener(),this.documentResizeEndListener(),this.documentResizeListener=null,this.documentResizeEndListener=null)}bindDocumentEscapeListener(){this.documentEscapeListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","keydown",i=>{27==i.which&&this.close(i)})}unbindDocumentEscapeListener(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}appendContainer(){this.appendTo&&("body"===this.appendTo?this.renderer.appendChild(this.document.body,this.wrapper):fn.appendChild(this.wrapper,this.appendTo))}restoreAppend(){this.container&&this.appendTo&&this.renderer.appendChild(this.el.nativeElement,this.wrapper)}onAnimationStart(n){switch(n.toState){case"visible":this.container=n.element,this.wrapper=this.container?.parentElement,this.appendContainer(),this.moveOnTop(),this.bindGlobalListeners(),this.container?.setAttribute(this.id,""),this.modal&&this.enableModality(),!this.modal&&this.blockScroll&&fn.addClass(this.document.body,"p-overflow-hidden"),this.focusOnShow&&this.focus();break;case"void":this.wrapper&&this.modal&&fn.addClass(this.wrapper,"p-component-overlay-leave")}}onAnimationEnd(n){switch(n.toState){case"void":this.onContainerDestroy(),this.onHide.emit({}),this.cd.markForCheck();break;case"visible":this.onShow.emit({})}}onContainerDestroy(){this.unbindGlobalListeners(),this.dragging=!1,this.maskVisible=!1,this.maximized&&(fn.removeClass(this.document.body,"p-overflow-hidden"),this.document.body.style.removeProperty("--scrollbar-width"),this.maximized=!1),this.modal&&this.disableModality(),this.blockScroll&&fn.removeClass(this.document.body,"p-overflow-hidden"),this.container&&this.autoZIndex&&eP.clear(this.container),this.container=null,this.wrapper=null,this._style=this.originalStyle?{...this.originalStyle}:{}}destroyStyle(){this.styleElement&&(this.renderer.removeChild(this.document.head,this.styleElement),this.styleElement=null)}ngOnDestroy(){this.container&&(this.restoreAppend(),this.onContainerDestroy()),this.destroyStyle()}static \u0275fac=function(i){return new(i||e)(pt(ys),pt(Yc),pt(hl),pt(Vf),pt(Yn),pt(E_),pt(QM))};static \u0275cmp=Er({type:e,selectors:[["p-dialog"]],contentQueries:function(i,r,l){if(1&i&&(ig(l,t$,5),ig(l,n$,5),ig(l,i$,4)),2&i){let h;nu(h=iu())&&(r.headerFacet=h.first),nu(h=iu())&&(r.footerFacet=h.first),nu(h=iu())&&(r.templates=h)}},viewQuery:function(i,r){if(1&i&&(ng(c$,5),ng(u$,5),ng(h$,5)),2&i){let l;nu(l=iu())&&(r.headerViewChild=l.first),nu(l=iu())&&(r.contentViewChild=l.first),nu(l=iu())&&(r.footerViewChild=l.first)}},hostAttrs:[1,"p-element"],inputs:{header:"header",draggable:"draggable",resizable:"resizable",positionLeft:"positionLeft",positionTop:"positionTop",contentStyle:"contentStyle",contentStyleClass:"contentStyleClass",modal:"modal",closeOnEscape:"closeOnEscape",dismissableMask:"dismissableMask",rtl:"rtl",closable:"closable",responsive:"responsive",appendTo:"appendTo",breakpoints:"breakpoints",styleClass:"styleClass",maskStyleClass:"maskStyleClass",showHeader:"showHeader",breakpoint:"breakpoint",blockScroll:"blockScroll",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",minX:"minX",minY:"minY",focusOnShow:"focusOnShow",maximizable:"maximizable",keepInViewport:"keepInViewport",focusTrap:"focusTrap",transitionOptions:"transitionOptions",closeIcon:"closeIcon",closeAriaLabel:"closeAriaLabel",closeTabindex:"closeTabindex",minimizeIcon:"minimizeIcon",maximizeIcon:"maximizeIcon",visible:"visible",style:"style",position:"position"},outputs:{onShow:"onShow",onHide:"onHide",visibleChange:"visibleChange",onResizeInit:"onResizeInit",onResizeEnd:"onResizeEnd",onDragEnd:"onDragEnd",onMaximize:"onMaximize"},ngContentSelectors:W$,decls:1,vars:1,consts:[[3,"class","ngClass",4,"ngIf"],[3,"ngClass"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","class","pFocusTrapDisabled",4,"ngIf"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","pFocusTrapDisabled"],["container",""],["class","p-resizable-handle","style","z-index: 90;",3,"mousedown",4,"ngIf"],["class","p-dialog-header",3,"mousedown",4,"ngIf"],[3,"ngClass","ngStyle"],["content",""],[4,"ngTemplateOutlet"],["class","p-dialog-footer",4,"ngIf"],[1,"p-resizable-handle",2,"z-index","90",3,"mousedown"],[1,"p-dialog-header",3,"mousedown"],["titlebar",""],["class","p-dialog-title",3,"id",4,"ngIf"],[1,"p-dialog-header-icons"],["role","button","type","button","tabindex","-1","pRipple","",3,"ngClass","click","keydown.enter",4,"ngIf"],["type","button","pRipple","",3,"ngClass","click","keydown.enter",4,"ngIf"],[1,"p-dialog-title",3,"id"],["role","button","type","button","tabindex","-1","pRipple","",3,"ngClass","click","keydown.enter"],["class","p-dialog-header-maximize-icon",3,"ngClass",4,"ngIf"],[4,"ngIf"],[1,"p-dialog-header-maximize-icon",3,"ngClass"],[3,"styleClass",4,"ngIf"],[3,"styleClass"],["type","button","pRipple","",3,"ngClass","click","keydown.enter"],["class","p-dialog-header-close-icon",3,"ngClass",4,"ngIf"],[1,"p-dialog-header-close-icon",3,"ngClass"],[1,"p-dialog-footer"],["footer",""]],template:function(i,r){1&i&&(Wm(G$),zn(0,q$,2,15,"div",0)),2&i&&$t("ngIf",r.maskVisible)},dependencies:function(){return[AD,Eb,ND,OD,r$,l$,tP,nP,iP]},styles:["@layer primeng{.p-dialog-mask{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;pointer-events:none}.p-dialog-mask.p-component-overlay{pointer-events:auto}.p-dialog{display:flex;flex-direction:column;pointer-events:auto;max-height:90%;transform:scale(1);position:relative}.p-dialog-content{overflow-y:auto;flex-grow:1}.p-dialog-header{display:flex;align-items:center;justify-content:space-between;flex-shrink:0}.p-dialog-draggable .p-dialog-header{cursor:move}.p-dialog-footer{flex-shrink:0}.p-dialog .p-dialog-header-icons{display:flex;align-items:center}.p-dialog .p-dialog-header-icon{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-fluid .p-dialog-footer .p-button{width:auto}.p-dialog-top .p-dialog,.p-dialog-bottom .p-dialog,.p-dialog-left .p-dialog,.p-dialog-right .p-dialog,.p-dialog-top-left .p-dialog,.p-dialog-top-right .p-dialog,.p-dialog-bottom-left .p-dialog,.p-dialog-bottom-right .p-dialog{margin:.75rem;transform:translateZ(0)}.p-dialog-maximized{transition:none;transform:none;width:100vw!important;height:100vh!important;top:0!important;left:0!important;max-height:100%;height:100%}.p-dialog-maximized .p-dialog-content{flex-grow:1}.p-dialog-left{justify-content:flex-start}.p-dialog-right{justify-content:flex-end}.p-dialog-top{align-items:flex-start}.p-dialog-top-left{justify-content:flex-start;align-items:flex-start}.p-dialog-top-right{justify-content:flex-end;align-items:flex-start}.p-dialog-bottom{align-items:flex-end}.p-dialog-bottom-left{justify-content:flex-start;align-items:flex-end}.p-dialog-bottom-right{justify-content:flex-end;align-items:flex-end}.p-dialog .p-resizable-handle{position:absolute;font-size:.1px;display:block;cursor:se-resize;width:12px;height:12px;right:1px;bottom:1px}.p-confirm-dialog .p-dialog-content{display:flex;align-items:center}}\n"],encapsulation:2,data:{animation:[_z("animation",[dI("void => visible",[pI(Z$)]),dI("visible => void",[pI(K$)])])]},changeDetection:0})}return e})(),Y$=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=nr({type:e});static \u0275inj=$i({imports:[yd,s$,rP,tP,nP,iP,$v]})}return e})();const Q$=["map"];function J$(e,t){if(1&e){const n=Ku();bn(0,"li",4)(1,"span",9),Ca("click",function(){const l=fo(n).$implicit;return Uo(ri(2).showUserCard(l))}),Ea(2),Mn()()}if(2&e){const n=t.$implicit;Kt(2),tu(" ",n.username," ")}}function e7(e,t){if(1&e&&(bn(0,"ul"),zn(1,J$,3,1,"li",8),Mn()),2&e){const n=ri();Kt(1),$t("ngForOf",n.displayedUsers)}}function t7(e,t){if(1&e&&(bn(0,"p",10),Ea(1),Mn()),2&e){const n=ri();Kt(1),h_(n.noUsersFoundMessage)}}function n7(e,t){if(1&e){const n=Ku();bn(0,"div")(1,"p",11),Ea(2),Mn(),bn(3,"p",11),Ea(4),Mn(),bn(5,"p",11),Ea(6),Mn(),Wr(7,"div",12),bn(8,"button",13),Ca("click",function(){fo(n);const r=ri();return Uo(r.initializeUserCardMap(r.selectedUser))}),Ea(9,"Show on Map"),Mn()()}if(2&e){const n=ri();Kt(2),tu("User Name: ",n.selectedUser.username,""),Kt(2),tu("Latitude: ",n.selectedUser.latitude,""),Kt(2),tu("Longitude: ",n.selectedUser.longitude,"")}}const i7=function(){return{width:"50vw"}};let r7=(()=>{class e{constructor(n){this.geocodingService=n,this.noUsersFoundMessage="",this.displayedUsers=[],this.selectedUser=null,this.userCardOpen=!1,this.visible=!1}ngOnInit(){Co.apiKey="fjwYPVI1cIuGWwKVQo31"}ngAfterViewInit(){this.map=new pw({container:this.mapContainer.nativeElement,style:Av.STREETS,center:[83.5385,17.9916],zoom:10}),this.map.on("click",i=>{const r=i.lngLat;this.clickedLatitude=r.lat,this.clickedLongitude=r.lng,this.geocodingService.getNearestUsers(this.clickedLatitude,this.clickedLongitude,10).subscribe(l=>{l.length>0?this.displayNearestUsers(l):this.noUsersFound()},l=>{console.error("Error finding nearest users:",l)})}),new aM({color:"#FF0000"}).setLngLat([83.5385,17.9916]).addTo(this.map)}ngOnDestroy(){this.map?.remove()}displayNearestUsers(n){console.log("User Names:",n.map(i=>i.username)),console.log("Latitude:",n.map(i=>i.latitude)),console.log("Longitude:",n.map(i=>i.longitude)),this.displayedUsers=n,this.noUsersFoundMessage="",this.userCardOpen&&this.closeUserCard()}noUsersFound(){console.log("No user found"),this.noUsersFoundMessage="No user found",this.displayedUsers=[],this.userCardOpen&&(this.closeUserCard(),this.visible=!1)}showUserCard(n){this.selectedUser=n,this.userCardOpen=!0,this.visible=!0}closeUserCard(){console.log("Close button clicked."),this.selectedUser=null}initializeUserCardMap(n){this.userCardMap&&this.userCardMap.remove(),this.userCardMap=new pw({container:"user-card-map",style:Av.STREETS,center:[n.longitude,n.latitude],zoom:12}),new aM({color:"blue"}).setLngLat([n.longitude,n.latitude]).addTo(this.userCardMap)}static#e=this.\u0275fac=function(i){return new(i||e)(pt(Jj))};static#t=this.\u0275cmp=Er({type:e,selectors:[["app-map"]],viewQuery:function(i,r){if(1&i&&ng(Q$,5),2&i){let l;nu(l=iu())&&(r.mapContainer=l.first)}},decls:15,vars:9,consts:[[1,"map-wrap"],[1,"map"],["map",""],[1,"find-location"],[1,"map-info"],[4,"ngIf"],["class","no-Users-Found-Message",4,"ngIf"],[3,"visible","visibleChange"],["class","map-info",4,"ngFor","ngForOf"],[2,"cursor","pointer",3,"click"],[1,"no-Users-Found-Message"],[1,"user-info"],["id","user-card-map",2,"width","100%","height","300px"],[1,"show-on-map-button",3,"click"]],template:function(i,r){1&i&&(bn(0,"div",0),Wr(1,"div",1,2),bn(3,"div",3)(4,"div")(5,"p",4),Ea(6),Mn(),bn(7,"p",4),Ea(8),Mn(),bn(9,"h2",4),Ea(10,"Nearby Users :"),Mn(),zn(11,e7,2,1,"ul",5),zn(12,t7,2,1,"p",6),Mn()(),bn(13,"p-dialog",7),Ca("visibleChange",function(h){return r.visible=h}),zn(14,n7,10,3,"div",5),Mn()()),2&i&&(Kt(6),tu("Latitude: ",r.clickedLatitude,""),Kt(2),tu("Longitude: ",r.clickedLongitude,""),Kt(3),$t("ngIf",r.displayedUsers.length>0),Kt(1),$t("ngIf",r.noUsersFoundMessage),Kt(1),function dl(e){pl(jE,QL,e,!1)}(g_(8,i7)),$t("visible",r.visible),Kt(1),$t("ngIf",r.selectedUser))},dependencies:[PD,Eb,X$],styles:[".find-location[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:center;align-items:center;background-color:#f2f3f4}.map-wrap[_ngcontent-%COMP%]{display:flex;height:calc(98vh - 70px)}.map[_ngcontent-%COMP%]{flex:1;position:relative;border:100px solid #F2F3F4}.map-info[_ngcontent-%COMP%]{color:#0d416b}.no-Users-Found-Message[_ngcontent-%COMP%]{color:red;font-size:30px}.user-card[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #ccc;padding:10px;box-shadow:0 2px 4px #0000001a;border-radius:4px;width:500px;margin:20px;height:400px}.user-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.user-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:8px 16px;cursor:pointer;margin-top:10px;border-radius:4px}.user-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#0056b3}.show-on-map-button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.user-info[_ngcontent-%COMP%]{color:#007bff}"]})}return e})(),s7=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Er({type:e,selectors:[["app-navbar"]],decls:5,vars:0,consts:[[1,"navbar"],["src","https://image.similarpng.com/very-thumbnail/2020/08/Golden-World-map-formed-location-icon-vector-PNG.png","alt","Map Logo",1,"map-logo"],[1,"heading"]],template:function(i,r){1&i&&(bn(0,"div",0),Wr(1,"img",1),bn(2,"div",2)(3,"h1"),Ea(4,"Finding Coordinates"),Mn()()())},styles:[".navbar[_ngcontent-%COMP%]{display:flex;align-items:center;background-color:#2c3e50;color:#fff;padding:10px}.map-logo[_ngcontent-%COMP%]{width:60px;height:auto;margin-right:20px;border-radius:30px}.heading[_ngcontent-%COMP%]{margin:0;padding:0}.heading[_ngcontent-%COMP%] > h1[_ngcontent-%COMP%]{margin:0 0 0 550px;font-family:Times New Roman,Times,serif}"]})}return e})(),o7=(()=>{class e{constructor(){this.title="find_Location"}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Er({type:e,selectors:[["app-root"]],decls:3,vars:0,consts:[[1,"App"]],template:function(i,r){1&i&&(bn(0,"div",0),Wr(1,"app-navbar")(2,"app-map"),Mn())},dependencies:[r7,s7],styles:[".App[_ngcontent-%COMP%]{text-align:center}"]})}return e})(),h7=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=nr({type:e});static \u0275inj=$i({imports:[yd,$v]})}return e})(),d7=(()=>{class e extends Hv{pathId;ngOnInit(){this.pathId="url(#"+zg()+")"}static \u0275fac=function(){let n;return function(r){return(n||(n=Bc(e)))(r||e)}}();static \u0275cmp=Er({type:e,selectors:[["SpinnerIcon"]],standalone:!0,features:[qf,fd],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M6.99701 14C5.85441 13.999 4.72939 13.7186 3.72012 13.1832C2.71084 12.6478 1.84795 11.8737 1.20673 10.9284C0.565504 9.98305 0.165424 8.89526 0.041387 7.75989C-0.0826496 6.62453 0.073125 5.47607 0.495122 4.4147C0.917119 3.35333 1.59252 2.4113 2.46241 1.67077C3.33229 0.930247 4.37024 0.413729 5.4857 0.166275C6.60117 -0.0811796 7.76026 -0.0520535 8.86188 0.251112C9.9635 0.554278 10.9742 1.12227 11.8057 1.90555C11.915 2.01493 11.9764 2.16319 11.9764 2.31778C11.9764 2.47236 11.915 2.62062 11.8057 2.73C11.7521 2.78503 11.688 2.82877 11.6171 2.85864C11.5463 2.8885 11.4702 2.90389 11.3933 2.90389C11.3165 2.90389 11.2404 2.8885 11.1695 2.85864C11.0987 2.82877 11.0346 2.78503 10.9809 2.73C9.9998 1.81273 8.73246 1.26138 7.39226 1.16876C6.05206 1.07615 4.72086 1.44794 3.62279 2.22152C2.52471 2.99511 1.72683 4.12325 1.36345 5.41602C1.00008 6.70879 1.09342 8.08723 1.62775 9.31926C2.16209 10.5513 3.10478 11.5617 4.29713 12.1803C5.48947 12.7989 6.85865 12.988 8.17414 12.7157C9.48963 12.4435 10.6711 11.7264 11.5196 10.6854C12.3681 9.64432 12.8319 8.34282 12.8328 7C12.8328 6.84529 12.8943 6.69692 13.0038 6.58752C13.1132 6.47812 13.2616 6.41667 13.4164 6.41667C13.5712 6.41667 13.7196 6.47812 13.8291 6.58752C13.9385 6.69692 14 6.84529 14 7C14 8.85651 13.2622 10.637 11.9489 11.9497C10.6356 13.2625 8.85432 14 6.99701 14Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){1&i&&(Oc(),bn(0,"svg",0)(1,"g"),Wr(2,"path",1),Mn(),bn(3,"defs")(4,"clipPath",2),Wr(5,"rect",3),Mn()()()),2&i&&(Yu(r.getClassNames()),wa("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),Kt(1),wa("clip-path",r.pathId),Kt(3),$t("id",r.pathId))},encapsulation:2})}return e})(),C7=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=nr({type:e});static \u0275inj=$i({imports:[yd,rP,$v,d7,$v]})}return e})(),E7=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=nr({type:e,bootstrap:[o7]});static#n=this.\u0275inj=$i({imports:[rI,fB,X8,Wj,h7,C7,Y$]})}return e})();cz().bootstrapModule(E7).catch(e=>console.error(e))},16:mu=>{"use strict";var xn,Bs="object"==typeof Reflect?Reflect:null,ta=Bs&&"function"==typeof Bs.apply?Bs.apply:function(Ue,He,yt){return Function.prototype.apply.call(Ue,He,yt)};xn=Bs&&"function"==typeof Bs.ownKeys?Bs.ownKeys:Object.getOwnPropertySymbols?function(Ue){return Object.getOwnPropertyNames(Ue).concat(Object.getOwnPropertySymbols(Ue))}:function(Ue){return Object.getOwnPropertyNames(Ue)};var gu=Number.isNaN||function(Ue){return Ue!=Ue};function y(){y.init.call(this)}mu.exports=y,mu.exports.once=function xs($e,Ue){return new Promise(function(He,yt){function ot(Dt){$e.removeListener(Ue,ln),yt(Dt)}function ln(){"function"==typeof $e.removeListener&&$e.removeListener("error",ot),He([].slice.call(arguments))}ws($e,Ue,ln,{once:!0}),"error"!==Ue&&function os($e,Ue,He){"function"==typeof $e.on&&ws($e,"error",Ue,He)}($e,ot,{once:!0})})},y.EventEmitter=y,y.prototype._events=void 0,y.prototype._eventsCount=0,y.prototype._maxListeners=void 0;var ei=10;function xe($e){if("function"!=typeof $e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof $e)}function Xr($e){return void 0===$e._maxListeners?y.defaultMaxListeners:$e._maxListeners}function Qi($e,Ue,He,yt){var ot,ln,Dt;if(xe(He),void 0===(ln=$e._events)?(ln=$e._events=Object.create(null),$e._eventsCount=0):(void 0!==ln.newListener&&($e.emit("newListener",Ue,He.listener?He.listener:He),ln=$e._events),Dt=ln[Ue]),void 0===Dt)Dt=ln[Ue]=He,++$e._eventsCount;else if("function"==typeof Dt?Dt=ln[Ue]=yt?[He,Dt]:[Dt,He]:yt?Dt.unshift(He):Dt.push(He),(ot=Xr($e))>0&&Dt.length>ot&&!Dt.warned){Dt.warned=!0;var ki=new Error("Possible EventEmitter memory leak detected. "+Dt.length+" "+String(Ue)+" listeners added. Use emitter.setMaxListeners() to increase limit");ki.name="MaxListenersExceededWarning",ki.emitter=$e,ki.type=Ue,ki.count=Dt.length,function lc($e){console&&console.warn&&console.warn($e)}(ki)}return $e}function ht(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function bs($e,Ue,He){var yt={fired:!1,wrapFn:void 0,target:$e,type:Ue,listener:He},ot=ht.bind(yt);return ot.listener=He,yt.wrapFn=ot,ot}function So($e,Ue,He){var yt=$e._events;if(void 0===yt)return[];var ot=yt[Ue];return void 0===ot?[]:"function"==typeof ot?He?[ot.listener||ot]:[ot]:He?function bl($e){for(var Ue=new Array($e.length),He=0;He<Ue.length;++He)Ue[He]=$e[He].listener||$e[He];return Ue}(ot):Ji(ot,ot.length)}function Us($e){var Ue=this._events;if(void 0!==Ue){var He=Ue[$e];if("function"==typeof He)return 1;if(void 0!==He)return He.length}return 0}function Ji($e,Ue){for(var He=new Array(Ue),yt=0;yt<Ue;++yt)He[yt]=$e[yt];return He}function ws($e,Ue,He,yt){if("function"==typeof $e.on)yt.once?$e.once(Ue,He):$e.on(Ue,He);else{if("function"!=typeof $e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof $e);$e.addEventListener(Ue,function ot(ln){yt.once&&$e.removeEventListener(Ue,ot),He(ln)})}}Object.defineProperty(y,"defaultMaxListeners",{enumerable:!0,get:function(){return ei},set:function($e){if("number"!=typeof $e||$e<0||gu($e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+$e+".");ei=$e}}),y.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},y.prototype.setMaxListeners=function(Ue){if("number"!=typeof Ue||Ue<0||gu(Ue))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+Ue+".");return this._maxListeners=Ue,this},y.prototype.getMaxListeners=function(){return Xr(this)},y.prototype.emit=function(Ue){for(var He=[],yt=1;yt<arguments.length;yt++)He.push(arguments[yt]);var ot="error"===Ue,ln=this._events;if(void 0!==ln)ot=ot&&void 0===ln.error;else if(!ot)return!1;if(ot){var Dt;if(He.length>0&&(Dt=He[0]),Dt instanceof Error)throw Dt;var ki=new Error("Unhandled error."+(Dt?" ("+Dt.message+")":""));throw ki.context=Dt,ki}var fi=ln[Ue];if(void 0===fi)return!1;if("function"==typeof fi)ta(fi,this,He);else{var br=fi.length,as=Ji(fi,br);for(yt=0;yt<br;++yt)ta(as[yt],this,He)}return!0},y.prototype.on=y.prototype.addListener=function(Ue,He){return Qi(this,Ue,He,!1)},y.prototype.prependListener=function(Ue,He){return Qi(this,Ue,He,!0)},y.prototype.once=function(Ue,He){return xe(He),this.on(Ue,bs(this,Ue,He)),this},y.prototype.prependOnceListener=function(Ue,He){return xe(He),this.prependListener(Ue,bs(this,Ue,He)),this},y.prototype.off=y.prototype.removeListener=function(Ue,He){var yt,ot,ln,Dt,ki;if(xe(He),void 0===(ot=this._events))return this;if(void 0===(yt=ot[Ue]))return this;if(yt===He||yt.listener===He)0==--this._eventsCount?this._events=Object.create(null):(delete ot[Ue],ot.removeListener&&this.emit("removeListener",Ue,yt.listener||He));else if("function"!=typeof yt){for(ln=-1,Dt=yt.length-1;Dt>=0;Dt--)if(yt[Dt]===He||yt[Dt].listener===He){ki=yt[Dt].listener,ln=Dt;break}if(ln<0)return this;0===ln?yt.shift():function bi($e,Ue){for(;Ue+1<$e.length;Ue++)$e[Ue]=$e[Ue+1];$e.pop()}(yt,ln),1===yt.length&&(ot[Ue]=yt[0]),void 0!==ot.removeListener&&this.emit("removeListener",Ue,ki||He)}return this},y.prototype.removeAllListeners=function(Ue){var He,yt,ot;if(void 0===(yt=this._events))return this;if(void 0===yt.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==yt[Ue]&&(0==--this._eventsCount?this._events=Object.create(null):delete yt[Ue]),this;if(0===arguments.length){var Dt,ln=Object.keys(yt);for(ot=0;ot<ln.length;++ot)"removeListener"!==(Dt=ln[ot])&&this.removeAllListeners(Dt);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(He=yt[Ue]))this.removeListener(Ue,He);else if(void 0!==He)for(ot=He.length-1;ot>=0;ot--)this.removeListener(Ue,He[ot]);return this},y.prototype.listeners=function(Ue){return So(this,Ue,!0)},y.prototype.rawListeners=function(Ue){return So(this,Ue,!1)},y.listenerCount=function($e,Ue){return"function"==typeof $e.listenerCount?$e.listenerCount(Ue):Us.call($e,Ue)},y.prototype.listenerCount=Us,y.prototype.eventNames=function(){return this._eventsCount>0?xn(this._events):[]}},624:function(mu){mu.exports=function(){"use strict";var Bs,ta,xn;function lc(y,ei){if(Bs)if(ta){var xe="var sharedChunk = {}; ("+Bs+")(sharedChunk); ("+ta+")(sharedChunk);",Xr={};Bs(Xr),xn=ei(Xr),typeof window<"u"&&(xn.workerUrl=window.URL.createObjectURL(new Blob([xe],{type:"text/javascript"})))}else ta=ei;else Bs=ei}return lc(0,function(y){function ei(a,s,c,d){return new(c||(c=Promise))(function(m,b){function w(M){try{D(d.next(M))}catch(L){b(L)}}function E(M){try{D(d.throw(M))}catch(L){b(L)}}function D(M){var L;M.done?m(M.value):(L=M.value,L instanceof c?L:new c(function(N){N(L)})).then(w,E)}D((d=d.apply(a,s||[])).next())})}function xe(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}"function"==typeof SuppressedError&&SuppressedError;var Xr=Qi;function Qi(a,s){this.x=a,this.y=s}Qi.prototype={clone:function(){return new Qi(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,s){return this.clone()._rotateAround(a,s)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var s=a.x-this.x,c=a.y-this.y;return s*s+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,s){return Math.atan2(this.x*s-this.y*a,this.x*a+this.y*s)},_matMult:function(a){var s=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=s,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var s=Math.cos(a),c=Math.sin(a),d=c*this.x+s*this.y;return this.x=s*this.x-c*this.y,this.y=d,this},_rotateAround:function(a,s){var c=Math.cos(a),d=Math.sin(a),m=s.y+d*(this.x-s.x)+c*(this.y-s.y);return this.x=s.x+c*(this.x-s.x)-d*(this.y-s.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Qi.convert=function(a){return a instanceof Qi?a:Array.isArray(a)?new Qi(a[0],a[1]):a};var ht=xe(Xr),bs=So;function So(a,s,c,d){this.cx=3*a,this.bx=3*(c-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(d-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=s,this.p2x=c,this.p2y=d}So.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,s){if(void 0===s&&(s=1e-6),a<0)return 0;if(a>1)return 1;for(var c=a,d=0;d<8;d++){var m=this.sampleCurveX(c)-a;if(Math.abs(m)<s)return c;var b=this.sampleCurveDerivativeX(c);if(Math.abs(b)<1e-6)break;c-=m/b}var w=0,E=1;for(c=a,d=0;d<20&&(m=this.sampleCurveX(c),!(Math.abs(m-a)<s));d++)a>m?w=c:E=c,c=.5*(E-w)+w;return c},solve:function(a,s){return this.sampleCurveY(this.solveCurveX(a,s))}};var Us=xe(bs);let Ji,bi;function bl(){return null==Ji&&(Ji=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),Ji}function xs(){if(null==bi&&(bi=!1,bl())){const s=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(s){for(let d=0;d<25;d++){const m=4*d;s.fillStyle=`rgb(${m},${m+1},${m+2})`,s.fillRect(d%5,Math.floor(d/5),1,1)}const c=s.getImageData(0,0,5,5).data;for(let d=0;d<100;d++)if(d%4!=3&&c[d]!==d){bi=!0;break}}}return bi||!1}function os(a,s,c,d){const m=new Us(a,s,c,d);return function(b){return m.solve(b)}}const ws=os(.25,.1,.25,1);function $e(a,s,c){return Math.min(c,Math.max(s,a))}function Ue(a,s,c){const d=c-s,m=((a-s)%d+d)%d+s;return m===s?c:m}function He(a,...s){for(const c of s)for(const d in c)a[d]=c[d];return a}let yt=1;function ot(a,s,c){const d={};for(const m in a)d[m]=s.call(c||this,a[m],m,a);return d}function ln(a,s,c){const d={};for(const m in a)s.call(c||this,a[m],m,a)&&(d[m]=a[m]);return d}function Dt(a){return Array.isArray(a)?a.map(Dt):"object"==typeof a&&a?ot(a,Dt):a}const ki={};function fi(a){ki[a]||(typeof console<"u"&&console.warn(a),ki[a]=!0)}function br(a,s,c){return(c.y-a.y)*(s.x-a.x)>(s.y-a.y)*(c.x-a.x)}function as(a){let s=0;for(let c,d,m=0,b=a.length,w=b-1;m<b;w=m++)c=a[m],d=a[w],s+=(d.x-c.x)*(c.y+d.y);return s}function ji(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let ka=null;function xl(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const pi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function wl(a,s,c,d,m){return ei(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const b=new VideoFrame(a,{timestamp:0});try{const w=b?.format;if(!w||!w.startsWith("BGR")&&!w.startsWith("RGB"))throw new Error(`Unrecognized format ${w}`);const E=w.startsWith("BGR"),D=new Uint8ClampedArray(d*m*4);if(yield b.copyTo(D,function(M,L,N,B,j){const H=4*Math.max(-L,0),W=(Math.max(0,N)-N)*B*4+H,te=4*B,re=Math.max(0,L),ce=Math.max(0,N);return{rect:{x:re,y:ce,width:Math.min(M.width,L+B)-re,height:Math.min(M.height,N+j)-ce},layout:[{offset:W,stride:te}]}}(a,s,c,d,m)),E)for(let M=0;M<D.length;M+=4){const L=D[M];D[M]=D[M+2],D[M+2]=L}return D}finally{b.close()}})}let ro,Gn,Yr,er;const Oa={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(a){const s=requestAnimationFrame(a);return{cancel:()=>cancelAnimationFrame(s)}},getImageData(a,s=0){return this.getImageCanvasContext(a).getImageData(-s,-s,a.width+2*s,a.height+2*s)},getImageCanvasContext(a){const s=window.document.createElement("canvas"),c=s.getContext("2d",{willReadFrequently:!0});if(!c)throw new Error("failed to create canvas 2d context");return s.width=a.width,s.height=a.height,c.drawImage(a,0,0,a.width,a.height),c},resolveURL:a=>(Yr||(Yr=document.createElement("a")),Yr.href=a,Yr.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==er&&(er=matchMedia("(prefers-reduced-motion: reduce)")),er.matches)}},Na={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class Wn extends Error{constructor(s,c,d,m){super(`AJAXError: ${c} (${s}): ${d}`),this.status=s,this.statusText=c,this.url=d,this.body=m}}const kn=ji()?()=>self.worker&&self.worker.referrer:()=>("blob:"===window.location.protocol?window.parent:window).location.href,Cs=a=>Na.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))];function pn(a,s){const c=new AbortController,d=new Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,cache:a.cache,referrer:kn(),signal:c.signal});let m=!1,b=!1;return"json"===a.type&&d.headers.set("Accept","application/json"),b||fetch(d).then(w=>{return w.ok?(E=w,void("arrayBuffer"===a.type||"image"===a.type?E.arrayBuffer():"json"===a.type?E.json():E.text()).then(D=>{b||(m=!0,s(null,D,E.headers.get("Cache-Control"),E.headers.get("Expires")))}).catch(D=>{b||s(new Error(D.message))})):w.blob().then(E=>s(new Wn(w.status,w.statusText,a.url,E)));var E}).catch(w=>{20!==w.code&&s(new Error(w.message))}),{cancel:()=>{b=!0,m||c.abort()}}}const so=function(a,s){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){if(ji()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,s);if(!ji())return(Cs(a.url)||pn)(a,s)}if(!(/^file:/.test(c=a.url)||/^file:/.test(kn())&&!/^\w+:/.test(c))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return pn(a,s);if(ji()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,s,void 0,!0)}var c;return function(d,m){const b=new XMLHttpRequest;b.open(d.method||"GET",d.url,!0),"arrayBuffer"!==d.type&&"image"!==d.type||(b.responseType="arraybuffer");for(const w in d.headers)b.setRequestHeader(w,d.headers[w]);return"json"===d.type&&(b.responseType="text",b.setRequestHeader("Accept","application/json")),b.withCredentials="include"===d.credentials,b.onerror=()=>{m(new Error(b.statusText))},b.onload=()=>{if((b.status>=200&&b.status<300||0===b.status)&&null!==b.response){let w=b.response;if("json"===d.type)try{w=JSON.parse(b.response)}catch(E){return m(E)}m(null,w,b.getResponseHeader("Cache-Control"),b.getResponseHeader("Expires"))}else{const w=new Blob([b.response],{type:b.getResponseHeader("Content-Type")});m(new Wn(b.status,b.statusText,d.url,w))}},b.send(d.body),{cancel:()=>b.abort()}}(a,s)},cc=function(a,s){return so(He(a,{type:"arrayBuffer"}),s)};function Vs(a){if(!a||a.indexOf("://")<=0||0===a.indexOf("data:image/")||0===a.indexOf("blob:"))return!0;const s=new URL(a),c=window.location;return s.protocol===c.protocol&&s.host===c.host}function Cl(a,s,c){c[a]&&-1!==c[a].indexOf(s)||(c[a]=c[a]||[],c[a].push(s))}function Fa(a,s,c){if(c&&c[a]){const d=c[a].indexOf(s);-1!==d&&c[a].splice(d,1)}}class na{constructor(s,c={}){He(this,c),this.type=s}}class za extends na{constructor(s,c={}){super("error",He({error:s},c))}}class El{on(s,c){return this._listeners=this._listeners||{},Cl(s,c,this._listeners),this}off(s,c){return Fa(s,c,this._listeners),Fa(s,c,this._oneTimeListeners),this}once(s,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},Cl(s,c,this._oneTimeListeners),this):new Promise(d=>this.once(s,d))}fire(s,c){"string"==typeof s&&(s=new na(s,c||{}));const d=s.type;if(this.listens(d)){s.target=this;const m=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(const E of m)E.call(this,s);const b=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(const E of b)Fa(d,E,this._oneTimeListeners),E.call(this,s);const w=this._eventedParent;w&&(He(s,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),w.fire(s))}else s instanceof za&&console.error(s.error);return this}listens(s){return this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s)}setEventedParent(s,c){return this._eventedParent=s,this._eventedParentData=c,this}}var we={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ls=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Es(a,s){const c={};for(const d in a)"ref"!==d&&(c[d]=a[d]);return ls.forEach(d=>{d in s&&(c[d]=s[d])}),c}function On(a,s){if(Array.isArray(a)){if(!Array.isArray(s)||a.length!==s.length)return!1;for(let c=0;c<a.length;c++)if(!On(a[c],s[c]))return!1;return!0}if("object"==typeof a&&null!==a&&null!==s){if("object"!=typeof s||Object.keys(a).length!==Object.keys(s).length)return!1;for(const c in a)if(!On(a[c],s[c]))return!1;return!0}return a===s}const mn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Ss(a,s,c){c.push({command:mn.addSource,args:[a,s[a]]})}function Sl(a,s,c){s.push({command:mn.removeSource,args:[a]}),c[a]=!0}function js(a,s,c,d){Sl(a,c,d),Ss(a,s,c)}function uc(a,s,c){let d;for(d in a[c])if(Object.prototype.hasOwnProperty.call(a[c],d)&&"data"!==d&&!On(a[c][d],s[c][d]))return!1;for(d in s[c])if(Object.prototype.hasOwnProperty.call(s[c],d)&&"data"!==d&&!On(a[c][d],s[c][d]))return!1;return!0}function Tl(a,s,c,d,m,b){let w;for(w in s=s||{},a=a||{})Object.prototype.hasOwnProperty.call(a,w)&&(On(a[w],s[w])||c.push({command:b,args:[d,w,s[w],m]}));for(w in s)Object.prototype.hasOwnProperty.call(s,w)&&!Object.prototype.hasOwnProperty.call(a,w)&&(On(a[w],s[w])||c.push({command:b,args:[d,w,s[w],m]}))}function ia(a){return a.id}function Ba(a,s){return a[s.id]=s,a}class ke{constructor(s,c,d,m){this.message=(s?`${s}: `:"")+d,m&&(this.identifier=m),null!=c&&c.__line__&&(this.line=c.__line__)}}function $s(a,...s){for(const c of s)for(const d in c)a[d]=c[d];return a}class mi extends Error{constructor(s,c){super(c),this.message=c,this.key=s}}class ra{constructor(s,c=[]){this.parent=s,this.bindings={};for(const[d,m]of c)this.bindings[d]=m}concat(s){return new ra(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}const To={kind:"null"},je={kind:"number"},Bt={kind:"string"},Mt={kind:"boolean"},Or={kind:"color"},oo={kind:"object"},Ft={kind:"value"},Do={kind:"collator"},X={kind:"formatted"},z={kind:"padding"},U={kind:"resolvedImage"},q={kind:"variableAnchorOffsetCollection"};function J(a,s){return{kind:"array",itemType:a,N:s}}function ne(a){if("array"===a.kind){const s=ne(a.itemType);return"number"==typeof a.N?`array<${s}, ${a.N}>`:"value"===a.itemType.kind?"array":`array<${s}>`}return a.kind}const de=[To,je,Bt,Mt,Or,X,oo,J(Ft),z,U,q];function ae(a,s){if("error"===s.kind)return null;if("array"===a.kind){if("array"===s.kind&&(0===s.N&&"value"===s.itemType.kind||!ae(a.itemType,s.itemType))&&("number"!=typeof a.N||a.N===s.N))return null}else{if(a.kind===s.kind)return null;if("value"===a.kind)for(const c of de)if(!ae(c,s))return null}return`Expected ${ne(a)} but found ${ne(s)} instead.`}function se(a,s){return s.some(c=>c.kind===a.kind)}function ue(a,s){return s.some(c=>"null"===c?null===a:"array"===c?Array.isArray(a):"object"===c?a&&!Array.isArray(a)&&"object"==typeof a:c===typeof a)}function Ce(a,s){return"array"===a.kind&&"array"===s.kind?a.itemType.kind===s.itemType.kind&&"number"==typeof a.N:a.kind===s.kind}const Je=4/29,Ct=6/29,it=3*Ct*Ct,gt=Ct*Ct*Ct,Pt=Math.PI/180,_n=180/Math.PI;function Nn(a){return(a%=360)<0&&(a+=360),a}function hn([a,s,c,d]){let m,b;const w=xr((.2225045*(a=zt(a))+.7168786*(s=zt(s))+.0606169*(c=zt(c)))/1);a===s&&s===c?m=b=w:(m=xr((.4360747*a+.3850649*s+.1430804*c)/.96422),b=xr((.0139322*a+.0971045*s+.7141733*c)/.82521));const E=116*w-16;return[E<0?0:E,500*(m-w),200*(w-b),d]}function zt(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function xr(a){return a>gt?Math.pow(a,1/3):a/it+Je}function Ut([a,s,c,d]){let m=(a+16)/116,b=isNaN(s)?m:m+s/500,w=isNaN(c)?m:m-c/200;return m=1*Zn(m),b=.96422*Zn(b),w=.82521*Zn(w),[ti(3.1338561*b-1.6168667*m-.4906146*w),ti(-.9787684*b+1.9161415*m+.033454*w),ti(.0719453*b-.2289914*m+1.4052427*w),d]}function ti(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function Zn(a){return a>Ct?a*a*a:it*(a-Je)}function Hs(a){return parseInt(a.padEnd(2,a),16)/255}function kd(a,s){return Dl(s?a/100:a,0,1)}function Dl(a,s,c){return Math.min(Math.max(s,a),c)}function sa(a){return!a.some(Number.isNaN)}const Dp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class gn{constructor(s,c,d,m=1,b=!0){this.r=s,this.g=c,this.b=d,this.a=m,b||(this.r*=m,this.g*=m,this.b*=m,m||this.overwriteGetter("rgb",[s,c,d,m]))}static parse(s){if(s instanceof gn)return s;if("string"!=typeof s)return;const c=function(d){if("transparent"===(d=d.toLowerCase().trim()))return[0,0,0,0];const m=Dp[d];if(m){const[w,E,D]=m;return[w/255,E/255,D/255,1]}if(d.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(d)){const w=d.length<6?1:2;let E=1;return[Hs(d.slice(E,E+=w)),Hs(d.slice(E,E+=w)),Hs(d.slice(E,E+=w)),Hs(d.slice(E,E+w)||"ff")]}if(d.startsWith("rgb")){const w=d.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(w){const[E,D,M,L,N,B,j,H,W,te,re,ce]=w,oe=[L||" ",j||" ",te].join("");if("  "===oe||"  /"===oe||",,"===oe||",,,"===oe){const fe=[M,B,W].join(""),ye="%%%"===fe?100:""===fe?255:0;if(ye){const Te=[Dl(+D/ye,0,1),Dl(+N/ye,0,1),Dl(+H/ye,0,1),re?kd(+re,ce):1];if(sa(Te))return Te}}return}}const b=d.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){const[w,E,D,M,L,N,B,j,H]=b,W=[D||" ",L||" ",B].join("");if("  "===W||"  /"===W||",,"===W||",,,"===W){const te=[+E,Dl(+M,0,100),Dl(+N,0,100),j?kd(+j,H):1];if(sa(te))return function([re,ce,oe,fe]){function ye(Te){const Ze=(Te+re/30)%12,nt=ce*Math.min(oe,1-oe);return oe-nt*Math.max(-1,Math.min(Ze-3,9-Ze,1))}return re=Nn(re),ce/=100,oe/=100,[ye(0),ye(8),ye(4),fe]}(te)}}}(s);return c?new gn(...c,!1):void 0}get rgb(){const{r:s,g:c,b:d,a:m}=this,b=m||1/0;return this.overwriteGetter("rgb",[s/b,c/b,d/b,m])}get hcl(){return this.overwriteGetter("hcl",function(s){const[c,d,m,b]=hn(s),w=Math.sqrt(d*d+m*m);return[Math.round(1e4*w)?Nn(Math.atan2(m,d)*_n):NaN,w,c,b]}(this.rgb))}get lab(){return this.overwriteGetter("lab",hn(this.rgb))}overwriteGetter(s,c){return Object.defineProperty(this,s,{value:c}),c}toString(){const[s,c,d,m]=this.rgb;return`rgba(${[s,c,d].map(b=>Math.round(255*b)).join(",")},${m})`}}gn.black=new gn(0,0,0,1),gn.white=new gn(1,1,1,1),gn.transparent=new gn(0,0,0,0),gn.red=new gn(1,0,0,1);class dh{constructor(s,c,d){this.sensitivity=s?c?"variant":"case":c?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,c){return this.collator.compare(s,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class hc{constructor(s,c,d,m,b){this.text=s,this.image=c,this.scale=d,this.fontStack=m,this.textColor=b}}class ur{constructor(s){this.sections=s}static fromString(s){return new ur([new hc(s,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(s=>0!==s.text.length||s.image&&0!==s.image.name.length)}static factory(s){return s instanceof ur?s:ur.fromString(s)}toString(){return 0===this.sections.length?"":this.sections.map(s=>s.text).join("")}}class cs{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof cs)return s;if("number"==typeof s)return new cs([s,s,s,s]);if(Array.isArray(s)&&!(s.length<1||s.length>4)){for(const c of s)if("number"!=typeof c)return;switch(s.length){case 1:s=[s[0],s[0],s[0],s[0]];break;case 2:s=[s[0],s[1],s[0],s[1]];break;case 3:s=[s[0],s[1],s[2],s[1]]}return new cs(s)}}toString(){return JSON.stringify(this.values)}}const Ip=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Ts{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof Ts)return s;if(Array.isArray(s)&&!(s.length<1)&&s.length%2==0){for(let c=0;c<s.length;c+=2){const d=s[c],m=s[c+1];if("string"!=typeof d||!Ip.has(d)||!Array.isArray(m)||2!==m.length||"number"!=typeof m[0]||"number"!=typeof m[1])return}return new Ts(s)}}toString(){return JSON.stringify(this.values)}}class hr{constructor(s){this.name=s.name,this.available=s.available}toString(){return this.name}static fromString(s){return s?new hr({name:s,available:!1}):null}}function dc(a,s,c,d){return"number"==typeof a&&a>=0&&a<=255&&"number"==typeof s&&s>=0&&s<=255&&"number"==typeof c&&c>=0&&c<=255?void 0===d||"number"==typeof d&&d>=0&&d<=1?null:`Invalid rgba value [${[a,s,c,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof d?[a,s,c,d]:[a,s,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Il(a){if(null===a||"string"==typeof a||"boolean"==typeof a||"number"==typeof a||a instanceof gn||a instanceof dh||a instanceof ur||a instanceof cs||a instanceof Ts||a instanceof hr)return!0;if(Array.isArray(a)){for(const s of a)if(!Il(s))return!1;return!0}if("object"==typeof a){for(const s in a)if(!Il(a[s]))return!1;return!0}return!1}function oi(a){if(null===a)return To;if("string"==typeof a)return Bt;if("boolean"==typeof a)return Mt;if("number"==typeof a)return je;if(a instanceof gn)return Or;if(a instanceof dh)return Do;if(a instanceof ur)return X;if(a instanceof cs)return z;if(a instanceof Ts)return q;if(a instanceof hr)return U;if(Array.isArray(a)){const s=a.length;let c;for(const d of a){const m=oi(d);if(c){if(c===m)continue;c=Ft;break}c=m}return J(c||Ft,s)}return oo}function It(a){const s=typeof a;return null===a?"":"string"===s||"number"===s||"boolean"===s?String(a):a instanceof gn||a instanceof ur||a instanceof cs||a instanceof Ts||a instanceof hr?a.toString():JSON.stringify(a)}class Ua{constructor(s,c){this.type=s,this.value=c}static parse(s,c){if(2!==s.length)return c.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!Il(s[1]))return c.error("invalid value");const d=s[1];let m=oi(d);const b=c.expectedType;return"array"!==m.kind||0!==m.N||!b||"array"!==b.kind||"number"==typeof b.N&&0!==b.N||(m=b),new Ua(m,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class yn{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}}const Et={string:Bt,number:je,boolean:Mt,object:oo};class us{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");let d,m=1;const b=s[0];if("array"===b){let E,D;if(s.length>2){const M=s[1];if("string"!=typeof M||!(M in Et)||"object"===M)return c.error('The item type argument of "array" must be one of string, number, boolean',1);E=Et[M],m++}else E=Ft;if(s.length>3){if(null!==s[2]&&("number"!=typeof s[2]||s[2]<0||s[2]!==Math.floor(s[2])))return c.error('The length argument to "array" must be a positive integer literal',2);D=s[2],m++}d=J(E,D)}else{if(!Et[b])throw new Error(`Types doesn't contain name = ${b}`);d=Et[b]}const w=[];for(;m<s.length;m++){const E=c.parse(s[m],m,Ft);if(!E)return null;w.push(E)}return new us(d,w)}evaluate(s){for(let c=0;c<this.args.length;c++){const d=this.args[c].evaluate(s);if(!ae(this.type,oi(d)))return d;if(c===this.args.length-1)throw new yn(`Expected value to be of type ${ne(this.type)}, but found ${ne(oi(d))} instead.`)}throw new Error}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const fc={"to-boolean":Mt,"to-color":Or,"to-number":je,"to-string":Bt};class tr{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");const d=s[0];if(!fc[d])throw new Error(`Can't parse ${d} as it is not part of the known types`);if(("to-boolean"===d||"to-string"===d)&&2!==s.length)return c.error("Expected one argument.");const m=fc[d],b=[];for(let w=1;w<s.length;w++){const E=c.parse(s[w],w,Ft);if(!E)return null;b.push(E)}return new tr(m,b)}evaluate(s){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(s);case"color":{let c,d;for(const m of this.args){if(c=m.evaluate(s),d=null,c instanceof gn)return c;if("string"==typeof c){const b=s.parseColor(c);if(b)return b}else if(Array.isArray(c)&&(d=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:dc(c[0],c[1],c[2],c[3]),!d))return new gn(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new yn(d||`Could not parse color from value '${"string"==typeof c?c:JSON.stringify(c)}'`)}case"padding":{let c;for(const d of this.args){c=d.evaluate(s);const m=cs.parse(c);if(m)return m}throw new yn(`Could not parse padding from value '${"string"==typeof c?c:JSON.stringify(c)}'`)}case"variableAnchorOffsetCollection":{let c;for(const d of this.args){c=d.evaluate(s);const m=Ts.parse(c);if(m)return m}throw new yn(`Could not parse variableAnchorOffsetCollection from value '${"string"==typeof c?c:JSON.stringify(c)}'`)}case"number":{let c=null;for(const d of this.args){if(c=d.evaluate(s),null===c)return 0;const m=Number(c);if(!isNaN(m))return m}throw new yn(`Could not convert ${JSON.stringify(c)} to number.`)}case"formatted":return ur.fromString(It(this.args[0].evaluate(s)));case"resolvedImage":return hr.fromString(It(this.args[0].evaluate(s)));default:return It(this.args[0].evaluate(s))}}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const Od=["Unknown","Point","LineString","Polygon"];class fh{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Od[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(s){let c=this._parseColorCache[s];return c||(c=this._parseColorCache[s]=gn.parse(s)),c}}class wn{constructor(s,c,d=[],m,b=new ra,w=[]){this.registry=s,this.path=d,this.key=d.map(E=>`[${E}]`).join(""),this.scope=b,this.errors=w,this.expectedType=m,this._isConstant=c}parse(s,c,d,m,b={}){return c?this.concat(c,d,m)._parse(s,b):this._parse(s,b)}_parse(s,c){function d(m,b,w){return"assert"===w?new us(b,[m]):"coerce"===w?new tr(b,[m]):m}if(null!==s&&"string"!=typeof s&&"boolean"!=typeof s&&"number"!=typeof s||(s=["literal",s]),Array.isArray(s)){if(0===s.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=s[0];if("string"!=typeof m)return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const b=this.registry[m];if(b){let w=b.parse(s,this);if(!w)return null;if(this.expectedType){const E=this.expectedType,D=w.type;if("string"!==E.kind&&"number"!==E.kind&&"boolean"!==E.kind&&"object"!==E.kind&&"array"!==E.kind||"value"!==D.kind)if("color"!==E.kind&&"formatted"!==E.kind&&"resolvedImage"!==E.kind||"value"!==D.kind&&"string"!==D.kind)if("padding"!==E.kind||"value"!==D.kind&&"number"!==D.kind&&"array"!==D.kind)if("variableAnchorOffsetCollection"!==E.kind||"value"!==D.kind&&"array"!==D.kind){if(this.checkSubtype(E,D))return null}else w=d(w,E,c.typeAnnotation||"coerce");else w=d(w,E,c.typeAnnotation||"coerce");else w=d(w,E,c.typeAnnotation||"coerce");else w=d(w,E,c.typeAnnotation||"assert")}if(!(w instanceof Ua)&&"resolvedImage"!==w.type.kind&&this._isConstant(w)){const E=new fh;try{w=new Ua(w.type,w.evaluate(E))}catch(D){return this.error(D.message),null}}return w}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===s?"'undefined' value invalid. Use null instead.":"object"==typeof s?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,c,d){const m="number"==typeof s?this.path.concat(s):this.path,b=d?this.scope.concat(d):this.scope;return new wn(this.registry,this._isConstant,m,c||null,b,this.errors)}error(s,...c){const d=`${this.key}${c.map(m=>`[${m}]`).join("")}`;this.errors.push(new mi(d,s))}checkSubtype(s,c){const d=ae(s,c);return d&&this.error(d),d}}class Va{constructor(s,c,d){this.type=Do,this.locale=d,this.caseSensitive=s,this.diacriticSensitive=c}static parse(s,c){if(2!==s.length)return c.error("Expected one argument.");const d=s[1];if("object"!=typeof d||Array.isArray(d))return c.error("Collator options argument must be an object.");const m=c.parse(void 0!==d["case-sensitive"]&&d["case-sensitive"],1,Mt);if(!m)return null;const b=c.parse(void 0!==d["diacritic-sensitive"]&&d["diacritic-sensitive"],1,Mt);if(!b)return null;let w=null;return d.locale&&(w=c.parse(d.locale,1,Bt),!w)?null:new Va(m,b,w)}evaluate(s){return new dh(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}}const Kn=8192;function pc(a,s){a[0]=Math.min(a[0],s[0]),a[1]=Math.min(a[1],s[1]),a[2]=Math.max(a[2],s[0]),a[3]=Math.max(a[3],s[1])}function mc(a,s){return!(a[0]<=s[0]||a[2]>=s[2]||a[1]<=s[1]||a[3]>=s[3])}function yu(a,s){const c=(180+a[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,m=Math.pow(2,s.z);return[Math.round(c*m*Kn),Math.round(d*m*Kn)]}function Ot(a,s,c){const d=a[0]-s[0],m=a[1]-s[1],b=a[0]-c[0],w=a[1]-c[1];return d*w-b*m==0&&d*b<=0&&m*w<=0}function gc(a,s){let c=!1;for(let w=0,E=s.length;w<E;w++){const D=s[w];for(let M=0,L=D.length;M<L-1;M++){if(Ot(a,D[M],D[M+1]))return!1;(m=D[M])[1]>(d=a)[1]!=(b=D[M+1])[1]>d[1]&&d[0]<(b[0]-m[0])*(d[1]-m[1])/(b[1]-m[1])+m[0]&&(c=!c)}}var d,m,b;return c}function yc(a,s){for(let c=0;c<s.length;c++)if(gc(a,s[c]))return!0;return!1}function Ap(a,s,c,d){const m=d[0]-c[0],b=d[1]-c[1],w=(a[0]-c[0])*b-m*(a[1]-c[1]),E=(s[0]-c[0])*b-m*(s[1]-c[1]);return w>0&&E<0||w<0&&E>0}function Nd(a,s,c){for(const M of c)for(let L=0;L<M.length-1;++L)if((E=[(w=M[L+1])[0]-(b=M[L])[0],w[1]-b[1]])[0]*(D=[(m=s)[0]-(d=a)[0],m[1]-d[1]])[1]-E[1]*D[0]!=0&&Ap(d,m,b,w)&&Ap(b,w,d,m))return!0;var d,m,b,w,E,D;return!1}function Ie(a,s){for(let c=0;c<a.length;++c)if(!gc(a[c],s))return!1;for(let c=0;c<a.length-1;++c)if(Nd(a[c],a[c+1],s))return!1;return!0}function _c(a,s){for(let c=0;c<s.length;c++)if(Ie(a,s[c]))return!0;return!1}function Lt(a,s,c){const d=[];for(let m=0;m<a.length;m++){const b=[];for(let w=0;w<a[m].length;w++){const E=yu(a[m][w],c);pc(s,E),b.push(E)}d.push(b)}return d}function Tn(a,s,c){const d=[];for(let m=0;m<a.length;m++){const b=Lt(a[m],s,c);d.push(b)}return d}function Fd(a,s,c,d){if(a[0]<c[0]||a[0]>c[2]){const m=.5*d;let b=a[0]-c[0]>m?-d:c[0]-a[0]>m?d:0;0===b&&(b=a[0]-c[2]>m?-d:c[2]-a[0]>m?d:0),a[0]+=b}pc(s,a)}function zd(a,s,c,d){const m=Math.pow(2,d.z)*Kn,b=[d.x*Kn,d.y*Kn],w=[];for(const E of a)for(const D of E){const M=[D.x+b[0],D.y+b[1]];Fd(M,s,c,m),w.push(M)}return w}function ph(a,s,c,d){const m=Math.pow(2,d.z)*Kn,b=[d.x*Kn,d.y*Kn],w=[];for(const D of a){const M=[];for(const L of D){const N=[L.x+b[0],L.y+b[1]];pc(s,N),M.push(N)}w.push(M)}if(s[2]-s[0]<=m/2){(E=s)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const D of w)for(const M of D)Fd(M,s,c,m)}var E;return w}class Io{constructor(s,c){this.type=Mt,this.geojson=s,this.geometries=c}static parse(s,c){if(2!==s.length)return c.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(Il(s[1])){const d=s[1];if("FeatureCollection"===d.type)for(let m=0;m<d.features.length;++m){const b=d.features[m].geometry.type;if("Polygon"===b||"MultiPolygon"===b)return new Io(d,d.features[m].geometry)}else if("Feature"===d.type){const m=d.geometry.type;if("Polygon"===m||"MultiPolygon"===m)return new Io(d,d.geometry)}else if("Polygon"===d.type||"MultiPolygon"===d.type)return new Io(d,d)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(null!=s.geometry()&&null!=s.canonicalID()){if("Point"===s.geometryType())return function(c,d){const m=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],w=c.canonicalID();if("Polygon"===d.type){const E=Lt(d.coordinates,b,w),D=zd(c.geometry(),m,b,w);if(!mc(m,b))return!1;for(const M of D)if(!gc(M,E))return!1}if("MultiPolygon"===d.type){const E=Tn(d.coordinates,b,w),D=zd(c.geometry(),m,b,w);if(!mc(m,b))return!1;for(const M of D)if(!yc(M,E))return!1}return!0}(s,this.geometries);if("LineString"===s.geometryType())return function(c,d){const m=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],w=c.canonicalID();if("Polygon"===d.type){const E=Lt(d.coordinates,b,w),D=ph(c.geometry(),m,b,w);if(!mc(m,b))return!1;for(const M of D)if(!Ie(M,E))return!1}if("MultiPolygon"===d.type){const E=Tn(d.coordinates,b,w),D=ph(c.geometry(),m,b,w);if(!mc(m,b))return!1;for(const M of D)if(!_c(M,E))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class wr{constructor(s,c){this.type=c.type,this.name=s,this.boundExpression=c}static parse(s,c){if(2!==s.length||"string"!=typeof s[1])return c.error("'var' expression requires exactly one string literal argument.");const d=s[1];return c.scope.has(d)?new wr(d,c.scope.get(d)):c.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}}class qs{constructor(s,c,d,m){this.name=s,this.type=c,this._evaluate=d,this.args=m}evaluate(s){return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}static parse(s,c){const d=s[0],m=qs.definitions[d];if(!m)return c.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(m)?m[0]:m.type,w=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,E=w.filter(([M])=>!Array.isArray(M)||M.length===s.length-1);let D=null;for(const[M,L]of E){D=new wn(c.registry,_u,c.path,null,c.scope);const N=[];let B=!1;for(let j=1;j<s.length;j++){const H=s[j],W=Array.isArray(M)?M[j-1]:M.type,te=D.parse(H,1+N.length,W);if(!te){B=!0;break}N.push(te)}if(!B)if(Array.isArray(M)&&M.length!==N.length)D.error(`Expected ${M.length} arguments, but found ${N.length} instead.`);else{for(let j=0;j<N.length;j++){const H=Array.isArray(M)?M[j]:M.type,W=N[j];D.concat(j+1).checkSubtype(H,W.type)}if(0===D.errors.length)return new qs(d,b,L,N)}}if(1===E.length)c.errors.push(...D.errors);else{const M=(E.length?E:w).map(([N])=>{return B=N,Array.isArray(B)?`(${B.map(ne).join(", ")})`:`(${ne(B.type)}...)`;var B}).join(" | "),L=[];for(let N=1;N<s.length;N++){const B=c.parse(s[N],1+L.length);if(!B)return null;L.push(ne(B.type))}c.error(`Expected arguments of type ${M}, but found (${L.join(", ")}) instead.`)}return null}static register(s,c){qs.definitions=c;for(const d in c)s[d]=qs}}function _u(a){if(a instanceof wr)return _u(a.boundExpression);if(a instanceof qs&&"error"===a.name||a instanceof Va||a instanceof Io)return!1;const s=a instanceof tr||a instanceof us;let c=!0;return a.eachChild(d=>{c=s?c&&_u(d):c&&d instanceof Ua}),!!c&&mh(a)&&gh(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function mh(a){if(a instanceof qs&&("get"===a.name&&1===a.args.length||"feature-state"===a.name||"has"===a.name&&1===a.args.length||"properties"===a.name||"geometry-type"===a.name||"id"===a.name||/^filter-/.test(a.name))||a instanceof Io)return!1;let s=!0;return a.eachChild(c=>{s&&!mh(c)&&(s=!1)}),s}function Gs(a){if(a instanceof qs&&"feature-state"===a.name)return!1;let s=!0;return a.eachChild(c=>{s&&!Gs(c)&&(s=!1)}),s}function gh(a,s){if(a instanceof qs&&s.indexOf(a.name)>=0)return!1;let c=!0;return a.eachChild(d=>{c&&!gh(d,s)&&(c=!1)}),c}function vc(a,s){const c=a.length-1;let d,m,b=0,w=c,E=0;for(;b<=w;)if(E=Math.floor((b+w)/2),d=a[E],m=a[E+1],d<=s){if(E===c||s<m)return E;b=E+1}else{if(!(d>s))throw new yn("Input is not a number.");w=E-1}return 0}class ja{constructor(s,c,d){this.type=s,this.input=c,this.labels=[],this.outputs=[];for(const[m,b]of d)this.labels.push(m),this.outputs.push(b)}static parse(s,c){if(s.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return c.error("Expected an even number of arguments.");const d=c.parse(s[1],1,je);if(!d)return null;const m=[];let b=null;c.expectedType&&"value"!==c.expectedType.kind&&(b=c.expectedType);for(let w=1;w<s.length;w+=2){const E=1===w?-1/0:s[w],D=s[w+1],M=w,L=w+1;if("number"!=typeof E)return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(m.length&&m[m.length-1][0]>=E)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const N=c.parse(D,L,b);if(!N)return null;b=b||N.type,m.push([E,N])}return new ja(b,d,m)}evaluate(s){const c=this.labels,d=this.outputs;if(1===c.length)return d[0].evaluate(s);const m=this.input.evaluate(s);if(m<=c[0])return d[0].evaluate(s);const b=c.length;return m>=c[b-1]?d[b-1].evaluate(s):d[vc(c,m)].evaluate(s)}eachChild(s){s(this.input);for(const c of this.outputs)s(c)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}function cn(a,s,c){return a+c*(s-a)}function vu(a,s,c){return a.map((d,m)=>cn(d,s[m],c))}const Ds={number:cn,color:function(a,s,c,d="rgb"){switch(d){case"rgb":{const[m,b,w,E]=vu(a.rgb,s.rgb,c);return new gn(m,b,w,E,!1)}case"hcl":{const[m,b,w,E]=a.hcl,[D,M,L,N]=s.hcl;let B,j;if(isNaN(m)||isNaN(D))isNaN(m)?isNaN(D)?B=NaN:(B=D,1!==w&&0!==w||(j=M)):(B=m,1!==L&&0!==L||(j=b));else{let ce=D-m;D>m&&ce>180?ce-=360:D<m&&m-D>180&&(ce+=360),B=m+c*ce}const[H,W,te,re]=function([ce,oe,fe,ye]){return ce=isNaN(ce)?0:ce*Pt,Ut([fe,Math.cos(ce)*oe,Math.sin(ce)*oe,ye])}([B,j??cn(b,M,c),cn(w,L,c),cn(E,N,c)]);return new gn(H,W,te,re,!1)}case"lab":{const[m,b,w,E]=Ut(vu(a.lab,s.lab,c));return new gn(m,b,w,E,!1)}}},array:vu,padding:function(a,s,c){return new cs(vu(a.values,s.values,c))},variableAnchorOffsetCollection:function(a,s,c){const d=a.values,m=s.values;if(d.length!==m.length)throw new yn(`Cannot interpolate values of different length. from: ${a.toString()}, to: ${s.toString()}`);const b=[];for(let w=0;w<d.length;w+=2){if(d[w]!==m[w])throw new yn(`Cannot interpolate values containing mismatched anchors. from[${w}]: ${d[w]}, to[${w}]: ${m[w]}`);b.push(d[w]);const[E,D]=d[w+1],[M,L]=m[w+1];b.push([cn(E,M,c),cn(D,L,c)])}return new Ts(b)}};class hs{constructor(s,c,d,m,b){this.type=s,this.operator=c,this.interpolation=d,this.input=m,this.labels=[],this.outputs=[];for(const[w,E]of b)this.labels.push(w),this.outputs.push(E)}static interpolationFactor(s,c,d,m){let b=0;if("exponential"===s.name)b=Bd(c,s.base,d,m);else if("linear"===s.name)b=Bd(c,1,d,m);else if("cubic-bezier"===s.name){const w=s.controlPoints;b=new Us(w[0],w[1],w[2],w[3]).solve(Bd(c,1,d,m))}return b}static parse(s,c){let[d,m,b,...w]=s;if(!Array.isArray(m)||0===m.length)return c.error("Expected an interpolation type expression.",1);if("linear"===m[0])m={name:"linear"};else if("exponential"===m[0]){const M=m[1];if("number"!=typeof M)return c.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:M}}else{if("cubic-bezier"!==m[0])return c.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const M=m.slice(1);if(4!==M.length||M.some(L=>"number"!=typeof L||L<0||L>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:M}}}if(s.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(b=c.parse(b,2,je),!b)return null;const E=[];let D=null;"interpolate-hcl"===d||"interpolate-lab"===d?D=Or:c.expectedType&&"value"!==c.expectedType.kind&&(D=c.expectedType);for(let M=0;M<w.length;M+=2){const L=w[M],N=w[M+1],B=M+3,j=M+4;if("number"!=typeof L)return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(E.length&&E[E.length-1][0]>=L)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',B);const H=c.parse(N,j,D);if(!H)return null;D=D||H.type,E.push([L,H])}return Ce(D,je)||Ce(D,Or)||Ce(D,z)||Ce(D,q)||Ce(D,J(je))?new hs(D,d,m,b,E):c.error(`Type ${ne(D)} is not interpolatable.`)}evaluate(s){const c=this.labels,d=this.outputs;if(1===c.length)return d[0].evaluate(s);const m=this.input.evaluate(s);if(m<=c[0])return d[0].evaluate(s);const b=c.length;if(m>=c[b-1])return d[b-1].evaluate(s);const w=vc(c,m),E=hs.interpolationFactor(this.interpolation,m,c[w],c[w+1]),D=d[w].evaluate(s),M=d[w+1].evaluate(s);switch(this.operator){case"interpolate":return Ds[this.type.kind](D,M,E);case"interpolate-hcl":return Ds.color(D,M,E,"hcl");case"interpolate-lab":return Ds.color(D,M,E,"lab")}}eachChild(s){s(this.input);for(const c of this.outputs)s(c)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}function Bd(a,s,c,d){const m=d-c,b=a-c;return 0===m?0:1===s?b/m:(Math.pow(s,b)-1)/(Math.pow(s,m)-1)}class Nr{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expectected at least one argument.");let d=null;const m=c.expectedType;m&&"value"!==m.kind&&(d=m);const b=[];for(const E of s.slice(1)){const D=c.parse(E,1+b.length,d,void 0,{typeAnnotation:"omit"});if(!D)return null;d=d||D.type,b.push(D)}if(!d)throw new Error("No output type");const w=m&&b.some(E=>ae(m,E.type));return new Nr(w?Ft:d,b)}evaluate(s){let c,d=null,m=0;for(const b of this.args)if(m++,d=b.evaluate(s),d&&d instanceof hr&&!d.available&&(c||(c=d.name),d=null,m===this.args.length&&(d=c)),null!==d)break;return d}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}class St{constructor(s,c){this.type=c.type,this.bindings=[].concat(s),this.result=c}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const c of this.bindings)s(c[1]);s(this.result)}static parse(s,c){if(s.length<4)return c.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const d=[];for(let b=1;b<s.length-1;b+=2){const w=s[b];if("string"!=typeof w)return c.error(`Expected string, but found ${typeof w} instead.`,b);if(/[^a-zA-Z0-9_]/.test(w))return c.error("Variable names must contain only alphanumeric characters or '_'.",b);const E=c.parse(s[b+1],b+1);if(!E)return null;d.push([w,E])}const m=c.parse(s[s.length-1],s.length-1,c.expectedType,d);return m?new St(d,m):null}outputDefined(){return this.result.outputDefined()}}class Ud{constructor(s,c,d){this.type=s,this.index=c,this.input=d}static parse(s,c){if(3!==s.length)return c.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const d=c.parse(s[1],1,je),m=c.parse(s[2],2,J(c.expectedType||Ft));return d&&m?new Ud(m.type.itemType,d,m):null}evaluate(s){const c=this.index.evaluate(s),d=this.input.evaluate(s);if(c<0)throw new yn(`Array index out of bounds: ${c} < 0.`);if(c>=d.length)throw new yn(`Array index out of bounds: ${c} > ${d.length-1}.`);if(c!==Math.floor(c))throw new yn(`Array index must be an integer, but found ${c} instead.`);return d[c]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}}class Vd{constructor(s,c){this.type=Mt,this.needle=s,this.haystack=c}static parse(s,c){if(3!==s.length)return c.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const d=c.parse(s[1],1,Ft),m=c.parse(s[2],2,Ft);return d&&m?se(d.type,[Mt,Bt,je,To,Ft])?new Vd(d,m):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${ne(d.type)} instead`):null}evaluate(s){const c=this.needle.evaluate(s),d=this.haystack.evaluate(s);if(!d)return!1;if(!ue(c,["boolean","string","number","null"]))throw new yn(`Expected first argument to be of type boolean, string, number or null, but found ${ne(oi(c))} instead.`);if(!ue(d,["string","array"]))throw new yn(`Expected second argument to be of type array or string, but found ${ne(oi(d))} instead.`);return d.indexOf(c)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}}class yh{constructor(s,c,d){this.type=je,this.needle=s,this.haystack=c,this.fromIndex=d}static parse(s,c){if(s.length<=2||s.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const d=c.parse(s[1],1,Ft),m=c.parse(s[2],2,Ft);if(!d||!m)return null;if(!se(d.type,[Mt,Bt,je,To,Ft]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${ne(d.type)} instead`);if(4===s.length){const b=c.parse(s[3],3,je);return b?new yh(d,m,b):null}return new yh(d,m)}evaluate(s){const c=this.needle.evaluate(s),d=this.haystack.evaluate(s);if(!ue(c,["boolean","string","number","null"]))throw new yn(`Expected first argument to be of type boolean, string, number or null, but found ${ne(oi(c))} instead.`);if(!ue(d,["string","array"]))throw new yn(`Expected second argument to be of type array or string, but found ${ne(oi(d))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(s);return d.indexOf(c,m)}return d.indexOf(c)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}}class ft{constructor(s,c,d,m,b,w){this.inputType=s,this.type=c,this.input=d,this.cases=m,this.outputs=b,this.otherwise=w}static parse(s,c){if(s.length<5)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return c.error("Expected an even number of arguments.");let d,m;c.expectedType&&"value"!==c.expectedType.kind&&(m=c.expectedType);const b={},w=[];for(let M=2;M<s.length-1;M+=2){let L=s[M];const N=s[M+1];Array.isArray(L)||(L=[L]);const B=c.concat(M);if(0===L.length)return B.error("Expected at least one branch label.");for(const H of L){if("number"!=typeof H&&"string"!=typeof H)return B.error("Branch labels must be numbers or strings.");if("number"==typeof H&&Math.abs(H)>Number.MAX_SAFE_INTEGER)return B.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof H&&Math.floor(H)!==H)return B.error("Numeric branch labels must be integer values.");if(d){if(B.checkSubtype(d,oi(H)))return null}else d=oi(H);if(void 0!==b[String(H)])return B.error("Branch labels must be unique.");b[String(H)]=w.length}const j=c.parse(N,M,m);if(!j)return null;m=m||j.type,w.push(j)}const E=c.parse(s[1],1,Ft);if(!E)return null;const D=c.parse(s[s.length-1],s.length-1,m);return D?"value"!==E.type.kind&&c.concat(1).checkSubtype(d,E.type)?null:new ft(d,m,E,b,w,D):null}evaluate(s){const c=this.input.evaluate(s);return(oi(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}}class jd{constructor(s,c,d){this.type=s,this.branches=c,this.otherwise=d}static parse(s,c){if(s.length<4)return c.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return c.error("Expected an odd number of arguments.");let d;c.expectedType&&"value"!==c.expectedType.kind&&(d=c.expectedType);const m=[];for(let w=1;w<s.length-1;w+=2){const E=c.parse(s[w],w,Mt);if(!E)return null;const D=c.parse(s[w+1],w+1,d);if(!D)return null;m.push([E,D]),d=d||D.type}const b=c.parse(s[s.length-1],s.length-1,d);if(!b)return null;if(!d)throw new Error("Can't infer output type");return new jd(d,m,b)}evaluate(s){for(const[c,d]of this.branches)if(c.evaluate(s))return d.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[c,d]of this.branches)s(c),s(d);s(this.otherwise)}outputDefined(){return this.branches.every(([s,c])=>c.outputDefined())&&this.otherwise.outputDefined()}}class $i{constructor(s,c,d,m){this.type=s,this.input=c,this.beginIndex=d,this.endIndex=m}static parse(s,c){if(s.length<=2||s.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const d=c.parse(s[1],1,Ft),m=c.parse(s[2],2,je);if(!d||!m)return null;if(!se(d.type,[J(Ft),Bt,Ft]))return c.error(`Expected first argument to be of type array or string, but found ${ne(d.type)} instead`);if(4===s.length){const b=c.parse(s[3],3,je);return b?new $i(d.type,d,m,b):null}return new $i(d.type,d,m)}evaluate(s){const c=this.input.evaluate(s),d=this.beginIndex.evaluate(s);if(!ue(c,["string","array"]))throw new yn(`Expected first argument to be of type array or string, but found ${ne(oi(c))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(s);return c.slice(d,m)}return c.slice(d)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}}function bc(a,s){return"=="===a||"!="===a?"boolean"===s.kind||"string"===s.kind||"number"===s.kind||"null"===s.kind||"value"===s.kind:"string"===s.kind||"number"===s.kind||"value"===s.kind}function $d(a,s,c,d){return 0===d.compare(s,c)}function $a(a,s,c){const d="=="!==a&&"!="!==a;return class sP{constructor(b,w,E){this.type=Mt,this.lhs=b,this.rhs=w,this.collator=E,this.hasUntypedArgument="value"===b.type.kind||"value"===w.type.kind}static parse(b,w){if(3!==b.length&&4!==b.length)return w.error("Expected two or three arguments.");const E=b[0];let D=w.parse(b[1],1,Ft);if(!D)return null;if(!bc(E,D.type))return w.concat(1).error(`"${E}" comparisons are not supported for type '${ne(D.type)}'.`);let M=w.parse(b[2],2,Ft);if(!M)return null;if(!bc(E,M.type))return w.concat(2).error(`"${E}" comparisons are not supported for type '${ne(M.type)}'.`);if(D.type.kind!==M.type.kind&&"value"!==D.type.kind&&"value"!==M.type.kind)return w.error(`Cannot compare types '${ne(D.type)}' and '${ne(M.type)}'.`);d&&("value"===D.type.kind&&"value"!==M.type.kind?D=new us(M.type,[D]):"value"!==D.type.kind&&"value"===M.type.kind&&(M=new us(D.type,[M])));let L=null;if(4===b.length){if("string"!==D.type.kind&&"string"!==M.type.kind&&"value"!==D.type.kind&&"value"!==M.type.kind)return w.error("Cannot use collator to compare non-string types.");if(L=w.parse(b[3],3,Do),!L)return null}return new sP(D,M,L)}evaluate(b){const w=this.lhs.evaluate(b),E=this.rhs.evaluate(b);if(d&&this.hasUntypedArgument){const D=oi(w),M=oi(E);if(D.kind!==M.kind||"string"!==D.kind&&"number"!==D.kind)throw new yn(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${D.kind}, ${M.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const D=oi(w),M=oi(E);if("string"!==D.kind||"string"!==M.kind)return s(b,w,E)}return this.collator?c(b,w,E,this.collator.evaluate(b)):s(b,w,E)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}}}const Mp=$a("==",function(a,s,c){return s===c},$d),bu=$a("!=",function(a,s,c){return s!==c},function(a,s,c,d){return!$d(0,s,c,d)}),xu=$a("<",function(a,s,c){return s<c},function(a,s,c,d){return d.compare(s,c)<0}),_h=$a(">",function(a,s,c){return s>c},function(a,s,c,d){return d.compare(s,c)>0}),Hd=$a("<=",function(a,s,c){return s<=c},function(a,s,c,d){return d.compare(s,c)<=0}),Pp=$a(">=",function(a,s,c){return s>=c},function(a,s,c,d){return d.compare(s,c)>=0});class en{constructor(s,c,d,m,b){this.type=Bt,this.number=s,this.locale=c,this.currency=d,this.minFractionDigits=m,this.maxFractionDigits=b}static parse(s,c){if(3!==s.length)return c.error("Expected two arguments.");const d=c.parse(s[1],1,je);if(!d)return null;const m=s[2];if("object"!=typeof m||Array.isArray(m))return c.error("NumberFormat options argument must be an object.");let b=null;if(m.locale&&(b=c.parse(m.locale,1,Bt),!b))return null;let w=null;if(m.currency&&(w=c.parse(m.currency,1,Bt),!w))return null;let E=null;if(m["min-fraction-digits"]&&(E=c.parse(m["min-fraction-digits"],1,je),!E))return null;let D=null;return m["max-fraction-digits"]&&(D=c.parse(m["max-fraction-digits"],1,je),!D)?null:new en(d,b,w,E,D)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}}class Al{constructor(s){this.type=X,this.sections=s}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");const d=s[1];if(!Array.isArray(d)&&"object"==typeof d)return c.error("First argument must be an image or text section.");const m=[];let b=!1;for(let w=1;w<=s.length-1;++w){const E=s[w];if(b&&"object"==typeof E&&!Array.isArray(E)){b=!1;let D=null;if(E["font-scale"]&&(D=c.parse(E["font-scale"],1,je),!D))return null;let M=null;if(E["text-font"]&&(M=c.parse(E["text-font"],1,J(Bt)),!M))return null;let L=null;if(E["text-color"]&&(L=c.parse(E["text-color"],1,Or),!L))return null;const N=m[m.length-1];N.scale=D,N.font=M,N.textColor=L}else{const D=c.parse(s[w],1,Ft);if(!D)return null;const M=D.type.kind;if("string"!==M&&"value"!==M&&"null"!==M&&"resolvedImage"!==M)return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,m.push({content:D,scale:null,font:null,textColor:null})}}return new Al(m)}evaluate(s){return new ur(this.sections.map(c=>{const d=c.content.evaluate(s);return oi(d)===U?new hc("",d,null,null,null):new hc(It(d),null,c.scale?c.scale.evaluate(s):null,c.font?c.font.evaluate(s).join(","):null,c.textColor?c.textColor.evaluate(s):null)}))}eachChild(s){for(const c of this.sections)s(c.content),c.scale&&s(c.scale),c.font&&s(c.font),c.textColor&&s(c.textColor)}outputDefined(){return!1}}class wu{constructor(s){this.type=U,this.input=s}static parse(s,c){if(2!==s.length)return c.error("Expected two arguments.");const d=c.parse(s[1],1,Bt);return d?new wu(d):c.error("No image name provided.")}evaluate(s){const c=this.input.evaluate(s),d=hr.fromString(c);return d&&s.availableImages&&(d.available=s.availableImages.indexOf(c)>-1),d}eachChild(s){s(this.input)}outputDefined(){return!1}}class Cr{constructor(s){this.type=je,this.input=s}static parse(s,c){if(2!==s.length)return c.error(`Expected 1 argument, but found ${s.length-1} instead.`);const d=c.parse(s[1],1);return d?"array"!==d.type.kind&&"string"!==d.type.kind&&"value"!==d.type.kind?c.error(`Expected argument of type string or array, but found ${ne(d.type)} instead.`):new Cr(d):null}evaluate(s){const c=this.input.evaluate(s);if("string"==typeof c||Array.isArray(c))return c.length;throw new yn(`Expected value to be of type string or array, but found ${ne(oi(c))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}}const Ha={"==":Mp,"!=":bu,">":_h,"<":xu,">=":Pp,"<=":Hd,array:us,at:Ud,boolean:us,case:jd,coalesce:Nr,collator:Va,format:Al,image:wu,in:Vd,"index-of":yh,interpolate:hs,"interpolate-hcl":hs,"interpolate-lab":hs,length:Cr,let:St,literal:Ua,match:ft,number:us,"number-format":en,object:us,slice:$i,step:ja,string:us,"to-boolean":tr,"to-color":tr,"to-number":tr,"to-string":tr,var:wr,within:Io};function Rp(a,[s,c,d,m]){s=s.evaluate(a),c=c.evaluate(a),d=d.evaluate(a);const b=m?m.evaluate(a):1,w=dc(s,c,d,b);if(w)throw new yn(w);return new gn(s/255,c/255,d/255,b,!1)}function Vn(a,s){return a in s}function qd(a,s){const c=s[a];return void 0===c?null:c}function Ml(a){return{type:a}}function ut(a){return{result:"success",value:a}}function ao(a){return{result:"error",value:a}}function oa(a){return"data-driven"===a["property-type"]||"cross-faded-data-driven"===a["property-type"]}function vh(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function xc(a){return!!a.expression&&a.expression.interpolated}function vn(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":null===a?"null":typeof a}function Xn(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}function Ug(a){return a}function un(a,s){const c="color"===s.type,d=a.stops&&"object"==typeof a.stops[0][0],m=d||!(d||void 0!==a.property),b=a.type||(xc(s)?"exponential":"interval");if(c||"padding"===s.type){const L=c?gn.parse:cs.parse;(a=$s({},a)).stops&&(a.stops=a.stops.map(N=>[N[0],L(N[1])])),a.default=L(a.default?a.default:s.default)}if(a.colorSpace&&"rgb"!==(w=a.colorSpace)&&"hcl"!==w&&"lab"!==w)throw new Error(`Unknown color space: "${a.colorSpace}"`);var w;let E,D,M;if("exponential"===b)E=Ao;else if("interval"===b)E=ai;else if("categorical"===b){E=gi,D=Object.create(null);for(const L of a.stops)D[L[0]]=L[1];M=typeof a.stops[0][0]}else{if("identity"!==b)throw new Error(`Unknown function type "${b}"`);E=Cu}if(d){const L={},N=[];for(let H=0;H<a.stops.length;H++){const W=a.stops[H],te=W[0].zoom;void 0===L[te]&&(L[te]={zoom:te,type:a.type,property:a.property,default:a.default,stops:[]},N.push(te)),L[te].stops.push([W[0].value,W[1]])}const B=[];for(const H of N)B.push([L[H].zoom,un(L[H],s)]);const j={name:"linear"};return{kind:"composite",interpolationType:j,interpolationFactor:hs.interpolationFactor.bind(void 0,j),zoomStops:B.map(H=>H[0]),evaluate:({zoom:H},W)=>Ao({stops:B,base:a.base},s,H).evaluate(H,W)}}if(m){const L="exponential"===b?{name:"exponential",base:void 0!==a.base?a.base:1}:null;return{kind:"camera",interpolationType:L,interpolationFactor:hs.interpolationFactor.bind(void 0,L),zoomStops:a.stops.map(N=>N[0]),evaluate:({zoom:N})=>E(a,s,N,D,M)}}return{kind:"source",evaluate(L,N){const B=N&&N.properties?N.properties[a.property]:void 0;return void 0===B?Pl(a.default,s.default):E(a,s,B,D,M)}}}function Pl(a,s,c){return void 0!==a?a:void 0!==s?s:void 0!==c?c:void 0}function gi(a,s,c,d,m){return Pl(typeof c===m?d[c]:void 0,a.default,s.default)}function ai(a,s,c){if("number"!==vn(c))return Pl(a.default,s.default);const d=a.stops.length;if(1===d||c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[d-1][0])return a.stops[d-1][1];const m=vc(a.stops.map(b=>b[0]),c);return a.stops[m][1]}function Ao(a,s,c){const d=void 0!==a.base?a.base:1;if("number"!==vn(c))return Pl(a.default,s.default);const m=a.stops.length;if(1===m||c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[m-1][0])return a.stops[m-1][1];const b=vc(a.stops.map(L=>L[0]),c),w=function(L,N,B,j){const H=j-B,W=L-B;return 0===H?0:1===N?W/H:(Math.pow(N,W)-1)/(Math.pow(N,H)-1)}(c,d,a.stops[b][0],a.stops[b+1][0]),E=a.stops[b][1],D=a.stops[b+1][1],M=Ds[s.type]||Ug;return"function"==typeof E.evaluate?{evaluate(...L){const N=E.evaluate.apply(void 0,L),B=D.evaluate.apply(void 0,L);if(void 0!==N&&void 0!==B)return M(N,B,w,a.colorSpace)}}:M(E,D,w,a.colorSpace)}function Cu(a,s,c){switch(s.type){case"color":c=gn.parse(c);break;case"formatted":c=ur.fromString(c.toString());break;case"resolvedImage":c=hr.fromString(c.toString());break;case"padding":c=cs.parse(c);break;default:vn(c)===s.type||"enum"===s.type&&s.values[c]||(c=void 0)}return Pl(c,a.default,s.default)}qs.register(Ha,{error:[{kind:"error"},[Bt],(a,[s])=>{throw new yn(s.evaluate(a))}],typeof:[Bt,[Ft],(a,[s])=>ne(oi(s.evaluate(a)))],"to-rgba":[J(je,4),[Or],(a,[s])=>{const[c,d,m,b]=s.evaluate(a).rgb;return[255*c,255*d,255*m,b]}],rgb:[Or,[je,je,je],Rp],rgba:[Or,[je,je,je,je],Rp],has:{type:Mt,overloads:[[[Bt],(a,[s])=>Vn(s.evaluate(a),a.properties())],[[Bt,oo],(a,[s,c])=>Vn(s.evaluate(a),c.evaluate(a))]]},get:{type:Ft,overloads:[[[Bt],(a,[s])=>qd(s.evaluate(a),a.properties())],[[Bt,oo],(a,[s,c])=>qd(s.evaluate(a),c.evaluate(a))]]},"feature-state":[Ft,[Bt],(a,[s])=>qd(s.evaluate(a),a.featureState||{})],properties:[oo,[],a=>a.properties()],"geometry-type":[Bt,[],a=>a.geometryType()],id:[Ft,[],a=>a.id()],zoom:[je,[],a=>a.globals.zoom],"heatmap-density":[je,[],a=>a.globals.heatmapDensity||0],"line-progress":[je,[],a=>a.globals.lineProgress||0],accumulated:[Ft,[],a=>void 0===a.globals.accumulated?null:a.globals.accumulated],"+":[je,Ml(je),(a,s)=>{let c=0;for(const d of s)c+=d.evaluate(a);return c}],"*":[je,Ml(je),(a,s)=>{let c=1;for(const d of s)c*=d.evaluate(a);return c}],"-":{type:je,overloads:[[[je,je],(a,[s,c])=>s.evaluate(a)-c.evaluate(a)],[[je],(a,[s])=>-s.evaluate(a)]]},"/":[je,[je,je],(a,[s,c])=>s.evaluate(a)/c.evaluate(a)],"%":[je,[je,je],(a,[s,c])=>s.evaluate(a)%c.evaluate(a)],ln2:[je,[],()=>Math.LN2],pi:[je,[],()=>Math.PI],e:[je,[],()=>Math.E],"^":[je,[je,je],(a,[s,c])=>Math.pow(s.evaluate(a),c.evaluate(a))],sqrt:[je,[je],(a,[s])=>Math.sqrt(s.evaluate(a))],log10:[je,[je],(a,[s])=>Math.log(s.evaluate(a))/Math.LN10],ln:[je,[je],(a,[s])=>Math.log(s.evaluate(a))],log2:[je,[je],(a,[s])=>Math.log(s.evaluate(a))/Math.LN2],sin:[je,[je],(a,[s])=>Math.sin(s.evaluate(a))],cos:[je,[je],(a,[s])=>Math.cos(s.evaluate(a))],tan:[je,[je],(a,[s])=>Math.tan(s.evaluate(a))],asin:[je,[je],(a,[s])=>Math.asin(s.evaluate(a))],acos:[je,[je],(a,[s])=>Math.acos(s.evaluate(a))],atan:[je,[je],(a,[s])=>Math.atan(s.evaluate(a))],min:[je,Ml(je),(a,s)=>Math.min(...s.map(c=>c.evaluate(a)))],max:[je,Ml(je),(a,s)=>Math.max(...s.map(c=>c.evaluate(a)))],abs:[je,[je],(a,[s])=>Math.abs(s.evaluate(a))],round:[je,[je],(a,[s])=>{const c=s.evaluate(a);return c<0?-Math.round(-c):Math.round(c)}],floor:[je,[je],(a,[s])=>Math.floor(s.evaluate(a))],ceil:[je,[je],(a,[s])=>Math.ceil(s.evaluate(a))],"filter-==":[Mt,[Bt,Ft],(a,[s,c])=>a.properties()[s.value]===c.value],"filter-id-==":[Mt,[Ft],(a,[s])=>a.id()===s.value],"filter-type-==":[Mt,[Bt],(a,[s])=>a.geometryType()===s.value],"filter-<":[Mt,[Bt,Ft],(a,[s,c])=>{const d=a.properties()[s.value],m=c.value;return typeof d==typeof m&&d<m}],"filter-id-<":[Mt,[Ft],(a,[s])=>{const c=a.id(),d=s.value;return typeof c==typeof d&&c<d}],"filter->":[Mt,[Bt,Ft],(a,[s,c])=>{const d=a.properties()[s.value],m=c.value;return typeof d==typeof m&&d>m}],"filter-id->":[Mt,[Ft],(a,[s])=>{const c=a.id(),d=s.value;return typeof c==typeof d&&c>d}],"filter-<=":[Mt,[Bt,Ft],(a,[s,c])=>{const d=a.properties()[s.value],m=c.value;return typeof d==typeof m&&d<=m}],"filter-id-<=":[Mt,[Ft],(a,[s])=>{const c=a.id(),d=s.value;return typeof c==typeof d&&c<=d}],"filter->=":[Mt,[Bt,Ft],(a,[s,c])=>{const d=a.properties()[s.value],m=c.value;return typeof d==typeof m&&d>=m}],"filter-id->=":[Mt,[Ft],(a,[s])=>{const c=a.id(),d=s.value;return typeof c==typeof d&&c>=d}],"filter-has":[Mt,[Ft],(a,[s])=>s.value in a.properties()],"filter-has-id":[Mt,[],a=>null!==a.id()&&void 0!==a.id()],"filter-type-in":[Mt,[J(Bt)],(a,[s])=>s.value.indexOf(a.geometryType())>=0],"filter-id-in":[Mt,[J(Ft)],(a,[s])=>s.value.indexOf(a.id())>=0],"filter-in-small":[Mt,[Bt,J(Ft)],(a,[s,c])=>c.value.indexOf(a.properties()[s.value])>=0],"filter-in-large":[Mt,[Bt,J(Ft)],(a,[s,c])=>function(d,m,b,w){for(;b<=w;){const E=b+w>>1;if(m[E]===d)return!0;m[E]>d?w=E-1:b=E+1}return!1}(a.properties()[s.value],c.value,0,c.value.length-1)],all:{type:Mt,overloads:[[[Mt,Mt],(a,[s,c])=>s.evaluate(a)&&c.evaluate(a)],[Ml(Mt),(a,s)=>{for(const c of s)if(!c.evaluate(a))return!1;return!0}]]},any:{type:Mt,overloads:[[[Mt,Mt],(a,[s,c])=>s.evaluate(a)||c.evaluate(a)],[Ml(Mt),(a,s)=>{for(const c of s)if(c.evaluate(a))return!0;return!1}]]},"!":[Mt,[Mt],(a,[s])=>!s.evaluate(a)],"is-supported-script":[Mt,[Bt],(a,[s])=>{const c=a.globals&&a.globals.isSupportedScript;return!c||c(s.evaluate(a))}],upcase:[Bt,[Bt],(a,[s])=>s.evaluate(a).toUpperCase()],downcase:[Bt,[Bt],(a,[s])=>s.evaluate(a).toLowerCase()],concat:[Bt,Ml(Ft),(a,s)=>s.map(c=>It(c.evaluate(a))).join("")],"resolved-locale":[Bt,[Do],(a,[s])=>s.evaluate(a).resolvedLocale()]});class Rl{constructor(s,c){var d;this.expression=s,this._warningHistory={},this._evaluator=new fh,this._defaultValue=c?"color"===(d=c).type&&Xn(d.default)?new gn(0,0,0,0):"color"===d.type?gn.parse(d.default)||null:"padding"===d.type?cs.parse(d.default)||null:"variableAnchorOffsetCollection"===d.type?Ts.parse(d.default)||null:void 0===d.default?null:d.default:null,this._enumValues=c&&"enum"===c.type?c.values:null}evaluateWithoutErrorHandling(s,c,d,m,b,w){return this._evaluator.globals=s,this._evaluator.feature=c,this._evaluator.featureState=d,this._evaluator.canonical=m,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=w,this.expression.evaluate(this._evaluator)}evaluate(s,c,d,m,b,w){this._evaluator.globals=s,this._evaluator.feature=c||null,this._evaluator.featureState=d||null,this._evaluator.canonical=m,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=w||null;try{const E=this.expression.evaluate(this._evaluator);if(null==E||"number"==typeof E&&E!=E)return this._defaultValue;if(this._enumValues&&!(E in this._enumValues))throw new yn(`Expected value to be one of ${Object.keys(this._enumValues).map(D=>JSON.stringify(D)).join(", ")}, but found ${JSON.stringify(E)} instead.`);return E}catch(E){return this._warningHistory[E.message]||(this._warningHistory[E.message]=!0,typeof console<"u"&&console.warn(E.message)),this._defaultValue}}}function Eu(a){return Array.isArray(a)&&a.length>0&&"string"==typeof a[0]&&a[0]in Ha}function Su(a,s){const c=new wn(Ha,_u,[],s?function(m){const b={color:Or,string:Bt,number:je,enum:Bt,boolean:Mt,formatted:X,padding:z,resolvedImage:U,variableAnchorOffsetCollection:q};return"array"===m.type?J(b[m.value]||Ft,m.length):b[m.type]}(s):void 0),d=c.parse(a,void 0,void 0,void 0,s&&"string"===s.type?{typeAnnotation:"coerce"}:void 0);return d?ut(new Rl(d,s)):ao(c.errors)}class bh{constructor(s,c){this.kind=s,this._styleExpression=c,this.isStateDependent="constant"!==s&&!Gs(c.expression)}evaluateWithoutErrorHandling(s,c,d,m,b,w){return this._styleExpression.evaluateWithoutErrorHandling(s,c,d,m,b,w)}evaluate(s,c,d,m,b,w){return this._styleExpression.evaluate(s,c,d,m,b,w)}}class wc{constructor(s,c,d,m){this.kind=s,this.zoomStops=d,this._styleExpression=c,this.isStateDependent="camera"!==s&&!Gs(c.expression),this.interpolationType=m}evaluateWithoutErrorHandling(s,c,d,m,b,w){return this._styleExpression.evaluateWithoutErrorHandling(s,c,d,m,b,w)}evaluate(s,c,d,m,b,w){return this._styleExpression.evaluate(s,c,d,m,b,w)}interpolationFactor(s,c,d){return this.interpolationType?hs.interpolationFactor(this.interpolationType,s,c,d):0}}function aa(a,s){const c=Su(a,s);if("error"===c.result)return c;const d=c.value.expression,m=mh(d);if(!m&&!oa(s))return ao([new mi("","data expressions not supported")]);const b=gh(d,["zoom"]);if(!b&&!vh(s))return ao([new mi("","zoom expressions not supported")]);const w=Is(d);return w||b?w instanceof mi?ao([w]):w instanceof hs&&!xc(s)?ao([new mi("",'"interpolate" expressions cannot be used with this property')]):ut(w?new wc(m?"camera":"composite",c.value,w.labels,w instanceof hs?w.interpolation:void 0):new bh(m?"constant":"source",c.value)):ao([new mi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Cc{constructor(s,c){this._parameters=s,this._specification=c,$s(this,un(this._parameters,this._specification))}static deserialize(s){return new Cc(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function Is(a){let s=null;if(a instanceof St)s=Is(a.result);else if(a instanceof Nr){for(const c of a.args)if(s=Is(c),s)break}else(a instanceof ja||a instanceof hs)&&a.input instanceof qs&&"zoom"===a.input.name&&(s=a);return s instanceof mi||a.eachChild(c=>{const d=Is(c);d instanceof mi?s=d:!s&&d?s=new mi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):s&&d&&s!==d&&(s=new mi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}function Ec(a){if(!0===a||!1===a)return!0;if(!Array.isArray(a)||0===a.length)return!1;switch(a[0]){case"has":return a.length>=2&&"$id"!==a[1]&&"$type"!==a[1];case"in":return a.length>=3&&("string"!=typeof a[1]||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==a.length||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const s of a.slice(1))if(!Ec(s)&&"boolean"!=typeof s)return!1;return!0;default:return!0}}const lt={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Tu(a){if(null==a)return{filter:()=>!0,needGeometry:!1};Ec(a)||(a=Ll(a));const s=Su(a,lt);if("error"===s.result)throw new Error(s.value.map(c=>`${c.key}: ${c.message}`).join(", "));return{filter:(c,d,m)=>s.value.evaluate(c,d,{},m),needGeometry:Sc(a)}}function tt(a,s){return a<s?-1:a>s?1:0}function Sc(a){if(!Array.isArray(a))return!1;if("within"===a[0])return!0;for(let s=1;s<a.length;s++)if(Sc(a[s]))return!0;return!1}function Ll(a){if(!a)return!0;const s=a[0];return a.length<=1?"any"!==s:"=="===s?qa(a[1],a[2],"=="):"!="===s?Tc(qa(a[1],a[2],"==")):"<"===s||">"===s||"<="===s||">="===s?qa(a[1],a[2],s):"any"===s?(c=a.slice(1),["any"].concat(c.map(Ll))):"all"===s?["all"].concat(a.slice(1).map(Ll)):"none"===s?["all"].concat(a.slice(1).map(Ll).map(Tc)):"in"===s?Gd(a[1],a.slice(2)):"!in"===s?Tc(Gd(a[1],a.slice(2))):"has"===s?Wd(a[1]):"!has"===s?Tc(Wd(a[1])):"within"!==s||a;var c}function qa(a,s,c){switch(a){case"$type":return[`filter-type-${c}`,s];case"$id":return[`filter-id-${c}`,s];default:return[`filter-${c}`,a,s]}}function Gd(a,s){if(0===s.length)return!1;switch(a){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(c=>typeof c!=typeof s[0])?["filter-in-large",a,["literal",s.sort(tt)]]:["filter-in-small",a,["literal",s]]}}function Wd(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Tc(a){return["!",a]}function As(a){const s=typeof a;if("number"===s||"boolean"===s||"string"===s||null==a)return JSON.stringify(a);if(Array.isArray(a)){let m="[";for(const b of a)m+=`${As(b)},`;return`${m}]`}const c=Object.keys(a).sort();let d="{";for(let m=0;m<c.length;m++)d+=`${JSON.stringify(c[m])}:${As(a[c[m]])},`;return`${d}}`}function Ga(a){let s="";for(const c of ls)s+=`/${As(a[c])}`;return s}function ds(a){const s=a.value;return s?[new ke(a.key,s,"constants have been deprecated as of v8")]:[]}function Cn(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function nn(a){if(Array.isArray(a))return a.map(nn);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const s={};for(const c in a)s[c]=nn(a[c]);return s}return Cn(a)}function dr(a){const s=a.key,c=a.value,d=a.valueSpec||{},m=a.objectElementValidators||{},b=a.style,w=a.styleSpec,E=a.validateSpec;let D=[];const M=vn(c);if("object"!==M)return[new ke(s,c,`object expected, ${M} found`)];for(const L in c){const N=L.split(".")[0],B=d[N]||d["*"];let j;if(m[N])j=m[N];else if(d[N])j=E;else if(m["*"])j=m["*"];else{if(!d["*"]){D.push(new ke(s,c[L],`unknown property "${L}"`));continue}j=E}D=D.concat(j({key:(s&&`${s}.`)+L,value:c[L],valueSpec:B,style:b,styleSpec:w,object:c,objectKey:L,validateSpec:E},c))}for(const L in d)m[L]||d[L].required&&void 0===d[L].default&&void 0===c[L]&&D.push(new ke(s,c,`missing required property "${L}"`));return D}function la(a){const s=a.value,c=a.valueSpec,d=a.style,m=a.styleSpec,b=a.key,w=a.arrayElementValidator||a.validateSpec;if("array"!==vn(s))return[new ke(b,s,`array expected, ${vn(s)} found`)];if(c.length&&s.length!==c.length)return[new ke(b,s,`array length ${c.length} expected, length ${s.length} found`)];if(c["min-length"]&&s.length<c["min-length"])return[new ke(b,s,`array length at least ${c["min-length"]} expected, length ${s.length} found`)];let E={type:c.value,values:c.values};m.$version<7&&(E.function=c.function),"object"===vn(c.value)&&(E=c.value);let D=[];for(let M=0;M<s.length;M++)D=D.concat(w({array:s,arrayIndex:M,value:s[M],valueSpec:E,validateSpec:a.validateSpec,style:d,styleSpec:m,key:`${b}[${M}]`}));return D}function Wa(a){const s=a.key,c=a.value,d=a.valueSpec;let m=vn(c);return"number"===m&&c!=c&&(m="NaN"),"number"!==m?[new ke(s,c,`number expected, ${m} found`)]:"minimum"in d&&c<d.minimum?[new ke(s,c,`${c} is less than the minimum value ${d.minimum}`)]:"maximum"in d&&c>d.maximum?[new ke(s,c,`${c} is greater than the maximum value ${d.maximum}`)]:[]}function Dc(a){const s=a.valueSpec,c=Cn(a.value.type);let d,m,b,w={};const E="categorical"!==c&&void 0===a.value.property,D=!E,M="array"===vn(a.value.stops)&&"array"===vn(a.value.stops[0])&&"object"===vn(a.value.stops[0][0]),L=dr({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(j){if("identity"===c)return[new ke(j.key,j.value,'identity function may not have a "stops" property')];let H=[];const W=j.value;return H=H.concat(la({key:j.key,value:W,valueSpec:j.valueSpec,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec,arrayElementValidator:N})),"array"===vn(W)&&0===W.length&&H.push(new ke(j.key,W,"array must have at least one stop")),H},default:function(j){return j.validateSpec({key:j.key,value:j.value,valueSpec:s,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec})}}});return"identity"===c&&E&&L.push(new ke(a.key,a.value,'missing required property "property"')),"identity"===c||a.value.stops||L.push(new ke(a.key,a.value,'missing required property "stops"')),"exponential"===c&&a.valueSpec.expression&&!xc(a.valueSpec)&&L.push(new ke(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(D&&!oa(a.valueSpec)?L.push(new ke(a.key,a.value,"property functions not supported")):E&&!vh(a.valueSpec)&&L.push(new ke(a.key,a.value,"zoom functions not supported"))),"categorical"!==c&&!M||void 0!==a.value.property||L.push(new ke(a.key,a.value,'"property" property is required')),L;function N(j){let H=[];const W=j.value,te=j.key;if("array"!==vn(W))return[new ke(te,W,`array expected, ${vn(W)} found`)];if(2!==W.length)return[new ke(te,W,`array length 2 expected, length ${W.length} found`)];if(M){if("object"!==vn(W[0]))return[new ke(te,W,`object expected, ${vn(W[0])} found`)];if(void 0===W[0].zoom)return[new ke(te,W,"object stop key must have zoom")];if(void 0===W[0].value)return[new ke(te,W,"object stop key must have value")];if(b&&b>Cn(W[0].zoom))return[new ke(te,W[0].zoom,"stop zoom values must appear in ascending order")];Cn(W[0].zoom)!==b&&(b=Cn(W[0].zoom),m=void 0,w={}),H=H.concat(dr({key:`${te}[0]`,value:W[0],valueSpec:{zoom:{}},validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec,objectElementValidators:{zoom:Wa,value:B}}))}else H=H.concat(B({key:`${te}[0]`,value:W[0],valueSpec:{},validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec},W));return Eu(nn(W[1]))?H.concat([new ke(`${te}[1]`,W[1],"expressions are not allowed in function stops.")]):H.concat(j.validateSpec({key:`${te}[1]`,value:W[1],valueSpec:s,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec}))}function B(j,H){const W=vn(j.value),te=Cn(j.value),re=null!==j.value?j.value:H;if(d){if(W!==d)return[new ke(j.key,re,`${W} stop domain type must match previous stop domain type ${d}`)]}else d=W;if("number"!==W&&"string"!==W&&"boolean"!==W)return[new ke(j.key,re,"stop domain value must be a number, string, or boolean")];if("number"!==W&&"categorical"!==c){let ce=`number expected, ${W} found`;return oa(s)&&void 0===c&&(ce+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ke(j.key,re,ce)]}return"categorical"!==c||"number"!==W||isFinite(te)&&Math.floor(te)===te?"categorical"!==c&&"number"===W&&void 0!==m&&te<m?[new ke(j.key,re,"stop domain values must appear in ascending order")]:(m=te,"categorical"===c&&te in w?[new ke(j.key,re,"stop domain values must be unique")]:(w[te]=!0,[])):[new ke(j.key,re,`integer expected, found ${te}`)]}}function Fr(a){const s=("property"===a.expressionContext?aa:Su)(nn(a.value),a.valueSpec);if("error"===s.result)return s.value.map(d=>new ke(`${a.key}${d.key}`,a.value,d.message));const c=s.value.expression||s.value._styleExpression.expression;if("property"===a.expressionContext&&"text-font"===a.propertyKey&&!c.outputDefined())return[new ke(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===a.expressionContext&&"layout"===a.propertyType&&!Gs(c))return[new ke(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===a.expressionContext&&!Gs(c))return[new ke(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&0===a.expressionContext.indexOf("cluster")){if(!gh(c,["zoom","feature-state"]))return[new ke(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===a.expressionContext&&!mh(c))return[new ke(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Mo(a){const s=a.key,c=a.value,d=a.valueSpec,m=[];return Array.isArray(d.values)?-1===d.values.indexOf(Cn(c))&&m.push(new ke(s,c,`expected one of [${d.values.join(", ")}], ${JSON.stringify(c)} found`)):-1===Object.keys(d.values).indexOf(Cn(c))&&m.push(new ke(s,c,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(c)} found`)),m}function Za(a){return Ec(nn(a.value))?Fr($s({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):xh(a)}function xh(a){const s=a.value,c=a.key;if("array"!==vn(s))return[new ke(c,s,`array expected, ${vn(s)} found`)];const d=a.styleSpec;let m,b=[];if(s.length<1)return[new ke(c,s,"filter array must have at least 1 element")];switch(b=b.concat(Mo({key:`${c}[0]`,value:s[0],valueSpec:d.filter_operator,style:a.style,styleSpec:a.styleSpec})),Cn(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&"$type"===Cn(s[1])&&b.push(new ke(c,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":3!==s.length&&b.push(new ke(c,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(m=vn(s[1]),"string"!==m&&b.push(new ke(`${c}[1]`,s[1],`string expected, ${m} found`)));for(let w=2;w<s.length;w++)m=vn(s[w]),"$type"===Cn(s[1])?b=b.concat(Mo({key:`${c}[${w}]`,value:s[w],valueSpec:d.geometry_type,style:a.style,styleSpec:a.styleSpec})):"string"!==m&&"number"!==m&&"boolean"!==m&&b.push(new ke(`${c}[${w}]`,s[w],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let w=1;w<s.length;w++)b=b.concat(xh({key:`${c}[${w}]`,value:s[w],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":m=vn(s[1]),2!==s.length?b.push(new ke(c,s,`filter array for "${s[0]}" operator must have 2 elements`)):"string"!==m&&b.push(new ke(`${c}[1]`,s[1],`string expected, ${m} found`));break;case"within":m=vn(s[1]),2!==s.length?b.push(new ke(c,s,`filter array for "${s[0]}" operator must have 2 elements`)):"object"!==m&&b.push(new ke(`${c}[1]`,s[1],`object expected, ${m} found`))}return b}function Du(a,s){const c=a.key,d=a.validateSpec,m=a.style,b=a.styleSpec,w=a.value,E=a.objectKey,D=b[`${s}_${a.layerType}`];if(!D)return[];const M=E.match(/^(.*)-transition$/);if("paint"===s&&M&&D[M[1]]&&D[M[1]].transition)return d({key:c,value:w,valueSpec:b.transition,style:m,styleSpec:b});const L=a.valueSpec||D[E];if(!L)return[new ke(c,w,`unknown property "${E}"`)];let N;if("string"===vn(w)&&oa(L)&&!L.tokens&&(N=/^{([^}]+)}$/.exec(w)))return[new ke(c,w,`"${E}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(N[1])} }\`.`)];const B=[];return"symbol"===a.layerType&&("text-field"===E&&m&&!m.glyphs&&B.push(new ke(c,w,'use of "text-field" requires a style "glyphs" property')),"text-font"===E&&Xn(nn(w))&&"identity"===Cn(w.type)&&B.push(new ke(c,w,'"text-font" does not support identity functions'))),B.concat(d({key:a.key,value:w,valueSpec:L,style:m,styleSpec:b,expressionContext:"property",propertyType:s,propertyKey:E}))}function wh(a){return Du(a,"paint")}function Ch(a){return Du(a,"layout")}function kl(a){let s=[];const c=a.value,d=a.key,m=a.style,b=a.styleSpec;c.type||c.ref||s.push(new ke(d,c,'either "type" or "ref" is required'));let w=Cn(c.type);const E=Cn(c.ref);if(c.id){const D=Cn(c.id);for(let M=0;M<a.arrayIndex;M++){const L=m.layers[M];Cn(L.id)===D&&s.push(new ke(d,c.id,`duplicate layer id "${c.id}", previously used at line ${L.id.__line__}`))}}if("ref"in c){let D;["type","source","source-layer","filter","layout"].forEach(M=>{M in c&&s.push(new ke(d,c[M],`"${M}" is prohibited for ref layers`))}),m.layers.forEach(M=>{Cn(M.id)===E&&(D=M)}),D?D.ref?s.push(new ke(d,c.ref,"ref cannot reference another ref layer")):w=Cn(D.type):s.push(new ke(d,c.ref,`ref layer "${E}" not found`))}else if("background"!==w)if(c.source){const D=m.sources&&m.sources[c.source],M=D&&Cn(D.type);D?"vector"===M&&"raster"===w?s.push(new ke(d,c.source,`layer "${c.id}" requires a raster source`)):"raster-dem"!==M&&"hillshade"===w?s.push(new ke(d,c.source,`layer "${c.id}" requires a raster-dem source`)):"raster"===M&&"raster"!==w?s.push(new ke(d,c.source,`layer "${c.id}" requires a vector source`)):"vector"!==M||c["source-layer"]?"raster-dem"===M&&"hillshade"!==w?s.push(new ke(d,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==w||!c.paint||!c.paint["line-gradient"]||"geojson"===M&&D.lineMetrics||s.push(new ke(d,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new ke(d,c,`layer "${c.id}" must specify a "source-layer"`)):s.push(new ke(d,c.source,`source "${c.source}" not found`))}else s.push(new ke(d,c,'missing required property "source"'));return s=s.concat(dr({key:d,value:c,valueSpec:b.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${d}.type`,value:c.type,valueSpec:b.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:c,objectKey:"type"}),filter:Za,layout:D=>dr({layer:c,key:D.key,value:D.value,style:D.style,styleSpec:D.styleSpec,validateSpec:D.validateSpec,objectElementValidators:{"*":M=>Ch($s({layerType:w},M))}}),paint:D=>dr({layer:c,key:D.key,value:D.value,style:D.style,styleSpec:D.styleSpec,validateSpec:D.validateSpec,objectElementValidators:{"*":M=>wh($s({layerType:w},M))}})}})),s}function Ws(a){const s=a.value,c=a.key,d=vn(s);return"string"!==d?[new ke(c,s,`string expected, ${d} found`)]:[]}const Ol={promoteId:function({key:a,value:s}){if("string"===vn(s))return Ws({key:a,value:s});{const c=[];for(const d in s)c.push(...Ws({key:`${a}.${d}`,value:s[d]}));return c}}};function fs(a){const s=a.value,c=a.key,d=a.styleSpec,m=a.style,b=a.validateSpec;if(!s.type)return[new ke(c,s,'"type" is required')];const w=Cn(s.type);let E;switch(w){case"vector":case"raster":return E=dr({key:c,value:s,valueSpec:d[`source_${w.replace("-","_")}`],style:a.style,styleSpec:d,objectElementValidators:Ol,validateSpec:b}),E;case"raster-dem":return E=function(D){var M;const L=null!==(M=D.sourceName)&&void 0!==M?M:"",N=D.value,B=D.styleSpec,j=B.source_raster_dem,H=D.style;let W=[];const te=vn(N);if(void 0===N)return W;if("object"!==te)return W.push(new ke("source_raster_dem",N,`object expected, ${te} found`)),W;const re="custom"===Cn(N.encoding),ce=["redFactor","greenFactor","blueFactor","baseShift"],oe=D.value.encoding?`"${D.value.encoding}"`:"Default";for(const fe in N)!re&&ce.includes(fe)?W.push(new ke(fe,N[fe],`In "${L}": "${fe}" is only valid when "encoding" is set to "custom". ${oe} encoding found`)):j[fe]?W=W.concat(D.validateSpec({key:fe,value:N[fe],valueSpec:j[fe],validateSpec:D.validateSpec,style:H,styleSpec:B})):W.push(new ke(fe,N[fe],`unknown property "${fe}"`));return W}({sourceName:c,value:s,style:a.style,styleSpec:d,validateSpec:b}),E;case"geojson":if(E=dr({key:c,value:s,valueSpec:d.source_geojson,style:m,styleSpec:d,validateSpec:b,objectElementValidators:Ol}),s.cluster)for(const D in s.clusterProperties){const[M,L]=s.clusterProperties[D],N="string"==typeof M?[M,["accumulated"],["get",D]]:M;E.push(...Fr({key:`${c}.${D}.map`,value:L,validateSpec:b,expressionContext:"cluster-map"})),E.push(...Fr({key:`${c}.${D}.reduce`,value:N,validateSpec:b,expressionContext:"cluster-reduce"}))}return E;case"video":return dr({key:c,value:s,valueSpec:d.source_video,style:m,validateSpec:b,styleSpec:d});case"image":return dr({key:c,value:s,valueSpec:d.source_image,style:m,validateSpec:b,styleSpec:d});case"canvas":return[new ke(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Mo({key:`${c}.type`,value:s.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:m,validateSpec:b,styleSpec:d})}}function Nl(a){const s=a.value,c=a.styleSpec,d=c.light,m=a.style;let b=[];const w=vn(s);if(void 0===s)return b;if("object"!==w)return b=b.concat([new ke("light",s,`object expected, ${w} found`)]),b;for(const E in s){const D=E.match(/^(.*)-transition$/);b=b.concat(D&&d[D[1]]&&d[D[1]].transition?a.validateSpec({key:E,value:s[E],valueSpec:c.transition,validateSpec:a.validateSpec,style:m,styleSpec:c}):d[E]?a.validateSpec({key:E,value:s[E],valueSpec:d[E],validateSpec:a.validateSpec,style:m,styleSpec:c}):[new ke(E,s[E],`unknown property "${E}"`)])}return b}function Zd(a){const s=a.value,c=a.styleSpec,d=c.terrain,m=a.style;let b=[];const w=vn(s);if(void 0===s)return b;if("object"!==w)return b=b.concat([new ke("terrain",s,`object expected, ${w} found`)]),b;for(const E in s)b=b.concat(d[E]?a.validateSpec({key:E,value:s[E],valueSpec:d[E],validateSpec:a.validateSpec,style:m,styleSpec:c}):[new ke(E,s[E],`unknown property "${E}"`)]);return b}function Kd(a){let s=[];const c=a.value,d=a.key;if(Array.isArray(c)){const m=[],b=[];for(const w in c)c[w].id&&m.includes(c[w].id)&&s.push(new ke(d,c,`all the sprites' ids must be unique, but ${c[w].id} is duplicated`)),m.push(c[w].id),c[w].url&&b.includes(c[w].url)&&s.push(new ke(d,c,`all the sprites' URLs must be unique, but ${c[w].url} is duplicated`)),b.push(c[w].url),s=s.concat(dr({key:`${d}[${w}]`,value:c[w],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return s}return Ws({key:d,value:c})}const Ms={"*":()=>[],array:la,boolean:function(a){const s=a.value,c=a.key,d=vn(s);return"boolean"!==d?[new ke(c,s,`boolean expected, ${d} found`)]:[]},number:Wa,color:function(a){const s=a.key,c=a.value,d=vn(c);return"string"!==d?[new ke(s,c,`color expected, ${d} found`)]:gn.parse(String(c))?[]:[new ke(s,c,`color expected, "${c}" found`)]},constants:ds,enum:Mo,filter:Za,function:Dc,layer:kl,object:dr,source:fs,light:Nl,terrain:Zd,string:Ws,formatted:function(a){return 0===Ws(a).length?[]:Fr(a)},resolvedImage:function(a){return 0===Ws(a).length?[]:Fr(a)},padding:function(a){const s=a.key,c=a.value;if("array"===vn(c)){if(c.length<1||c.length>4)return[new ke(s,c,`padding requires 1 to 4 values; ${c.length} values found`)];const d={type:"number"};let m=[];for(let b=0;b<c.length;b++)m=m.concat(a.validateSpec({key:`${s}[${b}]`,value:c[b],validateSpec:a.validateSpec,valueSpec:d}));return m}return Wa({key:s,value:c,valueSpec:{}})},variableAnchorOffsetCollection:function(a){const s=a.key,c=a.value,d=vn(c),m=a.styleSpec;if("array"!==d||c.length<1||c.length%2!=0)return[new ke(s,c,"variableAnchorOffsetCollection requires a non-empty array of even length")];let b=[];for(let w=0;w<c.length;w+=2)b=b.concat(Mo({key:`${s}[${w}]`,value:c[w],valueSpec:m.layout_symbol["text-anchor"]})),b=b.concat(la({key:`${s}[${w+1}]`,value:c[w+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:m}));return b},sprite:Kd};function Po(a){const s=a.value,c=a.valueSpec,d=a.styleSpec;return a.validateSpec=Po,c.expression&&Xn(Cn(s))?Dc(a):c.expression&&Eu(nn(s))?Fr(a):c.type&&Ms[c.type]?Ms[c.type](a):dr($s({},a,{valueSpec:c.type?d[c.type]:c}))}function Eh(a){const s=a.value,c=a.key,d=Ws(a);return d.length||(-1===s.indexOf("{fontstack}")&&d.push(new ke(c,s,'"glyphs" url must include a "{fontstack}" token')),-1===s.indexOf("{range}")&&d.push(new ke(c,s,'"glyphs" url must include a "{range}" token'))),d}function Ps(a,s=we){let c=[];return c=c.concat(Po({key:"",value:a,valueSpec:s.$root,styleSpec:s,style:a,validateSpec:Po,objectElementValidators:{glyphs:Eh,"*":()=>[]}})),a.constants&&(c=c.concat(ds({key:"constants",value:a.constants,style:a,styleSpec:s,validateSpec:Po}))),Iu(c)}function Ro(a){return function(s){return a({...s,validateSpec:Po})}}function Iu(a){return[].concat(a).sort((s,c)=>s.line-c.line)}function Lo(a){return function(...s){return Iu(a.apply(this,s))}}Ps.source=Lo(Ro(fs)),Ps.sprite=Lo(Ro(Kd)),Ps.glyphs=Lo(Ro(Eh)),Ps.light=Lo(Ro(Nl)),Ps.terrain=Lo(Ro(Zd)),Ps.layer=Lo(Ro(kl)),Ps.filter=Lo(Ro(Za)),Ps.paintProperty=Lo(Ro(wh)),Ps.layoutProperty=Lo(Ro(Ch));const lo=Ps,Lp=lo.light,Sh=lo.paintProperty,Xd=lo.layoutProperty;function Er(a,s){let c=!1;if(s&&s.length)for(const d of s)a.fire(new za(new Error(d.message))),c=!0;return c}class Fl{constructor(s,c,d){const m=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;const w=new Int32Array(this.arrayBuffer);s=w[0],this.d=(c=w[1])+2*(d=w[2]);for(let D=0;D<this.d*this.d;D++){const M=w[3+D],L=w[3+D+1];m.push(M===L?null:w.subarray(M,L))}const E=w[3+m.length+1];this.keys=w.subarray(w[3+m.length],E),this.bboxes=w.subarray(E),this.insert=this._insertReadonly}else{this.d=c+2*d;for(let w=0;w<this.d*this.d;w++)m.push([]);this.keys=[],this.bboxes=[]}this.n=c,this.extent=s,this.padding=d,this.scale=c/s,this.uid=0;const b=d/c*s;this.min=-b,this.max=s+b}insert(s,c,d,m,b){this._forEachCell(c,d,m,b,this._insertCell,this.uid++,void 0,void 0),this.keys.push(s),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(m),this.bboxes.push(b)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(s,c,d,m,b,w){this.cells[b].push(w)}query(s,c,d,m,b){const w=this.min,E=this.max;if(s<=w&&c<=w&&E<=d&&E<=m&&!b)return Array.prototype.slice.call(this.keys);{const D=[];return this._forEachCell(s,c,d,m,this._queryCell,D,{},b),D}}_queryCell(s,c,d,m,b,w,E,D){const M=this.cells[b];if(null!==M){const L=this.keys,N=this.bboxes;for(let B=0;B<M.length;B++){const j=M[B];if(void 0===E[j]){const H=4*j;(D?D(N[H+0],N[H+1],N[H+2],N[H+3]):s<=N[H+2]&&c<=N[H+3]&&d>=N[H+0]&&m>=N[H+1])?(E[j]=!0,w.push(L[j])):E[j]=!1}}}}_forEachCell(s,c,d,m,b,w,E,D){const M=this._convertToCellCoord(s),L=this._convertToCellCoord(c),N=this._convertToCellCoord(d),B=this._convertToCellCoord(m);for(let j=M;j<=N;j++)for(let H=L;H<=B;H++){const W=this.d*H+j;if((!D||D(this._convertFromCellCoord(j),this._convertFromCellCoord(H),this._convertFromCellCoord(j+1),this._convertFromCellCoord(H+1)))&&b.call(this,s,c,d,m,W,w,E,D))return}}_convertFromCellCoord(s){return(s-this.padding)/this.scale}_convertToCellCoord(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const s=this.cells,c=3+this.cells.length+1+1;let d=0;for(let w=0;w<this.cells.length;w++)d+=this.cells[w].length;const m=new Int32Array(c+d+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;let b=c;for(let w=0;w<s.length;w++){const E=s[w];m[3+w]=b,m.set(E,b),b+=E.length}return m[3+s.length]=b,m.set(this.keys,b),b+=this.keys.length,m[3+s.length+1]=b,m.set(this.bboxes,b),b+=this.bboxes.length,m.buffer}static serialize(s,c){const d=s.toArrayBuffer();return c&&c.push(d),{buffer:d}}static deserialize(s){return new Fl(s.buffer)}}const ko={};function Ye(a,s,c={}){if(ko[a])throw new Error(`${a} is already registered.`);Object.defineProperty(s,"_classRegistryKey",{value:a,writeable:!1}),ko[a]={klass:s,omit:c.omit||[],shallow:c.shallow||[]}}Ye("Object",Object),Ye("TransferableGridIndex",Fl),Ye("Color",gn),Ye("Error",Error),Ye("AJAXError",Wn),Ye("ResolvedImage",hr),Ye("StylePropertyFunction",Cc),Ye("StyleExpression",Rl,{omit:["_evaluator"]}),Ye("ZoomDependentExpression",wc),Ye("ZoomConstantExpression",bh),Ye("CompoundExpression",qs,{omit:["_evaluate"]});for(const a in Ha)Ha[a]._classRegistryKey||Ye(`Expression_${a}`,Ha[a]);function nr(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&"ArrayBuffer"===a.constructor.name)}function ca(a,s){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob)return a;if(nr(a)||xl(a))return s&&s.push(a),a;if(ArrayBuffer.isView(a)){const c=a;return s&&s.push(c.buffer),c}if(a instanceof ImageData)return s&&s.push(a.data.buffer),a;if(Array.isArray(a)){const c=[];for(const d of a)c.push(ca(d,s));return c}if("object"==typeof a){const c=a.constructor,d=c._classRegistryKey;if(!d)throw new Error("can't serialize object of unregistered class");if(!ko[d])throw new Error(`${d} is not registered.`);const m=c.serialize?c.serialize(a,s):{};if(c.serialize){if(s&&m===s[s.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const b in a){if(!a.hasOwnProperty(b)||ko[d].omit.indexOf(b)>=0)continue;const w=a[b];m[b]=ko[d].shallow.indexOf(b)>=0?w:ca(w,s)}a instanceof Error&&(m.message=a.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==d&&(m.$name=d),m}throw new Error("can't serialize object of type "+typeof a)}function Ka(a){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||nr(a)||xl(a)||ArrayBuffer.isView(a)||a instanceof ImageData)return a;if(Array.isArray(a))return a.map(Ka);if("object"==typeof a){const s=a.$name||"Object";if(!ko[s])throw new Error(`can't deserialize unregistered class ${s}`);const{klass:c}=ko[s];if(!c)throw new Error(`can't deserialize unregistered class ${s}`);if(c.deserialize)return c.deserialize(a);const d=Object.create(c.prototype);for(const m of Object.keys(a)){if("$name"===m)continue;const b=a[m];d[m]=ko[s].shallow.indexOf(m)>=0?b:Ka(b)}return d}throw new Error("can't deserialize object of type "+typeof a)}class Hi{constructor(){this.first=!0}update(s,c){const d=Math.floor(s);return this.first?(this.first=!1,this.lastIntegerZoom=d,this.lastIntegerZoomTime=0,this.lastZoom=s,this.lastFloorZoom=d,!0):(this.lastFloorZoom>d?(this.lastIntegerZoom=d+1,this.lastIntegerZoomTime=c):this.lastFloorZoom<d&&(this.lastIntegerZoom=d,this.lastIntegerZoomTime=c),s!==this.lastZoom&&(this.lastZoom=s,this.lastFloorZoom=d,!0))}}const Fe={"Latin-1 Supplement":a=>a>=128&&a<=255,Arabic:a=>a>=1536&&a<=1791,"Arabic Supplement":a=>a>=1872&&a<=1919,"Arabic Extended-A":a=>a>=2208&&a<=2303,"Hangul Jamo":a=>a>=4352&&a<=4607,"Unified Canadian Aboriginal Syllabics":a=>a>=5120&&a<=5759,Khmer:a=>a>=6016&&a<=6143,"Unified Canadian Aboriginal Syllabics Extended":a=>a>=6320&&a<=6399,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"CJK Radicals Supplement":a=>a>=11904&&a<=12031,"Kangxi Radicals":a=>a>=12032&&a<=12255,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Bopomofo:a=>a>=12544&&a<=12591,"Hangul Compatibility Jamo":a=>a>=12592&&a<=12687,Kanbun:a=>a>=12688&&a<=12703,"Bopomofo Extended":a=>a>=12704&&a<=12735,"CJK Strokes":a=>a>=12736&&a<=12783,"Katakana Phonetic Extensions":a=>a>=12784&&a<=12799,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"CJK Unified Ideographs Extension A":a=>a>=13312&&a<=19903,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Yi Syllables":a=>a>=40960&&a<=42127,"Yi Radicals":a=>a>=42128&&a<=42191,"Hangul Jamo Extended-A":a=>a>=43360&&a<=43391,"Hangul Syllables":a=>a>=44032&&a<=55215,"Hangul Jamo Extended-B":a=>a>=55216&&a<=55295,"Private Use Area":a=>a>=57344&&a<=63743,"CJK Compatibility Ideographs":a=>a>=63744&&a<=64255,"Arabic Presentation Forms-A":a=>a>=64336&&a<=65023,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Arabic Presentation Forms-B":a=>a>=65136&&a<=65279,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function dn(a){for(const s of a)if(ua(s.charCodeAt(0)))return!0;return!1}function qi(a){for(const s of a)if(!zr(s.charCodeAt(0)))return!1;return!0}function zr(a){return!(Fe.Arabic(a)||Fe["Arabic Supplement"](a)||Fe["Arabic Extended-A"](a)||Fe["Arabic Presentation Forms-A"](a)||Fe["Arabic Presentation Forms-B"](a))}function ua(a){return!(746!==a&&747!==a&&(a<4352||!(Fe["Bopomofo Extended"](a)||Fe.Bopomofo(a)||Fe["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Fe["CJK Compatibility Ideographs"](a)||Fe["CJK Compatibility"](a)||Fe["CJK Radicals Supplement"](a)||Fe["CJK Strokes"](a)||!(!Fe["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||12336===a)||Fe["CJK Unified Ideographs Extension A"](a)||Fe["CJK Unified Ideographs"](a)||Fe["Enclosed CJK Letters and Months"](a)||Fe["Hangul Compatibility Jamo"](a)||Fe["Hangul Jamo Extended-A"](a)||Fe["Hangul Jamo Extended-B"](a)||Fe["Hangul Jamo"](a)||Fe["Hangul Syllables"](a)||Fe.Hiragana(a)||Fe["Ideographic Description Characters"](a)||Fe.Kanbun(a)||Fe["Kangxi Radicals"](a)||Fe["Katakana Phonetic Extensions"](a)||Fe.Katakana(a)&&12540!==a||!(!Fe["Halfwidth and Fullwidth Forms"](a)||65288===a||65289===a||65293===a||a>=65306&&a<=65310||65339===a||65341===a||65343===a||a>=65371&&a<=65503||65507===a||a>=65512&&a<=65519)||!(!Fe["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Fe["Unified Canadian Aboriginal Syllabics"](a)||Fe["Unified Canadian Aboriginal Syllabics Extended"](a)||Fe["Vertical Forms"](a)||Fe["Yijing Hexagram Symbols"](a)||Fe["Yi Syllables"](a)||Fe["Yi Radicals"](a))))}function Qr(a){return!(ua(a)||(s=a,Fe["Latin-1 Supplement"](s)&&(167===s||169===s||174===s||177===s||188===s||189===s||190===s||215===s||247===s)||Fe["General Punctuation"](s)&&(8214===s||8224===s||8225===s||8240===s||8241===s||8251===s||8252===s||8258===s||8263===s||8264===s||8265===s||8273===s)||Fe["Letterlike Symbols"](s)||Fe["Number Forms"](s)||Fe["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||9003===s||s>=9085&&s<=9114||s>=9150&&s<=9165||9167===s||s>=9169&&s<=9179||s>=9186&&s<=9215)||Fe["Control Pictures"](s)&&9251!==s||Fe["Optical Character Recognition"](s)||Fe["Enclosed Alphanumerics"](s)||Fe["Geometric Shapes"](s)||Fe["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||Fe["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||Fe["CJK Symbols and Punctuation"](s)||Fe.Katakana(s)||Fe["Private Use Area"](s)||Fe["CJK Compatibility Forms"](s)||Fe["Small Form Variants"](s)||Fe["Halfwidth and Fullwidth Forms"](s)||8734===s||8756===s||8757===s||s>=9984&&s<=10087||s>=10102&&s<=10131||65532===s||65533===s));var s}function Th(a){return a>=1424&&a<=2303||Fe["Arabic Presentation Forms-A"](a)||Fe["Arabic Presentation Forms-B"](a)}function Dh(a,s){return!(!s&&Th(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||Fe.Khmer(a))}function Au(a){for(const s of a)if(Th(s.charCodeAt(0)))return!0;return!1}const Ih="deferred",Ah="loading",li="loaded";let Qe=null,bt="unavailable",Dn=null;const Br=function(a){a&&"string"==typeof a&&a.indexOf("NetworkError")>-1&&(bt="error"),Qe&&Qe(a)};function Xa(){Oi.fire(new na("pluginStateChange",{pluginStatus:bt,pluginURL:Dn}))}const Oi=new El,ha=function(){return bt},xi=function(){if(bt!==Ih||!Dn)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");bt=Ah,Xa(),Dn&&cc({url:Dn},a=>{a?Br(a):(bt=li,Xa())})},Ni={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>bt===li||null!=Ni.applyArabicShaping,isLoading:()=>bt===Ah,setState(a){if(!ji())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");bt=a.pluginStatus,Dn=a.pluginURL},isParsed(){if(!ji())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return null!=Ni.applyArabicShaping&&null!=Ni.processBidirectionalText&&null!=Ni.processStyledBidirectionalText},getPluginURL(){if(!ji())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Dn}};class In{constructor(s,c){this.zoom=s,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.zoomHistory=c.zoomHistory,this.transition=c.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Hi,this.transition={})}isSupportedScript(s){return function(c,d){for(const m of c)if(!Dh(m.charCodeAt(0),d))return!1;return!0}(s,Ni.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const s=this.zoom,c=s-Math.floor(s),d=this.crossFadingFactor();return s>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:c+(1-c)*d}:{fromScale:.5,toScale:1,t:1-(1-d)*c}}}class kt{constructor(s,c){this.property=s,this.value=c,this.expression=function(d,m){if(Xn(d))return new Cc(d,m);if(Eu(d)){const b=aa(d,m);if("error"===b.result)throw new Error(b.value.map(w=>`${w.key}: ${w.message}`).join(", "));return b.value}{let b=d;return"color"===m.type&&"string"==typeof d?b=gn.parse(d):"padding"!==m.type||"number"!=typeof d&&!Array.isArray(d)?"variableAnchorOffsetCollection"===m.type&&Array.isArray(d)&&(b=Ts.parse(d)):b=cs.parse(d),{kind:"constant",evaluate:()=>b}}}(void 0===c?s.specification.default:c,s.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(s,c,d){return this.property.possiblyEvaluate(this,s,c,d)}}class Ya{constructor(s){this.property=s,this.value=new kt(s,void 0)}transitioned(s,c){return new Qa(this.property,this.value,c,He({},s.transition,this.transition),s.now)}untransitioned(){return new Qa(this.property,this.value,null,{},0)}}class Mh{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)}getValue(s){return Dt(this._values[s].value.value)}setValue(s,c){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new Ya(this._values[s].property)),this._values[s].value=new kt(this._values[s].property,null===c?void 0:Dt(c))}getTransition(s){return Dt(this._values[s].transition)}setTransition(s,c){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new Ya(this._values[s].property)),this._values[s].transition=Dt(c)||void 0}serialize(){const s={};for(const c of Object.keys(this._values)){const d=this.getValue(c);void 0!==d&&(s[c]=d);const m=this.getTransition(c);void 0!==m&&(s[`${c}-transition`]=m)}return s}transitioned(s,c){const d=new wi(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].transitioned(s,c._values[m]);return d}untransitioned(){const s=new wi(this._properties);for(const c of Object.keys(this._values))s._values[c]=this._values[c].untransitioned();return s}}class Qa{constructor(s,c,d,m,b){this.property=s,this.value=c,this.begin=b+m.delay||0,this.end=this.begin+m.duration||0,s.specification.transition&&(m.delay||m.duration)&&(this.prior=d)}possiblyEvaluate(s,c,d){const m=s.now||0,b=this.value.possiblyEvaluate(s,c,d),w=this.prior;if(w){if(m>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(m<this.begin)return w.possiblyEvaluate(s,c,d);{const E=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(s,c,d),b,function(D){if(D<=0)return 0;if(D>=1)return 1;const M=D*D,L=M*D;return 4*(D<.5?L:3*(D-M)+L-.75)}(E))}}return b}}class wi{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,c,d){const m=new ps(this._properties);for(const b of Object.keys(this._values))m._values[b]=this._values[b].possiblyEvaluate(s,c,d);return m}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class Ic{constructor(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)}hasValue(s){return void 0!==this._values[s].value}getValue(s){return Dt(this._values[s].value)}setValue(s,c){this._values[s]=new kt(this._values[s].property,null===c?void 0:Dt(c))}serialize(){const s={};for(const c of Object.keys(this._values)){const d=this.getValue(c);void 0!==d&&(s[c]=d)}return s}possiblyEvaluate(s,c,d){const m=new ps(this._properties);for(const b of Object.keys(this._values))m._values[b]=this._values[b].possiblyEvaluate(s,c,d);return m}}class Fi{constructor(s,c,d){this.property=s,this.value=c,this.parameters=d}isConstant(){return"constant"===this.value.kind}constantOr(s){return"constant"===this.value.kind?this.value.value:s}evaluate(s,c,d,m){return this.property.evaluate(this.value,this.parameters,s,c,d,m)}}class ps{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class rt{constructor(s){this.specification=s}possiblyEvaluate(s,c){if(s.isDataDriven())throw new Error("Value should not be data driven");return s.expression.evaluate(c)}interpolate(s,c,d){const m=Ds[this.specification.type];return m?m(s,c,d):s}}class _t{constructor(s,c){this.specification=s,this.overrides=c}possiblyEvaluate(s,c,d,m){return new Fi(this,"constant"===s.expression.kind||"camera"===s.expression.kind?{kind:"constant",value:s.expression.evaluate(c,null,{},d,m)}:s.expression,c)}interpolate(s,c,d){if("constant"!==s.value.kind||"constant"!==c.value.kind)return s;if(void 0===s.value.value||void 0===c.value.value)return new Fi(this,{kind:"constant",value:void 0},s.parameters);const m=Ds[this.specification.type];if(m){const b=m(s.value.value,c.value.value,d);return new Fi(this,{kind:"constant",value:b},s.parameters)}return s}evaluate(s,c,d,m,b,w){return"constant"===s.kind?s.value:s.evaluate(c,d,m,b,w)}}class Rs extends _t{possiblyEvaluate(s,c,d,m){if(void 0===s.value)return new Fi(this,{kind:"constant",value:void 0},c);if("constant"===s.expression.kind){const b=s.expression.evaluate(c,null,{},d,m),w="resolvedImage"===s.property.specification.type&&"string"!=typeof b?b.name:b,E=this._calculate(w,w,w,c);return new Fi(this,{kind:"constant",value:E},c)}if("camera"===s.expression.kind){const b=this._calculate(s.expression.evaluate({zoom:c.zoom-1}),s.expression.evaluate({zoom:c.zoom}),s.expression.evaluate({zoom:c.zoom+1}),c);return new Fi(this,{kind:"constant",value:b},c)}return new Fi(this,s.expression,c)}evaluate(s,c,d,m,b,w){if("source"===s.kind){const E=s.evaluate(c,d,m,b,w);return this._calculate(E,E,E,c)}return"composite"===s.kind?this._calculate(s.evaluate({zoom:Math.floor(c.zoom)-1},d,m),s.evaluate({zoom:Math.floor(c.zoom)},d,m),s.evaluate({zoom:Math.floor(c.zoom)+1},d,m),c):s.value}_calculate(s,c,d,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:s,to:c}:{from:d,to:c}}interpolate(s){return s}}class Zs{constructor(s){this.specification=s}possiblyEvaluate(s,c,d,m){if(void 0!==s.value){if("constant"===s.expression.kind){const b=s.expression.evaluate(c,null,{},d,m);return this._calculate(b,b,b,c)}return this._calculate(s.expression.evaluate(new In(Math.floor(c.zoom-1),c)),s.expression.evaluate(new In(Math.floor(c.zoom),c)),s.expression.evaluate(new In(Math.floor(c.zoom+1),c)),c)}}_calculate(s,c,d,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:s,to:c}:{from:d,to:c}}interpolate(s){return s}}class Ja{constructor(s){this.specification=s}possiblyEvaluate(s,c,d,m){return!!s.expression.evaluate(c,null,{},d,m)}interpolate(){return!1}}class ni{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const c in s){const d=s[c];d.specification.overridable&&this.overridableProperties.push(c);const m=this.defaultPropertyValues[c]=new kt(d,void 0),b=this.defaultTransitionablePropertyValues[c]=new Ya(d);this.defaultTransitioningPropertyValues[c]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=m.possiblyEvaluate({})}}}Ye("DataDrivenProperty",_t),Ye("DataConstantProperty",rt),Ye("CrossFadedDataDrivenProperty",Rs),Ye("CrossFadedProperty",Zs),Ye("ColorRampProperty",Ja);const tn="-transition";class Ks extends El{constructor(s,c){if(super(),this.id=s.id,this.type=s.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==s.type&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,"background"!==s.type&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),c.layout&&(this._unevaluatedLayout=new Ic(c.layout)),c.paint)){this._transitionablePaint=new Mh(c.paint);for(const d in s.paint)this.setPaintProperty(d,s.paint[d],{validate:!1});for(const d in s.layout)this.setLayoutProperty(d,s.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ps(c.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(s){return"visibility"===s?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,c,d={}){null!=c&&this._validate(Xd,`layers.${this.id}.layout.${s}`,s,c,d)||("visibility"!==s?this._unevaluatedLayout.setValue(s,c):this.visibility=c)}getPaintProperty(s){return s.endsWith(tn)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,c,d={}){if(null!=c&&this._validate(Sh,`layers.${this.id}.paint.${s}`,s,c,d))return!1;if(s.endsWith(tn))return this._transitionablePaint.setTransition(s.slice(0,-11),c||void 0),!1;{const m=this._transitionablePaint._values[s],b="cross-faded-data-driven"===m.property.specification["property-type"],w=m.value.isDataDriven(),E=m.value;this._transitionablePaint.setValue(s,c),this._handleSpecialPaintPropertyUpdate(s);const D=this._transitionablePaint._values[s].value;return D.isDataDriven()||w||b||this._handleOverridablePaintPropertyUpdate(s,E,D)}}_handleSpecialPaintPropertyUpdate(s){}_handleOverridablePaintPropertyUpdate(s,c,d){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||"none"===this.visibility}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,c){s.getCrossfadeParameters&&(this._crossfadeParameters=s.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,c)}serialize(){const s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),ln(s,(c,d)=>!(void 0===c||"layout"===d&&!Object.keys(c).length||"paint"===d&&!Object.keys(c).length))}_validate(s,c,d,m,b={}){return(!b||!1!==b.validate)&&Er(this,s.call(lo,{key:c,layerType:this.type,objectKey:d,value:m,styleSpec:we,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const s in this.paint._values){const c=this.paint.get(s);if(c instanceof Fi&&oa(c.property.specification)&&("source"===c.value.kind||"composite"===c.value.kind)&&c.value.isStateDependent)return!0}return!1}}const Mu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class da{constructor(s,c){this._structArray=s,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class En{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,c){return s._trim(),c&&(s.isTransferred=!0,c.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const c=Object.create(this.prototype);return c.arrayBuffer=s.arrayBuffer,c.length=s.length,c.capacity=s.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function jn(a,s=1){let c=0,d=0;return{members:a.map(m=>{const b=Mu[m.type].BYTES_PER_ELEMENT,w=c=Xs(c,Math.max(s,b)),E=m.components||1;return d=Math.max(d,b),c+=b*E,{name:m.name,type:m.type,components:E,offset:w}}),size:Xs(c,Math.max(d,s)),alignment:s}}function Xs(a,s){return Math.ceil(a/s)*s}class Oo extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c){const d=this.length;return this.resize(d+1),this.emplace(d,s,c)}emplace(s,c,d){const m=2*s;return this.int16[m+0]=c,this.int16[m+1]=d,s}}Oo.prototype.bytesPerElement=4,Ye("StructArrayLayout2i4",Oo);class Ii extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,d)}emplace(s,c,d,m){const b=3*s;return this.int16[b+0]=c,this.int16[b+1]=d,this.int16[b+2]=m,s}}Ii.prototype.bytesPerElement=6,Ye("StructArrayLayout3i6",Ii);class zl extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d,m){const b=this.length;return this.resize(b+1),this.emplace(b,s,c,d,m)}emplace(s,c,d,m,b){const w=4*s;return this.int16[w+0]=c,this.int16[w+1]=d,this.int16[w+2]=m,this.int16[w+3]=b,s}}zl.prototype.bytesPerElement=8,Ye("StructArrayLayout4i8",zl);class Sr extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,b,w){const E=this.length;return this.resize(E+1),this.emplace(E,s,c,d,m,b,w)}emplace(s,c,d,m,b,w,E){const D=6*s;return this.int16[D+0]=c,this.int16[D+1]=d,this.int16[D+2]=m,this.int16[D+3]=b,this.int16[D+4]=w,this.int16[D+5]=E,s}}Sr.prototype.bytesPerElement=12,Ye("StructArrayLayout2i4i12",Sr);class fr extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,b,w){const E=this.length;return this.resize(E+1),this.emplace(E,s,c,d,m,b,w)}emplace(s,c,d,m,b,w,E){const D=4*s,M=8*s;return this.int16[D+0]=c,this.int16[D+1]=d,this.uint8[M+4]=m,this.uint8[M+5]=b,this.uint8[M+6]=w,this.uint8[M+7]=E,s}}fr.prototype.bytesPerElement=8,Ye("StructArrayLayout2i4ub8",fr);class fa extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c){const d=this.length;return this.resize(d+1),this.emplace(d,s,c)}emplace(s,c,d){const m=2*s;return this.float32[m+0]=c,this.float32[m+1]=d,s}}fa.prototype.bytesPerElement=8,Ye("StructArrayLayout2f8",fa);class No extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,b,w,E,D,M,L){const N=this.length;return this.resize(N+1),this.emplace(N,s,c,d,m,b,w,E,D,M,L)}emplace(s,c,d,m,b,w,E,D,M,L,N){const B=10*s;return this.uint16[B+0]=c,this.uint16[B+1]=d,this.uint16[B+2]=m,this.uint16[B+3]=b,this.uint16[B+4]=w,this.uint16[B+5]=E,this.uint16[B+6]=D,this.uint16[B+7]=M,this.uint16[B+8]=L,this.uint16[B+9]=N,s}}No.prototype.bytesPerElement=20,Ye("StructArrayLayout10ui20",No);class Bl extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,b,w,E,D,M,L,N,B){const j=this.length;return this.resize(j+1),this.emplace(j,s,c,d,m,b,w,E,D,M,L,N,B)}emplace(s,c,d,m,b,w,E,D,M,L,N,B,j){const H=12*s;return this.int16[H+0]=c,this.int16[H+1]=d,this.int16[H+2]=m,this.int16[H+3]=b,this.uint16[H+4]=w,this.uint16[H+5]=E,this.uint16[H+6]=D,this.uint16[H+7]=M,this.int16[H+8]=L,this.int16[H+9]=N,this.int16[H+10]=B,this.int16[H+11]=j,s}}Bl.prototype.bytesPerElement=24,Ye("StructArrayLayout4i4ui4i24",Bl);class Vt extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,d)}emplace(s,c,d,m){const b=3*s;return this.float32[b+0]=c,this.float32[b+1]=d,this.float32[b+2]=m,s}}Vt.prototype.bytesPerElement=12,Ye("StructArrayLayout3f12",Vt);class v extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.uint32[1*s+0]=c,s}}v.prototype.bytesPerElement=4,Ye("StructArrayLayout1ul4",v);class o extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,b,w,E,D,M){const L=this.length;return this.resize(L+1),this.emplace(L,s,c,d,m,b,w,E,D,M)}emplace(s,c,d,m,b,w,E,D,M,L){const N=10*s,B=5*s;return this.int16[N+0]=c,this.int16[N+1]=d,this.int16[N+2]=m,this.int16[N+3]=b,this.int16[N+4]=w,this.int16[N+5]=E,this.uint32[B+3]=D,this.uint16[N+8]=M,this.uint16[N+9]=L,s}}o.prototype.bytesPerElement=20,Ye("StructArrayLayout6i1ul2ui20",o);class u extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,b,w){const E=this.length;return this.resize(E+1),this.emplace(E,s,c,d,m,b,w)}emplace(s,c,d,m,b,w,E){const D=6*s;return this.int16[D+0]=c,this.int16[D+1]=d,this.int16[D+2]=m,this.int16[D+3]=b,this.int16[D+4]=w,this.int16[D+5]=E,s}}u.prototype.bytesPerElement=12,Ye("StructArrayLayout2i2i2i12",u);class p extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,b){const w=this.length;return this.resize(w+1),this.emplace(w,s,c,d,m,b)}emplace(s,c,d,m,b,w){const E=4*s,D=8*s;return this.float32[E+0]=c,this.float32[E+1]=d,this.float32[E+2]=m,this.int16[D+6]=b,this.int16[D+7]=w,s}}p.prototype.bytesPerElement=16,Ye("StructArrayLayout2f1f2i16",p);class g extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d,m){const b=this.length;return this.resize(b+1),this.emplace(b,s,c,d,m)}emplace(s,c,d,m,b){const w=12*s,E=3*s;return this.uint8[w+0]=c,this.uint8[w+1]=d,this.float32[E+1]=m,this.float32[E+2]=b,s}}g.prototype.bytesPerElement=12,Ye("StructArrayLayout2ub2f12",g);class x extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,d)}emplace(s,c,d,m){const b=3*s;return this.uint16[b+0]=c,this.uint16[b+1]=d,this.uint16[b+2]=m,s}}x.prototype.bytesPerElement=6,Ye("StructArrayLayout3ui6",x);class S extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d,m,b,w,E,D,M,L,N,B,j,H,W,te,re){const ce=this.length;return this.resize(ce+1),this.emplace(ce,s,c,d,m,b,w,E,D,M,L,N,B,j,H,W,te,re)}emplace(s,c,d,m,b,w,E,D,M,L,N,B,j,H,W,te,re,ce){const oe=24*s,fe=12*s,ye=48*s;return this.int16[oe+0]=c,this.int16[oe+1]=d,this.uint16[oe+2]=m,this.uint16[oe+3]=b,this.uint32[fe+2]=w,this.uint32[fe+3]=E,this.uint32[fe+4]=D,this.uint16[oe+10]=M,this.uint16[oe+11]=L,this.uint16[oe+12]=N,this.float32[fe+7]=B,this.float32[fe+8]=j,this.uint8[ye+36]=H,this.uint8[ye+37]=W,this.uint8[ye+38]=te,this.uint32[fe+10]=re,this.int16[oe+22]=ce,s}}S.prototype.bytesPerElement=48,Ye("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",S);class T extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d,m,b,w,E,D,M,L,N,B,j,H,W,te,re,ce,oe,fe,ye,Te,Ze,nt,Ge,Ve,ze,Xe){const Be=this.length;return this.resize(Be+1),this.emplace(Be,s,c,d,m,b,w,E,D,M,L,N,B,j,H,W,te,re,ce,oe,fe,ye,Te,Ze,nt,Ge,Ve,ze,Xe)}emplace(s,c,d,m,b,w,E,D,M,L,N,B,j,H,W,te,re,ce,oe,fe,ye,Te,Ze,nt,Ge,Ve,ze,Xe,Be){const Re=32*s,dt=16*s;return this.int16[Re+0]=c,this.int16[Re+1]=d,this.int16[Re+2]=m,this.int16[Re+3]=b,this.int16[Re+4]=w,this.int16[Re+5]=E,this.int16[Re+6]=D,this.int16[Re+7]=M,this.uint16[Re+8]=L,this.uint16[Re+9]=N,this.uint16[Re+10]=B,this.uint16[Re+11]=j,this.uint16[Re+12]=H,this.uint16[Re+13]=W,this.uint16[Re+14]=te,this.uint16[Re+15]=re,this.uint16[Re+16]=ce,this.uint16[Re+17]=oe,this.uint16[Re+18]=fe,this.uint16[Re+19]=ye,this.uint16[Re+20]=Te,this.uint16[Re+21]=Ze,this.uint16[Re+22]=nt,this.uint32[dt+12]=Ge,this.float32[dt+13]=Ve,this.float32[dt+14]=ze,this.uint16[Re+30]=Xe,this.uint16[Re+31]=Be,s}}T.prototype.bytesPerElement=64,Ye("StructArrayLayout8i15ui1ul2f2ui64",T);class I extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.float32[1*s+0]=c,s}}I.prototype.bytesPerElement=4,Ye("StructArrayLayout1f4",I);class P extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,d)}emplace(s,c,d,m){const b=3*s;return this.uint16[6*s+0]=c,this.float32[b+1]=d,this.float32[b+2]=m,s}}P.prototype.bytesPerElement=12,Ye("StructArrayLayout1ui2f12",P);class k extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,d)}emplace(s,c,d,m){const b=4*s;return this.uint32[2*s+0]=c,this.uint16[b+2]=d,this.uint16[b+3]=m,s}}k.prototype.bytesPerElement=8,Ye("StructArrayLayout1ul2ui8",k);class O extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c){const d=this.length;return this.resize(d+1),this.emplace(d,s,c)}emplace(s,c,d){const m=2*s;return this.uint16[m+0]=c,this.uint16[m+1]=d,s}}O.prototype.bytesPerElement=4,Ye("StructArrayLayout2ui4",O);class V extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.uint16[1*s+0]=c,s}}V.prototype.bytesPerElement=2,Ye("StructArrayLayout1ui2",V);class K extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d,m){const b=this.length;return this.resize(b+1),this.emplace(b,s,c,d,m)}emplace(s,c,d,m,b){const w=4*s;return this.float32[w+0]=c,this.float32[w+1]=d,this.float32[w+2]=m,this.float32[w+3]=b,s}}K.prototype.bytesPerElement=16,Ye("StructArrayLayout4f16",K);class Z extends da{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ht(this.anchorPointX,this.anchorPointY)}}Z.prototype.size=20;class Y extends o{get(s){return new Z(this,s)}}Ye("CollisionBoxArray",Y);class G extends da{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(s){this._structArray.uint8[this._pos1+37]=s}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(s){this._structArray.uint8[this._pos1+38]=s}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(s){this._structArray.uint32[this._pos4+10]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}G.prototype.size=48;class le extends S{get(s){return new G(this,s)}}Ye("PlacedSymbolArray",le);class ge extends da{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(s){this._structArray.uint32[this._pos4+12]=s}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ge.prototype.size=64;class ie extends T{get(s){return new ge(this,s)}}Ye("SymbolInstanceArray",ie);class he extends I{getoffsetX(s){return this.float32[1*s+0]}}Ye("GlyphOffsetArray",he);class _e extends Ii{getx(s){return this.int16[3*s+0]}gety(s){return this.int16[3*s+1]}gettileUnitDistanceFromAnchor(s){return this.int16[3*s+2]}}Ye("SymbolLineVertexArray",_e);class be extends da{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}be.prototype.size=12;class Ee extends P{get(s){return new be(this,s)}}Ye("TextAnchorOffsetArray",Ee);class Me extends da{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Me.prototype.size=8;class Ae extends k{get(s){return new Me(this,s)}}Ye("FeatureIndexArray",Ae);class Ne extends Oo{}class We extends Oo{}class jt extends Oo{}class Oe extends Sr{}class vt extends fr{}class st extends fa{}class An extends No{}class qt extends Bl{}class Nt extends Vt{}class Zt extends v{}class ci extends u{}class Fn extends g{}class ir extends x{}class zi extends O{}const Ci=jn([{name:"a_pos",components:2,type:"Int16"}],4),{members:Tr}=Ci;class Rn{constructor(s=[]){this.segments=s}prepareSegment(s,c,d,m){let b=this.segments[this.segments.length-1];return s>Rn.MAX_VERTEX_ARRAY_LENGTH&&fi(`Max vertices per segment is ${Rn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!b||b.vertexLength+s>Rn.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==m)&&(b={vertexOffset:c.length,primitiveOffset:d.length,vertexLength:0,primitiveLength:0},void 0!==m&&(b.sortKey=m),this.segments.push(b)),b}get(){return this.segments}destroy(){for(const s of this.segments)for(const c in s.vaos)s.vaos[c].destroy()}static simpleSegment(s,c,d,m){return new Rn([{vertexOffset:s,primitiveOffset:c,vertexLength:d,primitiveLength:m,vaos:{},sortKey:0}])}}function Ur(a,s){return 256*(a=$e(Math.floor(a),0,255))+$e(Math.floor(s),0,255)}Rn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ye("SegmentVector",Rn);const Ys=jn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var el={exports:{}},pr=function(a,s){var c,d,m,b,w,E,D,M;for(d=a.length-(c=3&a.length),m=s,w=3432918353,E=461845907,M=0;M<d;)D=255&a.charCodeAt(M)|(255&a.charCodeAt(++M))<<8|(255&a.charCodeAt(++M))<<16|(255&a.charCodeAt(++M))<<24,++M,m=27492+(65535&(b=5*(65535&(m=(m^=D=(65535&(D=(D=(65535&D)*w+(((D>>>16)*w&65535)<<16)&4294967295)<<15|D>>>17))*E+(((D>>>16)*E&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(D=0,c){case 3:D^=(255&a.charCodeAt(M+2))<<16;case 2:D^=(255&a.charCodeAt(M+1))<<8;case 1:m^=D=(65535&(D=(D=(65535&(D^=255&a.charCodeAt(M)))*w+(((D>>>16)*w&65535)<<16)&4294967295)<<15|D>>>17))*E+(((D>>>16)*E&65535)<<16)&4294967295}return m^=a.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0},Jr=function(a,s){for(var c,d=a.length,m=s^d,b=0;d>=4;)c=1540483477*(65535&(c=255&a.charCodeAt(b)|(255&a.charCodeAt(++b))<<8|(255&a.charCodeAt(++b))<<16|(255&a.charCodeAt(++b))<<24))+((1540483477*(c>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),d-=4,++b;switch(d){case 3:m^=(255&a.charCodeAt(b+2))<<16;case 2:m^=(255&a.charCodeAt(b+1))<<8;case 1:m=1540483477*(65535&(m^=255&a.charCodeAt(b)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0};el.exports=pr,el.exports.murmur3=pr,el.exports.murmur2=Jr;var pa=xe(el.exports);class ui{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(s,c,d,m){this.ids.push(Gi(s)),this.positions.push(c,d,m)}getPositions(s){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const c=Gi(s);let d=0,m=this.ids.length-1;for(;d<m;){const w=d+m>>1;this.ids[w]>=c?m=w:d=w+1}const b=[];for(;this.ids[d]===c;)b.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return b}static serialize(s,c){const d=new Float64Array(s.ids),m=new Uint32Array(s.positions);return Ir(d,m,0,d.length-1),c&&c.push(d.buffer,m.buffer),{ids:d,positions:m}}static deserialize(s){const c=new ui;return c.ids=s.ids,c.positions=s.positions,c.indexed=!0,c}}function Gi(a){const s=+a;return!isNaN(s)&&s<=Number.MAX_SAFE_INTEGER?s:pa(String(a))}function Ir(a,s,c,d){for(;c<d;){const m=a[c+d>>1];let b=c-1,w=d+1;for(;;){do{b++}while(a[b]<m);do{w--}while(a[w]>m);if(b>=w)break;Ai(a,b,w),Ai(s,3*b,3*w),Ai(s,3*b+1,3*w+1),Ai(s,3*b+2,3*w+2)}w-c<d-w?(Ir(a,s,c,w),c=w+1):(Ir(a,s,w+1,d),d=w)}}function Ai(a,s,c){const d=a[s];a[s]=a[c],a[c]=d}Ye("FeaturePositionMap",ui);class Vl{constructor(s,c){this.gl=s.gl,this.location=c}}class Pu extends Vl{constructor(s,c){super(s,c),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class Ph extends Vl{constructor(s,c){super(s,c),this.current=[0,0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3]))}}class Rh extends Vl{constructor(s,c){super(s,c),this.current=gn.transparent}set(s){s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a))}}const kp=new Float32Array(16);function Lh(a){return[Ur(255*a.r,255*a.g),Ur(255*a.b,255*a.a)]}class co{constructor(s,c,d){this.value=s,this.uniformNames=c.map(m=>`u_${m}`),this.type=d}setUniform(s,c,d){s.set(d.constantOr(this.value))}getBinding(s,c,d){return"color"===this.type?new Rh(s,c):new Pu(s,c)}}class ma{constructor(s,c){this.uniformNames=c.map(d=>`u_${d}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(s,c){this.pixelRatioFrom=c.pixelRatio,this.pixelRatioTo=s.pixelRatio,this.patternFrom=c.tlbr,this.patternTo=s.tlbr}setUniform(s,c,d,m){const b="u_pattern_to"===m?this.patternTo:"u_pattern_from"===m?this.patternFrom:"u_pixel_ratio_to"===m?this.pixelRatioTo:"u_pixel_ratio_from"===m?this.pixelRatioFrom:null;b&&s.set(b)}getBinding(s,c,d){return"u_pattern"===d.substr(0,9)?new Ph(s,c):new Pu(s,c)}}class uo{constructor(s,c,d,m){this.expression=s,this.type=d,this.maxValue=0,this.paintVertexAttributes=c.map(b=>({name:`a_${b}`,type:"Float32",components:"color"===d?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(s,c,d,m,b){const w=this.paintVertexArray.length,E=this.expression.evaluate(new In(0),c,{},m,[],b);this.paintVertexArray.resize(s),this._setPaintValue(w,s,E)}updatePaintArray(s,c,d,m){const b=this.expression.evaluate({zoom:0},d,m);this._setPaintValue(s,c,b)}_setPaintValue(s,c,d){if("color"===this.type){const m=Lh(d);for(let b=s;b<c;b++)this.paintVertexArray.emplace(b,m[0],m[1])}else{for(let m=s;m<c;m++)this.paintVertexArray.emplace(m,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ms{constructor(s,c,d,m,b,w){this.expression=s,this.uniformNames=c.map(E=>`u_${E}_t`),this.type=d,this.useIntegerZoom=m,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=c.map(E=>({name:`a_${E}`,type:"Float32",components:"color"===d?4:2,offset:0})),this.paintVertexArray=new w}populatePaintArray(s,c,d,m,b){const w=this.expression.evaluate(new In(this.zoom),c,{},m,[],b),E=this.expression.evaluate(new In(this.zoom+1),c,{},m,[],b),D=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(D,s,w,E)}updatePaintArray(s,c,d,m){const b=this.expression.evaluate({zoom:this.zoom},d,m),w=this.expression.evaluate({zoom:this.zoom+1},d,m);this._setPaintValue(s,c,b,w)}_setPaintValue(s,c,d,m){if("color"===this.type){const b=Lh(d),w=Lh(m);for(let E=s;E<c;E++)this.paintVertexArray.emplace(E,b[0],b[1],w[0],w[1])}else{for(let b=s;b<c;b++)this.paintVertexArray.emplace(b,d,m);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(m))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,c){const d=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,m=$e(this.expression.interpolationFactor(d,this.zoom,this.zoom+1),0,1);s.set(m)}getBinding(s,c,d){return new Pu(s,c)}}class ho{constructor(s,c,d,m,b,w){this.expression=s,this.type=c,this.useIntegerZoom=d,this.zoom=m,this.layerId=w,this.zoomInPaintVertexArray=new b,this.zoomOutPaintVertexArray=new b}populatePaintArray(s,c,d){const m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(s),this.zoomOutPaintVertexArray.resize(s),this._setPaintValues(m,s,c.patterns&&c.patterns[this.layerId],d)}updatePaintArray(s,c,d,m,b){this._setPaintValues(s,c,d.patterns&&d.patterns[this.layerId],b)}_setPaintValues(s,c,d,m){if(!m||!d)return;const{min:b,mid:w,max:E}=d,D=m[b],M=m[w],L=m[E];if(D&&M&&L)for(let N=s;N<c;N++)this.zoomInPaintVertexArray.emplace(N,M.tl[0],M.tl[1],M.br[0],M.br[1],D.tl[0],D.tl[1],D.br[0],D.br[1],M.pixelRatio,D.pixelRatio),this.zoomOutPaintVertexArray.emplace(N,M.tl[0],M.tl[1],M.br[0],M.br[1],L.tl[0],L.tl[1],L.br[0],L.br[1],M.pixelRatio,L.pixelRatio)}upload(s){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=s.createVertexBuffer(this.zoomInPaintVertexArray,Ys.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=s.createVertexBuffer(this.zoomOutPaintVertexArray,Ys.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Yd{constructor(s,c,d){this.binders={},this._buffers=[];const m=[];for(const b in s.paint._values){if(!d(b))continue;const w=s.paint.get(b);if(!(w instanceof Fi&&oa(w.property.specification)))continue;const E=Mc(b,s.type),D=w.value,M=w.property.specification.type,L=w.property.useIntegerZoom,N=w.property.specification["property-type"],B="cross-faded"===N||"cross-faded-data-driven"===N;if("constant"===D.kind)this.binders[b]=B?new ma(D.value,E):new co(D.value,E,M),m.push(`/u_${b}`);else if("source"===D.kind||B){const j=Op(b,M,"source");this.binders[b]=B?new ho(D,M,L,c,j,s.id):new uo(D,E,M,j),m.push(`/a_${b}`)}else{const j=Op(b,M,"composite");this.binders[b]=new ms(D,E,M,L,c,j),m.push(`/z_${b}`)}}this.cacheKey=m.sort().join("")}getMaxValue(s){const c=this.binders[s];return c instanceof uo||c instanceof ms?c.maxValue:0}populatePaintArrays(s,c,d,m,b){for(const w in this.binders){const E=this.binders[w];(E instanceof uo||E instanceof ms||E instanceof ho)&&E.populatePaintArray(s,c,d,m,b)}}setConstantPatternPositions(s,c){for(const d in this.binders){const m=this.binders[d];m instanceof ma&&m.setConstantPatternPositions(s,c)}}updatePaintArrays(s,c,d,m,b){let w=!1;for(const E in s){const D=c.getPositions(E);for(const M of D){const L=d.feature(M.index);for(const N in this.binders){const B=this.binders[N];if((B instanceof uo||B instanceof ms||B instanceof ho)&&!0===B.expression.isStateDependent){const j=m.paint.get(N);B.expression=j.value,B.updatePaintArray(M.start,M.end,L,s[E],b),w=!0}}}}return w}defines(){const s=[];for(const c in this.binders){const d=this.binders[c];(d instanceof co||d instanceof ma)&&s.push(...d.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return s}getBinderAttributes(){const s=[];for(const c in this.binders){const d=this.binders[c];if(d instanceof uo||d instanceof ms)for(let m=0;m<d.paintVertexAttributes.length;m++)s.push(d.paintVertexAttributes[m].name);else if(d instanceof ho)for(let m=0;m<Ys.members.length;m++)s.push(Ys.members[m].name)}return s}getBinderUniforms(){const s=[];for(const c in this.binders){const d=this.binders[c];if(d instanceof co||d instanceof ma||d instanceof ms)for(const m of d.uniformNames)s.push(m)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s,c){const d=[];for(const m in this.binders){const b=this.binders[m];if(b instanceof co||b instanceof ma||b instanceof ms)for(const w of b.uniformNames)if(c[w]){const E=b.getBinding(s,c[w],w);d.push({name:w,property:m,binding:E})}}return d}setUniforms(s,c,d,m){for(const{name:b,property:w,binding:E}of c)this.binders[w].setUniform(E,m,d.get(w),b)}updatePaintBuffers(s){this._buffers=[];for(const c in this.binders){const d=this.binders[c];if(s&&d instanceof ho){const m=2===s.fromScale?d.zoomInPaintVertexBuffer:d.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(d instanceof uo||d instanceof ms)&&d.paintVertexBuffer&&this._buffers.push(d.paintVertexBuffer)}}upload(s){for(const c in this.binders){const d=this.binders[c];(d instanceof uo||d instanceof ms||d instanceof ho)&&d.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const c=this.binders[s];(c instanceof uo||c instanceof ms||c instanceof ho)&&c.destroy()}}}class Fo{constructor(s,c,d=(()=>!0)){this.programConfigurations={};for(const m of s)this.programConfigurations[m.id]=new Yd(m,c,d);this.needsUpload=!1,this._featureMap=new ui,this._bufferOffset=0}populatePaintArrays(s,c,d,m,b,w){for(const E in this.programConfigurations)this.programConfigurations[E].populatePaintArrays(s,c,m,b,w);void 0!==c.id&&this._featureMap.add(c.id,d,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,c,d,m){for(const b of d)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(s,this._featureMap,c,b,m)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}function Mc(a,s){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${s}-`,"").replace(/-/g,"_")]}function Op(a,s,c){const m={"line-pattern":{source:An,composite:An},"fill-pattern":{source:An,composite:An},"fill-extrusion-pattern":{source:An,composite:An}}[a];return m&&m[c]||{color:{source:fa,composite:K},number:{source:I,composite:fa}}[s][c]}Ye("ConstantBinder",co),Ye("CrossFadedConstantBinder",ma),Ye("SourceExpressionBinder",uo),Ye("CrossFadedCompositeBinder",ho),Ye("CompositeExpressionBinder",ms),Ye("ProgramConfiguration",Yd,{omit:["_buffers"]}),Ye("ProgramConfigurationSet",Fo);const Bi=8192,Np=Math.pow(2,14)-1,Fp=-Np-1;function jl(a){const s=Bi/a.extent,c=a.loadGeometry();for(let d=0;d<c.length;d++){const m=c[d];for(let b=0;b<m.length;b++){const w=m[b],E=Math.round(w.x*s),D=Math.round(w.y*s);w.x=$e(E,Fp,Np),w.y=$e(D,Fp,Np),(E<w.x||E>w.x+1||D<w.y||D>w.y+1)&&fi("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return c}function Pc(a,s){return{type:a.type,id:a.id,properties:a.properties,geometry:s?jl(a):[]}}function Ru(a,s,c,d,m){a.emplaceBack(2*s+(d+1)/2,2*c+(m+1)/2)}class zp{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new We,this.indexArray=new ir,this.segments=new Rn,this.programConfigurations=new Fo(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(s,c,d){const m=this.layers[0],b=[];let w=null,E=!1;"circle"===m.type&&(w=m.layout.get("circle-sort-key"),E=!w.isConstant());for(const{feature:D,id:M,index:L,sourceLayerIndex:N}of s){const B=this.layers[0]._featureFilter.needGeometry,j=Pc(D,B);if(!this.layers[0]._featureFilter.filter(new In(this.zoom),j,d))continue;const H=E?w.evaluate(j,{},d):void 0,W={id:M,properties:D.properties,type:D.type,sourceLayerIndex:N,index:L,geometry:B?j.geometry:jl(D),patterns:{},sortKey:H};b.push(W)}E&&b.sort((D,M)=>D.sortKey-M.sortKey);for(const D of b){const{geometry:M,index:L,sourceLayerIndex:N}=D,B=s[L].feature;this.addFeature(D,M,L,d),c.featureIndex.insert(B,M,L,N,this.index)}}update(s,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Tr),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,c,d,m){for(const b of c)for(const w of b){const E=w.x,D=w.y;if(E<0||E>=Bi||D<0||D>=Bi)continue;const M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),L=M.vertexLength;Ru(this.layoutVertexArray,E,D,-1,-1),Ru(this.layoutVertexArray,E,D,1,-1),Ru(this.layoutVertexArray,E,D,1,1),Ru(this.layoutVertexArray,E,D,-1,1),this.indexArray.emplaceBack(L,L+1,L+2),this.indexArray.emplaceBack(L,L+3,L+2),M.vertexLength+=4,M.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,{},m)}}function zo(a,s){for(let c=0;c<a.length;c++)if(Bo(s,a[c]))return!0;for(let c=0;c<s.length;c++)if(Bo(a,s[c]))return!0;return!!kh(a,s)}function Vg(a,s,c){return!!Bo(a,s)||!!es(s,a,c)}function Bp(a,s){if(1===a.length)return Up(s,a[0]);for(let c=0;c<s.length;c++){const d=s[c];for(let m=0;m<d.length;m++)if(Bo(a,d[m]))return!0}for(let c=0;c<a.length;c++)if(Up(s,a[c]))return!0;for(let c=0;c<s.length;c++)if(kh(a,s[c]))return!0;return!1}function hi(a,s,c){if(a.length>1){if(kh(a,s))return!0;for(let d=0;d<s.length;d++)if(es(s[d],a,c))return!0}for(let d=0;d<a.length;d++)if(es(a[d],s,c))return!0;return!1}function kh(a,s){if(0===a.length||0===s.length)return!1;for(let c=0;c<a.length-1;c++){const d=a[c],m=a[c+1];for(let b=0;b<s.length-1;b++)if(Qd(d,m,s[b],s[b+1]))return!0}return!1}function Qd(a,s,c,d){return br(a,c,d)!==br(s,c,d)&&br(a,s,c)!==br(a,s,d)}function es(a,s,c){const d=c*c;if(1===s.length)return a.distSqr(s[0])<d;for(let m=1;m<s.length;m++)if(jg(a,s[m-1],s[m])<d)return!0;return!1}function jg(a,s,c){const d=s.distSqr(c);if(0===d)return a.distSqr(s);const m=((a.x-s.x)*(c.x-s.x)+(a.y-s.y)*(c.y-s.y))/d;return a.distSqr(m<0?s:m>1?c:c.sub(s)._mult(m)._add(s))}function Up(a,s){let c,d,m,b=!1;for(let w=0;w<a.length;w++){c=a[w];for(let E=0,D=c.length-1;E<c.length;D=E++)d=c[E],m=c[D],d.y>s.y!=m.y>s.y&&s.x<(m.x-d.x)*(s.y-d.y)/(m.y-d.y)+d.x&&(b=!b)}return b}function Bo(a,s){let c=!1;for(let d=0,m=a.length-1;d<a.length;m=d++){const b=a[d],w=a[m];b.y>s.y!=w.y>s.y&&s.x<(w.x-b.x)*(s.y-b.y)/(w.y-b.y)+b.x&&(c=!c)}return c}function Qs(a,s,c){const d=c[0],m=c[2];if(a.x<d.x&&s.x<d.x||a.x>m.x&&s.x>m.x||a.y<d.y&&s.y<d.y||a.y>m.y&&s.y>m.y)return!1;const b=br(a,s,c[0]);return b!==br(a,s,c[1])||b!==br(a,s,c[2])||b!==br(a,s,c[3])}function Oh(a,s,c){const d=s.paint.get(a).value;return"constant"===d.kind?d.value:c.programConfigurations.get(s.id).getMaxValue(a)}function Jd(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function ef(a,s,c,d,m){if(!s[0]&&!s[1])return a;const b=ht.convert(s)._mult(m);"viewport"===c&&b._rotate(-d);const w=[];for(let E=0;E<a.length;E++)w.push(a[E].sub(b));return w}let tl,Vp;Ye("CircleBucket",zp,{omit:["layers"]});var Wv={get paint(){return Vp=Vp||new ni({"circle-radius":new _t(we.paint_circle["circle-radius"]),"circle-color":new _t(we.paint_circle["circle-color"]),"circle-blur":new _t(we.paint_circle["circle-blur"]),"circle-opacity":new _t(we.paint_circle["circle-opacity"]),"circle-translate":new rt(we.paint_circle["circle-translate"]),"circle-translate-anchor":new rt(we.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new rt(we.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new rt(we.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new _t(we.paint_circle["circle-stroke-width"]),"circle-stroke-color":new _t(we.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new _t(we.paint_circle["circle-stroke-opacity"])})},get layout(){return tl=tl||new ni({"circle-sort-key":new _t(we.layout_circle["circle-sort-key"])})}},Vr=1e-6,Rc=typeof Float32Array<"u"?Float32Array:Array;function tf(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function $g(a,s,c){var d=s[0],m=s[1],b=s[2],w=s[3],E=s[4],D=s[5],M=s[6],L=s[7],N=s[8],B=s[9],j=s[10],H=s[11],W=s[12],te=s[13],re=s[14],ce=s[15],oe=c[0],fe=c[1],ye=c[2],Te=c[3];return a[0]=oe*d+fe*E+ye*N+Te*W,a[1]=oe*m+fe*D+ye*B+Te*te,a[2]=oe*b+fe*M+ye*j+Te*re,a[3]=oe*w+fe*L+ye*H+Te*ce,a[4]=(oe=c[4])*d+(fe=c[5])*E+(ye=c[6])*N+(Te=c[7])*W,a[5]=oe*m+fe*D+ye*B+Te*te,a[6]=oe*b+fe*M+ye*j+Te*re,a[7]=oe*w+fe*L+ye*H+Te*ce,a[8]=(oe=c[8])*d+(fe=c[9])*E+(ye=c[10])*N+(Te=c[11])*W,a[9]=oe*m+fe*D+ye*B+Te*te,a[10]=oe*b+fe*M+ye*j+Te*re,a[11]=oe*w+fe*L+ye*H+Te*ce,a[12]=(oe=c[12])*d+(fe=c[13])*E+(ye=c[14])*N+(Te=c[15])*W,a[13]=oe*m+fe*D+ye*B+Te*te,a[14]=oe*b+fe*M+ye*j+Te*re,a[15]=oe*w+fe*L+ye*H+Te*ce,a}Math.hypot||(Math.hypot=function(){for(var a=0,s=arguments.length;s--;)a+=arguments[s]*arguments[s];return Math.sqrt(a)});var At,Hg=$g;function jp(a,s,c){var d=s[0],m=s[1],b=s[2],w=s[3];return a[0]=c[0]*d+c[4]*m+c[8]*b+c[12]*w,a[1]=c[1]*d+c[5]*m+c[9]*b+c[13]*w,a[2]=c[2]*d+c[6]*m+c[10]*b+c[14]*w,a[3]=c[3]*d+c[7]*m+c[11]*b+c[15]*w,a}At=new Rc(4),Rc!=Float32Array&&(At[0]=0,At[1]=0,At[2]=0,At[3]=0);class Zv extends Ks{constructor(s){super(s,Wv)}createBucket(s){return new zp(s)}queryRadius(s){const c=s;return Oh("circle-radius",this,c)+Oh("circle-stroke-width",this,c)+Jd(this.paint.get("circle-translate"))}queryIntersectsFeature(s,c,d,m,b,w,E,D){const M=ef(s,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),w.angle,E),L=this.paint.get("circle-radius").evaluate(c,d)+this.paint.get("circle-stroke-width").evaluate(c,d),N="map"===this.paint.get("circle-pitch-alignment"),B=N?M:(W=D,M.map(te=>qg(te,W))),j=N?L*E:L;var W;for(const H of m)for(const W of H){const te=N?W:qg(W,D);let re=j;const ce=jp([],[W.x,W.y,0,1],D);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?re*=ce[3]/w.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(re*=w.cameraToCenterDistance/ce[3]),Vg(B,te,re))return!0}return!1}}function qg(a,s){const c=jp([],[a.x,a.y,0,1],s);return new ht(c[0]/c[3],c[1]/c[3])}class Gg extends zp{}let $p;Ye("HeatmapBucket",Gg,{omit:["layers"]});var Lu={get paint(){return $p=$p||new ni({"heatmap-radius":new _t(we.paint_heatmap["heatmap-radius"]),"heatmap-weight":new _t(we.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new rt(we.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ja(we.paint_heatmap["heatmap-color"]),"heatmap-opacity":new rt(we.paint_heatmap["heatmap-opacity"])})}};function Hp(a,{width:s,height:c},d,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==s*c*d)throw new RangeError(`mismatched image size. expected: ${m.length} but got: ${s*c*d}`)}else m=new Uint8Array(s*c*d);return a.width=s,a.height=c,a.data=m,a}function Wg(a,{width:s,height:c},d){if(s===a.width&&c===a.height)return;const m=Hp({},{width:s,height:c},d);qp(a,m,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,s),height:Math.min(a.height,c)},d),a.width=s,a.height=c,a.data=m.data}function qp(a,s,c,d,m,b){if(0===m.width||0===m.height)return s;if(m.width>a.width||m.height>a.height||c.x>a.width-m.width||c.y>a.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>s.width||m.height>s.height||d.x>s.width-m.width||d.y>s.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const w=a.data,E=s.data;if(w===E)throw new Error("srcData equals dstData, so image is already copied");for(let D=0;D<m.height;D++){const M=((c.y+D)*a.width+c.x)*b,L=((d.y+D)*s.width+d.x)*b;for(let N=0;N<m.width*b;N++)E[L+N]=w[M+N]}return s}class Nh{constructor(s,c){Hp(this,s,1,c)}resize(s){Wg(this,s,1)}clone(){return new Nh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,c,d,m,b){qp(s,c,d,m,b,1)}}class Js{constructor(s,c){Hp(this,s,4,c)}resize(s){Wg(this,s,4)}replace(s,c){c?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new Js({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,c,d,m,b){qp(s,c,d,m,b,4)}}function Pe(a){const s={},c=a.resolution||256,d=a.clips?a.clips.length:1,m=a.image||new Js({width:c,height:d});if(Math.log(c)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${c}`);const b=(w,E,D)=>{s[a.evaluationKey]=D;const M=a.expression.evaluate(s);m.data[w+E+0]=Math.floor(255*M.r/M.a),m.data[w+E+1]=Math.floor(255*M.g/M.a),m.data[w+E+2]=Math.floor(255*M.b/M.a),m.data[w+E+3]=Math.floor(255*M.a)};if(a.clips)for(let w=0,E=0;w<d;++w,E+=4*c)for(let D=0,M=0;D<c;D++,M+=4){const L=D/(c-1),{start:N,end:B}=a.clips[w];b(E,M,N*(1-L)+B*L)}else for(let w=0,E=0;w<c;w++,E+=4)b(0,E,w/(c-1));return m}Ye("AlphaImage",Nh),Ye("RGBAImage",Js);class Sn extends Ks{createBucket(s){return new Gg(s)}constructor(s){super(s,Lu),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){"heatmap-color"===s&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Pe({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}}let fo;var Uo={get paint(){return fo=fo||new ni({"hillshade-illumination-direction":new rt(we.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new rt(we.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new rt(we.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new rt(we.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new rt(we.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new rt(we.paint_hillshade["hillshade-accent-color"])})}};class jr extends Ks{constructor(s){super(s,Uo)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}}const Zg=jn([{name:"a_pos",components:2,type:"Int16"}],4),{members:Fh}=Zg;var po={exports:{}};function ku(a,s,c){c=c||2;var d,m,b,w,E,D,M,L=s&&s.length,N=L?s[0]*c:a.length,B=nf(a,0,N,c,!0),j=[];if(!B||B.next===B.prev)return j;if(L&&(B=function(W,te,re,ce){var oe,fe,ye,Te=[];for(oe=0,fe=te.length;oe<fe;oe++)(ye=nf(W,te[oe]*ce,oe<fe-1?te[oe+1]*ce:W.length,ce,!1))===ye.next&&(ye.steiner=!0),Te.push(Xv(ye));for(Te.sort(Ou),oe=0;oe<Te.length;oe++)re=il(Te[oe],re);return re}(a,s,B,c)),a.length>80*c){d=b=a[0],m=w=a[1];for(var H=c;H<N;H+=c)(E=a[H])<d&&(d=E),(D=a[H+1])<m&&(m=D),E>b&&(b=E),D>w&&(w=D);M=0!==(M=Math.max(b-d,w-m))?32767/M:0}return rf(B,j,c,d,m,M,0),j}function nf(a,s,c,d,m){var b,w;if(m===Uh(a,s,c,d)>0)for(b=s;b<c;b+=d)w=Zp(b,a[b],a[b+1],w);else for(b=c-d;b>=s;b-=d)w=Zp(b,a[b],a[b+1],w);return w&&zh(w,w.next)&&(Fu(w),w=w.next),w}function Lc(a,s){if(!a)return a;s||(s=a);var c,d=a;do{if(c=!1,d.steiner||!zh(d,d.next)&&0!==yi(d.prev,d,d.next))d=d.next;else{if(Fu(d),(d=s=d.prev)===d.next)break;c=!0}}while(c||d!==s);return s}function rf(a,s,c,d,m,b,w){if(a){!w&&b&&function(L,N,B,j){var H=L;do{0===H.z&&(H.z=sf(H.x,H.y,N,B,j)),H.prevZ=H.prev,H.nextZ=H.next,H=H.next}while(H!==L);H.prevZ.nextZ=null,H.prevZ=null,function(W){var te,re,ce,oe,fe,ye,Te,Ze,nt=1;do{for(re=W,W=null,fe=null,ye=0;re;){for(ye++,ce=re,Te=0,te=0;te<nt&&(Te++,ce=ce.nextZ);te++);for(Ze=nt;Te>0||Ze>0&&ce;)0!==Te&&(0===Ze||!ce||re.z<=ce.z)?(oe=re,re=re.nextZ,Te--):(oe=ce,ce=ce.nextZ,Ze--),fe?fe.nextZ=oe:W=oe,oe.prevZ=fe,fe=oe;re=ce}fe.nextZ=null,nt*=2}while(ye>1)}(H)}(a,d,m,b);for(var E,D,M=a;a.prev!==a.next;)if(E=a.prev,D=a.next,b?gs(a,d,m,b):Kg(a))s.push(E.i/c|0),s.push(a.i/c|0),s.push(D.i/c|0),Fu(a),a=D.next,M=D.next;else if((a=D)===M){w?1===w?rf(a=nl(Lc(a),s,c),s,c,d,m,b,2):2===w&&Xg(a,s,c,d,m,b):rf(Lc(a),s,c,d,m,b,1);break}}}function Kg(a){var s=a.prev,c=a,d=a.next;if(yi(s,c,d)>=0)return!1;for(var m=s.x,b=c.x,w=d.x,E=s.y,D=c.y,M=d.y,L=m<b?m<w?m:w:b<w?b:w,N=E<D?E<M?E:M:D<M?D:M,B=m>b?m>w?m:w:b>w?b:w,j=E>D?E>M?E:M:D>M?D:M,H=d.next;H!==s;){if(H.x>=L&&H.x<=B&&H.y>=N&&H.y<=j&&Nu(m,E,b,D,w,M,H.x,H.y)&&yi(H.prev,H,H.next)>=0)return!1;H=H.next}return!0}function gs(a,s,c,d){var m=a.prev,b=a,w=a.next;if(yi(m,b,w)>=0)return!1;for(var E=m.x,D=b.x,M=w.x,L=m.y,N=b.y,B=w.y,j=E<D?E<M?E:M:D<M?D:M,H=L<N?L<B?L:B:N<B?N:B,W=E>D?E>M?E:M:D>M?D:M,te=L>N?L>B?L:B:N>B?N:B,re=sf(j,H,s,c,d),ce=sf(W,te,s,c,d),oe=a.prevZ,fe=a.nextZ;oe&&oe.z>=re&&fe&&fe.z<=ce;){if(oe.x>=j&&oe.x<=W&&oe.y>=H&&oe.y<=te&&oe!==m&&oe!==w&&Nu(E,L,D,N,M,B,oe.x,oe.y)&&yi(oe.prev,oe,oe.next)>=0||(oe=oe.prevZ,fe.x>=j&&fe.x<=W&&fe.y>=H&&fe.y<=te&&fe!==m&&fe!==w&&Nu(E,L,D,N,M,B,fe.x,fe.y)&&yi(fe.prev,fe,fe.next)>=0))return!1;fe=fe.nextZ}for(;oe&&oe.z>=re;){if(oe.x>=j&&oe.x<=W&&oe.y>=H&&oe.y<=te&&oe!==m&&oe!==w&&Nu(E,L,D,N,M,B,oe.x,oe.y)&&yi(oe.prev,oe,oe.next)>=0)return!1;oe=oe.prevZ}for(;fe&&fe.z<=ce;){if(fe.x>=j&&fe.x<=W&&fe.y>=H&&fe.y<=te&&fe!==m&&fe!==w&&Nu(E,L,D,N,M,B,fe.x,fe.y)&&yi(fe.prev,fe,fe.next)>=0)return!1;fe=fe.nextZ}return!0}function nl(a,s,c){var d=a;do{var m=d.prev,b=d.next.next;!zh(m,b)&&af(m,d,d.next,b)&&kc(m,b)&&kc(b,m)&&(s.push(m.i/c|0),s.push(d.i/c|0),s.push(b.i/c|0),Fu(d),Fu(d.next),d=a=b),d=d.next}while(d!==a);return Lc(d)}function Xg(a,s,c,d,m,b){var w=a;do{for(var E=w.next.next;E!==w.prev;){if(w.i!==E.i&&Gp(w,E)){var D=Wp(w,E);return w=Lc(w,w.next),D=Lc(D,D.next),rf(w,s,c,d,m,b,0),void rf(D,s,c,d,m,b,0)}E=E.next}w=w.next}while(w!==a)}function Ou(a,s){return a.x-s.x}function il(a,s){var c=function(m,b){var w,E=b,D=m.x,M=m.y,L=-1/0;do{if(M<=E.y&&M>=E.next.y&&E.next.y!==E.y){var N=E.x+(M-E.y)*(E.next.x-E.x)/(E.next.y-E.y);if(N<=D&&N>L&&(L=N,w=E.x<E.next.x?E:E.next,N===D))return w}E=E.next}while(E!==b);if(!w)return null;var B,j=w,H=w.x,W=w.y,te=1/0;E=w;do{D>=E.x&&E.x>=H&&D!==E.x&&Nu(M<W?D:L,M,H,W,M<W?L:D,M,E.x,E.y)&&(B=Math.abs(M-E.y)/(D-E.x),kc(E,m)&&(B<te||B===te&&(E.x>w.x||E.x===w.x&&Kv(w,E)))&&(w=E,te=B)),E=E.next}while(E!==j);return w}(a,s);if(!c)return s;var d=Wp(c,a);return Lc(d,d.next),Lc(c,c.next)}function Kv(a,s){return yi(a.prev,a,s.prev)<0&&yi(s.next,a,a.next)<0}function sf(a,s,c,d,m){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-c)*m|0)|a<<8))|a<<4))|a<<2))|a<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-d)*m|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function Xv(a){var s=a,c=a;do{(s.x<c.x||s.x===c.x&&s.y<c.y)&&(c=s),s=s.next}while(s!==a);return c}function Nu(a,s,c,d,m,b,w,E){return(m-w)*(s-E)>=(a-w)*(b-E)&&(a-w)*(d-E)>=(c-w)*(s-E)&&(c-w)*(b-E)>=(m-w)*(d-E)}function Gp(a,s){return a.next.i!==s.i&&a.prev.i!==s.i&&!function(c,d){var m=c;do{if(m.i!==c.i&&m.next.i!==c.i&&m.i!==d.i&&m.next.i!==d.i&&af(m,m.next,c,d))return!0;m=m.next}while(m!==c);return!1}(a,s)&&(kc(a,s)&&kc(s,a)&&function(c,d){var m=c,b=!1,w=(c.x+d.x)/2,E=(c.y+d.y)/2;do{m.y>E!=m.next.y>E&&m.next.y!==m.y&&w<(m.next.x-m.x)*(E-m.y)/(m.next.y-m.y)+m.x&&(b=!b),m=m.next}while(m!==c);return b}(a,s)&&(yi(a.prev,a,s.prev)||yi(a,s.prev,s))||zh(a,s)&&yi(a.prev,a,a.next)>0&&yi(s.prev,s,s.next)>0)}function yi(a,s,c){return(s.y-a.y)*(c.x-s.x)-(s.x-a.x)*(c.y-s.y)}function zh(a,s){return a.x===s.x&&a.y===s.y}function af(a,s,c,d){var m=Bh(yi(a,s,c)),b=Bh(yi(a,s,d)),w=Bh(yi(c,d,a)),E=Bh(yi(c,d,s));return m!==b&&w!==E||!(0!==m||!lf(a,c,s))||!(0!==b||!lf(a,d,s))||!(0!==w||!lf(c,a,d))||!(0!==E||!lf(c,s,d))}function lf(a,s,c){return s.x<=Math.max(a.x,c.x)&&s.x>=Math.min(a.x,c.x)&&s.y<=Math.max(a.y,c.y)&&s.y>=Math.min(a.y,c.y)}function Bh(a){return a>0?1:a<0?-1:0}function kc(a,s){return yi(a.prev,a,a.next)<0?yi(a,s,a.next)>=0&&yi(a,a.prev,s)>=0:yi(a,s,a.prev)<0||yi(a,a.next,s)<0}function Wp(a,s){var c=new cf(a.i,a.x,a.y),d=new cf(s.i,s.x,s.y),m=a.next,b=s.prev;return a.next=s,s.prev=a,c.next=m,m.prev=c,d.next=c,c.prev=d,b.next=d,d.prev=b,d}function Zp(a,s,c,d){var m=new cf(a,s,c);return d?(m.next=d.next,m.prev=d,d.next.prev=m,d.next=m):(m.prev=m,m.next=m),m}function Fu(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function cf(a,s,c){this.i=a,this.x=s,this.y=c,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Uh(a,s,c,d){for(var m=0,b=s,w=c-d;b<c;b+=d)m+=(a[w]-a[b])*(a[b+1]+a[w+1]),w=b;return m}po.exports=ku,po.exports.default=ku,ku.deviation=function(a,s,c,d){var m=s&&s.length,b=Math.abs(Uh(a,0,m?s[0]*c:a.length,c));if(m)for(var w=0,E=s.length;w<E;w++)b-=Math.abs(Uh(a,s[w]*c,w<E-1?s[w+1]*c:a.length,c));var D=0;for(w=0;w<d.length;w+=3){var M=d[w]*c,L=d[w+1]*c,N=d[w+2]*c;D+=Math.abs((a[M]-a[N])*(a[L+1]-a[M+1])-(a[M]-a[L])*(a[N+1]-a[M+1]))}return 0===b&&0===D?0:Math.abs((D-b)/b)},ku.flatten=function(a){for(var s=a[0][0].length,c={vertices:[],holes:[],dimensions:s},d=0,m=0;m<a.length;m++){for(var b=0;b<a[m].length;b++)for(var w=0;w<s;w++)c.vertices.push(a[m][b][w]);m>0&&c.holes.push(d+=a[m-1].length)}return c};var Yg=xe(po.exports);function Yv(a,s,c,d,m){ts(a,s,c||0,d||a.length-1,m||Mi)}function ts(a,s,c,d,m){for(;d>c;){if(d-c>600){var b=d-c+1,w=s-c+1,E=Math.log(b),D=.5*Math.exp(2*E/3),M=.5*Math.sqrt(E*D*(b-D)/b)*(w-b/2<0?-1:1);ts(a,s,Math.max(c,Math.floor(s-w*D/b+M)),Math.min(d,Math.floor(s+(b-w)*D/b+M)),m)}var L=a[s],N=c,B=d;for(Vo(a,c,s),m(a[d],L)>0&&Vo(a,c,d);N<B;){for(Vo(a,N,B),N++,B--;m(a[N],L)<0;)N++;for(;m(a[B],L)>0;)B--}0===m(a[c],L)?Vo(a,c,B):Vo(a,++B,d),B<=s&&(c=B+1),s<=B&&(d=B-1)}}function Vo(a,s,c){var d=a[s];a[s]=a[c],a[c]=d}function Mi(a,s){return a<s?-1:a>s?1:0}function Oc(a,s){const c=a.length;if(c<=1)return[a];const d=[];let m,b;for(let w=0;w<c;w++){const E=as(a[w]);0!==E&&(a[w].area=Math.abs(E),void 0===b&&(b=E<0),b===E<0?(m&&d.push(m),m=[a[w]]):m.push(a[w]))}if(m&&d.push(m),s>1)for(let w=0;w<d.length;w++)d[w].length<=s||(Yv(d[w],s,1,d[w].length-1,Qv),d[w]=d[w].slice(0,s));return d}function Qv(a,s){return s.area-a.area}function Kp(a,s,c){const d=c.patternDependencies;let m=!1;for(const b of s){const w=b.paint.get(`${a}-pattern`);w.isConstant()||(m=!0);const E=w.constantOr(null);E&&(m=!0,d[E.to]=!0,d[E.from]=!0)}return m}function Xp(a,s,c,d,m){const b=m.patternDependencies;for(const w of s){const E=w.paint.get(`${a}-pattern`).value;if("constant"!==E.kind){let D=E.evaluate({zoom:d-1},c,{},m.availableImages),M=E.evaluate({zoom:d},c,{},m.availableImages),L=E.evaluate({zoom:d+1},c,{},m.availableImages);D=D&&D.name?D.name:D,M=M&&M.name?M.name:M,L=L&&L.name?L.name:L,b[D]=!0,b[M]=!0,b[L]=!0,c.patterns[w.id]={min:D,mid:M,max:L}}}return c}class uf{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new jt,this.indexArray=new ir,this.indexArray2=new zi,this.programConfigurations=new Fo(s.layers,s.zoom),this.segments=new Rn,this.segments2=new Rn,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(s,c,d){this.hasPattern=Kp("fill",this.layers,c);const m=this.layers[0].layout.get("fill-sort-key"),b=!m.isConstant(),w=[];for(const{feature:E,id:D,index:M,sourceLayerIndex:L}of s){const N=this.layers[0]._featureFilter.needGeometry,B=Pc(E,N);if(!this.layers[0]._featureFilter.filter(new In(this.zoom),B,d))continue;const j=b?m.evaluate(B,{},d,c.availableImages):void 0,H={id:D,properties:E.properties,type:E.type,sourceLayerIndex:L,index:M,geometry:N?B.geometry:jl(E),patterns:{},sortKey:j};w.push(H)}b&&w.sort((E,D)=>E.sortKey-D.sortKey);for(const E of w){const{geometry:D,index:M,sourceLayerIndex:L}=E;if(this.hasPattern){const N=Xp("fill",this.layers,E,this.zoom,c);this.patternFeatures.push(N)}else this.addFeature(E,D,M,d,{});c.featureIndex.insert(s[M].feature,D,M,L,this.index)}}update(s,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,d)}addFeatures(s,c,d){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,c,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Fh),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,c,d,m,b){for(const w of Oc(c,500)){let E=0;for(const j of w)E+=j.length;const D=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray),M=D.vertexLength,L=[],N=[];for(const j of w){if(0===j.length)continue;j!==w[0]&&N.push(L.length/2);const H=this.segments2.prepareSegment(j.length,this.layoutVertexArray,this.indexArray2),W=H.vertexLength;this.layoutVertexArray.emplaceBack(j[0].x,j[0].y),this.indexArray2.emplaceBack(W+j.length-1,W),L.push(j[0].x),L.push(j[0].y);for(let te=1;te<j.length;te++)this.layoutVertexArray.emplaceBack(j[te].x,j[te].y),this.indexArray2.emplaceBack(W+te-1,W+te),L.push(j[te].x),L.push(j[te].y);H.vertexLength+=j.length,H.primitiveLength+=j.length}const B=Yg(L,N);for(let j=0;j<B.length;j+=3)this.indexArray.emplaceBack(M+B[j],M+B[j+1],M+B[j+2]);D.vertexLength+=E,D.primitiveLength+=B.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,b,m)}}let Yp,Vh;Ye("FillBucket",uf,{omit:["layers","patternFeatures"]});var $l={get paint(){return Vh=Vh||new ni({"fill-antialias":new rt(we.paint_fill["fill-antialias"]),"fill-opacity":new _t(we.paint_fill["fill-opacity"]),"fill-color":new _t(we.paint_fill["fill-color"]),"fill-outline-color":new _t(we.paint_fill["fill-outline-color"]),"fill-translate":new rt(we.paint_fill["fill-translate"]),"fill-translate-anchor":new rt(we.paint_fill["fill-translate-anchor"]),"fill-pattern":new Rs(we.paint_fill["fill-pattern"])})},get layout(){return Yp=Yp||new ni({"fill-sort-key":new _t(we.layout_fill["fill-sort-key"])})}};class Jv extends Ks{constructor(s){super(s,$l)}recalculate(s,c){super.recalculate(s,c);const d=this.paint._values["fill-outline-color"];"constant"===d.value.kind&&void 0===d.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new uf(s)}queryRadius(){return Jd(this.paint.get("fill-translate"))}queryIntersectsFeature(s,c,d,m,b,w,E){return Bp(ef(s,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),w.angle,E),m)}isTileClipped(){return!0}}const hf=jn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),df=jn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:ff}=hf;var ga={},Qg=Xr,Qp=zu;function zu(a,s,c,d,m){this.properties={},this.extent=c,this.type=0,this._pbf=a,this._geometry=-1,this._keys=d,this._values=m,a.readFields(Bu,this,s)}function Bu(a,s,c){1==a?s.id=c.readVarint():2==a?function(d,m){for(var b=d.readVarint()+d.pos;d.pos<b;){var w=m._keys[d.readVarint()],E=m._values[d.readVarint()];m.properties[w]=E}}(c,s):3==a?s.type=c.readVarint():4==a&&(s._geometry=c.pos)}function jh(a){for(var s,c,d=0,m=0,b=a.length,w=b-1;m<b;w=m++)d+=((c=a[w]).x-(s=a[m]).x)*(s.y+c.y);return d}zu.types=["Unknown","Point","LineString","Polygon"],zu.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var s,c=a.readVarint()+a.pos,d=1,m=0,b=0,w=0,E=[];a.pos<c;){if(m<=0){var D=a.readVarint();d=7&D,m=D>>3}if(m--,1===d||2===d)b+=a.readSVarint(),w+=a.readSVarint(),1===d&&(s&&E.push(s),s=[]),s.push(new Qg(b,w));else{if(7!==d)throw new Error("unknown command "+d);s&&s.push(s[0].clone())}}return s&&E.push(s),E},zu.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var s=a.readVarint()+a.pos,c=1,d=0,m=0,b=0,w=1/0,E=-1/0,D=1/0,M=-1/0;a.pos<s;){if(d<=0){var L=a.readVarint();c=7&L,d=L>>3}if(d--,1===c||2===c)(m+=a.readSVarint())<w&&(w=m),m>E&&(E=m),(b+=a.readSVarint())<D&&(D=b),b>M&&(M=b);else if(7!==c)throw new Error("unknown command "+c)}return[w,D,E,M]},zu.prototype.toGeoJSON=function(a,s,c){var d,m,b=this.extent*Math.pow(2,c),w=this.extent*a,E=this.extent*s,D=this.loadGeometry(),M=zu.types[this.type];function L(j){for(var H=0;H<j.length;H++){var W=j[H];j[H]=[360*(W.x+w)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(W.y+E)/b)*Math.PI/180))-90]}}switch(this.type){case 1:var N=[];for(d=0;d<D.length;d++)N[d]=D[d][0];L(D=N);break;case 2:for(d=0;d<D.length;d++)L(D[d]);break;case 3:for(D=function(j){var H=j.length;if(H<=1)return[j];for(var W,te,re=[],ce=0;ce<H;ce++){var oe=jh(j[ce]);0!==oe&&(void 0===te&&(te=oe<0),te===oe<0?(W&&re.push(W),W=[j[ce]]):W.push(j[ce]))}return W&&re.push(W),re}(D),d=0;d<D.length;d++)for(m=0;m<D[d].length;m++)L(D[d][m])}1===D.length?D=D[0]:M="Multi"+M;var B={type:"Feature",geometry:{type:M,coordinates:D},properties:this.properties};return"id"in this&&(B.id=this.id),B};var e0=Qp,t0=pf;function pf(a,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(Sw,this,s),this.length=this._features.length}function Sw(a,s,c){15===a?s.version=c.readVarint():1===a?s.name=c.readString():5===a?s.extent=c.readVarint():2===a?s._features.push(c.pos):3===a?s._keys.push(c.readString()):4===a&&s._values.push(function(d){for(var m=null,b=d.readVarint()+d.pos;d.pos<b;){var w=d.readVarint()>>3;m=1===w?d.readString():2===w?d.readFloat():3===w?d.readDouble():4===w?d.readVarint64():5===w?d.readVarint():6===w?d.readSVarint():7===w?d.readBoolean():null}return m}(c))}pf.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var s=this._pbf.readVarint()+this._pbf.pos;return new e0(this._pbf,s,this.extent,this._keys,this._values)};var n0=t0;function r0(a,s,c){if(3===a){var d=new n0(c,c.readVarint()+c.pos);d.length&&(s[d.name]=d)}}ga.VectorTile=function(a,s){this.layers=a.readFields(r0,{},s)},ga.VectorTileFeature=Qp,ga.VectorTileLayer=t0;const Tw=ga.VectorTileFeature.types,Jg=Math.pow(2,13);function Nc(a,s,c,d,m,b,w,E){a.emplaceBack(s,c,2*Math.floor(d*Jg)+w,m*Jg*2,b*Jg*2,Math.round(E))}class Fc{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new Oe,this.centroidVertexArray=new Ne,this.indexArray=new ir,this.programConfigurations=new Fo(s.layers,s.zoom),this.segments=new Rn,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(s,c,d){this.features=[],this.hasPattern=Kp("fill-extrusion",this.layers,c);for(const{feature:m,id:b,index:w,sourceLayerIndex:E}of s){const D=this.layers[0]._featureFilter.needGeometry,M=Pc(m,D);if(!this.layers[0]._featureFilter.filter(new In(this.zoom),M,d))continue;const L={id:b,sourceLayerIndex:E,index:w,geometry:D?M.geometry:jl(m),properties:m.properties,type:m.type,patterns:{}};this.hasPattern?this.features.push(Xp("fill-extrusion",this.layers,L,this.zoom,c)):this.addFeature(L,L.geometry,w,d,{}),c.featureIndex.insert(m,L.geometry,w,E,this.index,!0)}}addFeatures(s,c,d){for(const m of this.features){const{geometry:b}=m;this.addFeature(m,b,m.index,c,d)}}update(s,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,d)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,ff),this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,df.members,!0),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(s,c,d,m,b){const w={x:0,y:0,vertexCount:0};for(const E of Oc(c,500)){let D=0;for(const H of E)D+=H.length;let M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const H of E){if(0===H.length||((a=H).every(s=>s.x<0)||a.every(s=>s.x>Bi)||a.every(s=>s.y<0)||a.every(s=>s.y>Bi)))continue;let W=0;for(let te=0;te<H.length;te++){const re=H[te];if(te>=1){const ce=H[te-1];if(!s0(re,ce)){M.vertexLength+4>Rn.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const oe=re.sub(ce)._perp()._unit(),fe=ce.dist(re);W+fe>32768&&(W=0),Nc(this.layoutVertexArray,re.x,re.y,oe.x,oe.y,0,0,W),Nc(this.layoutVertexArray,re.x,re.y,oe.x,oe.y,0,1,W),w.x+=2*re.x,w.y+=2*re.y,w.vertexCount+=2,W+=fe,Nc(this.layoutVertexArray,ce.x,ce.y,oe.x,oe.y,0,0,W),Nc(this.layoutVertexArray,ce.x,ce.y,oe.x,oe.y,0,1,W),w.x+=2*ce.x,w.y+=2*ce.y,w.vertexCount+=2;const ye=M.vertexLength;this.indexArray.emplaceBack(ye,ye+2,ye+1),this.indexArray.emplaceBack(ye+1,ye+2,ye+3),M.vertexLength+=4,M.primitiveLength+=2}}}}if(M.vertexLength+D>Rn.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(D,this.layoutVertexArray,this.indexArray)),"Polygon"!==Tw[s.type])continue;const L=[],N=[],B=M.vertexLength;for(const H of E)if(0!==H.length){H!==E[0]&&N.push(L.length/2);for(let W=0;W<H.length;W++){const te=H[W];Nc(this.layoutVertexArray,te.x,te.y,0,0,1,1,0),w.x+=te.x,w.y+=te.y,w.vertexCount+=1,L.push(te.x),L.push(te.y)}}const j=Yg(L,N);for(let H=0;H<j.length;H+=3)this.indexArray.emplaceBack(B+j[H],B+j[H+2],B+j[H+1]);M.primitiveLength+=j.length/3,M.vertexLength+=D}var a;for(let E=0;E<w.vertexCount;E++)this.centroidVertexArray.emplaceBack(Math.floor(w.x/w.vertexCount),Math.floor(w.y/w.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,b,m)}}function s0(a,s){return a.x===s.x&&(a.x<0||a.x>Bi)||a.y===s.y&&(a.y<0||a.y>Bi)}let mf;Ye("FillExtrusionBucket",Fc,{omit:["layers","features"]});var gf={get paint(){return mf=mf||new ni({"fill-extrusion-opacity":new rt(we["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new _t(we["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new rt(we["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new rt(we["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Rs(we["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new _t(we["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new _t(we["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new rt(we["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Dw extends Ks{constructor(s){super(s,gf)}createBucket(s){return new Fc(s)}queryRadius(){return Jd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(s,c,d,m,b,w,E,D){const M=ef(s,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),w.angle,E),L=this.paint.get("fill-extrusion-height").evaluate(c,d),N=this.paint.get("fill-extrusion-base").evaluate(c,d),B=function(H,W,te,re){const ce=[];for(const oe of H){const fe=[oe.x,oe.y,0,1];jp(fe,fe,W),ce.push(new ht(fe[0]/fe[3],fe[1]/fe[3]))}return ce}(M,D),j=function(H,W,te,re){const ce=[],oe=[],fe=re[8]*W,ye=re[9]*W,Te=re[10]*W,Ze=re[11]*W,nt=re[8]*te,Ge=re[9]*te,Ve=re[10]*te,ze=re[11]*te;for(const Xe of H){const Be=[],Re=[];for(const dt of Xe){const et=dt.x,Gt=dt.y,$n=re[0]*et+re[4]*Gt+re[12],ii=re[1]*et+re[5]*Gt+re[13],Ki=re[2]*et+re[6]*Gt+re[14],ks=re[3]*et+re[7]*Gt+re[15],Hr=Ki+Te,Pi=ks+Ze,Ui=$n+nt,rr=ii+Ge,Xi=Ki+Ve,is=ks+ze,Yi=new ht(($n+fe)/Pi,(ii+ye)/Pi);Yi.z=Hr/Pi,Be.push(Yi);const sr=new ht(Ui/is,rr/is);sr.z=Xi/is,Re.push(sr)}ce.push(Be),oe.push(Re)}return[ce,oe]}(m,N,L,D);return function(H,W,te){let re=1/0;Bp(te,W)&&(re=Jp(te,W[0]));for(let ce=0;ce<W.length;ce++){const oe=W[ce],fe=H[ce];for(let ye=0;ye<oe.length-1;ye++){const Te=oe[ye],Ze=[Te,oe[ye+1],fe[ye+1],fe[ye],Te];zo(te,Ze)&&(re=Math.min(re,Jp(te,Ze)))}}return re!==1/0&&re}(j[0],j[1],B)}}function Uu(a,s){return a.x*s.x+a.y*s.y}function Jp(a,s){if(1===a.length){let c=0;const d=s[c++];let m;for(;!m||d.equals(m);)if(m=s[c++],!m)return 1/0;for(;c<s.length;c++){const b=s[c],w=a[0],E=m.sub(d),D=b.sub(d),M=w.sub(d),L=Uu(E,E),N=Uu(E,D),B=Uu(D,D),j=Uu(M,E),H=Uu(M,D),W=L*B-N*N,te=(B*j-N*H)/W,re=(L*H-N*j)/W,ce=d.z*(1-te-re)+m.z*te+b.z*re;if(isFinite(ce))return ce}return 1/0}{let c=1/0;for(const d of s)c=Math.min(c,d.z);return c}}const o0=jn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:ya}=o0,a0=jn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:yf}=a0,em=ga.VectorTileFeature.types,ey=Math.cos(Math.PI/180*37.5),Hh=Math.pow(2,14)/.5;class qh{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new vt,this.layoutVertexArray2=new st,this.indexArray=new ir,this.programConfigurations=new Fo(s.layers,s.zoom),this.segments=new Rn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(s,c,d){this.hasPattern=Kp("line",this.layers,c);const m=this.layers[0].layout.get("line-sort-key"),b=!m.isConstant(),w=[];for(const{feature:E,id:D,index:M,sourceLayerIndex:L}of s){const N=this.layers[0]._featureFilter.needGeometry,B=Pc(E,N);if(!this.layers[0]._featureFilter.filter(new In(this.zoom),B,d))continue;const j=b?m.evaluate(B,{},d):void 0,H={id:D,properties:E.properties,type:E.type,sourceLayerIndex:L,index:M,geometry:N?B.geometry:jl(E),patterns:{},sortKey:j};w.push(H)}b&&w.sort((E,D)=>E.sortKey-D.sortKey);for(const E of w){const{geometry:D,index:M,sourceLayerIndex:L}=E;if(this.hasPattern){const N=Xp("line",this.layers,E,this.zoom,c);this.patternFeatures.push(N)}else this.addFeature(E,D,M,d,{});c.featureIndex.insert(s[M].feature,D,M,L,this.index)}}update(s,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,d)}addFeatures(s,c,d){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,c,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,yf)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,ya),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,c,d,m,b){const w=this.layers[0].layout,E=w.get("line-join").evaluate(s,{}),D=w.get("line-cap"),M=w.get("line-miter-limit"),L=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const N of c)this.addLine(N,s,E,D,M,L);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,b,m)}addLine(s,c,d,m,b,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let re=0;re<s.length-1;re++)this.totalDistance+=s[re].dist(s[re+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const E="Polygon"===em[c.type];let D=s.length;for(;D>=2&&s[D-1].equals(s[D-2]);)D--;let M=0;for(;M<D-1&&s[M].equals(s[M+1]);)M++;if(D<(E?3:2))return;"bevel"===d&&(b=1.05);const L=this.overscaling<=16?15*Bi/(512*this.overscaling):0,N=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray);let B,j,H,W,te;this.e1=this.e2=-1,E&&(B=s[D-2],te=s[M].sub(B)._unit()._perp());for(let re=M;re<D;re++){if(H=re===D-1?E?s[M+1]:void 0:s[re+1],H&&s[re].equals(H))continue;te&&(W=te),B&&(j=B),B=s[re],te=H?H.sub(B)._unit()._perp():W,W=W||te;let ce=W.add(te);0===ce.x&&0===ce.y||ce._unit();const oe=W.x*te.x+W.y*te.y,fe=ce.x*te.x+ce.y*te.y,ye=0!==fe?1/fe:1/0,Te=2*Math.sqrt(2-2*fe),Ze=fe<ey&&j&&H,nt=W.x*te.y-W.y*te.x>0;if(Ze&&re>M){const ze=B.dist(j);if(ze>2*L){const Xe=B.sub(B.sub(j)._mult(L/ze)._round());this.updateDistance(j,Xe),this.addCurrentVertex(Xe,W,0,0,N),j=Xe}}const Ge=j&&H;let Ve=Ge?d:E?"butt":m;if(Ge&&"round"===Ve&&(ye<w?Ve="miter":ye<=2&&(Ve="fakeround")),"miter"===Ve&&ye>b&&(Ve="bevel"),"bevel"===Ve&&(ye>2&&(Ve="flipbevel"),ye<b&&(Ve="miter")),j&&this.updateDistance(j,B),"miter"===Ve)ce._mult(ye),this.addCurrentVertex(B,ce,0,0,N);else if("flipbevel"===Ve){if(ye>100)ce=te.mult(-1);else{const ze=ye*W.add(te).mag()/W.sub(te).mag();ce._perp()._mult(ze*(nt?-1:1))}this.addCurrentVertex(B,ce,0,0,N),this.addCurrentVertex(B,ce.mult(-1),0,0,N)}else if("bevel"===Ve||"fakeround"===Ve){const ze=-Math.sqrt(ye*ye-1),Xe=nt?ze:0,Be=nt?0:ze;if(j&&this.addCurrentVertex(B,W,Xe,Be,N),"fakeround"===Ve){const Re=Math.round(180*Te/Math.PI/20);for(let dt=1;dt<Re;dt++){let et=dt/Re;if(.5!==et){const $n=et-.5;et+=et*$n*(et-1)*((1.0904+oe*(oe*(3.55645-1.43519*oe)-3.2452))*$n*$n+(.848013+oe*(.215638*oe-1.06021)))}const Gt=te.sub(W)._mult(et)._add(W)._unit()._mult(nt?-1:1);this.addHalfVertex(B,Gt.x,Gt.y,!1,nt,0,N)}}H&&this.addCurrentVertex(B,te,-Xe,-Be,N)}else if("butt"===Ve)this.addCurrentVertex(B,ce,0,0,N);else if("square"===Ve){const ze=j?1:-1;this.addCurrentVertex(B,ce,ze,ze,N)}else"round"===Ve&&(j&&(this.addCurrentVertex(B,W,0,0,N),this.addCurrentVertex(B,W,1,1,N,!0)),H&&(this.addCurrentVertex(B,te,-1,-1,N,!0),this.addCurrentVertex(B,te,0,0,N)));if(Ze&&re<D-1){const ze=B.dist(H);if(ze>2*L){const Xe=B.add(H.sub(B)._mult(L/ze)._round());this.updateDistance(B,Xe),this.addCurrentVertex(Xe,te,0,0,N),B=Xe}}}}addCurrentVertex(s,c,d,m,b,w=!1){const E=c.y*m-c.x,D=-c.y-c.x*m;this.addHalfVertex(s,c.x+c.y*d,c.y-c.x*d,w,!1,d,b),this.addHalfVertex(s,E,D,w,!0,-m,b),this.distance>Hh/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(s,c,d,m,b,w))}addHalfVertex({x:s,y:c},d,m,b,w,E,D){const M=.5*(this.lineClips?this.scaledDistance*(Hh-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((s<<1)+(b?1:0),(c<<1)+(w?1:0),Math.round(63*d)+128,Math.round(63*m)+128,1+(0===E?0:E<0?-1:1)|(63&M)<<2,M>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const L=D.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,L),D.primitiveLength++),w?this.e2=L:this.e1=L}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(s,c){this.distance+=s.dist(c),this.updateScaledDistance()}}let ty,tm;Ye("LineBucket",qh,{omit:["layers","patternFeatures"]});var nm={get paint(){return tm=tm||new ni({"line-opacity":new _t(we.paint_line["line-opacity"]),"line-color":new _t(we.paint_line["line-color"]),"line-translate":new rt(we.paint_line["line-translate"]),"line-translate-anchor":new rt(we.paint_line["line-translate-anchor"]),"line-width":new _t(we.paint_line["line-width"]),"line-gap-width":new _t(we.paint_line["line-gap-width"]),"line-offset":new _t(we.paint_line["line-offset"]),"line-blur":new _t(we.paint_line["line-blur"]),"line-dasharray":new Zs(we.paint_line["line-dasharray"]),"line-pattern":new Rs(we.paint_line["line-pattern"]),"line-gradient":new Ja(we.paint_line["line-gradient"])})},get layout(){return ty=ty||new ni({"line-cap":new rt(we.layout_line["line-cap"]),"line-join":new _t(we.layout_line["line-join"]),"line-miter-limit":new rt(we.layout_line["line-miter-limit"]),"line-round-limit":new rt(we.layout_line["line-round-limit"]),"line-sort-key":new _t(we.layout_line["line-sort-key"])})}};class ny extends _t{possiblyEvaluate(s,c){return c=new In(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,zoomHistory:c.zoomHistory,transition:c.transition}),super.possiblyEvaluate(s,c)}evaluate(s,c,d,m){return c=He({},c,{zoom:Math.floor(c.zoom)}),super.evaluate(s,c,d,m)}}let Gh;class l0 extends Ks{constructor(s){super(s,nm),this.gradientVersion=0,Gh||(Gh=new ny(nm.paint.properties["line-width"].specification),Gh.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(s){if("line-gradient"===s){const c=this.gradientExpression();this.stepInterpolant=!(void 0===c._styleExpression)&&c._styleExpression.expression instanceof ja,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(s,c){super.recalculate(s,c),this.paint._values["line-floorwidth"]=Gh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new qh(s)}queryRadius(s){const c=s,d=Wh(Oh("line-width",this,c),Oh("line-gap-width",this,c)),m=Oh("line-offset",this,c);return d/2+Math.abs(m)+Jd(this.paint.get("line-translate"))}queryIntersectsFeature(s,c,d,m,b,w,E){const D=ef(s,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),w.angle,E),M=E/2*Wh(this.paint.get("line-width").evaluate(c,d),this.paint.get("line-gap-width").evaluate(c,d)),L=this.paint.get("line-offset").evaluate(c,d);return L&&(m=function(N,B){const j=[];for(let H=0;H<N.length;H++){const W=N[H],te=[];for(let re=0;re<W.length;re++){const ce=W[re-1],oe=W[re],fe=W[re+1],ye=0===re?new ht(0,0):oe.sub(ce)._unit()._perp(),Te=re===W.length-1?new ht(0,0):fe.sub(oe)._unit()._perp(),Ze=ye._add(Te)._unit(),nt=Ze.x*Te.x+Ze.y*Te.y;0!==nt&&Ze._mult(1/nt),te.push(Ze._mult(B)._add(oe))}j.push(te)}return j}(m,L*E)),function(N,B,j){for(let H=0;H<B.length;H++){const W=B[H];if(N.length>=3)for(let te=0;te<W.length;te++)if(Bo(N,W[te]))return!0;if(hi(N,W,j))return!0}return!1}(D,m,M)}isTileClipped(){return!0}}function Wh(a,s){return s>0?s+2*a:a}const zc=jn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),c0=jn([{name:"a_projected_pos",components:3,type:"Float32"}],4);jn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const iy=jn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);jn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const im=jn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Zh=jn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function u0(a,s,c){return a.sections.forEach(d=>{d.text=function(m,b,w){const E=b.layout.get("text-transform").evaluate(w,{});return"uppercase"===E?m=m.toLocaleUpperCase():"lowercase"===E&&(m=m.toLocaleLowerCase()),Ni.applyArabicShaping&&(m=Ni.applyArabicShaping(m)),m}(d.text,s,c)}),a}jn([{name:"triangle",components:3,type:"Uint16"}]),jn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),jn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),jn([{type:"Float32",name:"offsetX"}]),jn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),jn([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const mr={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};var Wi=24,Bc=Ln,_f=function(a,s,c,d,m){var b,w,E=8*m-d-1,D=(1<<E)-1,M=D>>1,L=-7,N=c?m-1:0,B=c?-1:1,j=a[s+N];for(N+=B,b=j&(1<<-L)-1,j>>=-L,L+=E;L>0;b=256*b+a[s+N],N+=B,L-=8);for(w=b&(1<<-L)-1,b>>=-L,L+=d;L>0;w=256*w+a[s+N],N+=B,L-=8);if(0===b)b=1-M;else{if(b===D)return w?NaN:1/0*(j?-1:1);w+=Math.pow(2,d),b-=M}return(j?-1:1)*w*Math.pow(2,b-d)},ry=function(a,s,c,d,m,b){var w,E,D,M=8*b-m-1,L=(1<<M)-1,N=L>>1,B=23===m?Math.pow(2,-24)-Math.pow(2,-77):0,j=d?0:b-1,H=d?1:-1,W=s<0||0===s&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(E=isNaN(s)?1:0,w=L):(w=Math.floor(Math.log(s)/Math.LN2),s*(D=Math.pow(2,-w))<1&&(w--,D*=2),(s+=w+N>=1?B/D:B*Math.pow(2,1-N))*D>=2&&(w++,D/=2),w+N>=L?(E=0,w=L):w+N>=1?(E=(s*D-1)*Math.pow(2,m),w+=N):(E=s*Math.pow(2,N-1)*Math.pow(2,m),w=0));m>=8;a[c+j]=255&E,j+=H,E/=256,m-=8);for(w=w<<m|E,M+=m;M>0;a[c+j]=255&w,j+=H,w/=256,M-=8);a[c+j-H]|=128*W};function Ln(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}Ln.Varint=0,Ln.Fixed64=1,Ln.Bytes=2,Ln.Fixed32=5;var Vu=4294967296,Uc=1/Vu,Vc=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ls(a){return a.type===Ln.Bytes?a.readVarint()+a.pos:a.pos+1}function vf(a,s,c){var d=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));c.realloc(d);for(var m=c.pos-1;m>=a;m--)c.buf[m+d]=c.buf[m]}function ju(a,s){for(var c=0;c<a.length;c++)s.writeVarint(a[c])}function Iw(a,s){for(var c=0;c<a.length;c++)s.writeSVarint(a[c])}function h0(a,s){for(var c=0;c<a.length;c++)s.writeFloat(a[c])}function Aw(a,s){for(var c=0;c<a.length;c++)s.writeDouble(a[c])}function Mw(a,s){for(var c=0;c<a.length;c++)s.writeBoolean(a[c])}function Pw(a,s){for(var c=0;c<a.length;c++)s.writeFixed32(a[c])}function Rw(a,s){for(var c=0;c<a.length;c++)s.writeSFixed32(a[c])}function Lw(a,s){for(var c=0;c<a.length;c++)s.writeFixed64(a[c])}function kw(a,s){for(var c=0;c<a.length;c++)s.writeSFixed64(a[c])}function rl(a,s){return(a[s]|a[s+1]<<8|a[s+2]<<16)+16777216*a[s+3]}function $u(a,s,c){a[c]=s,a[c+1]=s>>>8,a[c+2]=s>>>16,a[c+3]=s>>>24}function sy(a,s){return(a[s]|a[s+1]<<8|a[s+2]<<16)+(a[s+3]<<24)}Ln.prototype={destroy:function(){this.buf=null},readFields:function(a,s,c){for(c=c||this.length;this.pos<c;){var d=this.readVarint(),m=d>>3,b=this.pos;this.type=7&d,a(m,s,this),this.pos===b&&this.skip(d)}return s},readMessage:function(a,s){return this.readFields(a,s,this.readVarint()+this.pos)},readFixed32:function(){var a=rl(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=sy(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=rl(this.buf,this.pos)+rl(this.buf,this.pos+4)*Vu;return this.pos+=8,a},readSFixed64:function(){var a=rl(this.buf,this.pos)+sy(this.buf,this.pos+4)*Vu;return this.pos+=8,a},readFloat:function(){var a=_f(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=_f(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var s,c,d=this.buf;return s=127&(c=d[this.pos++]),c<128?s:(s|=(127&(c=d[this.pos++]))<<7,c<128?s:(s|=(127&(c=d[this.pos++]))<<14,c<128?s:(s|=(127&(c=d[this.pos++]))<<21,c<128?s:function(m,b,w){var E,D,M=w.buf;if(E=(112&(D=M[w.pos++]))>>4,D<128||(E|=(127&(D=M[w.pos++]))<<3,D<128)||(E|=(127&(D=M[w.pos++]))<<10,D<128)||(E|=(127&(D=M[w.pos++]))<<17,D<128)||(E|=(127&(D=M[w.pos++]))<<24,D<128)||(E|=(1&(D=M[w.pos++]))<<31,D<128))return function jc(a,s,c){return c?4294967296*s+(a>>>0):4294967296*(s>>>0)+(a>>>0)}(m,E,b);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(c=d[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,s=this.pos;return this.pos=a,a-s>=12&&Vc?Vc.decode(this.buf.subarray(s,a)):function(c,d,m){for(var b="",w=d;w<m;){var E,D,M,L=c[w],N=null,B=L>239?4:L>223?3:L>191?2:1;if(w+B>m)break;1===B?L<128&&(N=L):2===B?128==(192&(E=c[w+1]))&&(N=(31&L)<<6|63&E)<=127&&(N=null):3===B?(D=c[w+2],128==(192&(E=c[w+1]))&&128==(192&D)&&((N=(15&L)<<12|(63&E)<<6|63&D)<=2047||N>=55296&&N<=57343)&&(N=null)):4===B&&(D=c[w+2],M=c[w+3],128==(192&(E=c[w+1]))&&128==(192&D)&&128==(192&M)&&((N=(15&L)<<18|(63&E)<<12|(63&D)<<6|63&M)<=65535||N>=1114112)&&(N=null)),null===N?(N=65533,B=1):N>65535&&(N-=65536,b+=String.fromCharCode(N>>>10&1023|55296),N=56320|1023&N),b+=String.fromCharCode(N),w+=B}return b}(this.buf,s,a)},readBytes:function(){var a=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,a);return this.pos=a,s},readPackedVarint:function(a,s){if(this.type!==Ln.Bytes)return a.push(this.readVarint(s));var c=Ls(this);for(a=a||[];this.pos<c;)a.push(this.readVarint(s));return a},readPackedSVarint:function(a){if(this.type!==Ln.Bytes)return a.push(this.readSVarint());var s=Ls(this);for(a=a||[];this.pos<s;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==Ln.Bytes)return a.push(this.readBoolean());var s=Ls(this);for(a=a||[];this.pos<s;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==Ln.Bytes)return a.push(this.readFloat());var s=Ls(this);for(a=a||[];this.pos<s;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==Ln.Bytes)return a.push(this.readDouble());var s=Ls(this);for(a=a||[];this.pos<s;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==Ln.Bytes)return a.push(this.readFixed32());var s=Ls(this);for(a=a||[];this.pos<s;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==Ln.Bytes)return a.push(this.readSFixed32());var s=Ls(this);for(a=a||[];this.pos<s;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==Ln.Bytes)return a.push(this.readFixed64());var s=Ls(this);for(a=a||[];this.pos<s;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==Ln.Bytes)return a.push(this.readSFixed64());var s=Ls(this);for(a=a||[];this.pos<s;)a.push(this.readSFixed64());return a},skip:function(a){var s=7&a;if(s===Ln.Varint)for(;this.buf[this.pos++]>127;);else if(s===Ln.Bytes)this.pos=this.readVarint()+this.pos;else if(s===Ln.Fixed32)this.pos+=4;else{if(s!==Ln.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(a,s){this.writeVarint(a<<3|s)},realloc:function(a){for(var s=this.length||16;s<this.pos+a;)s*=2;if(s!==this.length){var c=new Uint8Array(s);c.set(this.buf),this.buf=c,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),$u(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),$u(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),$u(this.buf,-1&a,this.pos),$u(this.buf,Math.floor(a*Uc),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),$u(this.buf,-1&a,this.pos),$u(this.buf,Math.floor(a*Uc),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(s,c){var d,m,b,E;if(s>=0?(d=s%4294967296|0,m=s/4294967296|0):(m=~(-s/4294967296),4294967295^(d=~(-s%4294967296))?d=d+1|0:(d=0,m=m+1|0)),s>=0x10000000000000000||s<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),b=d,(E=c).buf[E.pos++]=127&b|128,b>>>=7,E.buf[E.pos++]=127&b|128,b>>>=7,E.buf[E.pos++]=127&b|128,b>>>=7,E.buf[E.pos++]=127&b|128,E.buf[E.pos]=127&(b>>>=7),function(b,w){var E=(7&b)<<4;w.buf[w.pos++]|=E|((b>>>=3)?128:0),b&&(w.buf[w.pos++]=127&b|((b>>>=7)?128:0),b&&(w.buf[w.pos++]=127&b|((b>>>=7)?128:0),b&&(w.buf[w.pos++]=127&b|((b>>>=7)?128:0),b&&(w.buf[w.pos++]=127&b|((b>>>=7)?128:0),b&&(w.buf[w.pos++]=127&b)))))}(m,c)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(!!a)},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var s=this.pos;this.pos=function(d,m,b){for(var w,E,D=0;D<m.length;D++){if((w=m.charCodeAt(D))>55295&&w<57344){if(!E){w>56319||D+1===m.length?(d[b++]=239,d[b++]=191,d[b++]=189):E=w;continue}if(w<56320){d[b++]=239,d[b++]=191,d[b++]=189,E=w;continue}w=E-55296<<10|w-56320|65536,E=null}else E&&(d[b++]=239,d[b++]=191,d[b++]=189,E=null);w<128?d[b++]=w:(w<2048?d[b++]=w>>6|192:(w<65536?d[b++]=w>>12|224:(d[b++]=w>>18|240,d[b++]=w>>12&63|128),d[b++]=w>>6&63|128),d[b++]=63&w|128)}return b}(this.buf,a,this.pos);var c=this.pos-s;c>=128&&vf(s,c,this),this.pos=s-1,this.writeVarint(c),this.pos+=c},writeFloat:function(a){this.realloc(4),ry(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),ry(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var s=a.length;this.writeVarint(s),this.realloc(s);for(var c=0;c<s;c++)this.buf[this.pos++]=a[c]},writeRawMessage:function(a,s){this.pos++;var c=this.pos;a(s,this);var d=this.pos-c;d>=128&&vf(c,d,this),this.pos=c-1,this.writeVarint(d),this.pos+=d},writeMessage:function(a,s,c){this.writeTag(a,Ln.Bytes),this.writeRawMessage(s,c)},writePackedVarint:function(a,s){s.length&&this.writeMessage(a,ju,s)},writePackedSVarint:function(a,s){s.length&&this.writeMessage(a,Iw,s)},writePackedBoolean:function(a,s){s.length&&this.writeMessage(a,Mw,s)},writePackedFloat:function(a,s){s.length&&this.writeMessage(a,h0,s)},writePackedDouble:function(a,s){s.length&&this.writeMessage(a,Aw,s)},writePackedFixed32:function(a,s){s.length&&this.writeMessage(a,Pw,s)},writePackedSFixed32:function(a,s){s.length&&this.writeMessage(a,Rw,s)},writePackedFixed64:function(a,s){s.length&&this.writeMessage(a,Lw,s)},writePackedSFixed64:function(a,s){s.length&&this.writeMessage(a,kw,s)},writeBytesField:function(a,s){this.writeTag(a,Ln.Bytes),this.writeBytes(s)},writeFixed32Field:function(a,s){this.writeTag(a,Ln.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(a,s){this.writeTag(a,Ln.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(a,s){this.writeTag(a,Ln.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(a,s){this.writeTag(a,Ln.Fixed64),this.writeSFixed64(s)},writeVarintField:function(a,s){this.writeTag(a,Ln.Varint),this.writeVarint(s)},writeSVarintField:function(a,s){this.writeTag(a,Ln.Varint),this.writeSVarint(s)},writeStringField:function(a,s){this.writeTag(a,Ln.Bytes),this.writeString(s)},writeFloatField:function(a,s){this.writeTag(a,Ln.Fixed32),this.writeFloat(s)},writeDoubleField:function(a,s){this.writeTag(a,Ln.Fixed64),this.writeDouble(s)},writeBooleanField:function(a,s){this.writeVarintField(a,!!s)}};var Zi=xe(Bc);const rm=3;function Kh(a,s,c){1===a&&c.readMessage(d0,s)}function d0(a,s,c){if(3===a){const{id:d,bitmap:m,width:b,height:w,left:E,top:D,advance:M}=c.readMessage(mo,{});s.push({id:d,bitmap:new Nh({width:b+2*rm,height:w+2*rm},m),metrics:{width:b,height:w,left:E,top:D,advance:M}})}}function mo(a,s,c){1===a?s.id=c.readVarint():2===a?s.bitmap=c.readBytes():3===a?s.width=c.readVarint():4===a?s.height=c.readVarint():5===a?s.left=c.readSVarint():6===a?s.top=c.readSVarint():7===a&&(s.advance=c.readVarint())}const $c=rm;function sm(a){let s=0,c=0;for(const w of a)s+=w.w*w.h,c=Math.max(c,w.w);a.sort((w,E)=>E.h-w.h);const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),c),h:1/0}];let m=0,b=0;for(const w of a)for(let E=d.length-1;E>=0;E--){const D=d[E];if(!(w.w>D.w||w.h>D.h)){if(w.x=D.x,w.y=D.y,b=Math.max(b,w.y+w.h),m=Math.max(m,w.x+w.w),w.w===D.w&&w.h===D.h){const M=d.pop();E<d.length&&(d[E]=M)}else w.h===D.h?(D.x+=w.w,D.w-=w.w):w.w===D.w?(D.y+=w.h,D.h-=w.h):(d.push({x:D.x+w.w,y:D.y,w:D.w-w.w,h:w.h}),D.y+=w.h,D.h-=w.h);break}}return{w:m,h:b,fill:s/(m*b)||0}}const Ar=1;class Hc{constructor(s,{pixelRatio:c,version:d,stretchX:m,stretchY:b,content:w}){this.paddedRect=s,this.pixelRatio=c,this.stretchX=m,this.stretchY=b,this.content=w,this.version=d}get tl(){return[this.paddedRect.x+Ar,this.paddedRect.y+Ar]}get br(){return[this.paddedRect.x+this.paddedRect.w-Ar,this.paddedRect.y+this.paddedRect.h-Ar]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Ar)/this.pixelRatio,(this.paddedRect.h-2*Ar)/this.pixelRatio]}}class oy{constructor(s,c){const d={},m={};this.haveRenderCallbacks=[];const b=[];this.addImages(s,d,b),this.addImages(c,m,b);const{w,h:E}=sm(b),D=new Js({width:w||1,height:E||1});for(const M in s){const L=s[M],N=d[M].paddedRect;Js.copy(L.data,D,{x:0,y:0},{x:N.x+Ar,y:N.y+Ar},L.data)}for(const M in c){const L=c[M],N=m[M].paddedRect,B=N.x+Ar,j=N.y+Ar,H=L.data.width,W=L.data.height;Js.copy(L.data,D,{x:0,y:0},{x:B,y:j},L.data),Js.copy(L.data,D,{x:0,y:W-1},{x:B,y:j-1},{width:H,height:1}),Js.copy(L.data,D,{x:0,y:0},{x:B,y:j+W},{width:H,height:1}),Js.copy(L.data,D,{x:H-1,y:0},{x:B-1,y:j},{width:1,height:W}),Js.copy(L.data,D,{x:0,y:0},{x:B+H,y:j},{width:1,height:W})}this.image=D,this.iconPositions=d,this.patternPositions=m}addImages(s,c,d){for(const m in s){const b=s[m],w={x:0,y:0,w:b.data.width+2*Ar,h:b.data.height+2*Ar};d.push(w),c[m]=new Hc(w,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(s,c){s.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const d in s.updatedImages)this.patchUpdatedImage(this.iconPositions[d],s.getImage(d),c),this.patchUpdatedImage(this.patternPositions[d],s.getImage(d),c)}patchUpdatedImage(s,c,d){if(!s||!c||s.version===c.version)return;s.version=c.version;const[m,b]=s.tl;d.update(c.data,void 0,{x:m,y:b})}}var qc;Ye("ImagePosition",Hc),Ye("ImageAtlas",oy),y.ai=void 0,(qc=y.ai||(y.ai={}))[qc.none=0]="none",qc[qc.horizontal=1]="horizontal",qc[qc.vertical=2]="vertical",qc[qc.horizontalOnly=3]="horizontalOnly";const Xh=-17;class bf{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(s,c){const d=new bf;return d.scale=s||1,d.fontStack=c,d}static forImage(s){const c=new bf;return c.imageName=s,c}}class Mr{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,c){const d=new Mr;for(let m=0;m<s.sections.length;m++){const b=s.sections[m];b.image?d.addImageSection(b):d.addTextSection(b,c)}return d}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSectionIndex(s){return this.sectionIndex[s]}getCharCode(s){return this.text.charCodeAt(s)}verticalizePunctuation(){this.text=function(s){let c="";for(let d=0;d<s.length;d++){const m=s.charCodeAt(d+1)||null,b=s.charCodeAt(d-1)||null;c+=m&&Qr(m)&&!mr[s[d+1]]||b&&Qr(b)&&!mr[s[d-1]]||!mr[s[d]]?s[d]:mr[s[d]]}return c}(this.text)}trim(){let s=0;for(let d=0;d<this.text.length&&sl[this.text.charCodeAt(d)];d++)s++;let c=this.text.length;for(let d=this.text.length-1;d>=0&&d>=s&&sl[this.text.charCodeAt(d)];d--)c--;this.text=this.text.substring(s,c),this.sectionIndex=this.sectionIndex.slice(s,c)}substring(s,c){const d=new Mr;return d.text=this.text.substring(s,c),d.sectionIndex=this.sectionIndex.slice(s,c),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,c)=>Math.max(s,this.sections[c].scale),0)}addTextSection(s,c){this.text+=s.text,this.sections.push(bf.forText(s.scale,s.fontStack||c));const d=this.sections.length-1;for(let m=0;m<s.text.length;++m)this.sectionIndex.push(d)}addImageSection(s){const c=s.image?s.image.name:"";if(0===c.length)return void fi("Can't add FormattedSection with an empty image.");const d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push(bf.forImage(c)),this.sectionIndex.push(this.sections.length-1)):fi("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Hu(a,s,c,d,m,b,w,E,D,M,L,N,B,j,H,W){const te=Mr.fromFeature(a,m);let re;N===y.ai.vertical&&te.verticalizePunctuation();const{processBidirectionalText:ce,processStyledBidirectionalText:oe}=Ni;if(ce&&1===te.sections.length){re=[];const Te=ce(te.toString(),am(te,M,b,s,d,j,H));for(const Ze of Te){const nt=new Mr;nt.text=Ze,nt.sections=te.sections;for(let Ge=0;Ge<Ze.length;Ge++)nt.sectionIndex.push(0);re.push(nt)}}else if(oe){re=[];const Te=oe(te.text,te.sectionIndex,am(te,M,b,s,d,j,H));for(const Ze of Te){const nt=new Mr;nt.text=Ze[0],nt.sectionIndex=Ze[1],nt.sections=te.sections,re.push(nt)}}else re=function(Te,Ze){const nt=[],Ge=Te.text;let Ve=0;for(const ze of Ze)nt.push(Te.substring(Ve,ze)),Ve=ze;return Ve<Ge.length&&nt.push(Te.substring(Ve,Ge.length)),nt}(te,am(te,M,b,s,d,j,H));const fe=[],ye={positionedLines:fe,text:te.toString(),top:L[1],bottom:L[1],left:L[0],right:L[0],writingMode:N,iconsInText:!1,verticalizable:!1};return function(Te,Ze,nt,Ge,Ve,ze,Xe,Be,Re,dt,et,Gt){let $n=0,ii=Xh,Ki=0,ks=0;const Hr="right"===Be?1:"left"===Be?0:.5;let Pi=0;for(const Yi of Ve){Yi.trim();const sr=Yi.getMaxScale(),qr=(sr-1)*Wi,Pr={positionedGlyphs:[],lineOffset:0};Te.positionedLines[Pi]=Pr;const Gr=Pr.positionedGlyphs;let or=0;if(!Yi.length()){ii+=ze,++Pi;continue}for(let Ri=0;Ri<Yi.length();Ri++){const Qt=Yi.getSection(Ri),Lr=Yi.getSectionIndex(Ri),yr=Yi.getCharCode(Ri);let Vi=0,go=null,Ho=null,qo=null,ll=Wi;const yo=!(Re===y.ai.horizontal||!et&&!ua(yr)||et&&(sl[yr]||(Ui=yr,Fe.Arabic(Ui)||Fe["Arabic Supplement"](Ui)||Fe["Arabic Extended-A"](Ui)||Fe["Arabic Presentation Forms-A"](Ui)||Fe["Arabic Presentation Forms-B"](Ui))));if(Qt.imageName){const ar=Ge[Qt.imageName];if(!ar)continue;qo=Qt.imageName,Te.iconsInText=Te.iconsInText||!0,Ho=ar.paddedRect;const _r=ar.displaySize;Qt.scale=Qt.scale*Wi/Gt,go={width:_r[0],height:_r[1],left:Ar,top:-$c,advance:yo?_r[1]:_r[0]},Vi=qr+(Wi-_r[1]*Qt.scale),ll=go.advance;const cl=yo?_r[0]*Qt.scale-Wi*sr:_r[1]*Qt.scale-Wi*sr;cl>0&&cl>or&&(or=cl)}else{const ar=nt[Qt.fontStack],_r=ar&&ar[yr];if(_r&&_r.rect)Ho=_r.rect,go=_r.metrics;else{const cl=Ze[Qt.fontStack],kf=cl&&cl[yr];if(!kf)continue;go=kf.metrics}Vi=(sr-Qt.scale)*Wi}yo?(Te.verticalizable=!0,Gr.push({glyph:yr,imageName:qo,x:$n,y:ii+Vi,vertical:yo,scale:Qt.scale,fontStack:Qt.fontStack,sectionIndex:Lr,metrics:go,rect:Ho}),$n+=ll*Qt.scale+dt):(Gr.push({glyph:yr,imageName:qo,x:$n,y:ii+Vi,vertical:yo,scale:Qt.scale,fontStack:Qt.fontStack,sectionIndex:Lr,metrics:go,rect:Ho}),$n+=go.advance*Qt.scale+dt)}0!==Gr.length&&(Ki=Math.max($n-dt,Ki),cm(Gr,0,Gr.length-1,Hr,or)),$n=0;const Rr=ze*sr+or;Pr.lineOffset=Math.max(or,qr),ii+=Rr,ks=Math.max(Rr,ks),++Pi}var Ui;const rr=ii-Xh,{horizontalAlign:Xi,verticalAlign:is}=lm(Xe);(function(Yi,sr,qr,Pr,Gr,or,Rr,Ri,Qt){const Lr=(sr-qr)*Gr;let yr=0;yr=or!==Rr?-Ri*Pr-Xh:(-Pr*Qt+.5)*Rr;for(const Vi of Yi)for(const go of Vi.positionedGlyphs)go.x+=Lr,go.y+=yr})(Te.positionedLines,Hr,Xi,is,Ki,ks,ze,rr,Ve.length),Te.top+=-is*rr,Te.bottom=Te.top+rr,Te.left+=-Xi*Ki,Te.right=Te.left+Ki}(ye,s,c,d,re,w,E,D,N,M,B,W),!function(Te){for(const Ze of Te)if(0!==Ze.positionedGlyphs.length)return!1;return!0}(fe)&&ye}const sl={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Ow={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function om(a,s,c,d,m,b){if(s.imageName){const w=d[s.imageName];return w?w.displaySize[0]*s.scale*Wi/b+m:0}{const w=c[s.fontStack],E=w&&w[a];return E?E.metrics.advance*s.scale+m:0}}function ay(a,s,c,d){const m=Math.pow(a-s,2);return d?a<s?m/2:2*m:m+Math.abs(c)*c}function f0(a,s,c){let d=0;return 10===a&&(d-=1e4),c&&(d+=150),40!==a&&65288!==a||(d+=50),41!==s&&65289!==s||(d+=50),d}function ly(a,s,c,d,m,b){let w=null,E=ay(s,c,m,b);for(const D of d){const M=ay(s-D.x,c,m,b)+D.badness;M<=E&&(w=D,E=M)}return{index:a,x:s,priorBreak:w,badness:E}}function cy(a){return a?cy(a.priorBreak).concat(a.index):[]}function am(a,s,c,d,m,b,w){if("point"!==b)return[];if(!a)return[];const E=[],D=function(B,j,H,W,te,re){let ce=0;for(let oe=0;oe<B.length();oe++){const fe=B.getSection(oe);ce+=om(B.getCharCode(oe),fe,W,te,j,re)}return ce/Math.max(1,Math.ceil(ce/H))}(a,s,c,d,m,w),M=a.text.indexOf("\u200b")>=0;let L=0;for(let B=0;B<a.length();B++){const j=a.getSection(B),H=a.getCharCode(B);if(sl[H]||(L+=om(H,j,d,m,s,w)),B<a.length()-1){const W=!((N=H)<11904||!(Fe["Bopomofo Extended"](N)||Fe.Bopomofo(N)||Fe["CJK Compatibility Forms"](N)||Fe["CJK Compatibility Ideographs"](N)||Fe["CJK Compatibility"](N)||Fe["CJK Radicals Supplement"](N)||Fe["CJK Strokes"](N)||Fe["CJK Symbols and Punctuation"](N)||Fe["CJK Unified Ideographs Extension A"](N)||Fe["CJK Unified Ideographs"](N)||Fe["Enclosed CJK Letters and Months"](N)||Fe["Halfwidth and Fullwidth Forms"](N)||Fe.Hiragana(N)||Fe["Ideographic Description Characters"](N)||Fe["Kangxi Radicals"](N)||Fe["Katakana Phonetic Extensions"](N)||Fe.Katakana(N)||Fe["Vertical Forms"](N)||Fe["Yi Radicals"](N)||Fe["Yi Syllables"](N)));(Ow[H]||W||j.imageName)&&E.push(ly(B+1,L,D,E,f0(H,a.getCharCode(B+1),W&&M),!1))}}var N;return cy(ly(a.length(),L,D,E,0,!0))}function lm(a){let s=.5,c=.5;switch(a){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:s,verticalAlign:c}}function cm(a,s,c,d,m){if(!d&&!m)return;const b=a[c],w=(a[c].x+b.metrics.advance*b.scale)*d;for(let E=s;E<=c;E++)a[E].x-=w,a[E].y+=m}function xf(a,s,c){const{horizontalAlign:d,verticalAlign:m}=lm(c),b=s[0]-a.displaySize[0]*d,w=s[1]-a.displaySize[1]*m;return{image:a,top:w,bottom:w+a.displaySize[1],left:b,right:b+a.displaySize[0]}}function uy(a,s,c,d,m,b){const w=a.image;let E;if(w.content){const te=w.content,re=w.pixelRatio||1;E=[te[0]/re,te[1]/re,w.displaySize[0]-te[2]/re,w.displaySize[1]-te[3]/re]}const D=s.left*b,M=s.right*b;let L,N,B,j;"width"===c||"both"===c?(j=m[0]+D-d[3],N=m[0]+M+d[1]):(j=m[0]+(D+M-w.displaySize[0])/2,N=j+w.displaySize[0]);const H=s.top*b,W=s.bottom*b;return"height"===c||"both"===c?(L=m[1]+H-d[0],B=m[1]+W+d[2]):(L=m[1]+(H+W-w.displaySize[1])/2,B=L+w.displaySize[1]),{image:w,top:L,right:N,bottom:B,left:j,collisionPadding:E}}const Hl=255,_a=128,jo=Hl*_a;function hy(a,s){const{expression:c}=s;if("constant"===c.kind)return{kind:"constant",layoutSize:c.evaluate(new In(a+1))};if("source"===c.kind)return{kind:"source"};{const{zoomStops:d,interpolationType:m}=c;let b=0;for(;b<d.length&&d[b]<=a;)b++;b=Math.max(0,b-1);let w=b;for(;w<d.length&&d[w]<a+1;)w++;w=Math.min(d.length-1,w);const E=d[b],D=d[w];return"composite"===c.kind?{kind:"composite",minZoom:E,maxZoom:D,interpolationType:m}:{kind:"camera",minZoom:E,maxZoom:D,minSize:c.evaluate(new In(E)),maxSize:c.evaluate(new In(D)),interpolationType:m}}}function wf(a,s,c){let d="never";const m=a.get(s);return m?d=m:a.get(c)&&(d="always"),d}const um=ga.VectorTileFeature.types,Cf=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Yh(a,s,c,d,m,b,w,E,D,M,L,N,B){const j=E?Math.min(jo,Math.round(E[0])):0,H=E?Math.min(jo,Math.round(E[1])):0;a.emplaceBack(s,c,Math.round(32*d),Math.round(32*m),b,w,(j<<1)+(D?1:0),H,16*M,16*L,256*N,256*B)}function hm(a,s,c){a.emplaceBack(s.x,s.y,c),a.emplaceBack(s.x,s.y,c),a.emplaceBack(s.x,s.y,c),a.emplaceBack(s.x,s.y,c)}function p0(a){for(const s of a.sections)if(Au(s.text))return!0;return!1}class ql{constructor(s){this.layoutVertexArray=new qt,this.indexArray=new ir,this.programConfigurations=s,this.segments=new Rn,this.dynamicLayoutVertexArray=new Nt,this.opacityVertexArray=new Zt,this.hasVisibleVertices=!1,this.placedSymbolArray=new le}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(s,c,d,m){this.isEmpty()||(d&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,zc.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,c0.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,Cf,!0),this.opacityVertexBuffer.itemSize=1),(d||m)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ye("SymbolBuffers",ql);class Gc{constructor(s,c,d){this.layoutVertexArray=new s,this.layoutAttributes=c,this.indexArray=new d,this.segments=new Rn,this.collisionVertexArray=new Fn}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,iy.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ye("CollisionBuffers",Gc);class qu{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(w=>w.id),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=tf([]),this.placementViewportMatrix=tf([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=hy(this.zoom,c["text-size"]),this.iconSizeData=hy(this.zoom,c["icon-size"]);const d=this.layers[0].layout,m=d.get("symbol-sort-key"),b=d.get("symbol-z-order");this.canOverlap="never"!==wf(d,"text-overlap","text-allow-overlap")||"never"!==wf(d,"icon-overlap","icon-allow-overlap")||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==b&&!m.isConstant(),this.sortFeaturesByY=("viewport-y"===b||"auto"===b&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===d.get("symbol-placement")&&(this.writingModes=d.get("text-writing-mode").map(w=>y.ai[w])),this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id),this.sourceID=s.sourceID}createArrays(){this.text=new ql(new Fo(this.layers,this.zoom,s=>/^text/.test(s))),this.icon=new ql(new Fo(this.layers,this.zoom,s=>/^icon/.test(s))),this.glyphOffsetArray=new he,this.lineVertexArray=new _e,this.symbolInstances=new ie,this.textAnchorOffsets=new Ee}calculateGlyphDependencies(s,c,d,m,b){for(let w=0;w<s.length;w++)if(c[s.charCodeAt(w)]=!0,(d||m)&&b){const E=mr[s.charAt(w)];E&&(c[E.charCodeAt(0)]=!0)}}populate(s,c,d){const m=this.layers[0],b=m.layout,w=b.get("text-font"),E=b.get("text-field"),D=b.get("icon-image"),M=("constant"!==E.value.kind||E.value.value instanceof ur&&!E.value.value.isEmpty()||E.value.value.toString().length>0)&&("constant"!==w.value.kind||w.value.value.length>0),L="constant"!==D.value.kind||!!D.value.value||Object.keys(D.parameters).length>0,N=b.get("symbol-sort-key");if(this.features=[],!M&&!L)return;const B=c.iconDependencies,j=c.glyphDependencies,H=c.availableImages,W=new In(this.zoom);for(const{feature:te,id:re,index:ce,sourceLayerIndex:oe}of s){const fe=m._featureFilter.needGeometry,ye=Pc(te,fe);if(!m._featureFilter.filter(W,ye,d))continue;let Te,Ze;if(fe||(ye.geometry=jl(te)),M){const Ge=m.getValueAndResolveTokens("text-field",ye,d,H),Ve=ur.factory(Ge);p0(Ve)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===ha()||this.hasRTLText&&Ni.isParsed())&&(Te=u0(Ve,m,ye))}if(L){const Ge=m.getValueAndResolveTokens("icon-image",ye,d,H);Ze=Ge instanceof hr?Ge:hr.fromString(Ge)}if(!Te&&!Ze)continue;const nt=this.sortFeaturesByKey?N.evaluate(ye,{},d):void 0;if(this.features.push({id:re,text:Te,icon:Ze,index:ce,sourceLayerIndex:oe,geometry:ye.geometry,properties:te.properties,type:um[te.type],sortKey:nt}),Ze&&(B[Ze.name]=!0),Te){const Ge=w.evaluate(ye,{},d).join(","),Ve="viewport"!==b.get("text-rotation-alignment")&&"point"!==b.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(y.ai.vertical)>=0;for(const ze of Te.sections)if(ze.image)B[ze.image.name]=!0;else{const Xe=dn(Te.toString()),Be=ze.fontStack||Ge,Re=j[Be]=j[Be]||{};this.calculateGlyphDependencies(ze.text,Re,Ve,this.allowVerticalPlacement,Xe)}}}"line"===b.get("symbol-placement")&&(this.features=function(te){const re={},ce={},oe=[];let fe=0;function ye(Ge){oe.push(te[Ge]),fe++}function Te(Ge,Ve,ze){const Xe=ce[Ge];return delete ce[Ge],ce[Ve]=Xe,oe[Xe].geometry[0].pop(),oe[Xe].geometry[0]=oe[Xe].geometry[0].concat(ze[0]),Xe}function Ze(Ge,Ve,ze){const Xe=re[Ve];return delete re[Ve],re[Ge]=Xe,oe[Xe].geometry[0].shift(),oe[Xe].geometry[0]=ze[0].concat(oe[Xe].geometry[0]),Xe}function nt(Ge,Ve,ze){const Xe=ze?Ve[0][Ve[0].length-1]:Ve[0][0];return`${Ge}:${Xe.x}:${Xe.y}`}for(let Ge=0;Ge<te.length;Ge++){const Ve=te[Ge],ze=Ve.geometry,Xe=Ve.text?Ve.text.toString():null;if(!Xe){ye(Ge);continue}const Be=nt(Xe,ze),Re=nt(Xe,ze,!0);if(Be in ce&&Re in re&&ce[Be]!==re[Re]){const dt=Ze(Be,Re,ze),et=Te(Be,Re,oe[dt].geometry);delete re[Be],delete ce[Re],ce[nt(Xe,oe[et].geometry,!0)]=et,oe[dt].geometry=null}else Be in ce?Te(Be,Re,ze):Re in re?Ze(Be,Re,ze):(ye(Ge),re[Be]=fe-1,ce[Re]=fe-1)}return oe.filter(Ge=>Ge.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((te,re)=>te.sortKey-re.sortKey)}update(s,c,d){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,c,this.layers,d),this.icon.programConfigurations.updatePaintArrays(s,c,this.layers,d))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,c){const d=this.lineVertexArray.length;if(void 0!==s.segment){let m=s.dist(c[s.segment+1]),b=s.dist(c[s.segment]);const w={};for(let E=s.segment+1;E<c.length;E++)w[E]={x:c[E].x,y:c[E].y,tileUnitDistanceFromAnchor:m},E<c.length-1&&(m+=c[E+1].dist(c[E]));for(let E=s.segment||0;E>=0;E--)w[E]={x:c[E].x,y:c[E].y,tileUnitDistanceFromAnchor:b},E>0&&(b+=c[E-1].dist(c[E]));for(let E=0;E<c.length;E++){const D=w[E];this.lineVertexArray.emplaceBack(D.x,D.y,D.tileUnitDistanceFromAnchor)}}return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(s,c,d,m,b,w,E,D,M,L,N,B){const j=s.indexArray,H=s.layoutVertexArray,W=s.segments.prepareSegment(4*c.length,H,j,this.canOverlap?w.sortKey:void 0),te=this.glyphOffsetArray.length,re=W.vertexLength,ce=this.allowVerticalPlacement&&E===y.ai.vertical?Math.PI/2:0,oe=w.text&&w.text.sections;for(let fe=0;fe<c.length;fe++){const{tl:ye,tr:Te,bl:Ze,br:nt,tex:Ge,pixelOffsetTL:Ve,pixelOffsetBR:ze,minFontScaleX:Xe,minFontScaleY:Be,glyphOffset:Re,isSDF:dt,sectionIndex:et}=c[fe],Gt=W.vertexLength,$n=Re[1];Yh(H,D.x,D.y,ye.x,$n+ye.y,Ge.x,Ge.y,d,dt,Ve.x,Ve.y,Xe,Be),Yh(H,D.x,D.y,Te.x,$n+Te.y,Ge.x+Ge.w,Ge.y,d,dt,ze.x,Ve.y,Xe,Be),Yh(H,D.x,D.y,Ze.x,$n+Ze.y,Ge.x,Ge.y+Ge.h,d,dt,Ve.x,ze.y,Xe,Be),Yh(H,D.x,D.y,nt.x,$n+nt.y,Ge.x+Ge.w,Ge.y+Ge.h,d,dt,ze.x,ze.y,Xe,Be),hm(s.dynamicLayoutVertexArray,D,ce),j.emplaceBack(Gt,Gt+1,Gt+2),j.emplaceBack(Gt+1,Gt+2,Gt+3),W.vertexLength+=4,W.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Re[0]),fe!==c.length-1&&et===c[fe+1].sectionIndex||s.programConfigurations.populatePaintArrays(H.length,w,w.index,{},B,oe&&oe[et])}s.placedSymbolArray.emplaceBack(D.x,D.y,te,this.glyphOffsetArray.length-te,re,M,L,D.segment,d?d[0]:0,d?d[1]:0,m[0],m[1],E,0,!1,0,N)}_addCollisionDebugVertex(s,c,d,m,b,w){return c.emplaceBack(0,0),s.emplaceBack(d.x,d.y,m,b,Math.round(w.x),Math.round(w.y))}addCollisionDebugVertices(s,c,d,m,b,w,E){const D=b.segments.prepareSegment(4,b.layoutVertexArray,b.indexArray),M=D.vertexLength,L=b.layoutVertexArray,N=b.collisionVertexArray,B=E.anchorX,j=E.anchorY;this._addCollisionDebugVertex(L,N,w,B,j,new ht(s,c)),this._addCollisionDebugVertex(L,N,w,B,j,new ht(d,c)),this._addCollisionDebugVertex(L,N,w,B,j,new ht(d,m)),this._addCollisionDebugVertex(L,N,w,B,j,new ht(s,m)),D.vertexLength+=4;const H=b.indexArray;H.emplaceBack(M,M+1),H.emplaceBack(M+1,M+2),H.emplaceBack(M+2,M+3),H.emplaceBack(M+3,M),D.primitiveLength+=4}addDebugCollisionBoxes(s,c,d,m){for(let b=s;b<c;b++){const w=this.collisionBoxArray.get(b);this.addCollisionDebugVertices(w.x1,w.y1,w.x2,w.y2,m?this.textCollisionBox:this.iconCollisionBox,w.anchorPoint,d)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Gc(ci,im.members,zi),this.iconCollisionBox=new Gc(ci,im.members,zi);for(let s=0;s<this.symbolInstances.length;s++){const c=this.symbolInstances.get(s);this.addDebugCollisionBoxes(c.textBoxStartIndex,c.textBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.iconBoxStartIndex,c.iconBoxEndIndex,c,!1),this.addDebugCollisionBoxes(c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex,c,!1)}}_deserializeCollisionBoxesForSymbol(s,c,d,m,b,w,E,D,M){const L={};for(let N=c;N<d;N++){const B=s.get(N);L.textBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},L.textFeatureIndex=B.featureIndex;break}for(let N=m;N<b;N++){const B=s.get(N);L.verticalTextBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},L.verticalTextFeatureIndex=B.featureIndex;break}for(let N=w;N<E;N++){const B=s.get(N);L.iconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},L.iconFeatureIndex=B.featureIndex;break}for(let N=D;N<M;N++){const B=s.get(N);L.verticalIconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},L.verticalIconFeatureIndex=B.featureIndex;break}return L}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const d=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(s,c){const d=s.placedSymbolArray.get(c),m=d.vertexStartIndex+4*d.numGlyphs;for(let b=d.vertexStartIndex;b<m;b+=4)s.indexArray.emplaceBack(b,b+1,b+2),s.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const c=Math.sin(s),d=Math.cos(s),m=[],b=[],w=[];for(let E=0;E<this.symbolInstances.length;++E){w.push(E);const D=this.symbolInstances.get(E);m.push(0|Math.round(c*D.anchorX+d*D.anchorY)),b.push(D.featureIndex)}return w.sort((E,D)=>m[E]-m[D]||b[D]-b[E]),w}addToSortKeyRanges(s,c){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===c?d.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const d=this.symbolInstances.get(c);this.featureSortOrder.push(d.featureIndex),[d.rightJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.leftJustifiedTextSymbolIndex].forEach((m,b,w)=>{m>=0&&w.indexOf(m)===b&&this.addIndicesForPlacedSymbol(this.text,m)}),d.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,d.verticalPlacedTextSymbolIndex),d.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.placedIconSymbolIndex),d.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let m0,dm;Ye("SymbolBucket",qu,{omit:["layers","collisionBoxArray","features","compareText"]}),qu.MAX_GLYPHS=65535,qu.addDynamicAttributes=hm;var fm={get paint(){return dm=dm||new ni({"icon-opacity":new _t(we.paint_symbol["icon-opacity"]),"icon-color":new _t(we.paint_symbol["icon-color"]),"icon-halo-color":new _t(we.paint_symbol["icon-halo-color"]),"icon-halo-width":new _t(we.paint_symbol["icon-halo-width"]),"icon-halo-blur":new _t(we.paint_symbol["icon-halo-blur"]),"icon-translate":new rt(we.paint_symbol["icon-translate"]),"icon-translate-anchor":new rt(we.paint_symbol["icon-translate-anchor"]),"text-opacity":new _t(we.paint_symbol["text-opacity"]),"text-color":new _t(we.paint_symbol["text-color"],{runtimeType:Or,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new _t(we.paint_symbol["text-halo-color"]),"text-halo-width":new _t(we.paint_symbol["text-halo-width"]),"text-halo-blur":new _t(we.paint_symbol["text-halo-blur"]),"text-translate":new rt(we.paint_symbol["text-translate"]),"text-translate-anchor":new rt(we.paint_symbol["text-translate-anchor"])})},get layout(){return m0=m0||new ni({"symbol-placement":new rt(we.layout_symbol["symbol-placement"]),"symbol-spacing":new rt(we.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new rt(we.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new _t(we.layout_symbol["symbol-sort-key"]),"symbol-z-order":new rt(we.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new rt(we.layout_symbol["icon-allow-overlap"]),"icon-overlap":new rt(we.layout_symbol["icon-overlap"]),"icon-ignore-placement":new rt(we.layout_symbol["icon-ignore-placement"]),"icon-optional":new rt(we.layout_symbol["icon-optional"]),"icon-rotation-alignment":new rt(we.layout_symbol["icon-rotation-alignment"]),"icon-size":new _t(we.layout_symbol["icon-size"]),"icon-text-fit":new rt(we.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new rt(we.layout_symbol["icon-text-fit-padding"]),"icon-image":new _t(we.layout_symbol["icon-image"]),"icon-rotate":new _t(we.layout_symbol["icon-rotate"]),"icon-padding":new _t(we.layout_symbol["icon-padding"]),"icon-keep-upright":new rt(we.layout_symbol["icon-keep-upright"]),"icon-offset":new _t(we.layout_symbol["icon-offset"]),"icon-anchor":new _t(we.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new rt(we.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new rt(we.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new rt(we.layout_symbol["text-rotation-alignment"]),"text-field":new _t(we.layout_symbol["text-field"]),"text-font":new _t(we.layout_symbol["text-font"]),"text-size":new _t(we.layout_symbol["text-size"]),"text-max-width":new _t(we.layout_symbol["text-max-width"]),"text-line-height":new rt(we.layout_symbol["text-line-height"]),"text-letter-spacing":new _t(we.layout_symbol["text-letter-spacing"]),"text-justify":new _t(we.layout_symbol["text-justify"]),"text-radial-offset":new _t(we.layout_symbol["text-radial-offset"]),"text-variable-anchor":new rt(we.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new _t(we.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new _t(we.layout_symbol["text-anchor"]),"text-max-angle":new rt(we.layout_symbol["text-max-angle"]),"text-writing-mode":new rt(we.layout_symbol["text-writing-mode"]),"text-rotate":new _t(we.layout_symbol["text-rotate"]),"text-padding":new rt(we.layout_symbol["text-padding"]),"text-keep-upright":new rt(we.layout_symbol["text-keep-upright"]),"text-transform":new _t(we.layout_symbol["text-transform"]),"text-offset":new _t(we.layout_symbol["text-offset"]),"text-allow-overlap":new rt(we.layout_symbol["text-allow-overlap"]),"text-overlap":new rt(we.layout_symbol["text-overlap"]),"text-ignore-placement":new rt(we.layout_symbol["text-ignore-placement"]),"text-optional":new rt(we.layout_symbol["text-optional"])})}};class g0{constructor(s){if(void 0===s.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=s.property.overrides?s.property.overrides.runtimeType:To,this.defaultValue=s}evaluate(s){if(s.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(s.formattedSection))return c.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ye("FormatSectionOverride",g0,{omit:["defaultValue"]});class Ef extends Ks{constructor(s){super(s,fm)}recalculate(s,c){if(super.recalculate(s,c),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const d=this.layout.get("text-writing-mode");if(d){const m=[];for(const b of d)m.indexOf(b)<0&&m.push(b);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(s,c,d,m){const b=this.layout.get(s).evaluate(c,{},d,m),w=this._unevaluatedLayout._values[s];return w.isDataDriven()||Eu(w.value)||!b?b:(E=c.properties,b.replace(/{([^{}]+)}/g,(M,L)=>L in E?String(E[L]):""));var E}createBucket(s){return new qu(s)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const s of fm.paint.overridableProperties){if(!Ef.hasPaintOverride(this.layout,s))continue;const c=this.paint.get(s),d=new g0(c),m=new Rl(d,c.property.specification);let b=null;b="constant"===c.value.kind||"source"===c.value.kind?new bh("source",m):new wc("composite",m,c.value.zoomStops),this.paint._values[s]=new Fi(c.property,b,c.parameters)}}_handleOverridablePaintPropertyUpdate(s,c,d){return!(!this.layout||c.isDataDriven()||d.isDataDriven())&&Ef.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,c){const d=s.get("text-field"),m=fm.paint.properties[c];let b=!1;const w=E=>{for(const D of E)if(m.overrides&&m.overrides.hasOverride(D))return void(b=!0)};if("constant"===d.value.kind&&d.value.value instanceof ur)w(d.value.value.sections);else if("source"===d.value.kind){const E=M=>{b||(M instanceof Ua&&oi(M.value)===X?w(M.value.sections):M instanceof Al?w(M.sections):M.eachChild(E))},D=d.value;D._styleExpression&&E(D._styleExpression.expression)}return b}}let dy;var y0={get paint(){return dy=dy||new ni({"background-color":new rt(we.paint_background["background-color"]),"background-pattern":new Zs(we.paint_background["background-pattern"]),"background-opacity":new rt(we.paint_background["background-opacity"])})}};class Sf extends Ks{constructor(s){super(s,y0)}}let pm;var _0={get paint(){return pm=pm||new ni({"raster-opacity":new rt(we.paint_raster["raster-opacity"]),"raster-hue-rotate":new rt(we.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new rt(we.paint_raster["raster-brightness-min"]),"raster-brightness-max":new rt(we.paint_raster["raster-brightness-max"]),"raster-saturation":new rt(we.paint_raster["raster-saturation"]),"raster-contrast":new rt(we.paint_raster["raster-contrast"]),"raster-resampling":new rt(we.paint_raster["raster-resampling"]),"raster-fade-duration":new rt(we.paint_raster["raster-fade-duration"])})}};class fy extends Ks{constructor(s){super(s,_0)}}class Nw extends Ks{constructor(s){super(s,{}),this.onAdd=c=>{this.implementation.onAdd&&this.implementation.onAdd(c,c.painter.context.gl)},this.onRemove=c=>{this.implementation.onRemove&&this.implementation.onRemove(c,c.painter.context.gl)},this.implementation=s}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class py{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const my=6371008.8;class Gl{constructor(s,c){if(isNaN(s)||isNaN(c))throw new Error(`Invalid LngLat object: (${s}, ${c})`);if(this.lng=+s,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Gl(Ue(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const c=Math.PI/180,d=this.lat*c,m=s.lat*c,b=Math.sin(d)*Math.sin(m)+Math.cos(d)*Math.cos(m)*Math.cos((s.lng-this.lng)*c);return my*Math.acos(Math.min(b,1))}static convert(s){if(s instanceof Gl)return s;if(Array.isArray(s)&&(2===s.length||3===s.length))return new Gl(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&"object"==typeof s&&null!==s)return new Gl(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const gy=2*Math.PI*my;function Tf(a){return gy*Math.cos(a*Math.PI/180)}function v0(a){return(180+a)/360}function b0(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function Df(a,s){return a/Tf(s)}function yy(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}class mm{constructor(s,c,d=0){this.x=+s,this.y=+c,this.z=+d}static fromLngLat(s,c=0){const d=Gl.convert(s);return new mm(v0(d.lng),b0(d.lat),Df(c,d.lat))}toLngLat(){return new Gl(360*this.x-180,yy(this.y))}toAltitude(){return this.z*Tf(yy(this.y))}meterInMercatorCoordinateUnits(){return 1/gy*(s=yy(this.y),1/Math.cos(s*Math.PI/180));var s}}function x0(a,s,c){var d=2*Math.PI*6378137/256/Math.pow(2,c);return[a*d-2*Math.PI*6378137/2,s*d-2*Math.PI*6378137/2]}class _y{constructor(s,c,d){if(s<0||s>25||d<0||d>=Math.pow(2,s)||c<0||c>=Math.pow(2,s))throw new Error(`x=${c}, y=${d}, z=${s} outside of bounds. 0<=x<${Math.pow(2,s)}, 0<=y<${Math.pow(2,s)} 0<=z<=25 `);this.z=s,this.x=c,this.y=d,this.key=Wl(0,s,s,c,d)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,c,d){const m=(w=this.y,E=this.z,D=x0(256*(b=this.x),256*(w=Math.pow(2,E)-w-1),E),M=x0(256*(b+1),256*(w+1),E),D[0]+","+D[1]+","+M[0]+","+M[1]);var b,w,E,D,M;const L=function(N,B,j){let H,W="";for(let te=N;te>0;te--)H=1<<te-1,W+=(B&H?1:0)+(j&H?2:0);return W}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===d?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,c>1?"@2x":"").replace(/{quadkey}/g,L).replace(/{bbox-epsg-3857}/g,m)}isChildOf(s){const c=this.z-s.z;return c>0&&s.x===this.x>>c&&s.y===this.y>>c}getTilePoint(s){const c=Math.pow(2,this.z);return new ht((s.x*c-this.x)*Bi,(s.y*c-this.y)*Bi)}toString(){return`${this.z}/${this.x}/${this.y}`}}class w0{constructor(s,c){this.wrap=s,this.canonical=c,this.key=Wl(s,c.z,c.z,c.x,c.y)}}class eo{constructor(s,c,d,m,b){if(s<d)throw new Error(`overscaledZ should be >= z; overscaledZ = ${s}; z = ${d}`);this.overscaledZ=s,this.wrap=c,this.canonical=new _y(d,+m,+b),this.key=Wl(c,s,d,m,b)}clone(){return new eo(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const c=this.canonical.z-s;return s>this.canonical.z?new eo(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new eo(s,this.wrap,s,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(s,c){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const d=this.canonical.z-s;return s>this.canonical.z?Wl(this.wrap*+c,s,this.canonical.z,this.canonical.x,this.canonical.y):Wl(this.wrap*+c,s,s,this.canonical.x>>d,this.canonical.y>>d)}isChildOf(s){if(s.wrap!==this.wrap)return!1;const c=this.canonical.z-s.canonical.z;return 0===s.overscaledZ||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>c&&s.canonical.y===this.canonical.y>>c}children(s){if(this.overscaledZ>=s)return[new eo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,d=2*this.canonical.x,m=2*this.canonical.y;return[new eo(c,this.wrap,c,d,m),new eo(c,this.wrap,c,d+1,m),new eo(c,this.wrap,c,d,m+1),new eo(c,this.wrap,c,d+1,m+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new eo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new eo(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new w0(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(s){return this.canonical.getTilePoint(new mm(s.x-this.wrap,s.y))}}function Wl(a,s,c,d,m){(a*=2)<0&&(a=-1*a-1);const b=1<<c;return(b*b*a+b*m+d).toString(36)+c.toString(36)+s.toString(36)}Ye("CanonicalTileID",_y),Ye("OverscaledTileID",eo,{omit:["posMatrix"]});class Qh{constructor(s,c,d,m=1,b=1,w=1,E=0){if(this.uid=s,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(d&&!["mapbox","terrarium","custom"].includes(d))return void fi(`"${d}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=c.height;const D=this.dim=c.height-2;switch(this.data=new Uint32Array(c.data.buffer),d){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=m,this.greenFactor=b,this.blueFactor=w,this.baseShift=E;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let M=0;M<D;M++)this.data[this._idx(-1,M)]=this.data[this._idx(0,M)],this.data[this._idx(D,M)]=this.data[this._idx(D-1,M)],this.data[this._idx(M,-1)]=this.data[this._idx(M,0)],this.data[this._idx(M,D)]=this.data[this._idx(M,D-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(D,-1)]=this.data[this._idx(D-1,0)],this.data[this._idx(-1,D)]=this.data[this._idx(0,D-1)],this.data[this._idx(D,D)]=this.data[this._idx(D-1,D-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let M=0;M<D;M++)for(let L=0;L<D;L++){const N=this.get(M,L);N>this.max&&(this.max=N),N<this.min&&(this.min=N)}}get(s,c){const d=new Uint8Array(this.data.buffer),m=4*this._idx(s,c);return this.unpack(d[m],d[m+1],d[m+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(s,c){if(s<-1||s>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(s+1)}unpack(s,c,d){return s*this.redFactor+c*this.greenFactor+d*this.blueFactor-this.baseShift}getPixels(){return new Js({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(s,c,d){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let m=c*this.dim,b=c*this.dim+this.dim,w=d*this.dim,E=d*this.dim+this.dim;switch(c){case-1:m=b-1;break;case 1:b=m+1}switch(d){case-1:w=E-1;break;case 1:E=w+1}const D=-c*this.dim,M=-d*this.dim;for(let L=w;L<E;L++)for(let N=m;N<b;N++)this.data[this._idx(N,L)]=s.data[this._idx(N+D,L+M)]}}Ye("DEMData",Qh);class gm{constructor(s){this._stringToNumber={},this._numberToString=[];for(let c=0;c<s.length;c++){const d=s[c];this._stringToNumber[d]=c,this._numberToString[c]=d}}encode(s){return this._stringToNumber[s]}decode(s){if(s>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${s} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[s]}}class ym{constructor(s,c,d,m,b){this.type="Feature",this._vectorTileFeature=s,s._z=c,s._x=d,s._y=m,this.properties=s.properties,this.id=b}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={geometry:this.geometry};for(const c in this)"_geometry"!==c&&"_vectorTileFeature"!==c&&(s[c]=this[c]);return s}}class _m{constructor(s,c){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new Fl(Bi,16,0),this.grid3D=new Fl(Bi,16,0),this.featureIndexArray=new Ae,this.promoteId=c}insert(s,c,d,m,b,w){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,m,b);const D=w?this.grid3D:this.grid;for(let M=0;M<c.length;M++){const L=c[M],N=[1/0,1/0,-1/0,-1/0];for(let B=0;B<L.length;B++){const j=L[B];N[0]=Math.min(N[0],j.x),N[1]=Math.min(N[1],j.y),N[2]=Math.max(N[2],j.x),N[3]=Math.max(N[3],j.y)}N[0]<Bi&&N[1]<Bi&&N[2]>=0&&N[3]>=0&&D.insert(E,N[0],N[1],N[2],N[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new ga.VectorTile(new Zi(this.rawTileData)).layers,this.sourceLayerCoder=new gm(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(s,c,d,m){this.loadVTLayers();const b=s.params||{},w=Bi/s.tileSize/s.scale,E=Tu(b.filter),D=s.queryGeometry,M=s.queryPadding*w,L=vm(D),N=this.grid.query(L.minX-M,L.minY-M,L.maxX+M,L.maxY+M),B=vm(s.cameraQueryGeometry),j=this.grid3D.query(B.minX-M,B.minY-M,B.maxX+M,B.maxY+M,(te,re,ce,oe)=>function(fe,ye,Te,Ze,nt){for(const Ve of fe)if(ye<=Ve.x&&Te<=Ve.y&&Ze>=Ve.x&&nt>=Ve.y)return!0;const Ge=[new ht(ye,Te),new ht(ye,nt),new ht(Ze,nt),new ht(Ze,Te)];if(fe.length>2)for(const Ve of Ge)if(Bo(fe,Ve))return!0;for(let Ve=0;Ve<fe.length-1;Ve++)if(Qs(fe[Ve],fe[Ve+1],Ge))return!0;return!1}(s.cameraQueryGeometry,te-M,re-M,ce+M,oe+M));for(const te of j)N.push(te);N.sort(vy);const H={};let W;for(let te=0;te<N.length;te++){const re=N[te];if(re===W)continue;W=re;const ce=this.featureIndexArray.get(re);let oe=null;this.loadMatchingFeature(H,ce.bucketIndex,ce.sourceLayerIndex,ce.featureIndex,E,b.layers,b.availableImages,c,d,m,(fe,ye,Te)=>(oe||(oe=jl(fe)),ye.queryIntersectsFeature(D,fe,Te,oe,this.z,s.transform,w,s.pixelPosMatrix)))}return H}loadMatchingFeature(s,c,d,m,b,w,E,D,M,L,N){const B=this.bucketLayerIDs[c];if(w&&!function(te,re){for(let ce=0;ce<te.length;ce++)if(re.indexOf(te[ce])>=0)return!0;return!1}(w,B))return;const j=this.sourceLayerCoder.decode(d),H=this.vtLayers[j].feature(m);if(b.needGeometry){const te=Pc(H,!0);if(!b.filter(new In(this.tileID.overscaledZ),te,this.tileID.canonical))return}else if(!b.filter(new In(this.tileID.overscaledZ),H))return;const W=this.getId(H,j);for(let te=0;te<B.length;te++){const re=B[te];if(w&&w.indexOf(re)<0)continue;const ce=D[re];if(!ce)continue;let oe={};W&&L&&(oe=L.getState(ce.sourceLayer||"_geojsonTileLayer",W));const fe=He({},M[re]);fe.paint=Wc(fe.paint,ce.paint,H,oe,E),fe.layout=Wc(fe.layout,ce.layout,H,oe,E);const ye=!N||N(H,ce,oe);if(!ye)continue;const Te=new ym(H,this.z,this.x,this.y,W);Te.layer=fe;let Ze=s[re];void 0===Ze&&(Ze=s[re]=[]),Ze.push({featureIndex:m,feature:Te,intersectionZ:ye})}}lookupSymbolFeatures(s,c,d,m,b,w,E,D){const M={};this.loadVTLayers();const L=Tu(b);for(const N of s)this.loadMatchingFeature(M,d,m,N,L,w,E,D,c);return M}hasLayer(s){for(const c of this.bucketLayerIDs)for(const d of c)if(s===d)return!0;return!1}getId(s,c){let d=s.id;return this.promoteId&&(d=s.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[c]],"boolean"==typeof d&&(d=Number(d))),d}}function Wc(a,s,c,d,m){return ot(a,(b,w)=>{const E=s instanceof ps?s.get(w):null;return E&&E.evaluate?E.evaluate(c,d,m):E})}function vm(a){let s=1/0,c=1/0,d=-1/0,m=-1/0;for(const b of a)s=Math.min(s,b.x),c=Math.min(c,b.y),d=Math.max(d,b.x),m=Math.max(m,b.y);return{minX:s,minY:c,maxX:d,maxY:m}}function vy(a,s){return s-a}function Jh(a,s,c,d,m){const b=[];for(let w=0;w<a.length;w++){const E=a[w];let D;for(let M=0;M<E.length-1;M++){let L=E[M],N=E[M+1];L.x<s&&N.x<s||(L.x<s?L=new ht(s,L.y+(s-L.x)/(N.x-L.x)*(N.y-L.y))._round():N.x<s&&(N=new ht(s,L.y+(s-L.x)/(N.x-L.x)*(N.y-L.y))._round()),L.y<c&&N.y<c||(L.y<c?L=new ht(L.x+(c-L.y)/(N.y-L.y)*(N.x-L.x),c)._round():N.y<c&&(N=new ht(L.x+(c-L.y)/(N.y-L.y)*(N.x-L.x),c)._round()),L.x>=d&&N.x>=d||(L.x>=d?L=new ht(d,L.y+(d-L.x)/(N.x-L.x)*(N.y-L.y))._round():N.x>=d&&(N=new ht(d,L.y+(d-L.x)/(N.x-L.x)*(N.y-L.y))._round()),L.y>=m&&N.y>=m||(L.y>=m?L=new ht(L.x+(m-L.y)/(N.y-L.y)*(N.x-L.x),m)._round():N.y>=m&&(N=new ht(L.x+(m-L.y)/(N.y-L.y)*(N.x-L.x),m)._round()),D&&L.equals(D[D.length-1])||(D=[L],b.push(D)),D.push(N)))))}}return b}Ye("FeatureIndex",_m,{omit:["rawTileData","sourceLayerCoder"]});class $o extends ht{constructor(s,c,d,m){super(s,c),this.angle=d,void 0!==m&&(this.segment=m)}clone(){return new $o(this.x,this.y,this.angle,this.segment)}}function ol(a,s,c,d,m){if(void 0===s.segment||0===c)return!0;let b=s,w=s.segment+1,E=0;for(;E>-c/2;){if(w--,w<0)return!1;E-=a[w].dist(b),b=a[w]}E+=a[w].dist(a[w+1]),w++;const D=[];let M=0;for(;E<c/2;){const L=a[w],N=a[w+1];if(!N)return!1;let B=a[w-1].angleTo(L)-L.angleTo(N);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),D.push({distance:E,angleDelta:B}),M+=B;E-D[0].distance>d;)M-=D.shift().angleDelta;if(M>m)return!1;w++,E+=L.dist(N)}return!0}function by(a){let s=0;for(let c=0;c<a.length-1;c++)s+=a[c].dist(a[c+1]);return s}function xy(a,s,c){return a?.6*s*c:0}function wy(a,s){return Math.max(a?a.right-a.left:0,s?s.right-s.left:0)}function Cy(a,s,c,d,m,b){const w=xy(c,m,b),E=wy(c,d)*b;let D=0;const M=by(a)/2;for(let L=0;L<a.length-1;L++){const N=a[L],B=a[L+1],j=N.dist(B);if(D+j>M){const H=(M-D)/j,W=Ds.number(N.x,B.x,H),te=Ds.number(N.y,B.y,H),re=new $o(W,te,B.angleTo(N),L);return re._round(),!w||ol(a,re,E,w,s)?re:void 0}D+=j}}function bm(a,s,c,d,m,b,w,E,D){const M=xy(d,b,w),L=wy(d,m),N=L*w,B=0===a[0].x||a[0].x===D||0===a[0].y||a[0].y===D;return s-N<s/4&&(s=N+s/4),Ey(a,B?s/2*E%s:(L/2+2*b)*w*E%s,s,M,c,N,B,!1,D)}function Ey(a,s,c,d,m,b,w,E,D){const M=b/2,L=by(a);let N=0,B=s-c,j=[];for(let H=0;H<a.length-1;H++){const W=a[H],te=a[H+1],re=W.dist(te),ce=te.angleTo(W);for(;B+c<N+re;){B+=c;const oe=(B-N)/re,fe=Ds.number(W.x,te.x,oe),ye=Ds.number(W.y,te.y,oe);if(fe>=0&&fe<D&&ye>=0&&ye<D&&B-M>=0&&B+M<=L){const Te=new $o(fe,ye,ce,H);Te._round(),d&&!ol(a,Te,b,d,m)||j.push(Te)}}N+=re}return E||j.length||w||(j=Ey(a,N/2,c,d,m,b,w,!0,D)),j}Ye("Anchor",$o);const Gu=Ar;function Sy(a,s,c,d){const m=[],b=a.image,w=b.pixelRatio,E=b.paddedRect.w-2*Gu,D=b.paddedRect.h-2*Gu,M=a.right-a.left,L=a.bottom-a.top,N=b.stretchX||[[0,E]],B=b.stretchY||[[0,D]],j=(ze,Xe)=>ze+Xe[1]-Xe[0],H=N.reduce(j,0),W=B.reduce(j,0),te=E-H,re=D-W;let ce=0,oe=H,fe=0,ye=W,Te=0,Ze=te,nt=0,Ge=re;if(b.content&&d){const ze=b.content;ce=ed(N,0,ze[0]),fe=ed(B,0,ze[1]),oe=ed(N,ze[0],ze[2]),ye=ed(B,ze[1],ze[3]),Te=ze[0]-ce,nt=ze[1]-fe,Ze=ze[2]-ze[0]-oe,Ge=ze[3]-ze[1]-ye}const Ve=(ze,Xe,Be,Re)=>{const dt=If(ze.stretch-ce,oe,M,a.left),et=$r(ze.fixed-Te,Ze,ze.stretch,H),Gt=If(Xe.stretch-fe,ye,L,a.top),$n=$r(Xe.fixed-nt,Ge,Xe.stretch,W),ii=If(Be.stretch-ce,oe,M,a.left),Ki=$r(Be.fixed-Te,Ze,Be.stretch,H),ks=If(Re.stretch-fe,ye,L,a.top),Hr=$r(Re.fixed-nt,Ge,Re.stretch,W),Pi=new ht(dt,Gt),Ui=new ht(ii,Gt),rr=new ht(ii,ks),Xi=new ht(dt,ks),is=new ht(et/w,$n/w),Yi=new ht(Ki/w,Hr/w),sr=s*Math.PI/180;if(sr){const Gr=Math.sin(sr),or=Math.cos(sr),Rr=[or,-Gr,Gr,or];Pi._matMult(Rr),Ui._matMult(Rr),Xi._matMult(Rr),rr._matMult(Rr)}const qr=ze.stretch+ze.fixed,Pr=Xe.stretch+Xe.fixed;return{tl:Pi,tr:Ui,bl:Xi,br:rr,tex:{x:b.paddedRect.x+Gu+qr,y:b.paddedRect.y+Gu+Pr,w:Be.stretch+Be.fixed-qr,h:Re.stretch+Re.fixed-Pr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:is,pixelOffsetBR:Yi,minFontScaleX:Ze/w/M,minFontScaleY:Ge/w/L,isSDF:c}};if(d&&(b.stretchX||b.stretchY)){const ze=Ty(N,te,H),Xe=Ty(B,re,W);for(let Be=0;Be<ze.length-1;Be++){const Re=ze[Be],dt=ze[Be+1];for(let et=0;et<Xe.length-1;et++)m.push(Ve(Re,Xe[et],dt,Xe[et+1]))}}else m.push(Ve({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:D+1}));return m}function ed(a,s,c){let d=0;for(const m of a)d+=Math.max(s,Math.min(c,m[1]))-Math.max(s,Math.min(c,m[0]));return d}function Ty(a,s,c){const d=[{fixed:-Gu,stretch:0}];for(const[m,b]of a){const w=d[d.length-1];d.push({fixed:m-w.stretch,stretch:w.stretch}),d.push({fixed:m-w.stretch,stretch:w.stretch+(b-m)})}return d.push({fixed:s+Gu,stretch:c}),d}function If(a,s,c,d){return a/s*c+d}function $r(a,s,c,d){return a-s*c/d}class Wu{constructor(s,c,d,m,b,w,E,D,M,L){if(this.boxStartIndex=s.length,M){let N=w.top,B=w.bottom;const j=w.collisionPadding;j&&(N-=j[1],B+=j[3]);let H=B-N;H>0&&(H=Math.max(10,H),this.circleDiameter=H)}else{let N=w.top*E-D[0],B=w.bottom*E+D[2],j=w.left*E-D[3],H=w.right*E+D[1];const W=w.collisionPadding;if(W&&(j-=W[0]*E,N-=W[1]*E,H+=W[2]*E,B+=W[3]*E),L){const te=new ht(j,N),re=new ht(H,N),ce=new ht(j,B),oe=new ht(H,B),fe=L*Math.PI/180;te._rotate(fe),re._rotate(fe),ce._rotate(fe),oe._rotate(fe),j=Math.min(te.x,re.x,ce.x,oe.x),H=Math.max(te.x,re.x,ce.x,oe.x),N=Math.min(te.y,re.y,ce.y,oe.y),B=Math.max(te.y,re.y,ce.y,oe.y)}s.emplaceBack(c.x,c.y,j,N,H,B,d,m,b)}this.boxEndIndex=s.length}}class Dy{constructor(s=[],c=xm){if(this.data=s,this.length=this.data.length,this.compare=c,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(s){this.data.push(s),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const s=this.data[0],c=this.data.pop();return this.length--,this.length>0&&(this.data[0]=c,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:c,compare:d}=this,m=c[s];for(;s>0;){const b=s-1>>1,w=c[b];if(d(m,w)>=0)break;c[s]=w,s=b}c[s]=m}_down(s){const{data:c,compare:d}=this,m=this.length>>1,b=c[s];for(;s<m;){let w=1+(s<<1),E=c[w];const D=w+1;if(D<this.length&&d(c[D],E)<0&&(w=D,E=c[D]),d(E,b)>=0)break;c[s]=E,s=w}c[s]=b}}function xm(a,s){return a<s?-1:a>s?1:0}function ns(a,s=1,c=!1){let d=1/0,m=1/0,b=-1/0,w=-1/0;const E=a[0];for(let j=0;j<E.length;j++){const H=E[j];(!j||H.x<d)&&(d=H.x),(!j||H.y<m)&&(m=H.y),(!j||H.x>b)&&(b=H.x),(!j||H.y>w)&&(w=H.y)}const D=Math.min(b-d,w-m);let M=D/2;const L=new Dy([],td);if(0===D)return new ht(d,m);for(let j=d;j<b;j+=D)for(let H=m;H<w;H+=D)L.push(new Zc(j+M,H+M,M,a));let N=function(j){let H=0,W=0,te=0;const re=j[0];for(let ce=0,oe=re.length,fe=oe-1;ce<oe;fe=ce++){const ye=re[ce],Te=re[fe],Ze=ye.x*Te.y-Te.x*ye.y;W+=(ye.x+Te.x)*Ze,te+=(ye.y+Te.y)*Ze,H+=3*Ze}return new Zc(W/H,te/H,0,j)}(a),B=L.length;for(;L.length;){const j=L.pop();(j.d>N.d||!N.d)&&(N=j,c&&console.log("found best %d after %d probes",Math.round(1e4*j.d)/1e4,B)),j.max-N.d<=s||(M=j.h/2,L.push(new Zc(j.p.x-M,j.p.y-M,M,a)),L.push(new Zc(j.p.x+M,j.p.y-M,M,a)),L.push(new Zc(j.p.x-M,j.p.y+M,M,a)),L.push(new Zc(j.p.x+M,j.p.y+M,M,a)),B+=4)}return c&&(console.log(`num probes: ${B}`),console.log(`best distance: ${N.d}`)),N.p}function td(a,s){return s.max-a.max}function Zc(a,s,c,d){this.p=new ht(a,s),this.h=c,this.d=function(m,b){let w=!1,E=1/0;for(let D=0;D<b.length;D++){const M=b[D];for(let L=0,N=M.length,B=N-1;L<N;B=L++){const j=M[L],H=M[B];j.y>m.y!=H.y>m.y&&m.x<(H.x-j.x)*(m.y-j.y)/(H.y-j.y)+j.x&&(w=!w),E=Math.min(E,jg(m,j,H))}}return(w?1:-1)*Math.sqrt(E)}(this.p,d),this.max=this.d+this.h*Math.SQRT2}var gr;y.aq=void 0,(gr=y.aq||(y.aq={}))[gr.center=1]="center",gr[gr.left=2]="left",gr[gr.right=3]="right",gr[gr.top=4]="top",gr[gr.bottom=5]="bottom",gr[gr["top-left"]=6]="top-left",gr[gr["top-right"]=7]="top-right",gr[gr["bottom-left"]=8]="bottom-left",gr[gr["bottom-right"]=9]="bottom-right";const Zl=7,Af=Number.POSITIVE_INFINITY;function Iy(a,s){return s[1]!==Af?function(c,d,m){let b=0,w=0;switch(d=Math.abs(d),m=Math.abs(m),c){case"top-right":case"top-left":case"top":w=m-Zl;break;case"bottom-right":case"bottom-left":case"bottom":w=-m+Zl}switch(c){case"top-right":case"bottom-right":case"right":b=-d;break;case"top-left":case"bottom-left":case"left":b=d}return[b,w]}(a,s[0],s[1]):function(c,d){let m=0,b=0;d<0&&(d=0);const w=d/Math.SQRT2;switch(c){case"top-right":case"top-left":b=w-Zl;break;case"bottom-right":case"bottom-left":b=-w+Zl;break;case"bottom":b=-d+Zl;break;case"top":b=d-Zl}switch(c){case"top-right":case"bottom-right":m=-w;break;case"top-left":case"bottom-left":m=w;break;case"left":m=d;break;case"right":m=-d}return[m,b]}(a,s[0])}function wm(a,s,c){var d;const m=a.layout,b=null===(d=m.get("text-variable-anchor-offset"))||void 0===d?void 0:d.evaluate(s,{},c);if(b){const E=b.values,D=[];for(let M=0;M<E.length;M+=2){const L=D[M]=E[M],N=E[M+1].map(B=>B*Wi);L.startsWith("top")?N[1]-=Zl:L.startsWith("bottom")&&(N[1]+=Zl),D[M+1]=N}return new Ts(D)}const w=m.get("text-variable-anchor");if(w){let E;E=void 0!==a._unevaluatedLayout.getValue("text-radial-offset")?[m.get("text-radial-offset").evaluate(s,{},c)*Wi,Af]:m.get("text-offset").evaluate(s,{},c).map(M=>M*Wi);const D=[];for(const M of w)D.push(M,Iy(M,E));return new Ts(D)}return null}function Cm(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Ay(a,s,c,d,m,b,w,E,D,M,L){let N=b.textMaxSize.evaluate(s,{});void 0===N&&(N=w);const B=a.layers[0].layout,j=B.get("icon-offset").evaluate(s,{},L),H=Py(c.horizontal),W=w/24,te=a.tilePixelRatio*W,re=a.tilePixelRatio*N/24,ce=a.tilePixelRatio*E,oe=a.tilePixelRatio*B.get("symbol-spacing"),fe=B.get("text-padding")*a.tilePixelRatio,ye=function(Re,dt,et,Gt=1){const $n=Re.get("icon-padding").evaluate(dt,{},et),ii=$n&&$n.values;return[ii[0]*Gt,ii[1]*Gt,ii[2]*Gt,ii[3]*Gt]}(B,s,L,a.tilePixelRatio),Te=B.get("text-max-angle")/180*Math.PI,Ze="viewport"!==B.get("text-rotation-alignment")&&"point"!==B.get("symbol-placement"),nt="map"===B.get("icon-rotation-alignment")&&"point"!==B.get("symbol-placement"),Ge=B.get("symbol-placement"),Ve=oe/2,ze=B.get("icon-text-fit");let Xe;d&&"none"!==ze&&(a.allowVerticalPlacement&&c.vertical&&(Xe=uy(d,c.vertical,ze,B.get("icon-text-fit-padding"),j,W)),H&&(d=uy(d,H,ze,B.get("icon-text-fit-padding"),j,W)));const Be=(Re,dt)=>{dt.x<0||dt.x>=Bi||dt.y<0||dt.y>=Bi||function(et,Gt,$n,ii,Ki,ks,Hr,Pi,Ui,rr,Xi,is,Yi,sr,qr,Pr,Gr,or,Rr,Ri,Qt,Lr,yr,Vi,go){const Ho=et.addToLineVertexArray(Gt,$n);let qo,ll,yo,ar,_r=0,cl=0,kf=0,E0=0,Ly=-1,ky=-1;const Xl={};let Dm=pa("");if(et.allowVerticalPlacement&&ii.vertical){const rs=Pi.layout.get("text-rotate").evaluate(Qt,{},Vi)+90;yo=new Wu(Ui,Gt,rr,Xi,is,ii.vertical,Yi,sr,qr,rs),Hr&&(ar=new Wu(Ui,Gt,rr,Xi,is,Hr,Gr,or,qr,rs))}if(Ki){const rs=Pi.layout.get("icon-rotate").evaluate(Qt,{}),vo="none"!==Pi.layout.get("icon-text-fit"),Yl=Sy(Ki,rs,yr,vo),Go=Hr?Sy(Hr,rs,yr,vo):void 0;ll=new Wu(Ui,Gt,rr,Xi,is,Ki,Gr,or,!1,rs),_r=4*Yl.length;const Xc=et.iconSizeData;let va=null;"source"===Xc.kind?(va=[_a*Pi.layout.get("icon-size").evaluate(Qt,{})],va[0]>jo&&fi(`${et.layerIds[0]}: Value for "icon-size" is >= ${Hl}. Reduce your "icon-size".`)):"composite"===Xc.kind&&(va=[_a*Lr.compositeIconSizes[0].evaluate(Qt,{},Vi),_a*Lr.compositeIconSizes[1].evaluate(Qt,{},Vi)],(va[0]>jo||va[1]>jo)&&fi(`${et.layerIds[0]}: Value for "icon-size" is >= ${Hl}. Reduce your "icon-size".`)),et.addSymbols(et.icon,Yl,va,Ri,Rr,Qt,y.ai.none,Gt,Ho.lineStartIndex,Ho.lineLength,-1,Vi),Ly=et.icon.placedSymbolArray.length-1,Go&&(cl=4*Go.length,et.addSymbols(et.icon,Go,va,Ri,Rr,Qt,y.ai.vertical,Gt,Ho.lineStartIndex,Ho.lineLength,-1,Vi),ky=et.icon.placedSymbolArray.length-1)}const Oy=Object.keys(ii.horizontal);for(const rs of Oy){const vo=ii.horizontal[rs];if(!qo){Dm=pa(vo.text);const Go=Pi.layout.get("text-rotate").evaluate(Qt,{},Vi);qo=new Wu(Ui,Gt,rr,Xi,is,vo,Yi,sr,qr,Go)}const Yl=1===vo.positionedLines.length;if(kf+=My(et,Gt,vo,ks,Pi,qr,Qt,Pr,Ho,ii.vertical?y.ai.horizontal:y.ai.horizontalOnly,Yl?Oy:[rs],Xl,Ly,Lr,Vi),Yl)break}ii.vertical&&(E0+=My(et,Gt,ii.vertical,ks,Pi,qr,Qt,Pr,Ho,y.ai.vertical,["vertical"],Xl,ky,Lr,Vi));const S0=qo?qo.boxStartIndex:et.collisionBoxArray.length,T0=qo?qo.boxEndIndex:et.collisionBoxArray.length,D0=yo?yo.boxStartIndex:et.collisionBoxArray.length,Im=yo?yo.boxEndIndex:et.collisionBoxArray.length,ul=ll?ll.boxStartIndex:et.collisionBoxArray.length,rd=ll?ll.boxEndIndex:et.collisionBoxArray.length,Ny=ar?ar.boxStartIndex:et.collisionBoxArray.length,Fy=ar?ar.boxEndIndex:et.collisionBoxArray.length;let _o=-1;const Am=(rs,vo)=>rs&&rs.circleDiameter?Math.max(rs.circleDiameter,vo):vo;_o=Am(qo,_o),_o=Am(yo,_o),_o=Am(ll,_o),_o=Am(ar,_o);const I0=_o>-1?1:0;I0&&(_o*=go/Wi),et.glyphOffsetArray.length>=qu.MAX_GLYPHS&&fi("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Qt.sortKey&&et.addToSortKeyRanges(et.symbolInstances.length,Qt.sortKey);const Fw=wm(Pi,Qt,Vi),[Mm,Pm]=function(rs,vo){const Yl=rs.length,Go=vo?.values;if(Go?.length>0)for(let Xc=0;Xc<Go.length;Xc+=2){const va=Go[Xc+1];rs.emplaceBack(y.aq[Go[Xc]],va[0],va[1])}return[Yl,rs.length]}(et.textAnchorOffsets,Fw);et.symbolInstances.emplaceBack(Gt.x,Gt.y,Xl.right>=0?Xl.right:-1,Xl.center>=0?Xl.center:-1,Xl.left>=0?Xl.left:-1,Xl.vertical||-1,Ly,ky,Dm,S0,T0,D0,Im,ul,rd,Ny,Fy,rr,kf,E0,_r,cl,I0,0,Yi,_o,Mm,Pm)}(a,dt,Re,c,d,m,Xe,a.layers[0],a.collisionBoxArray,s.index,s.sourceLayerIndex,a.index,te,[fe,fe,fe,fe],Ze,D,ce,ye,nt,j,s,b,M,L,w)};if("line"===Ge)for(const Re of Jh(s.geometry,0,0,Bi,Bi)){const dt=bm(Re,oe,Te,c.vertical||H,d,24,re,a.overscaling,Bi);for(const et of dt)H&&Em(a,H.text,Ve,et)||Be(Re,et)}else if("line-center"===Ge){for(const Re of s.geometry)if(Re.length>1){const dt=Cy(Re,Te,c.vertical||H,d,24,re);dt&&Be(Re,dt)}}else if("Polygon"===s.type)for(const Re of Oc(s.geometry,0)){const dt=ns(Re,16);Be(Re[0],new $o(dt.x,dt.y,0))}else if("LineString"===s.type)for(const Re of s.geometry)Be(Re,new $o(Re[0].x,Re[0].y,0));else if("Point"===s.type)for(const Re of s.geometry)for(const dt of Re)Be([dt],new $o(dt.x,dt.y,0))}function My(a,s,c,d,m,b,w,E,D,M,L,N,B,j,H){const W=function(ce,oe,fe,ye,Te,Ze,nt,Ge){const Ve=ye.layout.get("text-rotate").evaluate(Ze,{})*Math.PI/180,ze=[];for(const Xe of oe.positionedLines)for(const Be of Xe.positionedGlyphs){if(!Be.rect)continue;const Re=Be.rect||{};let dt=$c+1,et=!0,Gt=1,$n=0;const ii=(Te||Ge)&&Be.vertical,Ki=Be.metrics.advance*Be.scale/2;if(Ge&&oe.verticalizable&&($n=Xe.lineOffset/2-(Be.imageName?-(Wi-Be.metrics.width*Be.scale)/2:(Be.scale-1)*Wi)),Be.imageName){const Ri=nt[Be.imageName];et=Ri.sdf,Gt=Ri.pixelRatio,dt=Ar/Gt}const ks=Te?[Be.x+Ki,Be.y]:[0,0];let Hr=Te?[0,0]:[Be.x+Ki+fe[0],Be.y+fe[1]-$n],Pi=[0,0];ii&&(Pi=Hr,Hr=[0,0]);const Ui=Be.metrics.isDoubleResolution?2:1,rr=(Be.metrics.left-dt)*Be.scale-Ki+Hr[0],Xi=(-Be.metrics.top-dt)*Be.scale+Hr[1],is=rr+Re.w/Ui*Be.scale/Gt,Yi=Xi+Re.h/Ui*Be.scale/Gt,sr=new ht(rr,Xi),qr=new ht(is,Xi),Pr=new ht(rr,Yi),Gr=new ht(is,Yi);if(ii){const Ri=new ht(-Ki,Ki-Xh),Qt=-Math.PI/2,Lr=Wi/2-Ki,yr=new ht(5-Xh-Lr,-(Be.imageName?Lr:0)),Vi=new ht(...Pi);sr._rotateAround(Qt,Ri)._add(yr)._add(Vi),qr._rotateAround(Qt,Ri)._add(yr)._add(Vi),Pr._rotateAround(Qt,Ri)._add(yr)._add(Vi),Gr._rotateAround(Qt,Ri)._add(yr)._add(Vi)}if(Ve){const Ri=Math.sin(Ve),Qt=Math.cos(Ve),Lr=[Qt,-Ri,Ri,Qt];sr._matMult(Lr),qr._matMult(Lr),Pr._matMult(Lr),Gr._matMult(Lr)}const or=new ht(0,0),Rr=new ht(0,0);ze.push({tl:sr,tr:qr,bl:Pr,br:Gr,tex:Re,writingMode:oe.writingMode,glyphOffset:ks,sectionIndex:Be.sectionIndex,isSDF:et,pixelOffsetTL:or,pixelOffsetBR:Rr,minFontScaleX:0,minFontScaleY:0})}return ze}(0,c,E,m,b,w,d,a.allowVerticalPlacement),te=a.textSizeData;let re=null;"source"===te.kind?(re=[_a*m.layout.get("text-size").evaluate(w,{})],re[0]>jo&&fi(`${a.layerIds[0]}: Value for "text-size" is >= ${Hl}. Reduce your "text-size".`)):"composite"===te.kind&&(re=[_a*j.compositeTextSizes[0].evaluate(w,{},H),_a*j.compositeTextSizes[1].evaluate(w,{},H)],(re[0]>jo||re[1]>jo)&&fi(`${a.layerIds[0]}: Value for "text-size" is >= ${Hl}. Reduce your "text-size".`)),a.addSymbols(a.text,W,re,E,b,w,M,s,D.lineStartIndex,D.lineLength,B,H);for(const ce of L)N[ce]=a.text.placedSymbolArray.length-1;return 4*W.length}function Py(a){for(const s in a)return a[s];return null}function Em(a,s,c,d){const m=a.compareText;if(s in m){const b=m[s];for(let w=b.length-1;w>=0;w--)if(d.dist(b[w])<c)return!0}else m[s]=[];return m[s].push(d),!1}const Mf=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Sm{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[c,d]=new Uint8Array(s,0,2);if(219!==c)throw new Error("Data does not appear to be in a KDBush format.");const m=d>>4;if(1!==m)throw new Error(`Got v${m} data when expected v1.`);const b=Mf[15&d];if(!b)throw new Error("Unrecognized array type.");const[w]=new Uint16Array(s,2,1),[E]=new Uint32Array(s,4,1);return new Sm(E,w,b,s)}constructor(s,c=64,d=Float64Array,m){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=d,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const b=Mf.indexOf(this.ArrayType),w=2*s*this.ArrayType.BYTES_PER_ELEMENT,E=s*this.IndexArrayType.BYTES_PER_ELEMENT,D=(8-E%8)%8;if(b<0)throw new Error(`Unexpected typed array class: ${d}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+E+D,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+w+E+D),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+E+D,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+b]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=s)}add(s,c){const d=this._pos>>1;return this.ids[d]=d,this.coords[this._pos++]=s,this.coords[this._pos++]=c,d}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return Kc(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,c,d,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:b,coords:w,nodeSize:E}=this,D=[0,b.length-1,0],M=[];for(;D.length;){const L=D.pop()||0,N=D.pop()||0,B=D.pop()||0;if(N-B<=E){for(let te=B;te<=N;te++){const re=w[2*te],ce=w[2*te+1];re>=s&&re<=d&&ce>=c&&ce<=m&&M.push(b[te])}continue}const j=B+N>>1,H=w[2*j],W=w[2*j+1];H>=s&&H<=d&&W>=c&&W<=m&&M.push(b[j]),(0===L?s<=H:c<=W)&&(D.push(B),D.push(j-1),D.push(1-L)),(0===L?d>=H:m>=W)&&(D.push(j+1),D.push(N),D.push(1-L))}return M}within(s,c,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:b,nodeSize:w}=this,E=[0,m.length-1,0],D=[],M=d*d;for(;E.length;){const L=E.pop()||0,N=E.pop()||0,B=E.pop()||0;if(N-B<=w){for(let te=B;te<=N;te++)Tm(b[2*te],b[2*te+1],s,c)<=M&&D.push(m[te]);continue}const j=B+N>>1,H=b[2*j],W=b[2*j+1];Tm(H,W,s,c)<=M&&D.push(m[j]),(0===L?s-d<=H:c-d<=W)&&(E.push(B),E.push(j-1),E.push(1-L)),(0===L?s+d>=H:c+d>=W)&&(E.push(j+1),E.push(N),E.push(1-L))}return D}}function Kc(a,s,c,d,m,b){if(m-d<=c)return;const w=d+m>>1;Ry(a,s,w,d,m,b),Kc(a,s,c,d,w-1,1-b),Kc(a,s,c,w+1,m,1-b)}function Ry(a,s,c,d,m,b){for(;m>d;){if(m-d>600){const M=m-d+1,L=c-d+1,N=Math.log(M),B=.5*Math.exp(2*N/3),j=.5*Math.sqrt(N*B*(M-B)/M)*(L-M/2<0?-1:1);Ry(a,s,c,Math.max(d,Math.floor(c-L*B/M+j)),Math.min(m,Math.floor(c+(M-L)*B/M+j)),b)}const w=s[2*c+b];let E=d,D=m;for(nd(a,s,d,c),s[2*m+b]>w&&nd(a,s,d,m);E<D;){for(nd(a,s,E,D),E++,D--;s[2*E+b]<w;)E++;for(;s[2*D+b]>w;)D--}s[2*d+b]===w?nd(a,s,d,D):(D++,nd(a,s,D,m)),D<=c&&(d=D+1),c<=D&&(m=D-1)}}function nd(a,s,c,d){Pf(a,c,d),Pf(s,2*c,2*d),Pf(s,2*c+1,2*d+1)}function Pf(a,s,c){const d=a[s];a[s]=a[c],a[c]=d}function Tm(a,s,c,d){const m=a-c,b=s-d;return m*m+b*b}var Rf;y.bg=void 0,(Rf=y.bg||(y.bg={})).create="create",Rf.load="load",Rf.fullLoad="fullLoad";let al=null,Kl=[];const Lf=1e3/60,id="loadTime",Zu="fullLoadTime",C0={mark(a){performance.mark(a)},frame(a){const s=a;null!=al&&Kl.push(s-al),al=s},clearMetrics(){al=null,Kl=[],performance.clearMeasures(id),performance.clearMeasures(Zu);for(const a in y.bg)performance.clearMarks(y.bg[a])},getPerformanceMetrics(){performance.measure(id,y.bg.create,y.bg.load),performance.measure(Zu,y.bg.create,y.bg.fullLoad);const a=performance.getEntriesByName(id)[0].duration,s=performance.getEntriesByName(Zu)[0].duration,c=Kl.length,d=1/(Kl.reduce((b,w)=>b+w,0)/c/1e3),m=Kl.filter(b=>b>Lf).reduce((b,w)=>b+(w-Lf)/Lf,0);return{loadTime:a,fullLoadTime:s,fps:d,percentDroppedFrames:m/(c+m)*100,totalFrames:c}}};y.$=function(a,s,c){var d,m,b,w,E,D,M,L,N,B,j,H,W=c[0],te=c[1],re=c[2];return s===a?(a[12]=s[0]*W+s[4]*te+s[8]*re+s[12],a[13]=s[1]*W+s[5]*te+s[9]*re+s[13],a[14]=s[2]*W+s[6]*te+s[10]*re+s[14],a[15]=s[3]*W+s[7]*te+s[11]*re+s[15]):(m=s[1],b=s[2],w=s[3],E=s[4],D=s[5],M=s[6],L=s[7],N=s[8],B=s[9],j=s[10],H=s[11],a[0]=d=s[0],a[1]=m,a[2]=b,a[3]=w,a[4]=E,a[5]=D,a[6]=M,a[7]=L,a[8]=N,a[9]=B,a[10]=j,a[11]=H,a[12]=d*W+E*te+N*re+s[12],a[13]=m*W+D*te+B*re+s[13],a[14]=b*W+M*te+j*re+s[14],a[15]=w*W+L*te+H*re+s[15]),a},y.A=Rc,y.B=Ds,y.C=class{constructor(a,s,c){this.receive=d=>{const m=d.data,b=m.id;if(b&&(!m.targetMapId||this.mapId===m.targetMapId))if("<cancel>"===m.type){delete this.tasks[b];const w=this.cancelCallbacks[b];delete this.cancelCallbacks[b],w&&w()}else ji()||m.mustQueue?(this.tasks[b]=m,this.taskQueue.push(b),this.invoker.trigger()):this.processTask(b,m)},this.process=()=>{if(!this.taskQueue.length)return;const d=this.taskQueue.shift(),m=this.tasks[d];delete this.tasks[d],this.taskQueue.length&&this.invoker.trigger(),m&&this.processTask(d,m)},this.target=a,this.parent=s,this.mapId=c,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new py(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=ji()?a:window}send(a,s,c,d,m=!1){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(this.callbacks[b]=c);const w=[],E={id:b,type:a,hasCallback:!!c,targetMapId:d,mustQueue:m,sourceMapId:this.mapId,data:ca(s,w)};return this.target.postMessage(E,{transfer:w}),{cancel:()=>{c&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:d,sourceMapId:this.mapId})}}}processTask(a,s){if("<response>"===s.type){const c=this.callbacks[a];delete this.callbacks[a],c&&(s.error?c(Ka(s.error)):c(null,Ka(s.data)))}else{let c=!1;const d=[],m=s.hasCallback?(E,D)=>{c=!0,delete this.cancelCallbacks[a];const M={id:a,type:"<response>",sourceMapId:this.mapId,error:E?ca(E):null,data:ca(D,d)};this.target.postMessage(M,{transfer:d})}:E=>{c=!0};let b=null;const w=Ka(s.data);if(this.parent[s.type])b=this.parent[s.type](s.sourceMapId,w,m);else if("getWorkerSource"in this.parent){const E=s.type.split(".");b=this.parent.getWorkerSource(s.sourceMapId,E[0],w.source)[E[1]](w,m)}else m(new Error(`Could not find function ${s.type}`));!c&&b&&b.cancel&&(this.cancelCallbacks[a]=b.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},y.D=rt,y.E=El,y.F=function(a,s){const c={};for(let d=0;d<s.length;d++){const m=s[d];m in a&&(c[m]=a[m])}return c},y.G=v0,y.H=b0,y.I=Hc,y.J=bl,y.K=xs,y.L=Gl,y.M=wl,y.N=Bi,y.O=eo,y.P=ht,y.Q=jn,y.R=Js,y.S=Rn,y.T=Mh,y.U=mm,y.V=class extends zl{},y.W=_y,y.X=function(a,s){const c=window.document.createElement("video");c.muted=!0,c.onloadstart=function(){s(null,c)};for(let d=0;d<a.length;d++){const m=window.document.createElement("source");Vs(a[d])||(c.crossOrigin="Anonymous"),m.src=a[d],c.appendChild(m)}return{cancel:()=>{}}},y.Y=ke,y.Z=function(){var a=new Rc(16);return Rc!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},y._=ei,y.a=xl,y.a$=class extends V{},y.a0=function(a,s,c){var d=c[0],m=c[1],b=c[2];return a[0]=s[0]*d,a[1]=s[1]*d,a[2]=s[2]*d,a[3]=s[3]*d,a[4]=s[4]*m,a[5]=s[5]*m,a[6]=s[6]*m,a[7]=s[7]*m,a[8]=s[8]*b,a[9]=s[9]*b,a[10]=s[10]*b,a[11]=s[11]*b,a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15],a},y.a1=$g,y.a2=function(){return yt++},y.a3=Y,y.a4=qu,y.a5=function(){Ni.isLoading()||Ni.isLoaded()||"deferred"!==ha()||xi()},y.a6=Tu,y.a7=Pc,y.a8=In,y.a9=ym,y.aA=Br,y.aB=function(a){a=a.slice();const s=Object.create(null);for(let c=0;c<a.length;c++)s[a[c].id]=a[c];for(let c=0;c<a.length;c++)"ref"in a[c]&&(a[c]=Es(a[c],s[a[c].ref]));return a},y.aC=function(a){if("custom"===a.type)return new Nw(a);switch(a.type){case"background":return new Sf(a);case"circle":return new Zv(a);case"fill":return new Jv(a);case"fill-extrusion":return new Dw(a);case"heatmap":return new Sn(a);case"hillshade":return new jr(a);case"line":return new l0(a);case"raster":return new fy(a);case"symbol":return new Ef(a)}},y.aD=Dt,y.aE=function(a,s){if(!a)return[{command:mn.setStyle,args:[s]}];let c=[];try{if(!On(a.version,s.version))return[{command:mn.setStyle,args:[s]}];On(a.center,s.center)||c.push({command:mn.setCenter,args:[s.center]}),On(a.zoom,s.zoom)||c.push({command:mn.setZoom,args:[s.zoom]}),On(a.bearing,s.bearing)||c.push({command:mn.setBearing,args:[s.bearing]}),On(a.pitch,s.pitch)||c.push({command:mn.setPitch,args:[s.pitch]}),On(a.sprite,s.sprite)||c.push({command:mn.setSprite,args:[s.sprite]}),On(a.glyphs,s.glyphs)||c.push({command:mn.setGlyphs,args:[s.glyphs]}),On(a.transition,s.transition)||c.push({command:mn.setTransition,args:[s.transition]}),On(a.light,s.light)||c.push({command:mn.setLight,args:[s.light]});const d={},m=[];!function(w,E,D,M){let L;for(L in E=E||{},w=w||{})Object.prototype.hasOwnProperty.call(w,L)&&(Object.prototype.hasOwnProperty.call(E,L)||Sl(L,D,M));for(L in E)Object.prototype.hasOwnProperty.call(E,L)&&(Object.prototype.hasOwnProperty.call(w,L)?On(w[L],E[L])||("geojson"===w[L].type&&"geojson"===E[L].type&&uc(w,E,L)?D.push({command:mn.setGeoJSONSourceData,args:[L,E[L].data]}):js(L,E,D,M)):Ss(L,E,D))}(a.sources,s.sources,m,d);const b=[];a.layers&&a.layers.forEach(w=>{d[w.source]?c.push({command:mn.removeLayer,args:[w.id]}):b.push(w)}),c=c.concat(m),function(w,E,D){E=E||[];const M=(w=w||[]).map(ia),L=E.map(ia),N=w.reduce(Ba,{}),B=E.reduce(Ba,{}),j=M.slice(),H=Object.create(null);let W,te,re,ce,oe,fe,ye;for(W=0,te=0;W<M.length;W++)re=M[W],Object.prototype.hasOwnProperty.call(B,re)?te++:(D.push({command:mn.removeLayer,args:[re]}),j.splice(j.indexOf(re,te),1));for(W=0,te=0;W<L.length;W++)re=L[L.length-1-W],j[j.length-1-W]!==re&&(Object.prototype.hasOwnProperty.call(N,re)?(D.push({command:mn.removeLayer,args:[re]}),j.splice(j.lastIndexOf(re,j.length-te),1)):te++,fe=j[j.length-W],D.push({command:mn.addLayer,args:[B[re],fe]}),j.splice(j.length-W,0,re),H[re]=!0);for(W=0;W<L.length;W++)if(re=L[W],ce=N[re],oe=B[re],!H[re]&&!On(ce,oe))if(On(ce.source,oe.source)&&On(ce["source-layer"],oe["source-layer"])&&On(ce.type,oe.type)){for(ye in Tl(ce.layout,oe.layout,D,re,null,mn.setLayoutProperty),Tl(ce.paint,oe.paint,D,re,null,mn.setPaintProperty),On(ce.filter,oe.filter)||D.push({command:mn.setFilter,args:[re,oe.filter]}),On(ce.minzoom,oe.minzoom)&&On(ce.maxzoom,oe.maxzoom)||D.push({command:mn.setLayerZoomRange,args:[re,oe.minzoom,oe.maxzoom]}),ce)Object.prototype.hasOwnProperty.call(ce,ye)&&"layout"!==ye&&"paint"!==ye&&"filter"!==ye&&"metadata"!==ye&&"minzoom"!==ye&&"maxzoom"!==ye&&(0===ye.indexOf("paint.")?Tl(ce[ye],oe[ye],D,re,ye.slice(6),mn.setPaintProperty):On(ce[ye],oe[ye])||D.push({command:mn.setLayerProperty,args:[re,ye,oe[ye]]}));for(ye in oe)Object.prototype.hasOwnProperty.call(oe,ye)&&!Object.prototype.hasOwnProperty.call(ce,ye)&&"layout"!==ye&&"paint"!==ye&&"filter"!==ye&&"metadata"!==ye&&"minzoom"!==ye&&"maxzoom"!==ye&&(0===ye.indexOf("paint.")?Tl(ce[ye],oe[ye],D,re,ye.slice(6),mn.setPaintProperty):On(ce[ye],oe[ye])||D.push({command:mn.setLayerProperty,args:[re,ye,oe[ye]]}))}else D.push({command:mn.removeLayer,args:[re]}),fe=j[j.lastIndexOf(re)+1],D.push({command:mn.addLayer,args:[oe,fe]})}(b,s.layers,c)}catch(d){console.warn("Unable to compute style diff:",d),c=[{command:mn.setStyle,args:[s]}]}return c},y.aF=function(a){const s=[],c=a.id;return void 0===c&&s.push({message:`layers.${c}: missing required property "id"`}),void 0===a.render&&s.push({message:`layers.${c}: missing required method "render"`}),a.renderingMode&&"2d"!==a.renderingMode&&"3d"!==a.renderingMode&&s.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),s},y.aG=function a(s,c){if(Array.isArray(s)){if(!Array.isArray(c)||s.length!==c.length)return!1;for(let d=0;d<s.length;d++)if(!a(s[d],c[d]))return!1;return!0}if("object"==typeof s&&null!==s&&null!==c){if("object"!=typeof c||Object.keys(s).length!==Object.keys(c).length)return!1;for(const d in s)if(!a(s[d],c[d]))return!1;return!0}return s===c},y.aH=ot,y.aI=ln,y.aJ=Oi,y.aK=function(a){return a({pluginStatus:bt,pluginURL:Dn}),Oi.on("pluginStateChange",a),a},y.aL=class extends Vl{constructor(a,s){super(a,s),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},y.aM=Pu,y.aN=class extends Vl{constructor(a,s){super(a,s),this.current=kp}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let s=1;s<16;s++)if(a[s]!==this.current[s]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},y.aO=Ph,y.aP=class extends Vl{constructor(a,s){super(a,s),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},y.aQ=class extends Vl{constructor(a,s){super(a,s),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},y.aR=Rh,y.aS=function(a,s,c,d,m,b,w){var E=1/(s-c),D=1/(d-m),M=1/(b-w);return a[0]=-2*E,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*D,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*M,a[11]=0,a[12]=(s+c)*E,a[13]=(m+d)*D,a[14]=(w+b)*M,a[15]=1,a},y.aT=gn,y.aU=Hg,y.aV=class extends p{},y.aW=Zh,y.aX=class extends x{},y.aY=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},y.aZ=Pe,y.a_=Ne,y.aa=function(a){const s={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,d,m,b)=>{const w=m||b;return s[d]=!w||w.toLowerCase(),""}),s["max-age"]){const c=parseInt(s["max-age"],10);isNaN(c)?delete s["max-age"]:s["max-age"]=c}return s},y.ab=function(a,s){const c=[];for(const d in a)d in s||c.push(d);return c},y.ac=function(a){if(null==ka){const s=a.navigator?a.navigator.userAgent:null;ka=!!a.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return ka},y.ad=$e,y.ae=function(a,s,c){var d=Math.sin(c),m=Math.cos(c),b=s[0],w=s[1],E=s[2],D=s[3],M=s[4],L=s[5],N=s[6],B=s[7];return s!==a&&(a[8]=s[8],a[9]=s[9],a[10]=s[10],a[11]=s[11],a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15]),a[0]=b*m+M*d,a[1]=w*m+L*d,a[2]=E*m+N*d,a[3]=D*m+B*d,a[4]=M*m-b*d,a[5]=L*m-w*d,a[6]=N*m-E*d,a[7]=B*m-D*d,a},y.af=function(a){var s=new Rc(16);return s[0]=a[0],s[1]=a[1],s[2]=a[2],s[3]=a[3],s[4]=a[4],s[5]=a[5],s[6]=a[6],s[7]=a[7],s[8]=a[8],s[9]=a[9],s[10]=a[10],s[11]=a[11],s[12]=a[12],s[13]=a[13],s[14]=a[14],s[15]=a[15],s},y.ag=jp,y.ah=function(a,s){let c=0,d=0;if("constant"===a.kind)d=a.layoutSize;else if("source"!==a.kind){const{interpolationType:m,minZoom:b,maxZoom:w}=a,E=m?$e(hs.interpolationFactor(m,s,b,w),0,1):0;"camera"===a.kind?d=Ds.number(a.minSize,a.maxSize,E):c=E}return{uSizeT:c,uSize:d}},y.aj=function(a,{uSize:s,uSizeT:c},{lowerSize:d,upperSize:m}){return"source"===a.kind?d/_a:"composite"===a.kind?Ds.number(d/_a,m/_a,c):s},y.ak=hm,y.al=function(a,s,c,d){const m=s.y-a.y,b=s.x-a.x,w=d.y-c.y,E=d.x-c.x,D=w*b-E*m;if(0===D)return null;const M=(E*(a.y-c.y)-w*(a.x-c.x))/D;return new ht(a.x+M*b,a.y+M*m)},y.am=Jh,y.an=zo,y.ao=tf,y.ap=Wi,y.ar=wf,y.as=function(a,s){var c=s[0],d=s[1],m=s[2],b=s[3],w=s[4],E=s[5],D=s[6],M=s[7],L=s[8],N=s[9],B=s[10],j=s[11],H=s[12],W=s[13],te=s[14],re=s[15],ce=c*E-d*w,oe=c*D-m*w,fe=c*M-b*w,ye=d*D-m*E,Te=d*M-b*E,Ze=m*M-b*D,nt=L*W-N*H,Ge=L*te-B*H,Ve=L*re-j*H,ze=N*te-B*W,Xe=N*re-j*W,Be=B*re-j*te,Re=ce*Be-oe*Xe+fe*ze+ye*Ve-Te*Ge+Ze*nt;return Re?(a[0]=(E*Be-D*Xe+M*ze)*(Re=1/Re),a[1]=(m*Xe-d*Be-b*ze)*Re,a[2]=(W*Ze-te*Te+re*ye)*Re,a[3]=(B*Te-N*Ze-j*ye)*Re,a[4]=(D*Ve-w*Be-M*Ge)*Re,a[5]=(c*Be-m*Ve+b*Ge)*Re,a[6]=(te*fe-H*Ze-re*oe)*Re,a[7]=(L*Ze-B*fe+j*oe)*Re,a[8]=(w*Xe-E*Ve+M*nt)*Re,a[9]=(d*Ve-c*Xe-b*nt)*Re,a[10]=(H*Te-W*fe+re*ce)*Re,a[11]=(N*fe-L*Te-j*ce)*Re,a[12]=(E*Ge-w*ze-D*nt)*Re,a[13]=(c*ze-d*Ge+m*nt)*Re,a[14]=(W*oe-H*ye-te*ce)*Re,a[15]=(L*ye-N*oe+B*ce)*Re,a):null},y.at=Cm,y.au=lm,y.av=Sm,y.aw=function(){const a={},s=we.$version;for(const c in we.$root){const d=we.$root[c];if(d.required){let m=null;m="version"===c?s:"array"===d.type?[]:{},null!=m&&(a[c]=m)}}return a},y.ax=mn,y.ay=Hi,y.az=kn,y.b=function(a,s){const c=new Blob([new Uint8Array(a)],{type:"image/png"});createImageBitmap(c).then(d=>{s(null,d)}).catch(d=>{s(new Error(`Could not load image because of ${d.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},y.b0=ir,y.b1=function(a,s){var c=a[0],d=a[1],m=a[2],b=a[3],w=a[4],E=a[5],D=a[6],M=a[7],L=a[8],N=a[9],B=a[10],j=a[11],H=a[12],W=a[13],te=a[14],re=a[15],ce=s[0],oe=s[1],fe=s[2],ye=s[3],Te=s[4],Ze=s[5],nt=s[6],Ge=s[7],Ve=s[8],ze=s[9],Xe=s[10],Be=s[11],Re=s[12],dt=s[13],et=s[14],Gt=s[15];return Math.abs(c-ce)<=Vr*Math.max(1,Math.abs(c),Math.abs(ce))&&Math.abs(d-oe)<=Vr*Math.max(1,Math.abs(d),Math.abs(oe))&&Math.abs(m-fe)<=Vr*Math.max(1,Math.abs(m),Math.abs(fe))&&Math.abs(b-ye)<=Vr*Math.max(1,Math.abs(b),Math.abs(ye))&&Math.abs(w-Te)<=Vr*Math.max(1,Math.abs(w),Math.abs(Te))&&Math.abs(E-Ze)<=Vr*Math.max(1,Math.abs(E),Math.abs(Ze))&&Math.abs(D-nt)<=Vr*Math.max(1,Math.abs(D),Math.abs(nt))&&Math.abs(M-Ge)<=Vr*Math.max(1,Math.abs(M),Math.abs(Ge))&&Math.abs(L-Ve)<=Vr*Math.max(1,Math.abs(L),Math.abs(Ve))&&Math.abs(N-ze)<=Vr*Math.max(1,Math.abs(N),Math.abs(ze))&&Math.abs(B-Xe)<=Vr*Math.max(1,Math.abs(B),Math.abs(Xe))&&Math.abs(j-Be)<=Vr*Math.max(1,Math.abs(j),Math.abs(Be))&&Math.abs(H-Re)<=Vr*Math.max(1,Math.abs(H),Math.abs(Re))&&Math.abs(W-dt)<=Vr*Math.max(1,Math.abs(W),Math.abs(dt))&&Math.abs(te-et)<=Vr*Math.max(1,Math.abs(te),Math.abs(et))&&Math.abs(re-Gt)<=Vr*Math.max(1,Math.abs(re),Math.abs(Gt))},y.b2=function(a,s){return a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[3],a[4]=s[4],a[5]=s[5],a[6]=s[6],a[7]=s[7],a[8]=s[8],a[9]=s[9],a[10]=s[10],a[11]=s[11],a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15],a},y.b3=function(a,s,c){return a[0]=s[0]*c[0],a[1]=s[1]*c[1],a[2]=s[2]*c[2],a[3]=s[3]*c[3],a},y.b4=function(a,s){return a[0]*s[0]+a[1]*s[1]+a[2]*s[2]+a[3]*s[3]},y.b5=Ue,y.b6=w0,y.b7=Df,y.b8=function(a,s,c,d,m){var b,w=1/Math.tan(s/2);return a[0]=w/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=w,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,null!=m&&m!==1/0?(a[10]=(m+d)*(b=1/(d-m)),a[14]=2*m*d*b):(a[10]=-1,a[14]=-2*d),a},y.b9=function(a,s,c){var d=Math.sin(c),m=Math.cos(c),b=s[4],w=s[5],E=s[6],D=s[7],M=s[8],L=s[9],N=s[10],B=s[11];return s!==a&&(a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[3],a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15]),a[4]=b*m+M*d,a[5]=w*m+L*d,a[6]=E*m+N*d,a[7]=D*m+B*d,a[8]=M*m-b*d,a[9]=L*m-w*d,a[10]=N*m-E*d,a[11]=B*m-D*d,a},y.bA=Bc,y.bB=Su,y.bC=Ni,y.ba=os,y.bb=ws,y.bc=function(a,s){return a[0]=s[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=s[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=s[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},y.bd=class extends Ii{},y.be=my,y.bf=C0,y.bh=Wn,y.bi=function(a,s,c=!1){if(bt===Ih||bt===Ah||bt===li)throw new Error("setRTLTextPlugin cannot be called multiple times.");Dn=Oa.resolveURL(a),bt=Ih,Qe=s,Xa(),c||xi()},y.bj=ha,y.bk=function(a,s){const c={};for(let m=0;m<a.length;m++){const b=s&&s[a[m].id]||Ga(a[m]);s&&(s[a[m].id]=b);let w=c[b];w||(w=c[b]=[]),w.push(a[m])}const d=[];for(const m in c)d.push(c[m]);return d},y.bl=Ye,y.bm=gm,y.bn=_m,y.bo=oy,y.bp=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=Bi/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const s=a.bucket.layers[0],c=s.layout,d=s._unevaluatedLayout._values,m={layoutIconSize:d["icon-size"].possiblyEvaluate(new In(a.bucket.zoom+1),a.canonical),layoutTextSize:d["text-size"].possiblyEvaluate(new In(a.bucket.zoom+1),a.canonical),textMaxSize:d["text-size"].possiblyEvaluate(new In(18))};if("composite"===a.bucket.textSizeData.kind){const{minZoom:M,maxZoom:L}=a.bucket.textSizeData;m.compositeTextSizes=[d["text-size"].possiblyEvaluate(new In(M),a.canonical),d["text-size"].possiblyEvaluate(new In(L),a.canonical)]}if("composite"===a.bucket.iconSizeData.kind){const{minZoom:M,maxZoom:L}=a.bucket.iconSizeData;m.compositeIconSizes=[d["icon-size"].possiblyEvaluate(new In(M),a.canonical),d["icon-size"].possiblyEvaluate(new In(L),a.canonical)]}const b=c.get("text-line-height")*Wi,w="viewport"!==c.get("text-rotation-alignment")&&"point"!==c.get("symbol-placement"),E=c.get("text-keep-upright"),D=c.get("text-size");for(const M of a.bucket.features){const L=c.get("text-font").evaluate(M,{},a.canonical).join(","),N=D.evaluate(M,{},a.canonical),B=m.layoutTextSize.evaluate(M,{},a.canonical),j=m.layoutIconSize.evaluate(M,{},a.canonical),H={horizontal:{},vertical:void 0},W=M.text;let te,re=[0,0];if(W){const fe=W.toString(),ye=c.get("text-letter-spacing").evaluate(M,{},a.canonical)*Wi,Te=qi(fe)?ye:0,Ze=c.get("text-anchor").evaluate(M,{},a.canonical),nt=wm(s,M,a.canonical);if(!nt){const Be=c.get("text-radial-offset").evaluate(M,{},a.canonical);re=Be?Iy(Ze,[Be*Wi,Af]):c.get("text-offset").evaluate(M,{},a.canonical).map(Re=>Re*Wi)}let Ge=w?"center":c.get("text-justify").evaluate(M,{},a.canonical);const Ve=c.get("symbol-placement"),ze="point"===Ve?c.get("text-max-width").evaluate(M,{},a.canonical)*Wi:0,Xe=()=>{a.bucket.allowVerticalPlacement&&dn(fe)&&(H.vertical=Hu(W,a.glyphMap,a.glyphPositions,a.imagePositions,L,ze,b,Ze,"left",Te,re,y.ai.vertical,!0,Ve,B,N))};if(!w&&nt){const Be=new Set;if("auto"===Ge)for(let dt=0;dt<nt.values.length;dt+=2)Be.add(Cm(nt.values[dt]));else Be.add(Ge);let Re=!1;for(const dt of Be)if(!H.horizontal[dt])if(Re)H.horizontal[dt]=H.horizontal[0];else{const et=Hu(W,a.glyphMap,a.glyphPositions,a.imagePositions,L,ze,b,"center",dt,Te,re,y.ai.horizontal,!1,Ve,B,N);et&&(H.horizontal[dt]=et,Re=1===et.positionedLines.length)}Xe()}else{"auto"===Ge&&(Ge=Cm(Ze));const Be=Hu(W,a.glyphMap,a.glyphPositions,a.imagePositions,L,ze,b,Ze,Ge,Te,re,y.ai.horizontal,!1,Ve,B,N);Be&&(H.horizontal[Ge]=Be),Xe(),dn(fe)&&w&&E&&(H.vertical=Hu(W,a.glyphMap,a.glyphPositions,a.imagePositions,L,ze,b,Ze,Ge,Te,re,y.ai.vertical,!1,Ve,B,N))}}let ce=!1;if(M.icon&&M.icon.name){const fe=a.imageMap[M.icon.name];fe&&(te=xf(a.imagePositions[M.icon.name],c.get("icon-offset").evaluate(M,{},a.canonical),c.get("icon-anchor").evaluate(M,{},a.canonical)),ce=!!fe.sdf,void 0===a.bucket.sdfIcons?a.bucket.sdfIcons=ce:a.bucket.sdfIcons!==ce&&fi("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(fe.pixelRatio!==a.bucket.pixelRatio||0!==c.get("icon-rotate").constantOr(1))&&(a.bucket.iconsNeedLinear=!0))}const oe=Py(H.horizontal)||H.vertical;a.bucket.iconsInText=!!oe&&oe.iconsInText,(oe||te)&&Ay(a.bucket,M,H,te,a.imageMap,m,B,j,re,ce,a.canonical)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},y.bq=qh,y.br=uf,y.bs=Fc,y.bt=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return 0===a.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},y.bu=Zi,y.bv=ga,y.bw=function(a,s,c,d,m){return ei(this,void 0,void 0,function*(){if(xs())try{return yield wl(a,s,c,d,m)}catch{}return function(b,w,E,D,M){const L=b.width,N=b.height;ro&&Gn||(ro=new OffscreenCanvas(L,N),Gn=ro.getContext("2d",{willReadFrequently:!0})),ro.width=L,ro.height=N,Gn.drawImage(b,0,0,L,N);const B=Gn.getImageData(w,E,D,M);return Gn.clearRect(0,0,L,N),B.data}(a,s,c,d,m)})},y.bx=Qh,y.by=xe,y.bz=Xr,y.c=Na,y.d=function(a,s){const c=new Image;c.onload=()=>{s(null,c),URL.revokeObjectURL(c.src),c.onload=null,window.requestAnimationFrame(()=>{c.src=pi})},c.onerror=()=>s(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const d=new Blob([new Uint8Array(a)],{type:"image/png"});c.src=a.byteLength?URL.createObjectURL(d):pi},y.e=He,y.f=function(a,s){return so(He(a,{type:"json"}),s)},y.g=Cs,y.h=Oa,y.i=ji,y.j=za,y.k=na,y.l=cc,y.m=so,y.n=function(a){return new Zi(a).readFields(Kh,[])},y.o=function(a,s,c){if(!a.length)return c(null,[]);let d=a.length;const m=new Array(a.length);let b=null;a.forEach((w,E)=>{s(w,(D,M)=>{D&&(b=D),m[E]=M,0==--d&&c(b,m)})})},y.p=sm,y.q=Nh,y.r=ni,y.s=Vs,y.t=Lp,y.u=Fe,y.v=we,y.w=fi,y.x=Er,y.y=lo,y.z=function([a,s,c]){return s+=90,s*=Math.PI/180,c*=Math.PI/180,{x:a*Math.cos(s)*Math.sin(c),y:a*Math.sin(s)*Math.sin(c),z:a*Math.cos(c)}}}),lc(0,function(y){class ei{constructor(z){this.keyCache={},z&&this.replace(z)}replace(z){this._layerConfigs={},this._layers={},this.update(z,[])}update(z,U){for(const J of z){this._layerConfigs[J.id]=J;const ne=this._layers[J.id]=y.aC(J);ne._featureFilter=y.a6(ne.filter),this.keyCache[J.id]&&delete this.keyCache[J.id]}for(const J of U)delete this.keyCache[J],delete this._layerConfigs[J],delete this._layers[J];this.familiesBySource={};const q=y.bk(Object.values(this._layerConfigs),this.keyCache);for(const J of q){const ne=J.map(Se=>this._layers[Se.id]),de=ne[0];if("none"===de.visibility)continue;const ae=de.source||"";let se=this.familiesBySource[ae];se||(se=this.familiesBySource[ae]={});const ue=de.sourceLayer||"_geojsonTileLayer";let Ce=se[ue];Ce||(Ce=se[ue]=[]),Ce.push(ne)}}}class xe{constructor(z){const U={},q=[];for(const ae in z){const se=z[ae],ue=U[ae]={};for(const Ce in se){const Se=se[+Ce];if(!Se||0===Se.bitmap.width||0===Se.bitmap.height)continue;const De={x:0,y:0,w:Se.bitmap.width+2,h:Se.bitmap.height+2};q.push(De),ue[Ce]={rect:De,metrics:Se.metrics}}}const{w:J,h:ne}=y.p(q),de=new y.q({width:J||1,height:ne||1});for(const ae in z){const se=z[ae];for(const ue in se){const Ce=se[+ue];if(!Ce||0===Ce.bitmap.width||0===Ce.bitmap.height)continue;const Se=U[ae][ue].rect;y.q.copy(Ce.bitmap,de,{x:0,y:0},{x:Se.x+1,y:Se.y+1},Ce.bitmap)}}this.image=de,this.positions=U}}y.bl("GlyphAtlas",xe);class Xr{constructor(z){this.tileID=new y.O(z.tileID.overscaledZ,z.tileID.wrap,z.tileID.canonical.z,z.tileID.canonical.x,z.tileID.canonical.y),this.uid=z.uid,this.zoom=z.zoom,this.pixelRatio=z.pixelRatio,this.tileSize=z.tileSize,this.source=z.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=z.showCollisionBoxes,this.collectResourceTiming=!!z.collectResourceTiming,this.returnDependencies=!!z.returnDependencies,this.promoteId=z.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(z,U,q,J,ne){this.status="parsing",this.data=z,this.collisionBoxArray=new y.a3;const de=new y.bm(Object.keys(z.layers).sort()),ae=new y.bn(this.tileID,this.promoteId);ae.bucketLayerIDs=[];const se={},ue={featureIndex:ae,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:q},Ce=U.familiesBySource[this.source];for(const hn in Ce){const zt=z.layers[hn];if(!zt)continue;1===zt.version&&y.w(`Vector tile source "${this.source}" layer "${hn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const xr=de.encode(hn),Ut=[];for(let ti=0;ti<zt.length;ti++){const Zn=zt.feature(ti),Hs=ae.getId(Zn,hn);Ut.push({feature:Zn,id:Hs,index:ti,sourceLayerIndex:xr})}for(const ti of Ce[hn]){const Zn=ti[0];Zn.source!==this.source&&y.w(`layer.source = ${Zn.source} does not equal this.source = ${this.source}`),Zn.minzoom&&this.zoom<Math.floor(Zn.minzoom)||Zn.maxzoom&&this.zoom>=Zn.maxzoom||"none"!==Zn.visibility&&(Qi(ti,this.zoom,q),(se[Zn.id]=Zn.createBucket({index:ae.bucketLayerIDs.length,layers:ti,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:xr,sourceID:this.source})).populate(Ut,ue,this.tileID.canonical),ae.bucketLayerIDs.push(ti.map(Hs=>Hs.id)))}}let Se,De,Je,Ct;const it=y.aH(ue.glyphDependencies,hn=>Object.keys(hn).map(Number));this.inFlightDependencies.forEach(hn=>hn?.cancel()),this.inFlightDependencies=[];const gt=++this.dependencySentinel;Object.keys(it).length?this.inFlightDependencies.push(J.send("getGlyphs",{uid:this.uid,stacks:it,source:this.source,tileID:this.tileID,type:"glyphs"},(hn,zt)=>{gt===this.dependencySentinel&&(Se||(Se=hn,De=zt,Nn.call(this)))})):De={};const Pt=Object.keys(ue.iconDependencies);Pt.length?this.inFlightDependencies.push(J.send("getImages",{icons:Pt,source:this.source,tileID:this.tileID,type:"icons"},(hn,zt)=>{gt===this.dependencySentinel&&(Se||(Se=hn,Je=zt,Nn.call(this)))})):Je={};const _n=Object.keys(ue.patternDependencies);function Nn(){if(Se)return ne(Se);if(De&&Je&&Ct){const hn=new xe(De),zt=new y.bo(Je,Ct);for(const xr in se){const Ut=se[xr];Ut instanceof y.a4?(Qi(Ut.layers,this.zoom,q),y.bp({bucket:Ut,glyphMap:De,glyphPositions:hn.positions,imageMap:Je,imagePositions:zt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Ut.hasPattern&&(Ut instanceof y.bq||Ut instanceof y.br||Ut instanceof y.bs)&&(Qi(Ut.layers,this.zoom,q),Ut.addFeatures(ue,this.tileID.canonical,zt.patternPositions))}this.status="done",ne(null,{buckets:Object.values(se).filter(xr=>!xr.isEmpty()),featureIndex:ae,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:hn.image,imageAtlas:zt,glyphMap:this.returnDependencies?De:null,iconMap:this.returnDependencies?Je:null,glyphPositions:this.returnDependencies?hn.positions:null})}}_n.length?this.inFlightDependencies.push(J.send("getImages",{icons:_n,source:this.source,tileID:this.tileID,type:"patterns"},(hn,zt)=>{gt===this.dependencySentinel&&(Se||(Se=hn,Ct=zt,Nn.call(this)))})):Ct={},Nn.call(this)}}function Qi(X,z,U){const q=new y.a8(z);for(const J of X)J.recalculate(q,U)}function ht(X,z){const U=y.l(X.request,(q,J,ne,de)=>{if(q)z(q);else if(J)try{const ae=new y.bv.VectorTile(new y.bu(J));z(null,{vectorTile:ae,rawData:J,cacheControl:ne,expires:de})}catch(ae){const se=new Uint8Array(J);let ue=`Unable to parse the tile at ${X.request.url}, `;ue+=31===se[0]&&139===se[1]?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ae.messge}`,z(new Error(ue))}});return()=>{U.cancel(),z()}}class bs{constructor(z,U,q,J){this.actor=z,this.layerIndex=U,this.availableImages=q,this.loadVectorData=J||ht,this.fetching={},this.loading={},this.loaded={}}loadTile(z,U){const q=z.uid;this.loading||(this.loading={});const J=!!(z&&z.request&&z.request.collectResourceTiming)&&new y.bt(z.request),ne=this.loading[q]=new Xr(z);ne.abort=this.loadVectorData(z,(de,ae)=>{if(delete this.loading[q],de||!ae)return ne.status="done",this.loaded[q]=ne,U(de);const se=ae.rawData,ue={};ae.expires&&(ue.expires=ae.expires),ae.cacheControl&&(ue.cacheControl=ae.cacheControl);const Ce={};if(J){const Se=J.finish();Se&&(Ce.resourceTiming=JSON.parse(JSON.stringify(Se)))}ne.vectorTile=ae.vectorTile,ne.parse(ae.vectorTile,this.layerIndex,this.availableImages,this.actor,(Se,De)=>{if(delete this.fetching[q],Se||!De)return U(Se);U(null,y.e({rawTileData:se.slice(0)},De,ue,Ce))}),this.loaded=this.loaded||{},this.loaded[q]=ne,this.fetching[q]={rawTileData:se,cacheControl:ue,resourceTiming:Ce}})}reloadTile(z,U){const q=this.loaded,J=z.uid;if(q&&q[J]){const ne=q[J];ne.showCollisionBoxes=z.showCollisionBoxes,"parsing"===ne.status?ne.parse(ne.vectorTile,this.layerIndex,this.availableImages,this.actor,(de,ae)=>{if(de||!ae)return U(de,ae);let se;if(this.fetching[J]){const{rawTileData:ue,cacheControl:Ce,resourceTiming:Se}=this.fetching[J];delete this.fetching[J],se=y.e({rawTileData:ue.slice(0)},ae,Ce,Se)}else se=ae;U(null,se)}):"done"===ne.status&&(ne.vectorTile?ne.parse(ne.vectorTile,this.layerIndex,this.availableImages,this.actor,U):U())}}abortTile(z,U){const q=this.loading,J=z.uid;q&&q[J]&&q[J].abort&&(q[J].abort(),delete q[J]),U()}removeTile(z,U){const q=this.loaded,J=z.uid;q&&q[J]&&delete q[J],U()}}class So{constructor(){this.loaded={}}loadTile(z,U){return y._(this,void 0,void 0,function*(){const{uid:q,encoding:J,rawImageData:ne,redFactor:de,greenFactor:ae,blueFactor:se,baseShift:ue}=z,Ce=ne.width+2,Se=ne.height+2,De=y.a(ne)?new y.R({width:Ce,height:Se},yield y.bw(ne,-1,-1,Ce,Se)):ne,Je=new y.bx(q,De,J,de,ae,se,ue);this.loaded=this.loaded||{},this.loaded[q]=Je,U(null,Je)})}removeTile(z){const U=this.loaded,q=z.uid;U&&U[q]&&delete U[q]}}function Us(X,z){if(0!==X.length){Ji(X[0],z);for(var U=1;U<X.length;U++)Ji(X[U],!z)}}function Ji(X,z){for(var U=0,q=0,J=0,ne=X.length,de=ne-1;J<ne;de=J++){var ae=(X[J][0]-X[de][0])*(X[de][1]+X[J][1]),se=U+ae;q+=Math.abs(U)>=Math.abs(ae)?U-se+ae:ae-se+U,U=se}U+q>=0!=!!z&&X.reverse()}var bi=y.by(function X(z,U){var q,J=z&&z.type;if("FeatureCollection"===J)for(q=0;q<z.features.length;q++)X(z.features[q],U);else if("GeometryCollection"===J)for(q=0;q<z.geometries.length;q++)X(z.geometries[q],U);else if("Feature"===J)X(z.geometry,U);else if("Polygon"===J)Us(z.coordinates,U);else if("MultiPolygon"===J)for(q=0;q<z.coordinates.length;q++)Us(z.coordinates[q],U);return z});const bl=y.bv.VectorTileFeature.prototype.toGeoJSON;var xs={exports:{}},os=y.bz,ws=y.bv.VectorTileFeature,$e=Ue;function Ue(X,z){this.options=z||{},this.features=X,this.length=X.length}function He(X,z){this.id="number"==typeof X.id?X.id:void 0,this.type=X.type,this.rawGeometry=1===X.type?[X.geometry]:X.geometry,this.properties=X.tags,this.extent=z||4096}Ue.prototype.feature=function(X){return new He(this.features[X],this.options.extent)},He.prototype.loadGeometry=function(){var X=this.rawGeometry;this.geometry=[];for(var z=0;z<X.length;z++){for(var U=X[z],q=[],J=0;J<U.length;J++)q.push(new os(U[J][0],U[J][1]));this.geometry.push(q)}return this.geometry},He.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var X=this.geometry,z=1/0,U=-1/0,q=1/0,J=-1/0,ne=0;ne<X.length;ne++)for(var de=X[ne],ae=0;ae<de.length;ae++){var se=de[ae];z=Math.min(z,se.x),U=Math.max(U,se.x),q=Math.min(q,se.y),J=Math.max(J,se.y)}return[z,q,U,J]},He.prototype.toGeoJSON=ws.prototype.toGeoJSON;var yt=y.bA,ot=$e;function ln(X){var z=new yt;return function(U,q){for(var J in U.layers)q.writeMessage(3,Dt,U.layers[J])}(X,z),z.finish()}function Dt(X,z){var U;z.writeVarintField(15,X.version||1),z.writeStringField(1,X.name||""),z.writeVarintField(5,X.extent||4096);var q={keys:[],values:[],keycache:{},valuecache:{}};for(U=0;U<X.length;U++)q.feature=X.feature(U),z.writeMessage(2,ki,q);var J=q.keys;for(U=0;U<J.length;U++)z.writeStringField(3,J[U]);var ne=q.values;for(U=0;U<ne.length;U++)z.writeMessage(4,ka,ne[U])}function ki(X,z){var U=X.feature;void 0!==U.id&&z.writeVarintField(1,U.id),z.writeMessage(2,fi,X),z.writeVarintField(3,U.type),z.writeMessage(4,ji,U)}function fi(X,z){var U=X.feature,q=X.keys,J=X.values,ne=X.keycache,de=X.valuecache;for(var ae in U.properties){var se=U.properties[ae],ue=ne[ae];if(null!==se){void 0===ue&&(q.push(ae),ne[ae]=ue=q.length-1),z.writeVarint(ue);var Ce=typeof se;"string"!==Ce&&"boolean"!==Ce&&"number"!==Ce&&(se=JSON.stringify(se));var Se=Ce+":"+se,De=de[Se];void 0===De&&(J.push(se),de[Se]=De=J.length-1),z.writeVarint(De)}}}function br(X,z){return(z<<3)+(7&X)}function as(X){return X<<1^X>>31}function ji(X,z){for(var U=X.loadGeometry(),q=X.type,J=0,ne=0,de=U.length,ae=0;ae<de;ae++){var se=U[ae],ue=1;1===q&&(ue=se.length),z.writeVarint(br(1,ue));for(var Ce=3===q?se.length-1:se.length,Se=0;Se<Ce;Se++){1===Se&&1!==q&&z.writeVarint(br(2,Ce-1));var De=se[Se].x-J,Je=se[Se].y-ne;z.writeVarint(as(De)),z.writeVarint(as(Je)),J+=De,ne+=Je}3===q&&z.writeVarint(br(7,1))}}function ka(X,z){var U=typeof X;"string"===U?z.writeStringField(1,X):"boolean"===U?z.writeBooleanField(7,X):"number"===U&&(X%1!=0?z.writeDoubleField(3,X):X<0?z.writeSVarintField(6,X):z.writeVarintField(5,X))}xs.exports=ln,xs.exports.fromVectorTileJs=ln,xs.exports.fromGeojsonVt=function(X,z){z=z||{};var U={};for(var q in X)U[q]=new ot(X[q].features,z),U[q].name=q,U[q].version=z.version,U[q].extent=z.extent;return ln({layers:U})},xs.exports.GeoJSONWrapper=ot;var xl=y.by(xs.exports);const pi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:X=>X},wl=Math.fround||(ro=new Float32Array(1),X=>(ro[0]=+X,ro[0]));var ro;const Gn=3,Yr=5,er=6;class Oa{constructor(z){this.options=Object.assign(Object.create(pi),z),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(z){const{log:U,minZoom:q,maxZoom:J}=this.options;U&&console.time("total time");const ne=`prepare ${z.length} points`;U&&console.time(ne),this.points=z;const de=[];for(let se=0;se<z.length;se++){const ue=z[se];if(!ue.geometry)continue;const[Ce,Se]=ue.geometry.coordinates,De=wl(kn(Ce)),Je=wl(Cs(Se));de.push(De,Je,1/0,se,-1,1),this.options.reduce&&de.push(0)}let ae=this.trees[J+1]=this._createTree(de);U&&console.timeEnd(ne);for(let se=J;se>=q;se--){const ue=+Date.now();ae=this.trees[se]=this._createTree(this._cluster(ae,se)),U&&console.log("z%d: %d clusters in %dms",se,ae.numItems,+Date.now()-ue)}return U&&console.timeEnd("total time"),this}getClusters(z,U){let q=((z[0]+180)%360+360)%360-180;const J=Math.max(-90,Math.min(90,z[1]));let ne=180===z[2]?180:((z[2]+180)%360+360)%360-180;const de=Math.max(-90,Math.min(90,z[3]));if(z[2]-z[0]>=360)q=-180,ne=180;else if(q>ne){const Se=this.getClusters([q,J,180,de],U),De=this.getClusters([-180,J,ne,de],U);return Se.concat(De)}const ae=this.trees[this._limitZoom(U)],se=ae.range(kn(q),Cs(de),kn(ne),Cs(J)),ue=ae.data,Ce=[];for(const Se of se){const De=this.stride*Se;Ce.push(ue[De+Yr]>1?Na(ue,De,this.clusterProps):this.points[ue[De+Gn]])}return Ce}getChildren(z){const U=this._getOriginId(z),q=this._getOriginZoom(z),J="No cluster with the specified id.",ne=this.trees[q];if(!ne)throw new Error(J);const de=ne.data;if(U*this.stride>=de.length)throw new Error(J);const ae=this.options.radius/(this.options.extent*Math.pow(2,q-1)),se=ne.within(de[U*this.stride],de[U*this.stride+1],ae),ue=[];for(const Ce of se){const Se=Ce*this.stride;de[Se+4]===z&&ue.push(de[Se+Yr]>1?Na(de,Se,this.clusterProps):this.points[de[Se+Gn]])}if(0===ue.length)throw new Error(J);return ue}getLeaves(z,U,q){const J=[];return this._appendLeaves(J,z,U=U||10,q=q||0,0),J}getTile(z,U,q){const J=this.trees[this._limitZoom(z)],ne=Math.pow(2,z),{extent:de,radius:ae}=this.options,se=ae/de,ue=(q-se)/ne,Ce=(q+1+se)/ne,Se={features:[]};return this._addTileFeatures(J.range((U-se)/ne,ue,(U+1+se)/ne,Ce),J.data,U,q,ne,Se),0===U&&this._addTileFeatures(J.range(1-se/ne,ue,1,Ce),J.data,ne,q,ne,Se),U===ne-1&&this._addTileFeatures(J.range(0,ue,se/ne,Ce),J.data,-1,q,ne,Se),Se.features.length?Se:null}getClusterExpansionZoom(z){let U=this._getOriginZoom(z)-1;for(;U<=this.options.maxZoom;){const q=this.getChildren(z);if(U++,1!==q.length)break;z=q[0].properties.cluster_id}return U}_appendLeaves(z,U,q,J,ne){const de=this.getChildren(U);for(const ae of de){const se=ae.properties;if(se&&se.cluster?ne+se.point_count<=J?ne+=se.point_count:ne=this._appendLeaves(z,se.cluster_id,q,J,ne):ne<J?ne++:z.push(ae),z.length===q)break}return ne}_createTree(z){const U=new y.av(z.length/this.stride|0,this.options.nodeSize,Float32Array);for(let q=0;q<z.length;q+=this.stride)U.add(z[q],z[q+1]);return U.finish(),U.data=z,U}_addTileFeatures(z,U,q,J,ne,de){for(const ae of z){const se=ae*this.stride,ue=U[se+Yr]>1;let Ce,Se,De;if(ue)Ce=Wn(U,se,this.clusterProps),Se=U[se],De=U[se+1];else{const it=this.points[U[se+Gn]];Ce=it.properties;const[gt,Pt]=it.geometry.coordinates;Se=kn(gt),De=Cs(Pt)}const Je={type:1,geometry:[[Math.round(this.options.extent*(Se*ne-q)),Math.round(this.options.extent*(De*ne-J))]],tags:Ce};let Ct;Ct=ue||this.options.generateId?U[se+Gn]:this.points[U[se+Gn]].id,void 0!==Ct&&(Je.id=Ct),de.features.push(Je)}}_limitZoom(z){return Math.max(this.options.minZoom,Math.min(Math.floor(+z),this.options.maxZoom+1))}_cluster(z,U){const{radius:q,extent:J,reduce:ne,minPoints:de}=this.options,ae=q/(J*Math.pow(2,U)),se=z.data,ue=[],Ce=this.stride;for(let Se=0;Se<se.length;Se+=Ce){if(se[Se+2]<=U)continue;se[Se+2]=U;const De=se[Se],Je=se[Se+1],Ct=z.within(se[Se],se[Se+1],ae),it=se[Se+Yr];let gt=it;for(const Pt of Ct){const _n=Pt*Ce;se[_n+2]>U&&(gt+=se[_n+Yr])}if(gt>it&&gt>=de){let Pt,_n=De*it,Nn=Je*it,hn=-1;const zt=((Se/Ce|0)<<5)+(U+1)+this.points.length;for(const xr of Ct){const Ut=xr*Ce;if(se[Ut+2]<=U)continue;se[Ut+2]=U;const ti=se[Ut+Yr];_n+=se[Ut]*ti,Nn+=se[Ut+1]*ti,se[Ut+4]=zt,ne&&(Pt||(Pt=this._map(se,Se,!0),hn=this.clusterProps.length,this.clusterProps.push(Pt)),ne(Pt,this._map(se,Ut)))}se[Se+4]=zt,ue.push(_n/gt,Nn/gt,1/0,zt,-1,gt),ne&&ue.push(hn)}else{for(let Pt=0;Pt<Ce;Pt++)ue.push(se[Se+Pt]);if(gt>1)for(const Pt of Ct){const _n=Pt*Ce;if(!(se[_n+2]<=U)){se[_n+2]=U;for(let Nn=0;Nn<Ce;Nn++)ue.push(se[_n+Nn])}}}}return ue}_getOriginId(z){return z-this.points.length>>5}_getOriginZoom(z){return(z-this.points.length)%32}_map(z,U,q){if(z[U+Yr]>1){const de=this.clusterProps[z[U+er]];return q?Object.assign({},de):de}const J=this.points[z[U+Gn]].properties,ne=this.options.map(J);return q&&ne===J?Object.assign({},ne):ne}}function Na(X,z,U){return{type:"Feature",id:X[z+Gn],properties:Wn(X,z,U),geometry:{type:"Point",coordinates:[(q=X[z],360*(q-.5)),pn(X[z+1])]}};var q}function Wn(X,z,U){const q=X[z+Yr],J=q>=1e4?`${Math.round(q/1e3)}k`:q>=1e3?Math.round(q/100)/10+"k":q,ne=X[z+er],de=-1===ne?{}:Object.assign({},U[ne]);return Object.assign(de,{cluster:!0,cluster_id:X[z+Gn],point_count:q,point_count_abbreviated:J})}function kn(X){return X/360+.5}function Cs(X){const z=Math.sin(X*Math.PI/180),U=.5-.25*Math.log((1+z)/(1-z))/Math.PI;return U<0?0:U>1?1:U}function pn(X){const z=(180-360*X)*Math.PI/180;return 360*Math.atan(Math.exp(z))/Math.PI-90}function so(X,z,U,q){for(var J,ne=q,de=U-z>>1,ae=U-z,se=X[z],ue=X[z+1],Ce=X[U],Se=X[U+1],De=z+3;De<U;De+=3){var Je=cc(X[De],X[De+1],se,ue,Ce,Se);if(Je>ne)J=De,ne=Je;else if(Je===ne){var Ct=Math.abs(De-de);Ct<ae&&(J=De,ae=Ct)}}ne>q&&(J-z>3&&so(X,z,J,q),X[J+2]=ne,U-J>3&&so(X,J,U,q))}function cc(X,z,U,q,J,ne){var de=J-U,ae=ne-q;if(0!==de||0!==ae){var se=((X-U)*de+(z-q)*ae)/(de*de+ae*ae);se>1?(U=J,q=ne):se>0&&(U+=de*se,q+=ae*se)}return(de=X-U)*de+(ae=z-q)*ae}function Vs(X,z,U,q){var J={id:void 0===X?null:X,type:z,geometry:U,tags:q,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ne){var de=ne.geometry,ae=ne.type;if("Point"===ae||"MultiPoint"===ae||"LineString"===ae)Cl(ne,de);else if("Polygon"===ae||"MultiLineString"===ae)for(var se=0;se<de.length;se++)Cl(ne,de[se]);else if("MultiPolygon"===ae)for(se=0;se<de.length;se++)for(var ue=0;ue<de[se].length;ue++)Cl(ne,de[se][ue])}(J),J}function Cl(X,z){for(var U=0;U<z.length;U+=3)X.minX=Math.min(X.minX,z[U]),X.minY=Math.min(X.minY,z[U+1]),X.maxX=Math.max(X.maxX,z[U]),X.maxY=Math.max(X.maxY,z[U+1])}function Fa(X,z,U,q){if(z.geometry){var J=z.geometry.coordinates,ne=z.geometry.type,de=Math.pow(U.tolerance/((1<<U.maxZoom)*U.extent),2),ae=[],se=z.id;if(U.promoteId?se=z.properties[U.promoteId]:U.generateId&&(se=q||0),"Point"===ne)na(J,ae);else if("MultiPoint"===ne)for(var ue=0;ue<J.length;ue++)na(J[ue],ae);else if("LineString"===ne)za(J,ae,de,!1);else if("MultiLineString"===ne){if(U.lineMetrics){for(ue=0;ue<J.length;ue++)za(J[ue],ae=[],de,!1),X.push(Vs(se,"LineString",ae,z.properties));return}El(J,ae,de,!1)}else if("Polygon"===ne)El(J,ae,de,!0);else{if("MultiPolygon"!==ne){if("GeometryCollection"===ne){for(ue=0;ue<z.geometry.geometries.length;ue++)Fa(X,{id:se,geometry:z.geometry.geometries[ue],properties:z.properties},U,q);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ue=0;ue<J.length;ue++){var Ce=[];El(J[ue],Ce,de,!0),ae.push(Ce)}}X.push(Vs(se,ne,ae,z.properties))}}function na(X,z){z.push(we(X[0])),z.push(ls(X[1])),z.push(0)}function za(X,z,U,q){for(var J,ne,de=0,ae=0;ae<X.length;ae++){var se=we(X[ae][0]),ue=ls(X[ae][1]);z.push(se),z.push(ue),z.push(0),ae>0&&(de+=q?(J*ue-se*ne)/2:Math.sqrt(Math.pow(se-J,2)+Math.pow(ue-ne,2))),J=se,ne=ue}var Ce=z.length-3;z[2]=1,so(z,0,Ce,U),z[Ce+2]=1,z.size=Math.abs(de),z.start=0,z.end=z.size}function El(X,z,U,q){for(var J=0;J<X.length;J++){var ne=[];za(X[J],ne,U,q),z.push(ne)}}function we(X){return X/360+.5}function ls(X){var z=Math.sin(X*Math.PI/180),U=.5-.25*Math.log((1+z)/(1-z))/Math.PI;return U<0?0:U>1?1:U}function Es(X,z,U,q,J,ne,de,ae){if(q/=z,ne>=(U/=z)&&de<q)return X;if(de<U||ne>=q)return null;for(var se=[],ue=0;ue<X.length;ue++){var Ce=X[ue],Se=Ce.geometry,De=Ce.type,Je=0===J?Ce.minX:Ce.minY,Ct=0===J?Ce.maxX:Ce.maxY;if(Je>=U&&Ct<q)se.push(Ce);else if(!(Ct<U||Je>=q)){var it=[];if("Point"===De||"MultiPoint"===De)On(Se,it,U,q,J);else if("LineString"===De)mn(Se,it,U,q,J,!1,ae.lineMetrics);else if("MultiLineString"===De)Sl(Se,it,U,q,J,!1);else if("Polygon"===De)Sl(Se,it,U,q,J,!0);else if("MultiPolygon"===De)for(var gt=0;gt<Se.length;gt++){var Pt=[];Sl(Se[gt],Pt,U,q,J,!0),Pt.length&&it.push(Pt)}if(it.length){if(ae.lineMetrics&&"LineString"===De){for(gt=0;gt<it.length;gt++)se.push(Vs(Ce.id,De,it[gt],Ce.tags));continue}"LineString"!==De&&"MultiLineString"!==De||(1===it.length?(De="LineString",it=it[0]):De="MultiLineString"),"Point"!==De&&"MultiPoint"!==De||(De=3===it.length?"Point":"MultiPoint"),se.push(Vs(Ce.id,De,it,Ce.tags))}}}return se.length?se:null}function On(X,z,U,q,J){for(var ne=0;ne<X.length;ne+=3){var de=X[ne+J];de>=U&&de<=q&&(z.push(X[ne]),z.push(X[ne+1]),z.push(X[ne+2]))}}function mn(X,z,U,q,J,ne,de){for(var ae,se,ue=Ss(X),Ce=0===J?uc:Tl,Se=X.start,De=0;De<X.length-3;De+=3){var Je=X[De],Ct=X[De+1],it=X[De+2],gt=X[De+3],Pt=X[De+4],_n=0===J?Je:Ct,Nn=0===J?gt:Pt,hn=!1;de&&(ae=Math.sqrt(Math.pow(Je-gt,2)+Math.pow(Ct-Pt,2))),_n<U?Nn>U&&(se=Ce(ue,Je,Ct,gt,Pt,U),de&&(ue.start=Se+ae*se)):_n>q?Nn<q&&(se=Ce(ue,Je,Ct,gt,Pt,q),de&&(ue.start=Se+ae*se)):js(ue,Je,Ct,it),Nn<U&&_n>=U&&(se=Ce(ue,Je,Ct,gt,Pt,U),hn=!0),Nn>q&&_n<=q&&(se=Ce(ue,Je,Ct,gt,Pt,q),hn=!0),!ne&&hn&&(de&&(ue.end=Se+ae*se),z.push(ue),ue=Ss(X)),de&&(Se+=ae)}var zt=X.length-3;Je=X[zt],Ct=X[zt+1],it=X[zt+2],(_n=0===J?Je:Ct)>=U&&_n<=q&&js(ue,Je,Ct,it),zt=ue.length-3,ne&&zt>=3&&(ue[zt]!==ue[0]||ue[zt+1]!==ue[1])&&js(ue,ue[0],ue[1],ue[2]),ue.length&&z.push(ue)}function Ss(X){var z=[];return z.size=X.size,z.start=X.start,z.end=X.end,z}function Sl(X,z,U,q,J,ne){for(var de=0;de<X.length;de++)mn(X[de],z,U,q,J,ne,!1)}function js(X,z,U,q){X.push(z),X.push(U),X.push(q)}function uc(X,z,U,q,J,ne){var de=(ne-z)/(q-z);return X.push(ne),X.push(U+(J-U)*de),X.push(1),de}function Tl(X,z,U,q,J,ne){var de=(ne-U)/(J-U);return X.push(z+(q-z)*de),X.push(ne),X.push(1),de}function ia(X,z){for(var U=[],q=0;q<X.length;q++){var J,ne=X[q],de=ne.type;if("Point"===de||"MultiPoint"===de||"LineString"===de)J=Ba(ne.geometry,z);else if("MultiLineString"===de||"Polygon"===de){J=[];for(var ae=0;ae<ne.geometry.length;ae++)J.push(Ba(ne.geometry[ae],z))}else if("MultiPolygon"===de)for(J=[],ae=0;ae<ne.geometry.length;ae++){for(var se=[],ue=0;ue<ne.geometry[ae].length;ue++)se.push(Ba(ne.geometry[ae][ue],z));J.push(se)}U.push(Vs(ne.id,de,J,ne.tags))}return U}function Ba(X,z){var U=[];U.size=X.size,void 0!==X.start&&(U.start=X.start,U.end=X.end);for(var q=0;q<X.length;q+=3)U.push(X[q]+z,X[q+1],X[q+2]);return U}function ke(X,z){if(X.transformed)return X;var U,q,J,ne=1<<X.z,de=X.x,ae=X.y;for(U=0;U<X.features.length;U++){var se=X.features[U],ue=se.geometry,Ce=se.type;if(se.geometry=[],1===Ce)for(q=0;q<ue.length;q+=2)se.geometry.push($s(ue[q],ue[q+1],z,ne,de,ae));else for(q=0;q<ue.length;q++){var Se=[];for(J=0;J<ue[q].length;J+=2)Se.push($s(ue[q][J],ue[q][J+1],z,ne,de,ae));se.geometry.push(Se)}}return X.transformed=!0,X}function $s(X,z,U,q,J,ne){return[Math.round(U*(X*q-J)),Math.round(U*(z*q-ne))]}function mi(X,z,U,q,J){for(var ne=z===J.maxZoom?0:J.tolerance/((1<<z)*J.extent),de={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:U,y:q,z,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ae=0;ae<X.length;ae++){de.numFeatures++,ra(de,X[ae],ne,J);var se=X[ae].minX,ue=X[ae].minY,Ce=X[ae].maxX,Se=X[ae].maxY;se<de.minX&&(de.minX=se),ue<de.minY&&(de.minY=ue),Ce>de.maxX&&(de.maxX=Ce),Se>de.maxY&&(de.maxY=Se)}return de}function ra(X,z,U,q){var J=z.geometry,ne=z.type,de=[];if("Point"===ne||"MultiPoint"===ne)for(var ae=0;ae<J.length;ae+=3)de.push(J[ae]),de.push(J[ae+1]),X.numPoints++,X.numSimplified++;else if("LineString"===ne)To(de,J,X,U,!1,!1);else if("MultiLineString"===ne||"Polygon"===ne)for(ae=0;ae<J.length;ae++)To(de,J[ae],X,U,"Polygon"===ne,0===ae);else if("MultiPolygon"===ne)for(var se=0;se<J.length;se++){var ue=J[se];for(ae=0;ae<ue.length;ae++)To(de,ue[ae],X,U,!0,0===ae)}if(de.length){var Ce=z.tags||null;if("LineString"===ne&&q.lineMetrics){for(var Se in Ce={},z.tags)Ce[Se]=z.tags[Se];Ce.mapbox_clip_start=J.start/J.size,Ce.mapbox_clip_end=J.end/J.size}var De={geometry:de,type:"Polygon"===ne||"MultiPolygon"===ne?3:"LineString"===ne||"MultiLineString"===ne?2:1,tags:Ce};null!==z.id&&(De.id=z.id),X.features.push(De)}}function To(X,z,U,q,J,ne){var de=q*q;if(q>0&&z.size<(J?de:q))U.numPoints+=z.length/3;else{for(var ae=[],se=0;se<z.length;se+=3)(0===q||z[se+2]>de)&&(U.numSimplified++,ae.push(z[se]),ae.push(z[se+1])),U.numPoints++;J&&function(ue,Ce){for(var Se=0,De=0,Je=ue.length,Ct=Je-2;De<Je;Ct=De,De+=2)Se+=(ue[De]-ue[Ct])*(ue[De+1]+ue[Ct+1]);if(Se>0===Ce)for(De=0,Je=ue.length;De<Je/2;De+=2){var it=ue[De],gt=ue[De+1];ue[De]=ue[Je-2-De],ue[De+1]=ue[Je-1-De],ue[Je-2-De]=it,ue[Je-1-De]=gt}}(ae,ne),X.push(ae)}}function je(X,z){var U=(z=this.options=function(J,ne){for(var de in ne)J[de]=ne[de];return J}(Object.create(this.options),z)).debug;if(U&&console.time("preprocess data"),z.maxZoom<0||z.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(z.promoteId&&z.generateId)throw new Error("promoteId and generateId cannot be used together.");var J,ne,de,ae,se,ue,q=function(J,ne){var de=[];if("FeatureCollection"===J.type)for(var ae=0;ae<J.features.length;ae++)Fa(de,J.features[ae],ne,ae);else Fa(de,"Feature"===J.type?J:{geometry:J},ne);return de}(X,z);this.tiles={},this.tileCoords=[],U&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",z.indexMaxZoom,z.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ae=J=q,se=Es(J,1,-1-(de=(ne=z).buffer/ne.extent),de,0,-1,2,ne),ue=Es(J,1,1-de,2+de,0,-1,2,ne),(se||ue)&&(ae=Es(J,1,-de,1+de,0,-1,2,ne)||[],se&&(ae=ia(se,1).concat(ae)),ue&&(ae=ae.concat(ia(ue,-1)))),(q=ae).length&&this.splitTile(q,0,0,0),U&&(q.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Bt(X,z,U){return 32*((1<<X)*U+z)+X}function Mt(X,z){return z?X.properties[z]:X.id}function Or(X,z){if(null==X)return!0;if("Feature"===X.type)return null!=Mt(X,z);if("FeatureCollection"===X.type){const U=new Set;for(const q of X.features){const J=Mt(q,z);if(null==J||U.has(J))return!1;U.add(J)}return!0}return!1}function oo(X,z){const U=new Map;if(null!=X)if("Feature"===X.type)U.set(Mt(X,z),X);else for(const q of X.features)U.set(Mt(q,z),q);return U}je.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},je.prototype.splitTile=function(X,z,U,q,J,ne,de){for(var ae=[X,z,U,q],se=this.options,ue=se.debug;ae.length;){q=ae.pop(),U=ae.pop(),z=ae.pop(),X=ae.pop();var Ce=1<<z,Se=Bt(z,U,q),De=this.tiles[Se];if(!De&&(ue>1&&console.time("creation"),De=this.tiles[Se]=mi(X,z,U,q,se),this.tileCoords.push({z,x:U,y:q}),ue)){ue>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",z,U,q,De.numFeatures,De.numPoints,De.numSimplified),console.timeEnd("creation"));var Je="z"+z;this.stats[Je]=(this.stats[Je]||0)+1,this.total++}if(De.source=X,J){if(z===se.maxZoom||z===J)continue;var Ct=1<<J-z;if(U!==Math.floor(ne/Ct)||q!==Math.floor(de/Ct))continue}else if(z===se.indexMaxZoom||De.numPoints<=se.indexMaxPoints)continue;if(De.source=null,0!==X.length){ue>1&&console.time("clipping");var it,gt,Pt,_n,Nn,hn,zt=.5*se.buffer/se.extent,xr=.5-zt,Ut=.5+zt,ti=1+zt;it=gt=Pt=_n=null,Nn=Es(X,Ce,U-zt,U+Ut,0,De.minX,De.maxX,se),hn=Es(X,Ce,U+xr,U+ti,0,De.minX,De.maxX,se),X=null,Nn&&(it=Es(Nn,Ce,q-zt,q+Ut,1,De.minY,De.maxY,se),gt=Es(Nn,Ce,q+xr,q+ti,1,De.minY,De.maxY,se),Nn=null),hn&&(Pt=Es(hn,Ce,q-zt,q+Ut,1,De.minY,De.maxY,se),_n=Es(hn,Ce,q+xr,q+ti,1,De.minY,De.maxY,se),hn=null),ue>1&&console.timeEnd("clipping"),ae.push(it||[],z+1,2*U,2*q),ae.push(gt||[],z+1,2*U,2*q+1),ae.push(Pt||[],z+1,2*U+1,2*q),ae.push(_n||[],z+1,2*U+1,2*q+1)}}},je.prototype.getTile=function(X,z,U){var q=this.options,J=q.extent,ne=q.debug;if(X<0||X>24)return null;var de=1<<X,ae=Bt(X,z=(z%de+de)%de,U);if(this.tiles[ae])return ke(this.tiles[ae],J);ne>1&&console.log("drilling down to z%d-%d-%d",X,z,U);for(var se,ue=X,Ce=z,Se=U;!se&&ue>0;)ue--,Ce=Math.floor(Ce/2),Se=Math.floor(Se/2),se=this.tiles[Bt(ue,Ce,Se)];return se&&se.source?(ne>1&&console.log("found parent tile z%d-%d-%d",ue,Ce,Se),ne>1&&console.time("drilling down"),this.splitTile(se.source,ue,Ce,Se,X,z,U),ne>1&&console.timeEnd("drilling down"),this.tiles[ae]?ke(this.tiles[ae],J):null):null};class Ft extends bs{constructor(z,U,q,J){super(z,U,q),this._dataUpdateable=new Map,this.loadGeoJSON=(ne,de)=>{const{promoteId:ae}=ne;if(ne.request)return y.f(ne.request,(se,ue,Ce,Se)=>{this._dataUpdateable=Or(ue,ae)?oo(ue,ae):void 0,de(se,ue,Ce,Se)});if("string"==typeof ne.data)try{const se=JSON.parse(ne.data);this._dataUpdateable=Or(se,ae)?oo(se,ae):void 0,de(null,se)}catch{de(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`))}else ne.dataDiff?this._dataUpdateable?(function(se,ue,Ce){var Se,De,Je,Ct;if(ue.removeAll&&se.clear(),ue.remove)for(const it of ue.remove)se.delete(it);if(ue.add)for(const it of ue.add){const gt=Mt(it,Ce);null!=gt&&se.set(gt,it)}if(ue.update)for(const it of ue.update){let gt=se.get(it.id);if(null==gt)continue;const Pt=!it.removeAllProperties&&((null===(Se=it.removeProperties)||void 0===Se?void 0:Se.length)>0||(null===(De=it.addOrUpdateProperties)||void 0===De?void 0:De.length)>0);if((it.newGeometry||it.removeAllProperties||Pt)&&(gt=Object.assign({},gt),se.set(it.id,gt),Pt&&(gt.properties=Object.assign({},gt.properties))),it.newGeometry&&(gt.geometry=it.newGeometry),it.removeAllProperties)gt.properties={};else if((null===(Je=it.removeProperties)||void 0===Je?void 0:Je.length)>0)for(const _n of it.removeProperties)Object.prototype.hasOwnProperty.call(gt.properties,_n)&&delete gt.properties[_n];if((null===(Ct=it.addOrUpdateProperties)||void 0===Ct?void 0:Ct.length)>0)for(const{key:_n,value:Nn}of it.addOrUpdateProperties)gt.properties[_n]=Nn}}(this._dataUpdateable,ne.dataDiff,ae),de(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):de(new Error(`Cannot update existing geojson data in ${ne.source}`)):de(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,J&&(this.loadGeoJSON=J)}loadGeoJSONTile(z,U){const q=z.tileID.canonical;if(!this._geoJSONIndex)return U(null,null);const J=this._geoJSONIndex.getTile(q.z,q.x,q.y);if(!J)return U(null,null);const ne=new class{constructor(ae){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=y.N,this.length=ae.length,this._features=ae}feature(ae){return new class{constructor(se){this._feature=se,this.extent=y.N,this.type=se.type,this.properties=se.tags,"id"in se&&!isNaN(se.id)&&(this.id=parseInt(se.id,10))}loadGeometry(){if(1===this._feature.type){const se=[];for(const ue of this._feature.geometry)se.push([new y.P(ue[0],ue[1])]);return se}{const se=[];for(const ue of this._feature.geometry){const Ce=[];for(const Se of ue)Ce.push(new y.P(Se[0],Se[1]));se.push(Ce)}return se}}toGeoJSON(se,ue,Ce){return bl.call(this,se,ue,Ce)}}(this._features[ae])}}(J.features);let de=xl(ne);0===de.byteOffset&&de.byteLength===de.buffer.byteLength||(de=new Uint8Array(de)),U(null,{vectorTile:ne,rawData:de.buffer})}loadData(z,U){var q;null===(q=this._pendingRequest)||void 0===q||q.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const J=!!(z&&z.request&&z.request.collectResourceTiming)&&new y.bt(z.request);this._pendingCallback=U,this._pendingRequest=this.loadGeoJSON(z,(ne,de)=>{if(delete this._pendingCallback,delete this._pendingRequest,ne||!de)return U(ne);if("object"!=typeof de)return U(new Error(`Input data given to '${z.source}' is not a valid GeoJSON object.`));{bi(de,!0);try{if(z.filter){const se=y.bB(z.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===se.result)throw new Error(se.value.map(Ce=>`${Ce.key}: ${Ce.message}`).join(", "));de={type:"FeatureCollection",features:de.features.filter(Ce=>se.value.evaluate({zoom:0},Ce))}}this._geoJSONIndex=z.cluster?new Oa(function({superclusterOptions:se,clusterProperties:ue}){if(!ue||!se)return se;const Ce={},Se={},De={accumulated:null,zoom:0},Je={properties:null},Ct=Object.keys(ue);for(const it of Ct){const[gt,Pt]=ue[it],_n=y.bB(Pt),Nn=y.bB("string"==typeof gt?[gt,["accumulated"],["get",it]]:gt);Ce[it]=_n.value,Se[it]=Nn.value}return se.map=it=>{Je.properties=it;const gt={};for(const Pt of Ct)gt[Pt]=Ce[Pt].evaluate(De,Je);return gt},se.reduce=(it,gt)=>{Je.properties=gt;for(const Pt of Ct)De.accumulated=it[Pt],it[Pt]=Se[Pt].evaluate(De,Je)},se}(z)).load(de.features):new je(se=de,z.geojsonVtOptions)}catch(se){return U(se)}this.loaded={};const ae={};if(J){const se=J.finish();se&&(ae.resourceTiming={},ae.resourceTiming[z.source]=JSON.parse(JSON.stringify(se)))}U(null,ae)}var se})}reloadTile(z,U){const q=this.loaded;return q&&q[z.uid]?super.reloadTile(z,U):this.loadTile(z,U)}removeSource(z,U){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),U()}getClusterExpansionZoom(z,U){try{U(null,this._geoJSONIndex.getClusterExpansionZoom(z.clusterId))}catch(q){U(q)}}getClusterChildren(z,U){try{U(null,this._geoJSONIndex.getChildren(z.clusterId))}catch(q){U(q)}}getClusterLeaves(z,U){try{U(null,this._geoJSONIndex.getLeaves(z.clusterId,z.limit,z.offset))}catch(q){U(q)}}}class Do{constructor(z){this.self=z,this.actor=new y.C(z,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:bs,geojson:Ft},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(U,q)=>{if(this.workerSourceTypes[U])throw new Error(`Worker source with name "${U}" already registered.`);this.workerSourceTypes[U]=q},this.self.registerRTLTextPlugin=U=>{if(y.bC.isParsed())throw new Error("RTL text plugin already registered.");y.bC.applyArabicShaping=U.applyArabicShaping,y.bC.processBidirectionalText=U.processBidirectionalText,y.bC.processStyledBidirectionalText=U.processStyledBidirectionalText}}setReferrer(z,U){this.referrer=U}setImages(z,U,q){this.availableImages[z]=U;for(const J in this.workerSources[z]){const ne=this.workerSources[z][J];for(const de in ne)ne[de].availableImages=U}q()}setLayers(z,U,q){this.getLayerIndex(z).replace(U),q()}updateLayers(z,U,q){this.getLayerIndex(z).update(U.layers,U.removedIds),q()}loadTile(z,U,q){this.getWorkerSource(z,U.type,U.source).loadTile(U,q)}loadDEMTile(z,U,q){this.getDEMWorkerSource(z,U.source).loadTile(U,q)}reloadTile(z,U,q){this.getWorkerSource(z,U.type,U.source).reloadTile(U,q)}abortTile(z,U,q){this.getWorkerSource(z,U.type,U.source).abortTile(U,q)}removeTile(z,U,q){this.getWorkerSource(z,U.type,U.source).removeTile(U,q)}removeDEMTile(z,U){this.getDEMWorkerSource(z,U.source).removeTile(U)}removeSource(z,U,q){if(!this.workerSources[z]||!this.workerSources[z][U.type]||!this.workerSources[z][U.type][U.source])return;const J=this.workerSources[z][U.type][U.source];delete this.workerSources[z][U.type][U.source],void 0!==J.removeSource?J.removeSource(U,q):q()}loadWorkerSource(z,U,q){try{this.self.importScripts(U.url),q()}catch(J){q(J.toString())}}syncRTLPluginState(z,U,q){try{y.bC.setState(U);const J=y.bC.getPluginURL();if(y.bC.isLoaded()&&!y.bC.isParsed()&&null!=J){this.self.importScripts(J);const ne=y.bC.isParsed();q(ne?void 0:new Error(`RTL Text Plugin failed to import scripts from ${J}`),ne)}}catch(J){q(J.toString())}}getAvailableImages(z){let U=this.availableImages[z];return U||(U=[]),U}getLayerIndex(z){let U=this.layerIndexes[z];return U||(U=this.layerIndexes[z]=new ei),U}getWorkerSource(z,U,q){return this.workerSources[z]||(this.workerSources[z]={}),this.workerSources[z][U]||(this.workerSources[z][U]={}),this.workerSources[z][U][q]||(this.workerSources[z][U][q]=new this.workerSourceTypes[U]({send:(J,ne,de)=>{this.actor.send(J,ne,de,z)}},this.getLayerIndex(z),this.getAvailableImages(z))),this.workerSources[z][U][q]}getDEMWorkerSource(z,U){return this.demWorkerSources[z]||(this.demWorkerSources[z]={}),this.demWorkerSources[z][U]||(this.demWorkerSources[z][U]=new So),this.demWorkerSources[z][U]}}return y.i()&&(self.worker=new Do(self)),Do}),lc(0,function(y){class xe{static testProp(o){if(!xe.docStyle)return o[0];for(let u=0;u<o.length;u++)if(o[u]in xe.docStyle)return o[u];return o[0]}static create(o,u,p){const g=window.document.createElement(o);return void 0!==u&&(g.className=u),p&&p.appendChild(g),g}static createNS(o,u){return window.document.createElementNS(o,u)}static disableDrag(){xe.docStyle&&xe.selectProp&&(xe.userSelect=xe.docStyle[xe.selectProp],xe.docStyle[xe.selectProp]="none")}static enableDrag(){xe.docStyle&&xe.selectProp&&(xe.docStyle[xe.selectProp]=xe.userSelect)}static setTransform(o,u){o.style[xe.transformProp]=u}static addEventListener(o,u,p,g={}){o.addEventListener(u,p,"passive"in g?g:g.capture)}static removeEventListener(o,u,p,g={}){o.removeEventListener(u,p,"passive"in g?g:g.capture)}static suppressClickInternal(o){o.preventDefault(),o.stopPropagation(),window.removeEventListener("click",xe.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",xe.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",xe.suppressClickInternal,!0)},0)}static mousePos(o,u){const p=o.getBoundingClientRect();return new y.P(u.clientX-p.left-o.clientLeft,u.clientY-p.top-o.clientTop)}static touchPos(o,u){const p=o.getBoundingClientRect(),g=[];for(let x=0;x<u.length;x++)g.push(new y.P(u[x].clientX-p.left-o.clientLeft,u[x].clientY-p.top-o.clientTop));return g}static mouseButton(o){return o.button}static remove(o){o.parentNode&&o.parentNode.removeChild(o)}}xe.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,xe.selectProp=xe.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),xe.transformProp=xe.testProp(["transform","WebkitTransform"]);const Xr={supported:!1,testSupport:function(v){!bs&&ht&&(So?Us(v):Qi=v)}};let Qi,ht,bs=!1,So=!1;function Us(v){const o=v.createTexture();v.bindTexture(v.TEXTURE_2D,o);try{if(v.texImage2D(v.TEXTURE_2D,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,ht),v.isContextLost())return;Xr.supported=!0}catch{}v.deleteTexture(o),bs=!0}var Ji,bi,v;typeof document<"u"&&(ht=document.createElement("img"),ht.onload=function(){Qi&&Us(Qi),Qi=null,So=!0},ht.onerror=function(){bs=!0,Qi=null},ht.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(v){let o,u,p,g;v.resetRequestQueue=()=>{o=[],u=0,p=0,g={}},v.addThrottleControl=P=>{const k=p++;return g[k]=P,k},v.removeThrottleControl=P=>{delete g[P],T()},v.getImage=(P,k,O=!0)=>{Xr.supported&&(P.headers||(P.headers={}),P.headers.accept="image/webp,*/*");const V={requestParameters:P,supportImageRefresh:O,callback:k,cancelled:!1,completed:!1,cancel:()=>{V.completed||V.cancelled||(V.cancelled=!0,V.innerRequest&&(V.innerRequest.cancel(),u--),T())}};return o.push(V),T(),V};const x=P=>{const{requestParameters:k,supportImageRefresh:O,callback:V}=P;return y.e(k,{type:"image"}),(!1!==O||y.i()||y.g(k.url)||k.headers&&!Object.keys(k.headers).reduce((K,Z)=>K&&"accept"===Z,!0)?y.m:I)(k,(K,Z,Y,G)=>{S(P,V,K,Z,Y,G)})},S=(P,k,O,V,K,Z)=>{var Y,G;O?k(O):V instanceof HTMLImageElement||y.a(V)?k(null,V):V&&(Y=V,G=(Y,G)=>{null!=Y?k(Y):null!=G&&k(null,G,{cacheControl:K,expires:Z})},"function"==typeof createImageBitmap?y.b(Y,G):y.d(Y,G)),P.cancelled||(P.completed=!0,u--,T())},T=()=>{const P=(()=>{const k=Object.keys(g);let O=!1;if(k.length>0)for(const V of k)if(O=g[V](),O)break;return O})()?y.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:y.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let k=u;k<P&&o.length>0;k++){const O=o.shift();if(O.cancelled){k--;continue}const V=x(O);u++,O.innerRequest=V}},I=(P,k)=>{const O=new Image,V=P.url;let K=!1;const Z=P.credentials;return Z&&"include"===Z?O.crossOrigin="use-credentials":(Z&&"same-origin"===Z||!y.s(V))&&(O.crossOrigin="anonymous"),O.fetchPriority="high",O.onload=()=>{k(null,O),O.onerror=O.onload=null},O.onerror=()=>{K||k(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),O.onerror=O.onload=null},O.src=V,{cancel:()=>{K=!0,O.src=""}}}}(Ji||(Ji={})),Ji.resetRequestQueue(),(v=bi||(bi={})).Glyphs="Glyphs",v.Image="Image",v.Source="Source",v.SpriteImage="SpriteImage",v.SpriteJSON="SpriteJSON",v.Style="Style",v.Tile="Tile",v.Unknown="Unknown";class bl{constructor(o){this._transformRequestFn=o}transformRequest(o,u){return this._transformRequestFn&&this._transformRequestFn(o,u)||{url:o}}normalizeSpriteURL(o,u,p){const g=function(x){const S=x.match(xs);if(!S)throw new Error(`Unable to parse URL "${x}"`);return{protocol:S[1],authority:S[2],path:S[3]||"/",params:S[4]?S[4].split("&"):[]}}(o);return g.path+=`${u}${p}`,function(x){const S=x.params.length?`?${x.params.join("&")}`:"";return`${x.protocol}://${x.authority}${x.path}${S}`}(g)}setTransformRequest(o){this._transformRequestFn=o}}const xs=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function os(v){var o=new y.A(3);return o[0]=v[0],o[1]=v[1],o[2]=v[2],o}var ws,$e=function(v,o,u){return v[0]=o[0]-u[0],v[1]=o[1]-u[1],v[2]=o[2]-u[2],v};ws=new y.A(3),y.A!=Float32Array&&(ws[0]=0,ws[1]=0,ws[2]=0);var Ue=function(v){var o=v[0],u=v[1];return o*o+u*u};function He(v){const o=[];if("string"==typeof v)o.push({id:"default",url:v});else if(v&&v.length>0){const u=[];for(const{id:p,url:g}of v){const x=`${p}${g}`;-1===u.indexOf(x)&&(u.push(x),o.push({id:p,url:g}))}}return o}function yt(v,o,u,p,g){if(p)return void v(p);if(g!==Object.values(o).length||g!==Object.values(u).length)return;const x={};for(const S in o){x[S]={};const T=y.h.getImageCanvasContext(u[S]),I=o[S];for(const P in I){const{width:k,height:O,x:V,y:K,sdf:Z,pixelRatio:Y,stretchX:G,stretchY:le,content:ge}=I[P];x[S][P]={data:null,pixelRatio:Y,sdf:Z,stretchX:G,stretchY:le,content:ge,spriteData:{width:k,height:O,x:V,y:K,context:T}}}}v(null,x)}!function(){var v=new y.A(2);y.A!=Float32Array&&(v[0]=0,v[1]=0)}();class ot{constructor(o,u,p,g){this.context=o,this.format=p,this.texture=o.gl.createTexture(),this.update(u,g)}update(o,u,p){const{width:g,height:x}=o,S=!(this.size&&this.size[0]===g&&this.size[1]===x||p),{context:T}=this,{gl:I}=T;if(this.useMipmap=!(!u||!u.useMipmap),I.bindTexture(I.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===I.RGBA&&(!u||!1!==u.premultiply)),S)this.size=[g,x],o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||y.a(o)?I.texImage2D(I.TEXTURE_2D,0,this.format,this.format,I.UNSIGNED_BYTE,o):I.texImage2D(I.TEXTURE_2D,0,this.format,g,x,0,this.format,I.UNSIGNED_BYTE,o.data);else{const{x:P,y:k}=p||{x:0,y:0};o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||y.a(o)?I.texSubImage2D(I.TEXTURE_2D,0,P,k,I.RGBA,I.UNSIGNED_BYTE,o):I.texSubImage2D(I.TEXTURE_2D,0,P,k,g,x,I.RGBA,I.UNSIGNED_BYTE,o.data)}this.useMipmap&&this.isSizePowerOfTwo()&&I.generateMipmap(I.TEXTURE_2D)}bind(o,u,p){const{context:g}=this,{gl:x}=g;x.bindTexture(x.TEXTURE_2D,this.texture),p!==x.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=x.LINEAR),o!==this.filter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,o),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,p||o),this.filter=o),u!==this.wrap&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,u),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,u),this.wrap=u)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}function ln(v){const{userImage:o}=v;return!!(o&&o.render&&o.render())&&(v.data.replace(new Uint8Array(o.data.buffer)),!0)}class Dt extends y.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new y.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:u,callback:p}of this.requestors)this._notify(u,p);this.requestors=[]}}getImage(o){const u=this.images[o];if(u&&!u.data&&u.spriteData){const p=u.spriteData;u.data=new y.R({width:p.width,height:p.height},p.context.getImageData(p.x,p.y,p.width,p.height).data),u.spriteData=null}return u}addImage(o,u){if(this.images[o])throw new Error(`Image id ${o} already exist, use updateImage instead`);this._validate(o,u)&&(this.images[o]=u)}_validate(o,u){let p=!0;const g=u.data||u.spriteData;return this._validateStretch(u.stretchX,g&&g.width)||(this.fire(new y.j(new Error(`Image "${o}" has invalid "stretchX" value`))),p=!1),this._validateStretch(u.stretchY,g&&g.height)||(this.fire(new y.j(new Error(`Image "${o}" has invalid "stretchY" value`))),p=!1),this._validateContent(u.content,u)||(this.fire(new y.j(new Error(`Image "${o}" has invalid "content" value`))),p=!1),p}_validateStretch(o,u){if(!o)return!0;let p=0;for(const g of o){if(g[0]<p||g[1]<g[0]||u<g[1])return!1;p=g[1]}return!0}_validateContent(o,u){if(!o)return!0;if(4!==o.length)return!1;const p=u.spriteData,g=p&&p.width||u.data.width,x=p&&p.height||u.data.height;return!(o[0]<0||g<o[0]||o[1]<0||x<o[1]||o[2]<0||g<o[2]||o[3]<0||x<o[3]||o[2]<o[0]||o[3]<o[1])}updateImage(o,u,p=!0){const g=this.getImage(o);if(p&&(g.data.width!==u.data.width||g.data.height!==u.data.height))throw new Error(`size mismatch between old image (${g.data.width}x${g.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=g.version+1,this.images[o]=u,this.updatedImages[o]=!0}removeImage(o){const u=this.images[o];delete this.images[o],delete this.patterns[o],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,u){let p=!0;if(!this.isLoaded())for(const g of o)this.images[g]||(p=!1);this.isLoaded()||p?this._notify(o,u):this.requestors.push({ids:o,callback:u})}_notify(o,u){const p={};for(const g of o){let x=this.getImage(g);x||(this.fire(new y.k("styleimagemissing",{id:g})),x=this.getImage(g)),x?p[g]={data:x.data.clone(),pixelRatio:x.pixelRatio,sdf:x.sdf,version:x.version,stretchX:x.stretchX,stretchY:x.stretchY,content:x.content,hasRenderCallback:!(!x.userImage||!x.userImage.render)}:y.w(`Image "${g}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}u(null,p)}getPixelSize(){const{width:o,height:u}=this.atlasImage;return{width:o,height:u}}getPattern(o){const u=this.patterns[o],p=this.getImage(o);if(!p)return null;if(u&&u.position.version===p.version)return u.position;if(u)u.position.version=p.version;else{const g={w:p.data.width+2,h:p.data.height+2,x:0,y:0},x=new y.I(g,p);this.patterns[o]={bin:g,position:x}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const u=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ot(o,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const x in this.patterns)o.push(this.patterns[x].bin);const{w:u,h:p}=y.p(o),g=this.atlasImage;g.resize({width:u||1,height:p||1});for(const x in this.patterns){const{bin:S}=this.patterns[x],T=S.x+1,I=S.y+1,P=this.getImage(x).data,k=P.width,O=P.height;y.R.copy(P,g,{x:0,y:0},{x:T,y:I},{width:k,height:O}),y.R.copy(P,g,{x:0,y:O-1},{x:T,y:I-1},{width:k,height:1}),y.R.copy(P,g,{x:0,y:0},{x:T,y:I+O},{width:k,height:1}),y.R.copy(P,g,{x:k-1,y:0},{x:T-1,y:I},{width:1,height:O}),y.R.copy(P,g,{x:0,y:0},{x:T+k,y:I},{width:1,height:O})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const u of o){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const p=this.getImage(u);p||y.w(`Image with ID: "${u}" was not found`),ln(p)&&this.updateImage(u,p)}}}const ki=1e20;function fi(v,o,u,p,g,x,S,T,I){for(let P=o;P<o+p;P++)br(v,u*x+P,x,g,S,T,I);for(let P=u;P<u+g;P++)br(v,P*x+o,1,p,S,T,I)}function br(v,o,u,p,g,x,S){x[0]=0,S[0]=-ki,S[1]=ki,g[0]=v[o];for(let T=1,I=0,P=0;T<p;T++){g[T]=v[o+T*u];const k=T*T;do{const O=x[I];P=(g[T]-g[O]+k-O*O)/(T-O)/2}while(P<=S[I]&&--I>-1);I++,x[I]=T,S[I]=P,S[I+1]=ki}for(let T=0,I=0;T<p;T++){for(;S[I+1]<T;)I++;const P=x[I],k=T-P;v[o+T*u]=g[P]+k*k}}class as{constructor(o,u){this.requestManager=o,this.localIdeographFontFamily=u,this.entries={}}setURL(o){this.url=o}getGlyphs(o,u){const p=[];for(const g in o)for(const x of o[g])p.push({stack:g,id:x});y.o(p,({stack:g,id:x},S)=>{let T=this.entries[g];T||(T=this.entries[g]={glyphs:{},requests:{},ranges:{}});let I=T.glyphs[x];if(void 0!==I)return void S(null,{stack:g,id:x,glyph:I});if(I=this._tinySDF(T,g,x),I)return T.glyphs[x]=I,void S(null,{stack:g,id:x,glyph:I});const P=Math.floor(x/256);if(256*P>65535)return void S(new Error("glyphs > 65535 not supported"));if(T.ranges[P])return void S(null,{stack:g,id:x,glyph:I});if(!this.url)return void S(new Error("glyphsUrl is not set"));let k=T.requests[P];k||(k=T.requests[P]=[],as.loadGlyphRange(g,P,this.url,this.requestManager,(O,V)=>{if(V){for(const K in V)this._doesCharSupportLocalGlyph(+K)||(T.glyphs[+K]=V[+K]);T.ranges[P]=!0}for(const K of k)K(O,V);delete T.requests[P]})),k.push((O,V)=>{O?S(O):V&&S(null,{stack:g,id:x,glyph:V[x]||null})})},(g,x)=>{if(g)u(g);else if(x){const S={};for(const{stack:T,id:I,glyph:P}of x)(S[T]||(S[T]={}))[I]=P&&{id:P.id,bitmap:P.bitmap.clone(),metrics:P.metrics};u(null,S)}})}_doesCharSupportLocalGlyph(o){return!!this.localIdeographFontFamily&&(y.u["CJK Unified Ideographs"](o)||y.u["Hangul Syllables"](o)||y.u.Hiragana(o)||y.u.Katakana(o))}_tinySDF(o,u,p){const g=this.localIdeographFontFamily;if(!g||!this._doesCharSupportLocalGlyph(p))return;let x=o.tinySDF;if(!x){let T="400";/bold/i.test(u)?T="900":/medium/i.test(u)?T="500":/light/i.test(u)&&(T="200"),x=o.tinySDF=new as.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:g,fontWeight:T})}const S=x.draw(String.fromCharCode(p));return{id:p,bitmap:new y.q({width:S.width||60,height:S.height||60},S.data),metrics:{width:S.glyphWidth/2||24,height:S.glyphHeight/2||24,left:S.glyphLeft/2+.5||0,top:S.glyphTop/2-27.5||-8,advance:S.glyphAdvance/2||24,isDoubleResolution:!0}}}}as.loadGlyphRange=function(v,o,u,p,g){const x=256*o,S=x+255,T=p.transformRequest(u.replace("{fontstack}",v).replace("{range}",`${x}-${S}`),bi.Glyphs);y.l(T,(I,P)=>{if(I)g(I);else if(P){const k={};for(const O of y.n(P))k[O.id]=O;g(null,k)}})},as.TinySDF=class{constructor({fontSize:v=24,buffer:o=3,radius:u=8,cutoff:p=.25,fontFamily:g="sans-serif",fontWeight:x="normal",fontStyle:S="normal"}={}){this.buffer=o,this.cutoff=p,this.radius=u;const T=this.size=v+4*o,I=this._createCanvas(T),P=this.ctx=I.getContext("2d",{willReadFrequently:!0});P.font=`${S} ${x} ${v}px ${g}`,P.textBaseline="alphabetic",P.textAlign="left",P.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(v){const o=document.createElement("canvas");return o.width=o.height=v,o}draw(v){const{width:o,actualBoundingBoxAscent:u,actualBoundingBoxDescent:p,actualBoundingBoxLeft:g,actualBoundingBoxRight:x}=this.ctx.measureText(v),S=Math.ceil(u),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(x-g))),I=Math.min(this.size-this.buffer,S+Math.ceil(p)),P=T+2*this.buffer,k=I+2*this.buffer,O=Math.max(P*k,0),V=new Uint8ClampedArray(O),K={data:V,width:P,height:k,glyphWidth:T,glyphHeight:I,glyphTop:S,glyphLeft:0,glyphAdvance:o};if(0===T||0===I)return K;const{ctx:Z,buffer:Y,gridInner:G,gridOuter:le}=this;Z.clearRect(Y,Y,T,I),Z.fillText(v,Y,Y+S);const ge=Z.getImageData(Y,Y,T,I);le.fill(ki,0,O),G.fill(0,0,O);for(let ie=0;ie<I;ie++)for(let he=0;he<T;he++){const _e=ge.data[4*(ie*T+he)+3]/255;if(0===_e)continue;const be=(ie+Y)*P+he+Y;if(1===_e)le[be]=0,G[be]=ki;else{const Ee=.5-_e;le[be]=Ee>0?Ee*Ee:0,G[be]=Ee<0?Ee*Ee:0}}fi(le,0,0,P,k,P,this.f,this.v,this.z),fi(G,Y,Y,T,I,P,this.f,this.v,this.z);for(let ie=0;ie<O;ie++){const he=Math.sqrt(le[ie])-Math.sqrt(G[ie]);V[ie]=Math.round(255-255*(he/this.radius+this.cutoff))}return K}};class ji{constructor(){this.specification=y.v.light.position}possiblyEvaluate(o,u){return y.z(o.expression.evaluate(u))}interpolate(o,u,p){return{x:y.B.number(o.x,u.x,p),y:y.B.number(o.y,u.y,p),z:y.B.number(o.z,u.z,p)}}}let ka;class xl extends y.E{constructor(o){super(),ka=ka||new y.r({anchor:new y.D(y.v.light.anchor),position:new ji,color:new y.D(y.v.light.color),intensity:new y.D(y.v.light.intensity)}),this._transitionable=new y.T(ka),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,u={}){if(!this._validate(y.t,o,u))for(const p in o){const g=o[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),g):this._transitionable.setValue(p,g)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,u,p){return(!p||!1!==p.validate)&&y.x(this,o.call(y.y,y.e({value:u,style:{glyphs:!0,sprite:!0},styleSpec:y.v})))}}class pi{constructor(o,u){this.width=o,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(o,u){const p=o.join(",")+String(u);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(o,u)),this.dashEntry[p]}getDashRanges(o,u,p){const g=[];let x=o.length%2==1?-o[o.length-1]*p:0,S=o[0]*p,T=!0;g.push({left:x,right:S,isDash:T,zeroLength:0===o[0]});let I=o[0];for(let P=1;P<o.length;P++){T=!T;const k=o[P];x=I*p,I+=k,S=I*p,g.push({left:x,right:S,isDash:T,zeroLength:0===k})}return g}addRoundDash(o,u,p){const g=u/2;for(let x=-p;x<=p;x++){const S=this.width*(this.nextRow+p+x);let T=0,I=o[T];for(let P=0;P<this.width;P++){P/I.right>1&&(I=o[++T]);const k=Math.abs(P-I.left),O=Math.abs(P-I.right),V=Math.min(k,O);let K;const Z=x/p*(g+1);if(I.isDash){const Y=g-Math.abs(Z);K=Math.sqrt(V*V+Y*Y)}else K=g-Math.sqrt(V*V+Z*Z);this.data[S+P]=Math.max(0,Math.min(255,K+128))}}}addRegularDash(o){for(let T=o.length-1;T>=0;--T){const I=o[T],P=o[T+1];I.zeroLength?o.splice(T,1):P&&P.isDash===I.isDash&&(P.left=I.left,o.splice(T,1))}const u=o[0],p=o[o.length-1];u.isDash===p.isDash&&(u.left=p.left-this.width,p.right=u.right+this.width);const g=this.width*this.nextRow;let x=0,S=o[x];for(let T=0;T<this.width;T++){T/S.right>1&&(S=o[++x]);const I=Math.abs(T-S.left),P=Math.abs(T-S.right),k=Math.min(I,P);this.data[g+T]=Math.max(0,Math.min(255,(S.isDash?k:-k)+128))}}addDash(o,u){const p=u?7:0,g=2*p+1;if(this.nextRow+g>this.height)return y.w("LineAtlas out of space"),null;let x=0;for(let T=0;T<o.length;T++)x+=o[T];if(0!==x){const T=this.width/x,I=this.getDashRanges(o,this.width,T);u?this.addRoundDash(I,T,p):this.addRegularDash(I)}const S={y:(this.nextRow+p+.5)/this.height,height:2*p/this.height,width:x};return this.nextRow+=g,this.dirty=!0,S}bind(o){const u=o.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}class wl{constructor(o,u,p){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=p;const g=this.workerPool.acquire(p);for(let x=0;x<g.length;x++){const S=new y.C(g[x],u,p);S.name=`Worker ${x}`,this.actors.push(S)}if(!this.actors.length)throw new Error("No actors found")}broadcast(o,u,p){y.o(this.actors,(g,x)=>{g.send(o,u,x)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(o=!0){this.actors.forEach(u=>{u.remove()}),this.actors=[],o&&this.workerPool.release(this.id)}}function ro(v,o,u){const p=function(g,x){if(g)return u(g);if(x){const S=y.F(y.e(x,v),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);x.vector_layers&&(S.vectorLayers=x.vector_layers,S.vectorLayerIds=S.vectorLayers.map(T=>T.id)),u(null,S)}};return v.url?y.f(o.transformRequest(v.url,bi.Source),p):y.h.frame(()=>p(null,v))}class Gn{constructor(o,u){o&&(u?this.setSouthWest(o).setNorthEast(u):Array.isArray(o)&&(4===o.length?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1])))}setNorthEast(o){return this._ne=o instanceof y.L?new y.L(o.lng,o.lat):y.L.convert(o),this}setSouthWest(o){return this._sw=o instanceof y.L?new y.L(o.lng,o.lat):y.L.convert(o),this}extend(o){const u=this._sw,p=this._ne;let g,x;if(o instanceof y.L)g=o,x=o;else{if(!(o instanceof Gn))return Array.isArray(o)?4===o.length||o.every(Array.isArray)?this.extend(Gn.convert(o)):this.extend(y.L.convert(o)):o&&("lng"in o||"lon"in o)&&"lat"in o?this.extend(y.L.convert(o)):this;if(g=o._sw,x=o._ne,!g||!x)return this}return u||p?(u.lng=Math.min(g.lng,u.lng),u.lat=Math.min(g.lat,u.lat),p.lng=Math.max(x.lng,p.lng),p.lat=Math.max(x.lat,p.lat)):(this._sw=new y.L(g.lng,g.lat),this._ne=new y.L(x.lng,x.lat)),this}getCenter(){return new y.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new y.L(this.getWest(),this.getNorth())}getSouthEast(){return new y.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:u,lat:p}=y.L.convert(o);let g=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&g}static convert(o){return o instanceof Gn?o:o&&new Gn(o)}static fromLngLat(o,u=0){const p=360*u/40075017,g=p/Math.cos(Math.PI/180*o.lat);return new Gn(new y.L(o.lng-g,o.lat-p),new y.L(o.lng+g,o.lat+p))}}class Yr{constructor(o,u,p){this.bounds=Gn.convert(this.validateBounds(o)),this.minzoom=u||0,this.maxzoom=p||24}validateBounds(o){return Array.isArray(o)&&4===o.length?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const u=Math.pow(2,o.z),p=Math.floor(y.G(this.bounds.getWest())*u),g=Math.floor(y.H(this.bounds.getNorth())*u),x=Math.ceil(y.G(this.bounds.getEast())*u),S=Math.ceil(y.H(this.bounds.getSouth())*u);return o.x>=p&&o.x<x&&o.y>=g&&o.y<S}}class er extends y.E{constructor(o,u,p,g){if(super(),this.load=()=>{this._loaded=!1,this.fire(new y.k("dataloading",{dataType:"source"})),this._tileJSONRequest=ro(this._options,this.map._requestManager,(x,S)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),x?this.fire(new y.j(x)):S&&(y.e(this,S),S.bounds&&(this.tileBounds=new Yr(S.bounds,this.minzoom,this.maxzoom)),this.fire(new y.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new y.k("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>y.e({},this._options),this.id=o,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,y.e(this,y.F(u,["url","scheme","tileSize","promoteId"])),this._options=y.e({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(g)}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(o,u){const p=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),g={request:this.map._requestManager.transformRequest(p,bi.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function x(S,T){return delete o.request,o.aborted?u(null):S&&404!==S.status?u(S):(T&&T.resourceTiming&&(o.resourceTiming=T.resourceTiming),this.map._refreshExpiredTiles&&T&&o.setExpiryData(T),o.loadVectorData(T,this.map.painter),u(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}g.request.collectResourceTiming=this._collectResourceTiming,o.actor&&"expired"!==o.state?"loading"===o.state?o.reloadCallback=u:o.request=o.actor.send("reloadTile",g,x.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",g,x.bind(this)))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)}unloadTile(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class Oa extends y.E{constructor(o,u,p,g){super(),this.id=o,this.dispatcher=p,this.setEventedParent(g),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=y.e({type:"raster"},u),y.e(this,y.F(u,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new y.k("dataloading",{dataType:"source"})),this._tileJSONRequest=ro(this._options,this.map._requestManager,(o,u)=>{this._tileJSONRequest=null,this._loaded=!0,o?this.fire(new y.j(o)):u&&(y.e(this,u),u.bounds&&(this.tileBounds=new Yr(u.bounds,this.minzoom,this.maxzoom)),this.fire(new y.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new y.k("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}serialize(){return y.e({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,u){const p=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);o.request=Ji.getImage(this.map._requestManager.transformRequest(p,bi.Tile),(g,x,S)=>{if(delete o.request,o.aborted)o.state="unloaded",u(null);else if(g)o.state="errored",u(g);else if(x){this.map._refreshExpiredTiles&&S&&o.setExpiryData(S);const T=this.map.painter.context,I=T.gl;o.texture=this.map.painter.getTileTexture(x.width),o.texture?o.texture.update(x,{useMipmap:!0}):(o.texture=new ot(T,x,I.RGBA,{useMipmap:!0}),o.texture.bind(I.LINEAR,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST),T.extTextureFilterAnisotropic&&I.texParameterf(I.TEXTURE_2D,T.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,T.extTextureFilterAnisotropicMax)),o.state="loaded",u(null)}},this.map._refreshExpiredTiles)}abortTile(o,u){o.request&&(o.request.cancel(),delete o.request),u()}unloadTile(o,u){o.texture&&this.map.painter.saveTileTexture(o.texture),u()}hasTransition(){return!1}}class Na extends Oa{constructor(o,u,p,g){super(o,u,p,g),this.type="raster-dem",this.maxzoom=22,this._options=y.e({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox",this.redFactor=u.redFactor,this.greenFactor=u.greenFactor,this.blueFactor=u.blueFactor,this.baseShift=u.baseShift}loadTile(o,u){const p=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),g=this.map._requestManager.transformRequest(p,bi.Tile);function x(S,T){S&&(o.state="errored",u(S)),T&&(o.dem=T,o.needsHillshadePrepare=!0,o.needsTerrainPrepare=!0,o.state="loaded",u(null))}o.neighboringTiles=this._getNeighboringTiles(o.tileID),o.request=Ji.getImage(g,(S,T,I)=>y._(this,void 0,void 0,function*(){if(delete o.request,o.aborted)o.state="unloaded",u(null);else if(S)o.state="errored",u(S);else if(T){this.map._refreshExpiredTiles&&o.setExpiryData(I);const P=y.a(T)&&y.J()?T:yield function(O){return y._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&y.K()){const V=O.width+2,K=O.height+2;try{return new y.R({width:V,height:K},yield y.M(O,-1,-1,V,K))}catch{}}return y.h.getImageData(O,1)})}(T),k={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:P,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};o.actor&&"expired"!==o.state||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",k,x))}}),this.map._refreshExpiredTiles)}_getNeighboringTiles(o){const u=o.canonical,p=Math.pow(2,u.z),g=(u.x-1+p)%p,x=0===u.x?o.wrap-1:o.wrap,S=(u.x+1+p)%p,T=u.x+1===p?o.wrap+1:o.wrap,I={};return I[new y.O(o.overscaledZ,x,u.z,g,u.y).key]={backfilled:!1},I[new y.O(o.overscaledZ,T,u.z,S,u.y).key]={backfilled:!1},u.y>0&&(I[new y.O(o.overscaledZ,x,u.z,g,u.y-1).key]={backfilled:!1},I[new y.O(o.overscaledZ,o.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},I[new y.O(o.overscaledZ,T,u.z,S,u.y-1).key]={backfilled:!1}),u.y+1<p&&(I[new y.O(o.overscaledZ,x,u.z,g,u.y+1).key]={backfilled:!1},I[new y.O(o.overscaledZ,o.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},I[new y.O(o.overscaledZ,T,u.z,S,u.y+1).key]={backfilled:!1}),I}unloadTile(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})}}class Wn extends y.E{constructor(o,u,p,g){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>y.e({},this._options,{type:this.type,data:this._data}),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=p.getActor(),this.setEventedParent(g),this._data=u.data,this._options=y.e({},u),this._collectResourceTiming=u.collectResourceTiming,void 0!==u.maxzoom&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;const x=y.N/this.tileSize;this.workerOptions=y.e({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(void 0!==u.buffer?u.buffer:128)*x,tolerance:(void 0!==u.tolerance?u.tolerance:.375)*x,extent:y.N,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:void 0!==u.clusterMaxZoom?u.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:y.N,radius:(u.clusterRadius||50)*x,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}onAdd(o){this.map=o,this.load()}setData(o){return this._data=o,this._updateWorkerData(),this}updateData(o){return this._updateWorkerData(o),this}setClusterOptions(o){return this.workerOptions.cluster=o.cluster,o&&(void 0!==o.clusterRadius&&(this.workerOptions.superclusterOptions.radius=o.clusterRadius),void 0!==o.clusterMaxZoom&&(this.workerOptions.superclusterOptions.maxZoom=o.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(o,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},u),this}getClusterChildren(o,u){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},u),this}getClusterLeaves(o,u,p,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:u,offset:p},g),this}_updateWorkerData(o){const u=y.e({},this.workerOptions);o?u.dataDiff=o:"string"==typeof this._data?(u.request=this.map._requestManager.transformRequest(y.h.resolveURL(this._data),bi.Source),u.request.collectResourceTiming=this._collectResourceTiming):u.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new y.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,u,(p,g)=>{if(this._pendingLoads--,this._removed||g&&g.abandoned)return void this.fire(new y.k("dataabort",{dataType:"source"}));let x=null;if(g&&g.resourceTiming&&g.resourceTiming[this.id]&&(x=g.resourceTiming[this.id].slice(0)),p)return void this.fire(new y.j(p));const S={dataType:"source"};this._collectResourceTiming&&x&&x.length>0&&y.e(S,{resourceTiming:x}),this.fire(new y.k("data",Object.assign(Object.assign({},S),{sourceDataType:"metadata"}))),this.fire(new y.k("data",Object.assign(Object.assign({},S),{sourceDataType:"content"})))})}loaded(){return 0===this._pendingLoads}loadTile(o,u){const p=o.actor?"reloadTile":"loadTile";o.actor=this.actor;const g={type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};o.request=this.actor.send(p,g,(x,S)=>(delete o.request,o.unloadVectorData(),o.aborted?u(null):x?u(x):(o.loadVectorData(S,this.map.painter,"reloadTile"===p),u(null))))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0}unloadTile(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var kn=y.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Cs extends y.E{constructor(o,u,p,g){super(),this.load=(x,S)=>{this._loaded=!1,this.fire(new y.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=Ji.getImage(this.map._requestManager.transformRequest(this.url,bi.Image),(T,I)=>{this._request=null,this._loaded=!0,T?this.fire(new y.j(T)):I&&(this.image=I,x&&(this.coordinates=x),S&&S(),this._finishLoading())})},this.prepare=()=>{if(0===Object.keys(this.tiles).length||!this.image)return;const x=this.map.painter.context,S=x.gl;this.boundsBuffer||(this.boundsBuffer=x.createVertexBuffer(this._boundsArray,kn.members)),this.boundsSegments||(this.boundsSegments=y.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new ot(x,this.image,S.RGBA),this.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE));let T=!1;for(const I in this.tiles){const P=this.tiles[I];"loaded"!==P.state&&(P.state="loaded",P.texture=this.texture,T=!0)}T&&this.fire(new y.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=o,this.dispatcher=p,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(g),this.options=u}loaded(){return this._loaded}updateImage(o){return o.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=o.url,this.load(o.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new y.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(o){this.coordinates=o;const u=o.map(y.U.fromLngLat);this.tileID=function(g){let x=1/0,S=1/0,T=-1/0,I=-1/0;for(const V of g)x=Math.min(x,V.x),S=Math.min(S,V.y),T=Math.max(T,V.x),I=Math.max(I,V.y);const P=Math.max(T-x,I-S),k=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),O=Math.pow(2,k);return new y.W(k,Math.floor((x+T)/2*O),Math.floor((S+I)/2*O))}(u),this.minzoom=this.maxzoom=this.tileID.z;const p=u.map(g=>this.tileID.getTilePoint(g)._round());return this._boundsArray=new y.V,this._boundsArray.emplaceBack(p[0].x,p[0].y,0,0),this._boundsArray.emplaceBack(p[1].x,p[1].y,y.N,0),this._boundsArray.emplaceBack(p[3].x,p[3].y,0,y.N),this._boundsArray.emplaceBack(p[2].x,p[2].y,y.N,y.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new y.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(o,u){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},u(null)):(o.state="errored",u(null))}hasTransition(){return!1}}class pn extends Cs{constructor(o,u,p,g){super(o,u,p,g),this.load=()=>{this._loaded=!1;const x=this.options;this.urls=[];for(const S of x.urls)this.urls.push(this.map._requestManager.transformRequest(S,bi.Source).url);y.X(this.urls,(S,T)=>{this._loaded=!0,S?this.fire(new y.j(S)):T&&(this.video=T,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const x=this.map.painter.context,S=x.gl;this.boundsBuffer||(this.boundsBuffer=x.createVertexBuffer(this._boundsArray,kn.members)),this.boundsSegments||(this.boundsSegments=y.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE),S.texSubImage2D(S.TEXTURE_2D,0,0,0,S.RGBA,S.UNSIGNED_BYTE,this.video)):(this.texture=new ot(x,this.video,S.RGBA),this.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE));let T=!1;for(const I in this.tiles){const P=this.tiles[I];"loaded"!==P.state&&(P.state="loaded",P.texture=this.texture,T=!0)}T&&this.fire(new y.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=u}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const u=this.video.seekable;o<u.start(0)||o>u.end(0)?this.fire(new y.j(new y.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class so extends Cs{constructor(o,u,p,g){super(o,u,p,g),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new y.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let x=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,x=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,x=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const S=this.map.painter.context,T=S.gl;this.boundsBuffer||(this.boundsBuffer=S.createVertexBuffer(this._boundsArray,kn.members)),this.boundsSegments||(this.boundsSegments=y.S.simpleSegment(0,0,4,2)),this.texture?(x||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ot(S,this.canvas,T.RGBA,{premultiply:!0});let I=!1;for(const P in this.tiles){const k=this.tiles[P];"loaded"!==k.state&&(k.state="loaded",k.texture=this.texture,I=!0)}I&&this.fire(new y.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),u.coordinates?Array.isArray(u.coordinates)&&4===u.coordinates.length&&!u.coordinates.some(x=>!Array.isArray(x)||2!==x.length||x.some(S=>"number"!=typeof S))||this.fire(new y.j(new y.Y(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new y.j(new y.Y(`sources.${o}`,null,'missing required property "coordinates"'))),u.animate&&"boolean"!=typeof u.animate&&this.fire(new y.j(new y.Y(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),u.canvas?"string"==typeof u.canvas||u.canvas instanceof HTMLCanvasElement||this.fire(new y.j(new y.Y(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new y.j(new y.Y(`sources.${o}`,null,'missing required property "canvas"'))),this.options=u,this.animate=void 0===u.animate||u.animate}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}}const cc={},Vs=v=>{switch(v){case"geojson":return Wn;case"image":return Cs;case"raster":return Oa;case"raster-dem":return Na;case"vector":return er;case"video":return pn;case"canvas":return so}return cc[v]};function Cl(v,o){const u=y.Z();return y.$(u,u,[1,1,0]),y.a0(u,u,[.5*v.width,.5*v.height,1]),y.a1(u,u,v.calculatePosMatrix(o.toUnwrapped()))}function Fa(v,o,u,p,g,x){const S=function(O,V,K){if(O)for(const Z of O){const Y=V[Z];if(Y&&Y.source===K&&"fill-extrusion"===Y.type)return!0}else for(const Z in V){const Y=V[Z];if(Y.source===K&&"fill-extrusion"===Y.type)return!0}return!1}(g&&g.layers,o,v.id),T=x.maxPitchScaleFactor(),I=v.tilesIn(p,T,S);I.sort(na);const P=[];for(const O of I)P.push({wrappedTileID:O.tileID.wrapped().key,queryResults:O.tile.queryRenderedFeatures(o,u,v._state,O.queryGeometry,O.cameraQueryGeometry,O.scale,g,x,T,Cl(v.transform,O.tileID))});const k=function(O){const V={},K={};for(const Z of O){const Y=Z.queryResults,G=Z.wrappedTileID,le=K[G]=K[G]||{};for(const ge in Y){const ie=Y[ge],he=le[ge]=le[ge]||{},_e=V[ge]=V[ge]||[];for(const be of ie)he[be.featureIndex]||(he[be.featureIndex]=!0,_e.push(be))}}return V}(P);for(const O in k)k[O].forEach(V=>{const K=V.feature,Z=v.getFeatureState(K.layer["source-layer"],K.id);K.source=K.layer.source,K.layer["source-layer"]&&(K.sourceLayer=K.layer["source-layer"]),K.state=Z});return k}function na(v,o){const u=v.tileID,p=o.tileID;return u.overscaledZ-p.overscaledZ||u.canonical.y-p.canonical.y||u.wrap-p.wrap||u.canonical.x-p.canonical.x}class za{constructor(o,u){this.timeAdded=0,this.fadeEndTime=0,this.tileID=o,this.uid=y.a2(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(o){const u=o+this.timeAdded;u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(o){this.demTexture&&o.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(o,u,p){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(g,x){const S={};if(!x)return S;for(const T of g){const I=T.layerIds.map(P=>x.getLayer(P)).filter(Boolean);if(0!==I.length){T.layers=I,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map(P=>I.filter(k=>k.id===P)[0]));for(const P of I)S[P.id]=T}}return S}(o.buckets,u.style),this.hasSymbolBuckets=!1;for(const g in this.buckets){const x=this.buckets[g];if(x instanceof y.a4){if(this.hasSymbolBuckets=!0,!p)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const g in this.buckets){const x=this.buckets[g];if(x instanceof y.a4&&x.hasRTLText){this.hasRTLText=!0,y.a5();break}}this.queryPadding=0;for(const g in this.buckets){const x=this.buckets[g];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(g).queryRadius(x))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage)}else this.collisionBoxArray=new y.a3}unloadVectorData(){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(o){return this.buckets[o.id]}upload(o){for(const p in this.buckets){const g=this.buckets[p];g.uploadPending()&&g.upload(o)}const u=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ot(o,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ot(o,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,u,p,g,x,S,T,I,P,k){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:g,cameraQueryGeometry:x,scale:S,tileSize:this.tileSize,pixelPosMatrix:k,transform:I,params:T,queryPadding:this.queryPadding*P},o,u,p):{}}querySourceFeatures(o,u){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const g=p.loadVTLayers(),x=u&&u.sourceLayer?u.sourceLayer:"",S=g._geojsonTileLayer||g[x];if(!S)return;const T=y.a6(u&&u.filter),{z:I,x:P,y:k}=this.tileID.canonical,O={z:I,x:P,y:k};for(let V=0;V<S.length;V++){const K=S.feature(V);if(T.needGeometry){const G=y.a7(K,!0);if(!T.filter(new y.a8(this.tileID.overscaledZ),G,this.tileID.canonical))continue}else if(!T.filter(new y.a8(this.tileID.overscaledZ),K))continue;const Z=p.getId(K,x),Y=new y.a9(K,I,P,k,Z);Y.tile=O,o.push(Y)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const u=this.expirationTime;if(o.cacheControl){const p=y.aa(o.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const p=Date.now();let g=!1;if(this.expirationTime>p)g=!1;else if(u)if(this.expirationTime<u)g=!0;else{const x=this.expirationTime-u;x?this.expirationTime=p+Math.max(x,3e4):g=!0}else g=!0;g?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(o,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(o).length)return;const p=this.latestFeatureIndex.loadVTLayers();for(const g in this.buckets){if(!u.style.hasLayer(g))continue;const x=this.buckets[g],S=x.layers[0].sourceLayer||"_geojsonTileLayer",T=p[S],I=o[S];if(!T||!I||0===Object.keys(I).length)continue;x.update(I,T,this.imageAtlas&&this.imageAtlas.patternPositions||{});const P=u&&u.style&&u.style.getLayer(g);P&&(this.queryPadding=Math.max(this.queryPadding,P.queryRadius(x)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<y.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=y.h.now()+o}setDependencies(o,u){const p={};for(const g of u)p[g]=!0;this.dependencies[o]=p}hasDependency(o,u){for(const p of o){const g=this.dependencies[p];if(g)for(const x of u)if(g[x])return!0}return!1}}class El{constructor(o,u){this.max=o,this.onRemove=u,this.reset()}reset(){for(const o in this.data)for(const u of this.data[o])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(o,u,p){const g=o.wrapped().key;void 0===this.data[g]&&(this.data[g]=[]);const x={value:u,timeout:void 0};if(void 0!==p&&(x.timeout=setTimeout(()=>{this.remove(o,x)},p)),this.data[g].push(x),this.order.push(g),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const u=this.data[o].shift();return u.timeout&&clearTimeout(u.timeout),0===this.data[o].length&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),u.value}getByKey(o){const u=this.data[o];return u?u[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,u){if(!this.has(o))return this;const p=o.wrapped().key,g=void 0===u?0:this.data[p].indexOf(u),x=this.data[p][g];return this.data[p].splice(g,1),x.timeout&&clearTimeout(x.timeout),0===this.data[p].length&&delete this.data[p],this.onRemove(x.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(o){const u=[];for(const p in this.data)for(const g of this.data[p])o(g.value)||u.push(g);for(const p of u)this.remove(p.value.tileID,p)}}class we{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,u,p){const g=String(u);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][g]=this.stateChanges[o][g]||{},y.e(this.stateChanges[o][g],p),null===this.deletedStates[o]){this.deletedStates[o]={};for(const x in this.state[o])x!==g&&(this.deletedStates[o][x]=null)}else if(this.deletedStates[o]&&null===this.deletedStates[o][g]){this.deletedStates[o][g]={};for(const x in this.state[o][g])p[x]||(this.deletedStates[o][g][x]=null)}else for(const x in p)this.deletedStates[o]&&this.deletedStates[o][g]&&null===this.deletedStates[o][g][x]&&delete this.deletedStates[o][g][x]}removeFeatureState(o,u,p){if(null===this.deletedStates[o])return;const g=String(u);if(this.deletedStates[o]=this.deletedStates[o]||{},p&&void 0!==u)null!==this.deletedStates[o][g]&&(this.deletedStates[o][g]=this.deletedStates[o][g]||{},this.deletedStates[o][g][p]=null);else if(void 0!==u)if(this.stateChanges[o]&&this.stateChanges[o][g])for(p in this.deletedStates[o][g]={},this.stateChanges[o][g])this.deletedStates[o][g][p]=null;else this.deletedStates[o][g]=null;else this.deletedStates[o]=null}getState(o,u){const p=String(u),g=y.e({},(this.state[o]||{})[p],(this.stateChanges[o]||{})[p]);if(null===this.deletedStates[o])return{};if(this.deletedStates[o]){const x=this.deletedStates[o][u];if(null===x)return{};for(const S in x)delete g[S]}return g}initializeTileState(o,u){o.setFeatureState(this.state,u)}coalesceChanges(o,u){const p={};for(const g in this.stateChanges){this.state[g]=this.state[g]||{};const x={};for(const S in this.stateChanges[g])this.state[g][S]||(this.state[g][S]={}),y.e(this.state[g][S],this.stateChanges[g][S]),x[S]=this.state[g][S];p[g]=x}for(const g in this.deletedStates){this.state[g]=this.state[g]||{};const x={};if(null===this.deletedStates[g])for(const S in this.state[g])x[S]={},this.state[g][S]={};else for(const S in this.deletedStates[g]){if(null===this.deletedStates[g][S])this.state[g][S]={};else for(const T of Object.keys(this.deletedStates[g][S]))delete this.state[g][S][T];x[S]=this.state[g][S]}p[g]=p[g]||{},y.e(p[g],x)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(p).length)for(const g in o)o[g].setFeatureState(p,u)}}class ls extends y.E{constructor(o,u,p){super(),this.id=o,this.dispatcher=p,this.on("data",g=>{"source"===g.dataType&&"metadata"===g.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===g.dataType&&"content"===g.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((g,x,S,T)=>{const I=new(Vs(x.type))(g,x,S,T);if(I.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${I.id}`);return I})(o,u,p,this),this._tiles={},this._cache=new El(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new we,this._didEmitContent=!1,this._updated=!1}onAdd(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._maxTileCacheZoomLevels=o?o._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(o)}onRemove(o){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(o)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const o in this._tiles){const u=this._tiles[o];if("loaded"!==u.state&&"errored"!==u.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(o,u){return this._source.loadTile(o,u)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o,()=>{})}_abortTile(o){this._source.abortTile&&this._source.abortTile(o,()=>{}),this._source.fire(new y.k("dataabort",{tile:o,coord:o.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const p=this._tiles[u];p.upload(o),p.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(Es).map(o=>o.key)}getRenderableIds(o){const u=[];for(const p in this._tiles)this._isIdRenderable(p,o)&&u.push(this._tiles[p]);return o?u.sort((p,g)=>{const x=p.tileID,S=g.tileID,T=new y.P(x.canonical.x,x.canonical.y)._rotate(this.transform.angle),I=new y.P(S.canonical.x,S.canonical.y)._rotate(this.transform.angle);return x.overscaledZ-S.overscaledZ||I.y-T.y||I.x-T.x}).map(p=>p.tileID.key):u.map(p=>p.tileID).sort(Es).map(p=>p.key)}hasRenderableParent(o){const u=this.findLoadedParent(o,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(o,u){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(u||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)"errored"!==this._tiles[o].state&&this._reloadTile(o,"reloading")}}_reloadTile(o,u){const p=this._tiles[o];p&&("loading"!==p.state&&(p.state=u),this._loadTile(p,this._tileLoaded.bind(this,p,o,u)))}_tileLoaded(o,u,p,g){if(g)return o.state="errored",void(404!==g.status?this._source.fire(new y.j(g,{tile:o})):this.update(this.transform,this.terrain));o.timeAdded=y.h.now(),"expired"===p&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(u,o),"raster-dem"===this.getSource().type&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),o.aborted||this._source.fire(new y.k("data",{dataType:"source",tile:o,coord:o.tileID}))}_backfillDEM(o){const u=this.getRenderableIds();for(let g=0;g<u.length;g++){const x=u[g];if(o.neighboringTiles&&o.neighboringTiles[x]){const S=this.getTileByID(x);p(o,S),p(S,o)}}function p(g,x){g.needsHillshadePrepare=!0,g.needsTerrainPrepare=!0;let S=x.tileID.canonical.x-g.tileID.canonical.x;const T=x.tileID.canonical.y-g.tileID.canonical.y,I=Math.pow(2,g.tileID.canonical.z),P=x.tileID.key;0===S&&0===T||Math.abs(T)>1||(Math.abs(S)>1&&(1===Math.abs(S+I)?S+=I:1===Math.abs(S-I)&&(S-=I)),x.dem&&g.dem&&(g.dem.backfillBorder(x.dem,S,T),g.neighboringTiles&&g.neighboringTiles[P]&&(g.neighboringTiles[P].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,u,p,g){for(const x in this._tiles){let S=this._tiles[x];if(g[x]||!S.hasData()||S.tileID.overscaledZ<=u||S.tileID.overscaledZ>p)continue;let T=S.tileID;for(;S&&S.tileID.overscaledZ>u+1;){const P=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[P.key],S&&S.hasData()&&(T=P)}let I=T;for(;I.overscaledZ>u;)if(I=I.scaledTo(I.overscaledZ-1),o[I.key]){g[T.key]=T;break}}}findLoadedParent(o,u){if(o.key in this._loadedParentTiles){const p=this._loadedParentTiles[o.key];return p&&p.tileID.overscaledZ>=u?p:null}for(let p=o.overscaledZ-1;p>=u;p--){const g=o.scaledTo(p),x=this._getLoadedTile(g);if(x)return x}}_getLoadedTile(o){const u=this._tiles[o.key];return u&&u.hasData()?u:this._cache.getByKey(o.wrapped().key)}updateCacheSize(o){const u=Math.ceil(o.width/this._source.tileSize)+1,p=Math.ceil(o.height/this._source.tileSize)+1,g=Math.floor(u*p*(null===this._maxTileCacheZoomLevels?y.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),x="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,g):g;this._cache.setMaxSize(x)}handleWrapJump(o){const u=Math.round((o-(void 0===this._prevLng?o:this._prevLng))/360);if(this._prevLng=o,u){const p={};for(const g in this._tiles){const x=this._tiles[g];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+u),p[x.tileID.key]=x}this._tiles=p;for(const g in this._timers)clearTimeout(this._timers[g]),delete this._timers[g];for(const g in this._tiles)this._setTileReloadTimer(g,this._tiles[g])}}update(o,u){if(this.transform=o,this.terrain=u,!this._sourceLoaded||this._paused)return;let p;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(k=>new y.O(k.canonical.z,k.wrap,k.canonical.z,k.canonical.x,k.canonical.y)):(p=o.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u}),this._source.hasTile&&(p=p.filter(k=>this._source.hasTile(k)))):p=[];const g=o.coveringZoomLevel(this._source),x=Math.max(g-ls.maxOverzooming,this._source.minzoom),S=Math.max(g+ls.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const k={};for(const O of p)if(O.canonical.z>this._source.minzoom){const V=O.scaledTo(O.canonical.z-1);k[V.key]=V;const K=O.scaledTo(Math.max(this._source.minzoom,Math.min(O.canonical.z,5)));k[K.key]=K}p=p.concat(Object.values(k))}const T=0===p.length&&!this._updated&&this._didEmitContent;this._updated=!0,T&&this.fire(new y.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const I=this._updateRetainedTiles(p,g);if(On(this._source.type)){const k={},O={},V=Object.keys(I),K=y.h.now();for(const Z of V){const Y=I[Z],G=this._tiles[Z];if(!G||0!==G.fadeEndTime&&G.fadeEndTime<=K)continue;const le=this.findLoadedParent(Y,x);le&&(this._addTile(le.tileID),k[le.tileID.key]=le.tileID),O[Z]=Y}this._retainLoadedChildren(O,g,S,I);for(const Z in k)I[Z]||(this._coveredTiles[Z]=!0,I[Z]=k[Z]);if(u){const Z={},Y={};for(const G of p)this._tiles[G.key].hasData()?Z[G.key]=G:Y[G.key]=G;for(const G in Y){const le=Y[G].children(this._source.maxzoom);this._tiles[le[0].key]&&this._tiles[le[1].key]&&this._tiles[le[2].key]&&this._tiles[le[3].key]&&(Z[le[0].key]=I[le[0].key]=le[0],Z[le[1].key]=I[le[1].key]=le[1],Z[le[2].key]=I[le[2].key]=le[2],Z[le[3].key]=I[le[3].key]=le[3],delete Y[G])}for(const G in Y){const le=this.findLoadedParent(Y[G],this._source.minzoom);if(le){Z[le.tileID.key]=I[le.tileID.key]=le.tileID;for(const ge in Z)Z[ge].isChildOf(le.tileID)&&delete Z[ge]}}for(const G in this._tiles)Z[G]||(this._coveredTiles[G]=!0)}}for(const k in I)this._tiles[k].clearFadeHold();const P=y.ab(this._tiles,I);for(const k of P){const O=this._tiles[k];O.hasSymbolBuckets&&!O.holdingForFade()?O.setHoldDuration(this.map._fadeDuration):O.hasSymbolBuckets&&!O.symbolFadeFinished()||this._removeTile(k)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)}_updateRetainedTiles(o,u){const p={},g={},x=Math.max(u-ls.maxOverzooming,this._source.minzoom),S=Math.max(u+ls.maxUnderzooming,this._source.minzoom),T={};for(const I of o){const P=this._addTile(I);p[I.key]=I,P.hasData()||u<this._source.maxzoom&&(T[I.key]=I)}this._retainLoadedChildren(T,u,S,p);for(const I of o){let P=this._tiles[I.key];if(P.hasData())continue;if(u+1>this._source.maxzoom){const O=I.children(this._source.maxzoom)[0],V=this.getTile(O);if(V&&V.hasData()){p[O.key]=O;continue}}else{const O=I.children(this._source.maxzoom);if(p[O[0].key]&&p[O[1].key]&&p[O[2].key]&&p[O[3].key])continue}let k=P.wasRequested();for(let O=I.overscaledZ-1;O>=x;--O){const V=I.scaledTo(O);if(g[V.key])break;if(g[V.key]=!0,P=this.getTile(V),!P&&k&&(P=this._addTile(V)),P){const K=P.hasData();if((k||K)&&(p[V.key]=V),k=P.wasRequested(),K)break}}}return p}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const u=[];let p,g=this._tiles[o].tileID;for(;g.overscaledZ>0;){if(g.key in this._loadedParentTiles){p=this._loadedParentTiles[g.key];break}u.push(g.key);const x=g.scaledTo(g.overscaledZ-1);if(p=this._getLoadedTile(x),p)break;g=x}for(const x of u)this._loadedParentTiles[x]=p}}_addTile(o){let u=this._tiles[o.key];if(u)return u;u=this._cache.getAndRemove(o),u&&(this._setTileReloadTimer(o.key,u),u.tileID=o,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,u)));const p=u;return u||(u=new za(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(u,this._tileLoaded.bind(this,u,o.key,u.state))),u.uses++,this._tiles[o.key]=u,p||this._source.fire(new y.k("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(o,u){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const p=u.getExpiryTimeout();p&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},p))}_removeTile(o){const u=this._tiles[o];u&&(u.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),u.uses>0||(u.hasData()&&"reloading"!==u.state?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(o);this._cache.reset()}tilesIn(o,u,p){const g=[],x=this.transform;if(!x)return g;const S=p?x.getCameraQueryGeometry(o):o,T=o.map(Z=>x.pointCoordinate(Z,this.terrain)),I=S.map(Z=>x.pointCoordinate(Z,this.terrain)),P=this.getIds();let k=1/0,O=1/0,V=-1/0,K=-1/0;for(const Z of I)k=Math.min(k,Z.x),O=Math.min(O,Z.y),V=Math.max(V,Z.x),K=Math.max(K,Z.y);for(let Z=0;Z<P.length;Z++){const Y=this._tiles[P[Z]];if(Y.holdingForFade())continue;const G=Y.tileID,le=Math.pow(2,x.zoom-Y.tileID.overscaledZ),ge=u*Y.queryPadding*y.N/Y.tileSize/le,ie=[G.getTilePoint(new y.U(k,O)),G.getTilePoint(new y.U(V,K))];if(ie[0].x-ge<y.N&&ie[0].y-ge<y.N&&ie[1].x+ge>=0&&ie[1].y+ge>=0){const he=T.map(be=>G.getTilePoint(be)),_e=I.map(be=>G.getTilePoint(be));g.push({tile:Y,tileID:G,queryGeometry:he,cameraQueryGeometry:_e,scale:le})}}return g}getVisibleCoordinates(o){const u=this.getRenderableIds(o).map(p=>this._tiles[p].tileID);for(const p of u)p.posMatrix=this.transform.calculatePosMatrix(p.toUnwrapped());return u}hasTransition(){if(this._source.hasTransition())return!0;if(On(this._source.type)){const o=y.h.now();for(const u in this._tiles)if(this._tiles[u].fadeEndTime>=o)return!0}return!1}setFeatureState(o,u,p){this._state.updateState(o=o||"_geojsonTileLayer",u,p)}removeFeatureState(o,u,p){this._state.removeFeatureState(o=o||"_geojsonTileLayer",u,p)}getFeatureState(o,u){return this._state.getState(o=o||"_geojsonTileLayer",u)}setDependencies(o,u,p){const g=this._tiles[o];g&&g.setDependencies(u,p)}reloadTilesForDependencies(o,u){for(const p in this._tiles)this._tiles[p].hasDependency(o,u)&&this._reloadTile(p,"reloading");this._cache.filter(p=>!p.hasDependency(o,u))}}function Es(v,o){const u=Math.abs(2*v.wrap)-+(v.wrap<0),p=Math.abs(2*o.wrap)-+(o.wrap<0);return v.overscaledZ-o.overscaledZ||p-u||o.canonical.y-v.canonical.y||o.canonical.x-v.canonical.x}function On(v){return"raster"===v||"image"===v||"video"===v}ls.maxOverzooming=10,ls.maxUnderzooming=3;const mn="mapboxgl_preloaded_worker_pool";class Ss{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<Ss.workerCount;)this.workers.push(new Worker(y.c.WORKER_URL));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],0===this.numActive()&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[mn]}numActive(){return Object.keys(this.active).length}}const Sl=Math.floor(y.h.hardwareConcurrency/2);let js;function uc(){return js||(js=new Ss),js}Ss.workerCount=y.ac(globalThis)?Math.max(Math.min(Sl,3),1):1;class Tl{constructor(o,u){this.reset(o,u)}reset(o,u){this.points=o||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(1===this.points.length)return this.points[0];o=y.ad(o,0,1);let u=1,p=this._distances[u];const g=o*this.paddedLength+this.padding;for(;p<g&&u<this._distances.length;)p=this._distances[++u];const x=u-1,S=this._distances[x],T=p-S,I=T>0?(g-S)/T:0;return this.points[x].mult(1-I).add(this.points[u].mult(I))}}function ia(v,o){let u=!0;return"always"===v||"never"!==v&&"never"!==o||(u=!1),u}class Ba{constructor(o,u,p){const g=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(o/p),this.yCellCount=Math.ceil(u/p);for(let S=0;S<this.xCellCount*this.yCellCount;S++)g.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=u,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,u,p,g,x){this._forEachCell(u,p,g,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(g),this.bboxes.push(x)}insertCircle(o,u,p,g){this._forEachCell(u-g,p-g,u+g,p+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(u),this.circles.push(p),this.circles.push(g)}_insertBoxCell(o,u,p,g,x,S){this.boxCells[x].push(S)}_insertCircleCell(o,u,p,g,x,S){this.circleCells[x].push(S)}_query(o,u,p,g,x,S,T){if(p<0||o>this.width||g<0||u>this.height)return[];const I=[];if(o<=0&&u<=0&&this.width<=p&&this.height<=g){if(x)return[{key:null,x1:o,y1:u,x2:p,y2:g}];for(let P=0;P<this.boxKeys.length;P++)I.push({key:this.boxKeys[P],x1:this.bboxes[4*P],y1:this.bboxes[4*P+1],x2:this.bboxes[4*P+2],y2:this.bboxes[4*P+3]});for(let P=0;P<this.circleKeys.length;P++){const k=this.circles[3*P],O=this.circles[3*P+1],V=this.circles[3*P+2];I.push({key:this.circleKeys[P],x1:k-V,y1:O-V,x2:k+V,y2:O+V})}}else this._forEachCell(o,u,p,g,this._queryCell,I,{hitTest:x,overlapMode:S,seenUids:{box:{},circle:{}}},T);return I}query(o,u,p,g){return this._query(o,u,p,g,!1,null)}hitTest(o,u,p,g,x,S){return this._query(o,u,p,g,!0,x,S).length>0}hitTestCircle(o,u,p,g,x){const S=o-p,T=o+p,I=u-p,P=u+p;if(T<0||S>this.width||P<0||I>this.height)return!1;const k=[];return this._forEachCell(S,I,T,P,this._queryCellCircle,k,{hitTest:!0,overlapMode:g,circle:{x:o,y:u,radius:p},seenUids:{box:{},circle:{}}},x),k.length>0}_queryCell(o,u,p,g,x,S,T,I){const{seenUids:P,hitTest:k,overlapMode:O}=T,V=this.boxCells[x];if(null!==V){const Z=this.bboxes;for(const Y of V)if(!P.box[Y]){P.box[Y]=!0;const G=4*Y,le=this.boxKeys[Y];if(o<=Z[G+2]&&u<=Z[G+3]&&p>=Z[G+0]&&g>=Z[G+1]&&(!I||I(le))&&(!k||!ia(O,le.overlapMode))&&(S.push({key:le,x1:Z[G],y1:Z[G+1],x2:Z[G+2],y2:Z[G+3]}),k))return!0}}const K=this.circleCells[x];if(null!==K){const Z=this.circles;for(const Y of K)if(!P.circle[Y]){P.circle[Y]=!0;const G=3*Y,le=this.circleKeys[Y];if(this._circleAndRectCollide(Z[G],Z[G+1],Z[G+2],o,u,p,g)&&(!I||I(le))&&(!k||!ia(O,le.overlapMode))){const ge=Z[G],ie=Z[G+1],he=Z[G+2];if(S.push({key:le,x1:ge-he,y1:ie-he,x2:ge+he,y2:ie+he}),k)return!0}}}return!1}_queryCellCircle(o,u,p,g,x,S,T,I){const{circle:P,seenUids:k,overlapMode:O}=T,V=this.boxCells[x];if(null!==V){const Z=this.bboxes;for(const Y of V)if(!k.box[Y]){k.box[Y]=!0;const G=4*Y,le=this.boxKeys[Y];if(this._circleAndRectCollide(P.x,P.y,P.radius,Z[G+0],Z[G+1],Z[G+2],Z[G+3])&&(!I||I(le))&&!ia(O,le.overlapMode))return S.push(!0),!0}}const K=this.circleCells[x];if(null!==K){const Z=this.circles;for(const Y of K)if(!k.circle[Y]){k.circle[Y]=!0;const G=3*Y,le=this.circleKeys[Y];if(this._circlesCollide(Z[G],Z[G+1],Z[G+2],P.x,P.y,P.radius)&&(!I||I(le))&&!ia(O,le.overlapMode))return S.push(!0),!0}}}_forEachCell(o,u,p,g,x,S,T,I){const P=this._convertToXCellCoord(o),k=this._convertToYCellCoord(u),O=this._convertToXCellCoord(p),V=this._convertToYCellCoord(g);for(let K=P;K<=O;K++)for(let Z=k;Z<=V;Z++)if(x.call(this,o,u,p,g,this.xCellCount*Z+K,S,T,I))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,u,p,g,x,S){const T=g-o,I=x-u,P=p+S;return P*P>T*T+I*I}_circleAndRectCollide(o,u,p,g,x,S,T){const I=(S-g)/2,P=Math.abs(o-(g+I));if(P>I+p)return!1;const k=(T-x)/2,O=Math.abs(u-(x+k));if(O>k+p)return!1;if(P<=I||O<=k)return!0;const V=P-I,K=O-k;return V*V+K*K<=p*p}}function ke(v,o,u,p,g){const x=y.Z();return o?(y.a0(x,x,[1/g,1/g,1]),u||y.ae(x,x,p.angle)):y.a1(x,p.labelPlaneMatrix,v),x}function $s(v,o,u,p,g){if(o){const x=y.af(v);return y.a0(x,x,[g,g,1]),u||y.ae(x,x,-p.angle),x}return p.glCoordMatrix}function mi(v,o,u){let p;u?(p=[v.x,v.y,u(v.x,v.y),1],y.ag(p,p,o)):(p=[v.x,v.y,0,1],J(p,p,o));const g=p[3];return{point:new y.P(p[0]/g,p[1]/g),signedDistanceFromCamera:g}}function ra(v,o){return.5+v/o*.5}function To(v,o){const u=v[0]/v[3],p=v[1]/v[3];return u>=-o[0]&&u<=o[0]&&p>=-o[1]&&p<=o[1]}function je(v,o,u,p,g,x,S,T,I,P){const k=p?v.textSizeData:v.iconSizeData,O=y.ah(k,u.transform.zoom),V=[256/u.width*2+1,256/u.height*2+1],K=p?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;K.clear();const Z=v.lineVertexArray,Y=p?v.text.placedSymbolArray:v.icon.placedSymbolArray,G=u.transform.width/u.transform.height;let le=!1;for(let ge=0;ge<Y.length;ge++){const ie=Y.get(ge);if(ie.hidden||ie.writingMode===y.ai.vertical&&!le){q(ie.numGlyphs,K);continue}let he;if(le=!1,P?(he=[ie.anchorX,ie.anchorY,P(ie.anchorX,ie.anchorY),1],y.ag(he,he,o)):(he=[ie.anchorX,ie.anchorY,0,1],J(he,he,o)),!To(he,V)){q(ie.numGlyphs,K);continue}const _e=ra(u.transform.cameraToCenterDistance,he[3]),be=y.aj(k,O,ie),Ee=S?be/_e:be*_e,Me=new y.P(ie.anchorX,ie.anchorY),Ae=mi(Me,g,P).point,Ne={projections:{},offsets:{}},We=Or(ie,Ee,!1,T,o,g,x,v.glyphOffsetArray,Z,K,Ae,Me,Ne,G,I,P);le=We.useVertical,(We.notEnoughRoom||le||We.needsFlipping&&Or(ie,Ee,!0,T,o,g,x,v.glyphOffsetArray,Z,K,Ae,Me,Ne,G,I,P).notEnoughRoom)&&q(ie.numGlyphs,K)}p?v.text.dynamicLayoutVertexBuffer.updateData(K):v.icon.dynamicLayoutVertexBuffer.updateData(K)}function Bt(v,o,u,p,g,x,S,T,I,P,k,O,V){const K=T.glyphStartIndex+T.numGlyphs,Z=T.lineStartIndex,Y=T.lineStartIndex+T.lineLength,G=o.getoffsetX(T.glyphStartIndex),le=o.getoffsetX(K-1),ge=z(v*G,u,p,g,x,S,T.segment,Z,Y,I,P,k,O,V);if(!ge)return null;const ie=z(v*le,u,p,g,x,S,T.segment,Z,Y,I,P,k,O,V);return ie?{first:ge,last:ie}:null}function Mt(v,o,u,p){return v===y.ai.horizontal&&Math.abs(u.y-o.y)>Math.abs(u.x-o.x)*p?{useVertical:!0}:(v===y.ai.vertical?o.y<u.y:o.x>u.x)?{needsFlipping:!0}:null}function Or(v,o,u,p,g,x,S,T,I,P,k,O,V,K,Z,Y){const G=o/24,le=v.lineOffsetX*G,ge=v.lineOffsetY*G;let ie;if(v.numGlyphs>1){const he=v.glyphStartIndex+v.numGlyphs,_e=v.lineStartIndex,be=v.lineStartIndex+v.lineLength,Ee=Bt(G,T,le,ge,u,k,O,v,I,x,V,Z,Y);if(!Ee)return{notEnoughRoom:!0};const Me=mi(Ee.first.point,S,Y).point,Ae=mi(Ee.last.point,S,Y).point;if(p&&!u){const Ne=Mt(v.writingMode,Me,Ae,K);if(Ne)return Ne}ie=[Ee.first];for(let Ne=v.glyphStartIndex+1;Ne<he-1;Ne++)ie.push(z(G*T.getoffsetX(Ne),le,ge,u,k,O,v.segment,_e,be,I,x,V,Z,Y));ie.push(Ee.last)}else{if(p&&!u){const _e=mi(O,g,Y).point,be=v.lineStartIndex+v.segment+1,Ee=new y.P(I.getx(be),I.gety(be)),Me=mi(Ee,g,Y),Ae=Me.signedDistanceFromCamera>0?Me.point:oo(O,Ee,_e,1,g,Y),Ne=Mt(v.writingMode,_e,Ae,K);if(Ne)return Ne}const he=z(G*T.getoffsetX(v.glyphStartIndex),le,ge,u,k,O,v.segment,v.lineStartIndex,v.lineStartIndex+v.lineLength,I,x,V,Z,Y);if(!he)return{notEnoughRoom:!0};ie=[he]}for(const he of ie)y.ak(P,he.point,he.angle);return{}}function oo(v,o,u,p,g,x){const S=mi(v.add(v.sub(o)._unit()),g,x).point,T=u.sub(S);return u.add(T._mult(p/T.mag()))}function Ft(v,o){const{projectionCache:u,lineVertexArray:p,labelPlaneMatrix:g,tileAnchorPoint:x,distanceFromAnchor:S,getElevation:T,previousVertex:I,direction:P,absOffsetX:k}=o;if(u.projections[v])return u.projections[v];const O=new y.P(p.getx(v),p.gety(v)),V=mi(O,g,T);if(V.signedDistanceFromCamera>0)return u.projections[v]=V.point,V.point;const K=v-P;return oo(0===S?x:new y.P(p.getx(K),p.gety(K)),O,I,k-S+1,g,T)}function Do(v,o,u){return v._unit()._perp()._mult(o*u)}function X(v,o,u,p,g,x,S,T){const{projectionCache:I,direction:P}=T;if(I.offsets[v])return I.offsets[v];const k=u.add(o);if(v+P<p||v+P>=g)return I.offsets[v]=k,k;const O=Ft(v+P,T),V=Do(O.sub(u),S,P),K=u.add(V),Z=O.add(V);return I.offsets[v]=y.al(x,k,K,Z)||k,I.offsets[v]}function z(v,o,u,p,g,x,S,T,I,P,k,O,V,K){const Z=p?v-o:v+o;let Y=Z>0?1:-1,G=0;p&&(Y*=-1,G=Math.PI),Y<0&&(G+=Math.PI);let le,ge,ie=Y>0?T+S:T+S+1,he=g,_e=g,be=0,Ee=0;const Me=Math.abs(Z),Ae=[];let Ne;for(;be+Ee<=Me;){if(ie+=Y,ie<T||ie>=I)return null;be+=Ee,_e=he,ge=le;const Oe={projectionCache:O,lineVertexArray:P,labelPlaneMatrix:k,tileAnchorPoint:x,distanceFromAnchor:be,getElevation:K,previousVertex:_e,direction:Y,absOffsetX:Me};if(he=Ft(ie,Oe),0===u)Ae.push(_e),Ne=he.sub(_e);else{let vt;const st=he.sub(_e);vt=0===st.mag()?Do(Ft(ie+Y,Oe).sub(he),u,Y):Do(st,u,Y),ge||(ge=_e.add(vt)),le=X(ie,vt,he,T,I,ge,u,Oe),Ae.push(ge),Ne=le.sub(ge)}Ee=Ne.mag()}const We=Ne._mult((Me-be)/Ee)._add(ge||_e),jt=G+Math.atan2(he.y-_e.y,he.x-_e.x);return Ae.push(We),{point:We,angle:V?jt:0,path:Ae}}const U=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function q(v,o){for(let u=0;u<v;u++){const p=o.length;o.resize(p+4),o.float32.set(U,3*p)}}function J(v,o,u){const p=o[0],g=o[1];return v[0]=u[0]*p+u[4]*g+u[12],v[1]=u[1]*p+u[5]*g+u[13],v[3]=u[3]*p+u[7]*g+u[15],v}const ne=100;class de{constructor(o,u=new Ba(o.width+200,o.height+200,25),p=new Ba(o.width+200,o.height+200,25)){this.transform=o,this.grid=u,this.ignoredGrid=p,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+ne,this.screenBottomBoundary=o.height+ne,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(o,u,p,g,x,S){const T=this.projectAndGetPerspectiveRatio(g,o.anchorPointX,o.anchorPointY,S),I=p*T.perspectiveRatio,P=o.x1*I+T.point.x,k=o.y1*I+T.point.y,O=o.x2*I+T.point.x,V=o.y2*I+T.point.y;return!this.isInsideGrid(P,k,O,V)||"always"!==u&&this.grid.hitTest(P,k,O,V,u,x)||T.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[P,k,O,V],offscreen:this.isOffscreen(P,k,O,V)}}placeCollisionCircles(o,u,p,g,x,S,T,I,P,k,O,V,K,Z){const Y=[],G=new y.P(u.anchorX,u.anchorY),le=mi(G,S,Z),ge=ra(this.transform.cameraToCenterDistance,le.signedDistanceFromCamera),ie=(k?x/ge:x*ge)/y.ap,he=mi(G,T,Z).point,_e=Bt(ie,g,u.lineOffsetX*ie,u.lineOffsetY*ie,!1,he,G,u,p,T,{projections:{},offsets:{}},!1,Z);let be=!1,Ee=!1,Me=!0;if(_e){const Ae=.5*V*ge+K,Ne=new y.P(-100,-100),We=new y.P(this.screenRightBoundary,this.screenBottomBoundary),jt=new Tl,Oe=_e.first,vt=_e.last;let st=[];for(let Nt=Oe.path.length-1;Nt>=1;Nt--)st.push(Oe.path[Nt]);for(let Nt=1;Nt<vt.path.length;Nt++)st.push(vt.path[Nt]);const An=2.5*Ae;if(I){const Nt=st.map(Zt=>mi(Zt,I,Z));st=Nt.some(Zt=>Zt.signedDistanceFromCamera<=0)?[]:Nt.map(Zt=>Zt.point)}let qt=[];if(st.length>0){const Nt=st[0].clone(),Zt=st[0].clone();for(let ci=1;ci<st.length;ci++)Nt.x=Math.min(Nt.x,st[ci].x),Nt.y=Math.min(Nt.y,st[ci].y),Zt.x=Math.max(Zt.x,st[ci].x),Zt.y=Math.max(Zt.y,st[ci].y);qt=Nt.x>=Ne.x&&Zt.x<=We.x&&Nt.y>=Ne.y&&Zt.y<=We.y?[st]:Zt.x<Ne.x||Nt.x>We.x||Zt.y<Ne.y||Nt.y>We.y?[]:y.am([st],Ne.x,Ne.y,We.x,We.y)}for(const Nt of qt){jt.reset(Nt,.25*Ae);let Zt=0;Zt=jt.length<=.5*Ae?1:Math.ceil(jt.paddedLength/An)+1;for(let ci=0;ci<Zt;ci++){const Fn=ci/Math.max(Zt-1,1),ir=jt.lerp(Fn),zi=ir.x+ne,Ci=ir.y+ne;Y.push(zi,Ci,Ae,0);const Tr=zi-Ae,Rn=Ci-Ae,Ur=zi+Ae,Ys=Ci+Ae;if(Me=Me&&this.isOffscreen(Tr,Rn,Ur,Ys),Ee=Ee||this.isInsideGrid(Tr,Rn,Ur,Ys),"always"!==o&&this.grid.hitTestCircle(zi,Ci,Ae,o,O)&&(be=!0,!P))return{circles:[],offscreen:!1,collisionDetected:be}}}}return{circles:!P&&be||!Ee||ge<this.perspectiveRatioCutoff?[]:Y,offscreen:Me,collisionDetected:be}}queryRenderedSymbols(o){if(0===o.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const u=[];let p=1/0,g=1/0,x=-1/0,S=-1/0;for(const k of o){const O=new y.P(k.x+ne,k.y+ne);p=Math.min(p,O.x),g=Math.min(g,O.y),x=Math.max(x,O.x),S=Math.max(S,O.y),u.push(O)}const T=this.grid.query(p,g,x,S).concat(this.ignoredGrid.query(p,g,x,S)),I={},P={};for(const k of T){const O=k.key;if(void 0===I[O.bucketInstanceId]&&(I[O.bucketInstanceId]={}),I[O.bucketInstanceId][O.featureIndex])continue;const V=[new y.P(k.x1,k.y1),new y.P(k.x2,k.y1),new y.P(k.x2,k.y2),new y.P(k.x1,k.y2)];y.an(u,V)&&(I[O.bucketInstanceId][O.featureIndex]=!0,void 0===P[O.bucketInstanceId]&&(P[O.bucketInstanceId]=[]),P[O.bucketInstanceId].push(O.featureIndex))}return P}insertCollisionBox(o,u,p,g,x,S){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:x,collisionGroupID:S,overlapMode:u},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,u,p,g,x,S){const T=p?this.ignoredGrid:this.grid,I={bucketInstanceId:g,featureIndex:x,collisionGroupID:S,overlapMode:u};for(let P=0;P<o.length;P+=4)T.insertCircle(I,o[P],o[P+1],o[P+2])}projectAndGetPerspectiveRatio(o,u,p,g){let x;return g?(x=[u,p,g(u,p),1],y.ag(x,x,o)):(x=[u,p,0,1],J(x,x,o)),{point:new y.P((x[0]/x[3]+1)/2*this.transform.width+ne,(-x[1]/x[3]+1)/2*this.transform.height+ne),perspectiveRatio:.5+this.transform.cameraToCenterDistance/x[3]*.5}}isOffscreen(o,u,p,g){return p<ne||o>=this.screenRightBoundary||g<ne||u>this.screenBottomBoundary}isInsideGrid(o,u,p,g){return p>=0&&o<this.gridRightBoundary&&g>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const o=y.ao([]);return y.$(o,o,[-100,-100,0]),o}}function ae(v,o,u){return o*(y.N/(v.tileSize*Math.pow(2,u-v.tileID.overscaledZ)))}class se{constructor(o,u,p,g){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?u:-u))):g&&p?1:0,this.placed=p}isHidden(){return 0===this.opacity&&!this.placed}}class ue{constructor(o,u,p,g,x){this.text=new se(o?o.text:null,u,p,x),this.icon=new se(o?o.icon:null,u,g,x)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ce{constructor(o,u,p){this.text=o,this.icon=u,this.skipFade=p}}class Se{constructor(){this.invProjMatrix=y.Z(),this.viewportMatrix=y.Z(),this.circles=[]}}class De{constructor(o,u,p,g,x){this.bucketInstanceId=o,this.featureIndex=u,this.sourceLayerIndex=p,this.bucketIndex=g,this.tileID=x}}class Je{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const u=++this.maxGroupID;this.collisionGroups[o]={ID:u,predicate:p=>p.collisionGroupID===u}}return this.collisionGroups[o]}}function Ct(v,o,u,p,g){const{horizontalAlign:x,verticalAlign:S}=y.au(v);return new y.P(-(x-.5)*o+p[0]*g,-(S-.5)*u+p[1]*g)}function it(v,o,u,p,g,x){const{x1:S,x2:T,y1:I,y2:P,anchorPointX:k,anchorPointY:O}=v,V=new y.P(o,u);return p&&V._rotate(g?x:-x),{x1:S+V.x,y1:I+V.y,x2:T+V.x,y2:P+V.y,anchorPointX:k,anchorPointY:O}}class gt{constructor(o,u,p,g,x){this.transform=o.clone(),this.terrain=u,this.collisionIndex=new de(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new Je(g),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,u,p,g){const x=p.getBucket(u),S=p.latestFeatureIndex;if(!x||!S||u.id!==x.layerIds[0])return;const T=p.collisionBoxArray,I=x.layers[0].layout,P=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),k=p.tileSize/y.N,O=this.transform.calculatePosMatrix(p.tileID.toUnwrapped()),V="map"===I.get("text-pitch-alignment"),K="map"===I.get("text-rotation-alignment"),Z=ae(p,1,this.transform.zoom),Y=ke(O,V,K,this.transform,Z);let G=null;if(V){const ge=$s(O,V,K,this.transform,Z);G=y.a1([],this.transform.labelPlaneMatrix,ge)}this.retainedQueryData[x.bucketInstanceId]=new De(x.bucketInstanceId,S,x.sourceLayerIndex,x.index,p.tileID);const le={bucket:x,layout:I,posMatrix:O,textLabelPlaneMatrix:Y,labelToScreenMatrix:G,scale:P,textPixelRatio:k,holdingForFade:p.holdingForFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:y.ah(x.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(g)for(const ge of x.sortKeyRanges){const{sortKey:ie,symbolInstanceStart:he,symbolInstanceEnd:_e}=ge;o.push({sortKey:ie,symbolInstanceStart:he,symbolInstanceEnd:_e,parameters:le})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:le})}attemptAnchorPlacement(o,u,p,g,x,S,T,I,P,k,O,V,K,Z,Y,G){const le=y.aq[o.textAnchor],ge=[o.textOffset0,o.textOffset1],ie=Ct(le,p,g,ge,x),he=this.collisionIndex.placeCollisionBox(it(u,ie.x,ie.y,S,T,this.transform.angle),O,I,P,k.predicate,G);if((!Y||0!==this.collisionIndex.placeCollisionBox(it(Y,ie.x,ie.y,S,T,this.transform.angle),O,I,P,k.predicate,G).box.length)&&he.box.length>0){let _e;if(this.prevPlacement&&this.prevPlacement.variableOffsets[V.crossTileID]&&this.prevPlacement.placements[V.crossTileID]&&this.prevPlacement.placements[V.crossTileID].text&&(_e=this.prevPlacement.variableOffsets[V.crossTileID].anchor),0===V.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[V.crossTileID]={textOffset:ge,width:p,height:g,anchor:le,textBoxScale:x,prevAnchor:_e},this.markUsedJustification(K,le,V,Z),K.allowVerticalPlacement&&(this.markUsedOrientation(K,Z,V),this.placedOrientations[V.crossTileID]=Z),{shift:ie,placedGlyphBoxes:he}}}placeLayerBucketPart(o,u,p){const{bucket:g,layout:x,posMatrix:S,textLabelPlaneMatrix:T,labelToScreenMatrix:I,textPixelRatio:P,holdingForFade:k,collisionBoxArray:O,partiallyEvaluatedTextSize:V,collisionGroup:K}=o.parameters,Z=x.get("text-optional"),Y=x.get("icon-optional"),G=y.ar(x,"text-overlap","text-allow-overlap"),le="always"===G,ge=y.ar(x,"icon-overlap","icon-allow-overlap"),ie="always"===ge,he="map"===x.get("text-rotation-alignment"),_e="map"===x.get("text-pitch-alignment"),be="none"!==x.get("icon-text-fit"),Ee="viewport-y"===x.get("symbol-z-order"),Me=le&&(ie||!g.hasIconData()||Y),Ae=ie&&(le||!g.hasTextData()||Z);!g.collisionArrays&&O&&g.deserializeCollisionBoxes(O);const Ne=this.retainedQueryData[g.bucketInstanceId].tileID,We=this.terrain?(Oe,vt)=>this.terrain.getElevation(Ne,Oe,vt):null,jt=(Oe,vt)=>{var st,An;if(u[Oe.crossTileID])return;if(k)return void(this.placements[Oe.crossTileID]=new Ce(!1,!1,!1));let qt=!1,Nt=!1,Zt=!0,ci=null,Fn={box:null,offscreen:null},ir={box:null,offscreen:null},zi=null,Ci=null,Tr=null,Rn=0,Ur=0,Ys=0;vt.textFeatureIndex?Rn=vt.textFeatureIndex:Oe.useRuntimeCollisionCircles&&(Rn=Oe.featureIndex),vt.verticalTextFeatureIndex&&(Ur=vt.verticalTextFeatureIndex);const el=vt.textBox;if(el){const Dr=ui=>{let Gi=y.ai.horizontal;if(g.allowVerticalPlacement&&!ui&&this.prevPlacement){const Ir=this.prevPlacement.placedOrientations[Oe.crossTileID];Ir&&(this.placedOrientations[Oe.crossTileID]=Ir,Gi=Ir,this.markUsedOrientation(g,Gi,Oe))}return Gi},pr=(ui,Gi)=>{if(g.allowVerticalPlacement&&Oe.numVerticalGlyphVertices>0&&vt.verticalTextBox){for(const Ir of g.writingModes)if(Ir===y.ai.vertical?(Fn=Gi(),ir=Fn):Fn=ui(),Fn&&Fn.box&&Fn.box.length)break}else Fn=ui()},Jr=Oe.textAnchorOffsetStartIndex,pa=Oe.textAnchorOffsetEndIndex;if(pa===Jr){const ui=(Gi,Ir)=>{const Ai=this.collisionIndex.placeCollisionBox(Gi,G,P,S,K.predicate,We);return Ai&&Ai.box&&Ai.box.length&&(this.markUsedOrientation(g,Ir,Oe),this.placedOrientations[Oe.crossTileID]=Ir),Ai};pr(()=>ui(el,y.ai.horizontal),()=>{const Gi=vt.verticalTextBox;return g.allowVerticalPlacement&&Oe.numVerticalGlyphVertices>0&&Gi?ui(Gi,y.ai.vertical):{box:null,offscreen:null}}),Dr(Fn&&Fn.box&&Fn.box.length)}else{let ui=y.aq[null===(An=null===(st=this.prevPlacement)||void 0===st?void 0:st.variableOffsets[Oe.crossTileID])||void 0===An?void 0:An.anchor];const Gi=(Ai,Vl,Pu)=>{const Ph=Ai.x2-Ai.x1,Rh=Ai.y2-Ai.y1,kp=Oe.textBoxScale,Lh=be&&"never"===ge?Vl:null;let co={box:[],offscreen:!1},ma="never"===G?1:2,uo="never";ui&&ma++;for(let ms=0;ms<ma;ms++){for(let ho=Jr;ho<pa;ho++){const Yd=g.textAnchorOffsets.get(ho);if(ui&&Yd.textAnchor!==ui)continue;const Fo=this.attemptAnchorPlacement(Yd,Ai,Ph,Rh,kp,he,_e,P,S,K,uo,Oe,g,Pu,Lh,We);if(Fo&&(co=Fo.placedGlyphBoxes,co&&co.box&&co.box.length))return qt=!0,ci=Fo.shift,co}ui?ui=null:uo=G}return co};pr(()=>Gi(el,vt.iconBox,y.ai.horizontal),()=>{const Ai=vt.verticalTextBox;return g.allowVerticalPlacement&&!(Fn&&Fn.box&&Fn.box.length)&&Oe.numVerticalGlyphVertices>0&&Ai?Gi(Ai,vt.verticalIconBox,y.ai.vertical):{box:null,offscreen:null}}),Fn&&(qt=Fn.box,Zt=Fn.offscreen);const Ir=Dr(Fn&&Fn.box);if(!qt&&this.prevPlacement){const Ai=this.prevPlacement.variableOffsets[Oe.crossTileID];Ai&&(this.variableOffsets[Oe.crossTileID]=Ai,this.markUsedJustification(g,Ai.anchor,Oe,Ir))}}}if(zi=Fn,qt=zi&&zi.box&&zi.box.length>0,Zt=zi&&zi.offscreen,Oe.useRuntimeCollisionCircles){const Dr=g.text.placedSymbolArray.get(Oe.centerJustifiedTextSymbolIndex),pr=y.aj(g.textSizeData,V,Dr),Jr=x.get("text-padding");Ci=this.collisionIndex.placeCollisionCircles(G,Dr,g.lineVertexArray,g.glyphOffsetArray,pr,S,T,I,p,_e,K.predicate,Oe.collisionCircleDiameter,Jr,We),Ci.circles.length&&Ci.collisionDetected&&!p&&y.w("Collisions detected, but collision boxes are not shown"),qt=le||Ci.circles.length>0&&!Ci.collisionDetected,Zt=Zt&&Ci.offscreen}if(vt.iconFeatureIndex&&(Ys=vt.iconFeatureIndex),vt.iconBox){const Dr=pr=>{const Jr=be&&ci?it(pr,ci.x,ci.y,he,_e,this.transform.angle):pr;return this.collisionIndex.placeCollisionBox(Jr,ge,P,S,K.predicate,We)};ir&&ir.box&&ir.box.length&&vt.verticalIconBox?(Tr=Dr(vt.verticalIconBox),Nt=Tr.box.length>0):(Tr=Dr(vt.iconBox),Nt=Tr.box.length>0),Zt=Zt&&Tr.offscreen}const Ul=Z||0===Oe.numHorizontalGlyphVertices&&0===Oe.numVerticalGlyphVertices,Ac=Y||0===Oe.numIconVertices;if(Ul||Ac?Ac?Ul||(Nt=Nt&&qt):qt=Nt&&qt:Nt=qt=Nt&&qt,qt&&zi&&zi.box&&this.collisionIndex.insertCollisionBox(zi.box,G,x.get("text-ignore-placement"),g.bucketInstanceId,ir&&ir.box&&Ur?Ur:Rn,K.ID),Nt&&Tr&&this.collisionIndex.insertCollisionBox(Tr.box,ge,x.get("icon-ignore-placement"),g.bucketInstanceId,Ys,K.ID),Ci&&(qt&&this.collisionIndex.insertCollisionCircles(Ci.circles,G,x.get("text-ignore-placement"),g.bucketInstanceId,Rn,K.ID),p)){const Dr=g.bucketInstanceId;let pr=this.collisionCircleArrays[Dr];void 0===pr&&(pr=this.collisionCircleArrays[Dr]=new Se);for(let Jr=0;Jr<Ci.circles.length;Jr+=4)pr.circles.push(Ci.circles[Jr+0]),pr.circles.push(Ci.circles[Jr+1]),pr.circles.push(Ci.circles[Jr+2]),pr.circles.push(Ci.collisionDetected?1:0)}if(0===Oe.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===g.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Oe.crossTileID]=new Ce(qt||Me,Nt||Ae,Zt||g.justReloaded),u[Oe.crossTileID]=!0};if(Ee){if(0!==o.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");const Oe=g.getSortedSymbolIndexes(this.transform.angle);for(let vt=Oe.length-1;vt>=0;--vt){const st=Oe[vt];jt(g.symbolInstances.get(st),g.collisionArrays[st])}}else for(let Oe=o.symbolInstanceStart;Oe<o.symbolInstanceEnd;Oe++)jt(g.symbolInstances.get(Oe),g.collisionArrays[Oe]);if(p&&g.bucketInstanceId in this.collisionCircleArrays){const Oe=this.collisionCircleArrays[g.bucketInstanceId];y.as(Oe.invProjMatrix,S),Oe.viewportMatrix=this.collisionIndex.getViewportMatrix()}g.justReloaded=!1}markUsedJustification(o,u,p,g){let x;x=g===y.ai.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[y.at(u)];const S=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const T of S)T>=0&&(o.text.placedSymbolArray.get(T).crossTileID=x>=0&&T!==x?0:p.crossTileID)}markUsedOrientation(o,u,p){const g=u===y.ai.horizontal||u===y.ai.horizontalOnly?u:0,x=u===y.ai.vertical?u:0,S=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const T of S)o.text.placedSymbolArray.get(T).placedOrientation=g;p.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=x)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let p=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const g=u?u.symbolFadeChange(o):1,x=u?u.opacities:{},S=u?u.variableOffsets:{},T=u?u.placedOrientations:{};for(const I in this.placements){const P=this.placements[I],k=x[I];k?(this.opacities[I]=new ue(k,g,P.text,P.icon),p=p||P.text!==k.text.placed||P.icon!==k.icon.placed):(this.opacities[I]=new ue(null,g,P.text,P.icon,P.skipFade),p=p||P.text||P.icon)}for(const I in x){const P=x[I];if(!this.opacities[I]){const k=new ue(P,g,!1,!1);k.isHidden()||(this.opacities[I]=k,p=p||P.text.placed||P.icon.placed)}}for(const I in S)this.variableOffsets[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.variableOffsets[I]=S[I]);for(const I in T)this.placedOrientations[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.placedOrientations[I]=T[I]);if(u&&void 0===u.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");p?this.lastPlacementChangeTime=o:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:o)}updateLayerOpacities(o,u){const p={};for(const g of u){const x=g.getBucket(o);x&&g.latestFeatureIndex&&o.id===x.layerIds[0]&&this.updateBucketOpacities(x,p,g.collisionBoxArray)}}updateBucketOpacities(o,u,p){o.hasTextData()&&(o.text.opacityVertexArray.clear(),o.text.hasVisibleVertices=!1),o.hasIconData()&&(o.icon.opacityVertexArray.clear(),o.icon.hasVisibleVertices=!1),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const g=o.layers[0],x=g.layout,S=new ue(null,0,!1,!1,!0),T=x.get("text-allow-overlap"),I=x.get("icon-allow-overlap"),P=g._unevaluatedLayout.hasValue("text-variable-anchor")||g._unevaluatedLayout.hasValue("text-variable-anchor-offset"),k="map"===x.get("text-rotation-alignment"),O="map"===x.get("text-pitch-alignment"),V="none"!==x.get("icon-text-fit"),K=new ue(null,0,T&&(I||!o.hasIconData()||x.get("icon-optional")),I&&(T||!o.hasTextData()||x.get("text-optional")),!0);!o.collisionArrays&&p&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(p);const Z=(Y,G,le)=>{for(let ge=0;ge<G/4;ge++)Y.opacityVertexArray.emplaceBack(le);Y.hasVisibleVertices=Y.hasVisibleVertices||le!==Hs};for(let Y=0;Y<o.symbolInstances.length;Y++){const G=o.symbolInstances.get(Y),{numHorizontalGlyphVertices:le,numVerticalGlyphVertices:ge,crossTileID:ie}=G;let he=this.opacities[ie];u[ie]?he=S:he||(he=K,this.opacities[ie]=he),u[ie]=!0;const _e=G.numIconVertices>0,be=this.placedOrientations[G.crossTileID],Ee=be===y.ai.vertical,Me=be===y.ai.horizontal||be===y.ai.horizontalOnly;if(le>0||ge>0){const Ae=Zn(he.text);Z(o.text,le,Ee?Hs:Ae),Z(o.text,ge,Me?Hs:Ae);const Ne=he.text.isHidden();[G.rightJustifiedTextSymbolIndex,G.centerJustifiedTextSymbolIndex,G.leftJustifiedTextSymbolIndex].forEach(Oe=>{Oe>=0&&(o.text.placedSymbolArray.get(Oe).hidden=Ne||Ee?1:0)}),G.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(G.verticalPlacedTextSymbolIndex).hidden=Ne||Me?1:0);const We=this.variableOffsets[G.crossTileID];We&&this.markUsedJustification(o,We.anchor,G,be);const jt=this.placedOrientations[G.crossTileID];jt&&(this.markUsedJustification(o,"left",G,jt),this.markUsedOrientation(o,jt,G))}if(_e){const Ae=Zn(he.icon),Ne=!(V&&G.verticalPlacedIconSymbolIndex&&Ee);G.placedIconSymbolIndex>=0&&(Z(o.icon,G.numIconVertices,Ne?Ae:Hs),o.icon.placedSymbolArray.get(G.placedIconSymbolIndex).hidden=he.icon.isHidden()),G.verticalPlacedIconSymbolIndex>=0&&(Z(o.icon,G.numVerticalIconVertices,Ne?Hs:Ae),o.icon.placedSymbolArray.get(G.verticalPlacedIconSymbolIndex).hidden=he.icon.isHidden())}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const Ae=o.collisionArrays[Y];if(Ae){let Ne=new y.P(0,0);if(Ae.textBox||Ae.verticalTextBox){let jt=!0;if(P){const Oe=this.variableOffsets[ie];Oe?(Ne=Ct(Oe.anchor,Oe.width,Oe.height,Oe.textOffset,Oe.textBoxScale),k&&Ne._rotate(O?this.transform.angle:-this.transform.angle)):jt=!1}Ae.textBox&&Pt(o.textCollisionBox.collisionVertexArray,he.text.placed,!jt||Ee,Ne.x,Ne.y),Ae.verticalTextBox&&Pt(o.textCollisionBox.collisionVertexArray,he.text.placed,!jt||Me,Ne.x,Ne.y)}const We=!(Me||!Ae.verticalIconBox);Ae.iconBox&&Pt(o.iconCollisionBox.collisionVertexArray,he.icon.placed,We,V?Ne.x:0,V?Ne.y:0),Ae.verticalIconBox&&Pt(o.iconCollisionBox.collisionVertexArray,he.icon.placed,!We,V?Ne.x:0,V?Ne.y:0)}}}if(o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.text.opacityVertexArray.length!==o.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${o.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${o.text.layoutVertexArray.length}) / 4`);if(o.icon.opacityVertexArray.length!==o.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${o.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${o.icon.layoutVertexArray.length}) / 4`);if(o.bucketInstanceId in this.collisionCircleArrays){const Y=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=Y.invProjMatrix,o.placementViewportMatrix=Y.viewportMatrix,o.collisionCircleArray=Y.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return 0===this.fadeDuration?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,u){const p=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*p>o}setStale(){this.stale=!0}}function Pt(v,o,u,p,g){v.emplaceBack(o?1:0,u?1:0,p||0,g||0),v.emplaceBack(o?1:0,u?1:0,p||0,g||0),v.emplaceBack(o?1:0,u?1:0,p||0,g||0),v.emplaceBack(o?1:0,u?1:0,p||0,g||0)}const _n=Math.pow(2,25),Nn=Math.pow(2,24),hn=Math.pow(2,17),zt=Math.pow(2,16),xr=Math.pow(2,9),Ut=Math.pow(2,8),ti=Math.pow(2,1);function Zn(v){if(0===v.opacity&&!v.placed)return 0;if(1===v.opacity&&v.placed)return 4294967295;const o=v.placed?1:0,u=Math.floor(127*v.opacity);return u*_n+o*Nn+u*hn+o*zt+u*xr+o*Ut+u*ti+o}const Hs=0;class kd{constructor(o){this._sortAcrossTiles="viewport-y"!==o.layout.get("symbol-z-order")&&!o.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,u,p,g,x){const S=this._bucketParts;for(;this._currentTileIndex<o.length;)if(u.getBucketParts(S,g,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((T,I)=>T.sortKey-I.sortKey));this._currentPartIndex<S.length;)if(u.placeLayerBucketPart(S[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,x())return!0;return!1}}class Dl{constructor(o,u,p,g,x,S,T,I){this.placement=new gt(o,u,S,T,I),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(o,u,p){const g=y.h.now(),x=()=>!this._forceFullPlacement&&y.h.now()-g>2;for(;this._currentPlacementIndex>=0;){const S=u[o[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if("symbol"===S.type&&(!S.minzoom||S.minzoom<=T)&&(!S.maxzoom||S.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new kd(S)),this._inProgressLayer.continuePlacement(p[S.source],this.placement,this._showCollisionBoxes,S,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const sa=512/y.N/2;class Dp{constructor(o,u,p){this.tileID=o,this.bucketInstanceId=p,this._symbolsByKey={};const g=new Map;for(let x=0;x<u.length;x++){const S=u.get(x),T=S.key,I=g.get(T);I?I.push(S):g.set(T,[S])}for(const[x,S]of g){const T={positions:S.map(I=>({x:Math.floor(I.anchorX*sa),y:Math.floor(I.anchorY*sa)})),crossTileIDs:S.map(I=>I.crossTileID)};if(T.positions.length>128){const I=new y.av(T.positions.length,16,Uint16Array);for(const{x:P,y:k}of T.positions)I.add(P,k);I.finish(),delete T.positions,T.index=I}this._symbolsByKey[x]=T}}getScaledCoordinates(o,u){const{x:p,y:g,z:x}=this.tileID.canonical,{x:S,y:T,z:I}=u.canonical,P=sa/Math.pow(2,I-x),k=(T*y.N+o.anchorY)*P,O=g*y.N*sa;return{x:Math.floor((S*y.N+o.anchorX)*P-p*y.N*sa),y:Math.floor(k-O)}}findMatches(o,u,p){const g=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let x=0;x<o.length;x++){const S=o.get(x);if(S.crossTileID)continue;const T=this._symbolsByKey[S.key];if(!T)continue;const I=this.getScaledCoordinates(S,u);if(T.index){const P=T.index.range(I.x-g,I.y-g,I.x+g,I.y+g).sort();for(const k of P){const O=T.crossTileIDs[k];if(!p[O]){p[O]=!0,S.crossTileID=O;break}}}else if(T.positions)for(let P=0;P<T.positions.length;P++){const k=T.positions[P],O=T.crossTileIDs[P];if(Math.abs(k.x-I.x)<=g&&Math.abs(k.y-I.y)<=g&&!p[O]){p[O]=!0,S.crossTileID=O;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:o})=>o)}}class gn{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class dh{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const u=Math.round((o-this.lng)/360);if(0!==u)for(const p in this.indexes){const g=this.indexes[p],x={};for(const S in g){const T=g[S];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+u),x[T.tileID.key]=T}this.indexes[p]=x}this.lng=o}addBucket(o,u,p){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let x=0;x<u.symbolInstances.length;x++)u.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const g=this.usedCrossTileIDs[o.overscaledZ];for(const x in this.indexes){const S=this.indexes[x];if(Number(x)>o.overscaledZ)for(const T in S){const I=S[T];I.tileID.isChildOf(o)&&I.findMatches(u.symbolInstances,o,g)}else{const T=S[o.scaledTo(Number(x)).key];T&&T.findMatches(u.symbolInstances,o,g)}}for(let x=0;x<u.symbolInstances.length;x++){const S=u.symbolInstances.get(x);S.crossTileID||(S.crossTileID=p.generate(),g[S.crossTileID]=!0)}return void 0===this.indexes[o.overscaledZ]&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Dp(o,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(o,u){for(const p of u.getCrossTileIDsLists())for(const g of p)delete this.usedCrossTileIDs[o][g]}removeStaleBuckets(o){let u=!1;for(const p in this.indexes){const g=this.indexes[p];for(const x in g)o[g[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,g[x]),delete g[x],u=!0)}return u}}class hc{constructor(){this.layerIndexes={},this.crossTileIDs=new gn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,u,p){let g=this.layerIndexes[o.id];void 0===g&&(g=this.layerIndexes[o.id]=new dh);let x=!1;const S={};g.handleWrapJump(p);for(const T of u){const I=T.getBucket(o);I&&o.id===I.layerIds[0]&&(I.bucketInstanceId||(I.bucketInstanceId=++this.maxBucketInstanceId),g.addBucket(T.tileID,I,this.crossTileIDs)&&(x=!0),S[I.bucketInstanceId]=!0)}return g.removeStaleBuckets(S)&&(x=!0),x}pruneUnusedLayers(o){const u={};o.forEach(p=>{u[p]=!0});for(const p in this.layerIndexes)u[p]||delete this.layerIndexes[p]}}const ur=(v,o)=>y.x(v,o&&o.filter(u=>"source.canvas"!==u.identifier)),cs=y.F(y.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Ip=y.F(y.ax,["setCenter","setZoom","setBearing","setPitch"]),Ts=y.aw();class hr extends y.E{constructor(o,u={}){super(),this.map=o,this.dispatcher=new wl(uc(),this,o._getMapId()),this.imageManager=new Dt,this.imageManager.setEventedParent(this),this.glyphManager=new as(o._requestManager,u.localIdeographFontFamily),this.lineAtlas=new pi(256,512),this.crossTileSymbolIndex=new hc,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new y.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",y.az());const p=this;this._rtlTextPluginCallback=hr.registerForPluginStateChange(g=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:g.pluginStatus,pluginURL:g.pluginURL},(x,S)=>{if(y.aA(x),S&&S.every(T=>T))for(const T in p.sourceCaches){const I=p.sourceCaches[T].getSource().type;"vector"!==I&&"geojson"!==I||p.sourceCaches[T].reload()}})}),this.on("data",g=>{if("source"!==g.dataType||"metadata"!==g.sourceDataType)return;const x=this.sourceCaches[g.sourceId];if(!x)return;const S=x.getSource();if(S&&S.vectorLayerIds)for(const T in this._layers){const I=this._layers[T];I.source===S.id&&this._validateLayer(I)}})}loadURL(o,u={},p){this.fire(new y.k("dataloading",{dataType:"style"})),u.validate="boolean"!=typeof u.validate||u.validate;const g=this.map._requestManager.transformRequest(o,bi.Style);this._request=y.f(g,(x,S)=>{this._request=null,x?this.fire(new y.j(x)):S&&this._load(S,u,p)})}loadJSON(o,u={},p){this.fire(new y.k("dataloading",{dataType:"style"})),this._request=y.h.frame(()=>{this._request=null,u.validate=!1!==u.validate,this._load(o,u,p)})}loadEmpty(){this.fire(new y.k("dataloading",{dataType:"style"})),this._load(Ts,{validate:!1})}_load(o,u,p){var g;const x=u.transformStyle?u.transformStyle(p,o):o;if(!u.validate||!ur(this,y.y(x))){this._loaded=!0,this.stylesheet=x;for(const S in x.sources)this.addSource(S,x.sources[S],{validate:!1});x.sprite?this._loadSprite(x.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(x.glyphs),this._createLayers(),this.light=new xl(this.stylesheet.light),this.map.setTerrain(null!==(g=this.stylesheet.terrain)&&void 0!==g?g:null),this.fire(new y.k("data",{dataType:"style"})),this.fire(new y.k("style.load"))}}_createLayers(){const o=y.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",o),this._order=o.map(u=>u.id),this._layers={},this._serializedLayers=null;for(const u of o){const p=y.aC(u);p.setEventedParent(this,{layer:{id:u.id}}),this._layers[u.id]=p}}_loadSprite(o,u=!1,p=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(g,x,S,T){const I=He(g),P=I.length,k=S>1?"@2x":"",O={},V={},K={};for(const{id:Z,url:Y}of I){const G=x.transformRequest(x.normalizeSpriteURL(Y,k,".json"),bi.SpriteJSON),le=`${Z}_${G.url}`;O[le]=y.f(G,(he,_e)=>{delete O[le],V[Z]=_e,yt(T,V,K,he,P)});const ge=x.transformRequest(x.normalizeSpriteURL(Y,k,".png"),bi.SpriteImage),ie=`${Z}_${ge.url}`;O[ie]=Ji.getImage(ge,(he,_e)=>{delete O[ie],K[Z]=_e,yt(T,V,K,he,P)})}return{cancel(){for(const Z of Object.values(O))Z.cancel()}}}(o,this.map._requestManager,this.map.getPixelRatio(),(g,x)=>{if(this._spriteRequest=null,g)this.fire(new y.j(g));else if(x)for(const S in x){this._spritesImagesIds[S]=[];const T=this._spritesImagesIds[S]?this._spritesImagesIds[S].filter(I=>!(I in x)):[];for(const I of T)this.imageManager.removeImage(I),this._changedImages[I]=!0;for(const I in x[S]){const P="default"===S?I:`${S}:${I}`;this._spritesImagesIds[S].push(P),P in this.imageManager.images?this.imageManager.updateImage(P,x[S][I],!1):this.imageManager.addImage(P,x[S][I]),u&&(this._changedImages[P]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),u&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new y.k("data",{dataType:"style"})),p&&p(g)})}_unloadSprite(){for(const o of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(o),this._changedImages[o]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new y.k("data",{dataType:"style"}))}_validateLayer(o){const u=this.sourceCaches[o.source];if(!u)return;const p=o.sourceLayer;if(!p)return;const g=u.getSource();("geojson"===g.type||g.vectorLayerIds&&-1===g.vectorLayerIds.indexOf(p))&&this.fire(new y.j(new Error(`Source layer "${p}" does not exist on source "${g.id}" as specified by style layer "${o.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(o){const u=this._serializedAllLayers();if(!o||0===o.length)return Object.values(u);const p=[];for(const g of o)u[g]&&p.push(u[g]);return p}_serializedAllLayers(){let o=this._serializedLayers;if(o)return o;o=this._serializedLayers={};const u=Object.keys(this._layers);for(const p of u){const g=this._layers[p];"custom"!==g.type&&(o[p]=g.serialize())}return o}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(o){if(!this._loaded)return;const u=this._changed;if(this._changed){const g=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(g.length||x.length)&&this._updateWorkerLayers(g,x);for(const S in this._updatedSources){const T=this._updatedSources[S];if("reload"===T)this._reloadSource(S);else{if("clear"!==T)throw new Error(`Invalid action ${T}`);this._clearSource(S)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}const p={};for(const g in this.sourceCaches){const x=this.sourceCaches[g];p[g]=x.used,x.used=!1}for(const g of this._order){const x=this._layers[g];x.recalculate(o,this._availableImages),!x.isHidden(o.zoom)&&x.source&&(this.sourceCaches[x.source].used=!0)}for(const g in p){const x=this.sourceCaches[g];p[g]!==x.used&&x.fire(new y.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:g}))}this.light.recalculate(o),this.z=o.zoom,u&&this.fire(new y.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(o,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(o),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(o,u={}){this._checkLoaded();const p=this.serialize();if(o=u.transformStyle?u.transformStyle(p,o):o,ur(this,y.y(o)))return!1;(o=y.aD(o)).layers=y.aB(o.layers);const g=y.aE(p,o).filter(S=>!(S.command in Ip));if(0===g.length)return!1;const x=g.filter(S=>!(S.command in cs));if(x.length>0)throw new Error(`Unimplemented: ${x.map(S=>S.command).join(", ")}.`);for(const S of g)"setTransition"!==S.command&&this[S.command].apply(this,S.args);return this.stylesheet=o,this._serializedLayers=null,!0}addImage(o,u){if(this.getImage(o))return this.fire(new y.j(new Error(`An image named "${o}" already exists.`)));this.imageManager.addImage(o,u),this._afterImageUpdated(o)}updateImage(o,u){this.imageManager.updateImage(o,u)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new y.j(new Error(`An image named "${o}" does not exist.`)));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new y.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,u,p={}){if(this._checkLoaded(),void 0!==this.sourceCaches[o])throw new Error(`Source "${o}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(y.y.source,`sources.${o}`,u,null,p))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const g=this.sourceCaches[o]=new ls(o,u,this.dispatcher);g.style=this,g.setEventedParent(this,()=>({isSourceLoaded:g.loaded(),source:g.serialize(),sourceId:o})),g.onAdd(this.map),this._changed=!0}removeSource(o){if(this._checkLoaded(),void 0===this.sourceCaches[o])throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===o)return this.fire(new y.j(new Error(`Source "${o}" cannot be removed while layer "${p}" is using it.`)));const u=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],u.fire(new y.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,u){if(this._checkLoaded(),void 0===this.sourceCaches[o])throw new Error(`There is no source with this ID=${o}`);const p=this.sourceCaches[o].getSource();if("geojson"!==p.type)throw new Error(`geojsonSource.type is ${p.type}, which is !== 'geojson`);p.setData(u),this._changed=!0}getSource(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()}addLayer(o,u,p={}){this._checkLoaded();const g=o.id;if(this.getLayer(g))return void this.fire(new y.j(new Error(`Layer "${g}" already exists on this map.`)));let x;if("custom"===o.type){if(ur(this,y.aF(o)))return;x=y.aC(o)}else{if("source"in o&&"object"==typeof o.source&&(this.addSource(g,o.source),o=y.aD(o),o=y.e(o,{source:g})),this._validate(y.y.layer,`layers.${g}`,o,{arrayIndex:-1},p))return;x=y.aC(o),this._validateLayer(x),x.setEventedParent(this,{layer:{id:g}})}const S=u?this._order.indexOf(u):this._order.length;if(u&&-1===S)this.fire(new y.j(new Error(`Cannot add layer "${g}" before non-existing layer "${u}".`)));else{if(this._order.splice(S,0,g),this._layerOrderChanged=!0,this._layers[g]=x,this._removedLayers[g]&&x.source&&"custom"!==x.type){const T=this._removedLayers[g];delete this._removedLayers[g],T.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",this.sourceCaches[x.source].pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map)}}moveLayer(o,u){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new y.j(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===u)return;const p=this._order.indexOf(o);this._order.splice(p,1);const g=u?this._order.indexOf(u):this._order.length;u&&-1===g?this.fire(new y.j(new Error(`Cannot move layer "${o}" before non-existing layer "${u}".`))):(this._order.splice(g,0,o),this._layerOrderChanged=!0)}removeLayer(o){this._checkLoaded();const u=this._layers[o];if(!u)return void this.fire(new y.j(new Error(`Cannot remove non-existing layer "${o}".`)));u.setEventedParent(null);const p=this._order.indexOf(o);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=u,delete this._layers[o],this._serializedLayers&&delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],u.onRemove&&u.onRemove(this.map)}getLayer(o){return this._layers[o]}hasLayer(o){return o in this._layers}setLayerZoomRange(o,u,p){this._checkLoaded();const g=this.getLayer(o);g?g.minzoom===u&&g.maxzoom===p||(null!=u&&(g.minzoom=u),null!=p&&(g.maxzoom=p),this._updateLayer(g)):this.fire(new y.j(new Error(`Cannot set the zoom range of non-existing layer "${o}".`)))}setFilter(o,u,p={}){this._checkLoaded();const g=this.getLayer(o);if(g){if(!y.aG(g.filter,u))return null==u?(g.filter=void 0,void this._updateLayer(g)):void(this._validate(y.y.filter,`layers.${g.id}.filter`,u,null,p)||(g.filter=y.aD(u),this._updateLayer(g)))}else this.fire(new y.j(new Error(`Cannot filter non-existing layer "${o}".`)))}getFilter(o){return y.aD(this.getLayer(o).filter)}setLayoutProperty(o,u,p,g={}){this._checkLoaded();const x=this.getLayer(o);x?y.aG(x.getLayoutProperty(u),p)||(x.setLayoutProperty(u,p,g),this._updateLayer(x)):this.fire(new y.j(new Error(`Cannot style non-existing layer "${o}".`)))}getLayoutProperty(o,u){const p=this.getLayer(o);if(p)return p.getLayoutProperty(u);this.fire(new y.j(new Error(`Cannot get style of non-existing layer "${o}".`)))}setPaintProperty(o,u,p,g={}){this._checkLoaded();const x=this.getLayer(o);x?y.aG(x.getPaintProperty(u),p)||(x.setPaintProperty(u,p,g)&&this._updateLayer(x),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new y.j(new Error(`Cannot style non-existing layer "${o}".`)))}getPaintProperty(o,u){return this.getLayer(o).getPaintProperty(u)}setFeatureState(o,u){this._checkLoaded();const p=o.source,g=o.sourceLayer,x=this.sourceCaches[p];if(void 0===x)return void this.fire(new y.j(new Error(`The source '${p}' does not exist in the map's style.`)));const S=x.getSource().type;"geojson"===S&&g?this.fire(new y.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==S||g?(void 0===o.id&&this.fire(new y.j(new Error("The feature id parameter must be provided."))),x.setFeatureState(g,o.id,u)):this.fire(new y.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(o,u){this._checkLoaded();const p=o.source,g=this.sourceCaches[p];if(void 0===g)return void this.fire(new y.j(new Error(`The source '${p}' does not exist in the map's style.`)));const x=g.getSource().type,S="vector"===x?o.sourceLayer:void 0;"vector"!==x||S?u&&"string"!=typeof o.id&&"number"!=typeof o.id?this.fire(new y.j(new Error("A feature id is required to remove its specific state property."))):g.removeFeatureState(S,o.id,u):this.fire(new y.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(o){this._checkLoaded();const u=o.source,p=o.sourceLayer,g=this.sourceCaches[u];if(void 0!==g)return"vector"!==g.getSource().type||p?(void 0===o.id&&this.fire(new y.j(new Error("The feature id parameter must be provided."))),g.getFeatureState(p,o.id)):void this.fire(new y.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new y.j(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return y.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const o=y.aH(this.sourceCaches,x=>x.serialize()),u=this._serializeByIds(this._order),p=this.map.getTerrain()||void 0,g=this.stylesheet;return y.aI({version:g.version,name:g.name,metadata:g.metadata,light:g.light,center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch,sprite:g.sprite,glyphs:g.glyphs,transition:g.transition,sources:o,layers:u,terrain:p},x=>void 0!==x)}_updateLayer(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&"raster"!==this.sourceCaches[o.source].getSource().type&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(o){const u=S=>"fill-extrusion"===this._layers[S].type,p={},g=[];for(let S=this._order.length-1;S>=0;S--){const T=this._order[S];if(u(T)){p[T]=S;for(const I of o){const P=I[T];if(P)for(const k of P)g.push(k)}}}g.sort((S,T)=>T.intersectionZ-S.intersectionZ);const x=[];for(let S=this._order.length-1;S>=0;S--){const T=this._order[S];if(u(T))for(let I=g.length-1;I>=0;I--){const P=g[I].feature;if(p[P.layer.id]<S)break;x.push(P),g.pop()}else for(const I of o){const P=I[T];if(P)for(const k of P)x.push(k.feature)}}return x}queryRenderedFeatures(o,u,p){u&&u.filter&&this._validate(y.y.filter,"queryRenderedFeatures.filter",u.filter,null,u);const g={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new y.j(new Error("parameters.layers must be an Array."))),[];for(const T of u.layers){const I=this._layers[T];if(!I)return this.fire(new y.j(new Error(`The layer '${T}' does not exist in the map's style and cannot be queried for features.`))),[];g[I.source]=!0}}const x=[];u.availableImages=this._availableImages;const S=this._serializedAllLayers();for(const T in this.sourceCaches)u.layers&&!g[T]||x.push(Fa(this.sourceCaches[T],this._layers,S,o,u,p));return this.placement&&x.push(function(T,I,P,k,O,V,K){const Z={},Y=V.queryRenderedSymbols(k),G=[];for(const le of Object.keys(Y).map(Number))G.push(K[le]);G.sort(na);for(const le of G){const ge=le.featureIndex.lookupSymbolFeatures(Y[le.bucketInstanceId],I,le.bucketIndex,le.sourceLayerIndex,O.filter,O.layers,O.availableImages,T);for(const ie in ge){const he=Z[ie]=Z[ie]||[],_e=ge[ie];_e.sort((be,Ee)=>{const Me=le.featureSortOrder;if(Me){const Ae=Me.indexOf(be.featureIndex);return Me.indexOf(Ee.featureIndex)-Ae}return Ee.featureIndex-be.featureIndex});for(const be of _e)he.push(be)}}for(const le in Z)Z[le].forEach(ge=>{const ie=ge.feature,he=P[T[le].source].getFeatureState(ie.layer["source-layer"],ie.id);ie.source=ie.layer.source,ie.layer["source-layer"]&&(ie.sourceLayer=ie.layer["source-layer"]),ie.state=he});return Z}(this._layers,S,this.sourceCaches,o,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(o,u){u&&u.filter&&this._validate(y.y.filter,"querySourceFeatures.filter",u.filter,null,u);const p=this.sourceCaches[o];return p?function(g,x){const S=g.getRenderableIds().map(P=>g.getTileByID(P)),T=[],I={};for(let P=0;P<S.length;P++){const k=S[P],O=k.tileID.canonical.key;I[O]||(I[O]=!0,k.querySourceFeatures(T,x))}return T}(p,u):[]}addSourceType(o,u,p){return Vs(o)?p(new Error(`A source type called "${o}" already exists.`)):(cc[o]=u,u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:u.workerSourceURL},p):p(null,null))}getLight(){return this.light.getLight()}setLight(o,u={}){this._checkLoaded();const p=this.light.getLight();let g=!1;for(const S in o)if(!y.aG(o[S],p[S])){g=!0;break}if(!g)return;const x={now:y.h.now(),transition:y.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,u),this.light.updateTransitions(x)}_validate(o,u,p,g,x={}){return(!x||!1!==x.validate)&&ur(this,o.call(y.y,y.e({key:u,style:this.serialize(),value:p,styleSpec:y.v},g)))}_remove(o=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),y.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this.sourceCaches){const p=this.sourceCaches[u];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(o)}_clearSource(o){this.sourceCaches[o].clearTiles()}_reloadSource(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()}_updateSources(o){for(const u in this.sourceCaches)this.sourceCaches[u].update(o,this.map.terrain)}_generateCollisionBoxes(){for(const o in this.sourceCaches)this._reloadSource(o)}_updatePlacement(o,u,p,g,x=!1){let S=!1,T=!1;const I={};for(const P of this._order){const k=this._layers[P];if("symbol"!==k.type)continue;if(!I[k.source]){const V=this.sourceCaches[k.source];I[k.source]=V.getRenderableIds(!0).map(K=>V.getTileByID(K)).sort((K,Z)=>Z.tileID.overscaledZ-K.tileID.overscaledZ||(K.tileID.isLessThan(Z.tileID)?-1:1))}const O=this.crossTileSymbolIndex.addLayer(k,I[k.source],o.center.lng);S=S||O}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((x=x||this._layerOrderChanged||0===p)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(y.h.now(),o.zoom))&&(this.pauseablePlacement=new Dl(o,this.map.terrain,this._order,x,u,p,g,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,I),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(y.h.now()),T=!0),S&&this.pauseablePlacement.placement.setStale()),T||S)for(const P of this._order){const k=this._layers[P];"symbol"===k.type&&this.placement.updateLayerOpacities(k,I[k.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(y.h.now())}_releaseSymbolFadeTiles(){for(const o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,u,p){this.imageManager.getImages(u.icons,p),this._updateTilesForChangedImages();const g=this.sourceCaches[u.source];g&&g.setDependencies(u.tileID.key,u.type,u.icons)}getGlyphs(o,u,p){this.glyphManager.getGlyphs(u.stacks,p);const g=this.sourceCaches[u.source];g&&g.setDependencies(u.tileID.key,u.type,[""])}getResource(o,u,p){return y.m(u,p)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(o,u={}){this._checkLoaded(),o&&this._validate(y.y.glyphs,"glyphs",o,null,u)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=o,this.glyphManager.entries={},this.glyphManager.setURL(o))}addSprite(o,u,p={},g){this._checkLoaded();const x=[{id:o,url:u}],S=[...He(this.stylesheet.sprite),...x];this._validate(y.y.sprite,"sprite",S,null,p)||(this.stylesheet.sprite=S,this._loadSprite(x,!0,g))}removeSprite(o){this._checkLoaded();const u=He(this.stylesheet.sprite);if(u.find(p=>p.id===o)){if(this._spritesImagesIds[o])for(const p of this._spritesImagesIds[o])this.imageManager.removeImage(p),this._changedImages[p]=!0;u.splice(u.findIndex(p=>p.id===o),1),this.stylesheet.sprite=u.length>0?u:void 0,delete this._spritesImagesIds[o],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new y.k("data",{dataType:"style"}))}else this.fire(new y.j(new Error(`Sprite "${o}" doesn't exists on this map.`)))}getSprite(){return He(this.stylesheet.sprite)}setSprite(o,u={},p){this._checkLoaded(),o&&this._validate(y.y.sprite,"sprite",o,null,u)||(this.stylesheet.sprite=o,o?this._loadSprite(o,!0,p):(this._unloadSprite(),p&&p(null)))}}hr.registerForPluginStateChange=y.aK;var dc=y.Q([{name:"a_pos",type:"Int16",components:2}]),Il="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const oi={prelude:It("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\n","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"),background:It("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:It("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:It("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:It("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:It("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:It("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:It("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:It("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:It("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:It("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:It("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:It("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:It("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:It("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:It("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:It("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:It("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:It("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:It("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:It("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:It("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:It("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:It("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:It("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:It("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:It("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Il),terrainDepth:It("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Il),terrainCoords:It("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Il)};function It(v,o){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=o.match(/attribute ([\w]+) ([\w]+)/g),g=v.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=x?x.concat(g):g,T={};return{fragmentSource:v=v.replace(u,(I,P,k,O,V)=>(T[V]=!0,"define"===P?`\n#ifndef HAS_UNIFORM_u_${V}\nvarying ${k} ${O} ${V};\n#else\nuniform ${k} ${O} u_${V};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${V}\n    ${k} ${O} ${V} = u_${V};\n#endif\n`)),vertexSource:o=o.replace(u,(I,P,k,O,V)=>{const K="float"===O?"vec2":"vec4",Z=V.match(/color/)?"color":K;return T[V]?"define"===P?`\n#ifndef HAS_UNIFORM_u_${V}\nuniform lowp float u_${V}_t;\nattribute ${k} ${K} a_${V};\nvarying ${k} ${O} ${V};\n#else\nuniform ${k} ${O} u_${V};\n#endif\n`:"vec4"===Z?`\n#ifndef HAS_UNIFORM_u_${V}\n    ${V} = a_${V};\n#else\n    ${k} ${O} ${V} = u_${V};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${V}\n    ${V} = unpack_mix_${Z}(a_${V}, u_${V}_t);\n#else\n    ${k} ${O} ${V} = u_${V};\n#endif\n`:"define"===P?`\n#ifndef HAS_UNIFORM_u_${V}\nuniform lowp float u_${V}_t;\nattribute ${k} ${K} a_${V};\n#else\nuniform ${k} ${O} u_${V};\n#endif\n`:"vec4"===Z?`\n#ifndef HAS_UNIFORM_u_${V}\n    ${k} ${O} ${V} = a_${V};\n#else\n    ${k} ${O} ${V} = u_${V};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${V}\n    ${k} ${O} ${V} = unpack_mix_${Z}(a_${V}, u_${V}_t);\n#else\n    ${k} ${O} ${V} = u_${V};\n#endif\n`}),staticAttributes:p,staticUniforms:S}}class Ua{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,u,p,g,x,S,T,I,P){this.context=o;let k=this.boundPaintVertexBuffers.length!==g.length;for(let O=0;!k&&O<g.length;O++)this.boundPaintVertexBuffers[O]!==g[O]&&(k=!0);!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==p||k||this.boundIndexBuffer!==x||this.boundVertexOffset!==S||this.boundDynamicVertexBuffer!==T||this.boundDynamicVertexBuffer2!==I||this.boundDynamicVertexBuffer3!==P?this.freshBind(u,p,g,x,S,T,I,P):(o.bindVertexArray.set(this.vao),T&&T.bind(),x&&x.dynamicDraw&&x.bind(),I&&I.bind(),P&&P.bind())}freshBind(o,u,p,g,x,S,T,I){const P=o.numAttributes,k=this.context,O=k.gl;this.vao&&this.destroy(),this.vao=k.createVertexArray(),k.bindVertexArray.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=g,this.boundVertexOffset=x,this.boundDynamicVertexBuffer=S,this.boundDynamicVertexBuffer2=T,this.boundDynamicVertexBuffer3=I,u.enableAttributes(O,o);for(const V of p)V.enableAttributes(O,o);S&&S.enableAttributes(O,o),T&&T.enableAttributes(O,o),I&&I.enableAttributes(O,o),u.bind(),u.setVertexAttribPointers(O,o,x);for(const V of p)V.bind(),V.setVertexAttribPointers(O,o,x);S&&(S.bind(),S.setVertexAttribPointers(O,o,x)),g&&g.bind(),T&&(T.bind(),T.setVertexAttribPointers(O,o,x)),I&&(I.bind(),I.setVertexAttribPointers(O,o,x)),k.currentNumAttributes=P}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function yn(v){const o=[];for(let u=0;u<v.length;u++){if(null===v[u])continue;const p=v[u].split(" ");o.push(p.pop())}return o}class Et{constructor(o,u,p,g,x,S){const T=o.gl;this.program=T.createProgram();const I=yn(u.staticAttributes),P=p?p.getBinderAttributes():[],k=I.concat(P),O=oi.prelude.staticUniforms?yn(oi.prelude.staticUniforms):[],V=u.staticUniforms?yn(u.staticUniforms):[],K=p?p.getBinderUniforms():[],Z=O.concat(V).concat(K),Y=[];for(const be of Z)Y.indexOf(be)<0&&Y.push(be);const G=p?p.defines():[];x&&G.push("#define OVERDRAW_INSPECTOR;"),S&&G.push("#define TERRAIN3D;");const le=G.concat(oi.prelude.fragmentSource,u.fragmentSource).join("\n"),ge=G.concat(oi.prelude.vertexSource,u.vertexSource).join("\n"),ie=T.createShader(T.FRAGMENT_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);if(T.shaderSource(ie,le),T.compileShader(ie),!T.getShaderParameter(ie,T.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${T.getShaderInfoLog(ie)}`);T.attachShader(this.program,ie);const he=T.createShader(T.VERTEX_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);if(T.shaderSource(he,ge),T.compileShader(he),!T.getShaderParameter(he,T.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${T.getShaderInfoLog(he)}`);T.attachShader(this.program,he),this.attributes={};const _e={};this.numAttributes=k.length;for(let be=0;be<this.numAttributes;be++)k[be]&&(T.bindAttribLocation(this.program,be,k[be]),this.attributes[k[be]]=be);if(T.linkProgram(this.program),!T.getProgramParameter(this.program,T.LINK_STATUS))throw new Error(`Program failed to link: ${T.getProgramInfoLog(this.program)}`);T.deleteShader(he),T.deleteShader(ie);for(let be=0;be<Y.length;be++){const Ee=Y[be];if(Ee&&!_e[Ee]){const Me=T.getUniformLocation(this.program,Ee);Me&&(_e[Ee]=Me)}}var be,Ee;this.fixedUniforms=g(o,_e),this.terrainUniforms={u_depth:new y.aL(be=o,(Ee=_e).u_depth),u_terrain:new y.aL(be,Ee.u_terrain),u_terrain_dim:new y.aM(be,Ee.u_terrain_dim),u_terrain_matrix:new y.aN(be,Ee.u_terrain_matrix),u_terrain_unpack:new y.aO(be,Ee.u_terrain_unpack),u_terrain_exaggeration:new y.aM(be,Ee.u_terrain_exaggeration)},this.binderUniforms=p?p.getUniforms(o,_e):[]}draw(o,u,p,g,x,S,T,I,P,k,O,V,K,Z,Y,G,le,ge){const ie=o.gl;if(this.failedToCreate)return;if(o.program.set(this.program),o.setDepthMode(p),o.setStencilMode(g),o.setColorMode(x),o.setCullFace(S),I){o.activeTexture.set(ie.TEXTURE2),ie.bindTexture(ie.TEXTURE_2D,I.depthTexture),o.activeTexture.set(ie.TEXTURE3),ie.bindTexture(ie.TEXTURE_2D,I.texture);for(const _e in this.terrainUniforms)this.terrainUniforms[_e].set(I[_e])}for(const _e in this.fixedUniforms)this.fixedUniforms[_e].set(T[_e]);Y&&Y.setUniforms(o,this.binderUniforms,K,{zoom:Z});let he=0;switch(u){case ie.LINES:he=2;break;case ie.TRIANGLES:he=3;break;case ie.LINE_STRIP:he=1}for(const _e of V.get()){const be=_e.vaos||(_e.vaos={});(be[P]||(be[P]=new Ua)).bind(o,this,k,Y?Y.getPaintVertexBuffers():[],O,_e.vertexOffset,G,le,ge),ie.drawElements(u,_e.primitiveLength*he,ie.UNSIGNED_SHORT,_e.primitiveOffset*he*2)}}}function us(v,o,u){const p=1/ae(u,1,o.transform.tileZoom),g=Math.pow(2,u.tileID.overscaledZ),x=u.tileSize*Math.pow(2,o.transform.tileZoom)/g,S=x*(u.tileID.canonical.x+u.tileID.wrap*g),T=x*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[p,v.fromScale,v.toScale],u_fade:v.t,u_pixel_coord_upper:[S>>16,T>>16],u_pixel_coord_lower:[65535&S,65535&T]}}const fc=(v,o,u,p)=>{const g=o.style.light,x=g.properties.get("position"),S=[x.x,x.y,x.z],T=(P=new y.A(9),y.A!=Float32Array&&(P[1]=0,P[2]=0,P[3]=0,P[5]=0,P[6]=0,P[7]=0),P[0]=1,P[4]=1,P[8]=1,P);var P;"viewport"===g.properties.get("anchor")&&function(P,k){var O=Math.sin(k),V=Math.cos(k);P[0]=V,P[1]=O,P[2]=0,P[3]=-O,P[4]=V,P[5]=0,P[6]=0,P[7]=0,P[8]=1}(T,-o.transform.angle),function(P,k,O){var V=k[0],K=k[1],Z=k[2];P[0]=V*O[0]+K*O[3]+Z*O[6],P[1]=V*O[1]+K*O[4]+Z*O[7],P[2]=V*O[2]+K*O[5]+Z*O[8]}(S,S,T);const I=g.properties.get("color");return{u_matrix:v,u_lightpos:S,u_lightintensity:g.properties.get("intensity"),u_lightcolor:[I.r,I.g,I.b],u_vertical_gradient:+u,u_opacity:p}},tr=(v,o,u,p,g,x,S)=>y.e(fc(v,o,u,p),us(x,o,S),{u_height_factor:-Math.pow(2,g.overscaledZ)/S.tileSize/8}),Od=v=>({u_matrix:v}),fh=(v,o,u,p)=>y.e(Od(v),us(u,o,p)),wn=(v,o)=>({u_matrix:v,u_world:o}),Va=(v,o,u,p,g)=>y.e(fh(v,o,u,p),{u_world:g}),Kn=(v,o,u,p)=>{const g=v.transform;let x,S;if("map"===p.paint.get("circle-pitch-alignment")){const T=ae(u,1,g.zoom);x=!0,S=[T,T]}else x=!1,S=g.pixelsToGLUnits;return{u_camera_to_center_distance:g.cameraToCenterDistance,u_scale_with_map:+("map"===p.paint.get("circle-pitch-scale")),u_matrix:v.translatePosMatrix(o.posMatrix,u,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_pitch_with_map:+x,u_device_pixel_ratio:v.pixelRatio,u_extrude_scale:S}},pc=(v,o,u)=>{const p=ae(u,1,o.zoom),g=Math.pow(2,o.zoom-u.tileID.overscaledZ),x=u.tileID.overscaleFactor();return{u_matrix:v,u_camera_to_center_distance:o.cameraToCenterDistance,u_pixels_to_tile_units:p,u_extrude_scale:[o.pixelsToGLUnits[0]/(p*g),o.pixelsToGLUnits[1]/(p*g)],u_overscale_factor:x}},mc=(v,o,u=1)=>({u_matrix:v,u_color:o,u_overlay:0,u_overlay_scale:u}),yu=v=>({u_matrix:v}),Ot=(v,o,u,p)=>({u_matrix:v,u_extrude_scale:ae(o,1,u),u_intensity:p});function gc(v,o){const u=Math.pow(2,o.canonical.z),p=o.canonical.y;return[new y.U(0,p/u).toLngLat().lat,new y.U(0,(p+1)/u).toLngLat().lat]}const yc=(v,o,u,p)=>{const g=v.transform;return{u_matrix:Lt(v,o,u,p),u_ratio:1/ae(o,1,g.zoom),u_device_pixel_ratio:v.pixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},Ap=(v,o,u,p,g)=>y.e(yc(v,o,u,g),{u_image:0,u_image_height:p}),Nd=(v,o,u,p,g)=>{const x=v.transform,S=_c(o,x);return{u_matrix:Lt(v,o,u,g),u_texsize:o.imageAtlasTexture.size,u_ratio:1/ae(o,1,x.zoom),u_device_pixel_ratio:v.pixelRatio,u_image:0,u_scale:[S,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},Ie=(v,o,u,p,g,x)=>{const S=v.lineAtlas,T=_c(o,v.transform),I="round"===u.layout.get("line-cap"),P=S.getDash(p.from,I),k=S.getDash(p.to,I),O=P.width*g.fromScale,V=k.width*g.toScale;return y.e(yc(v,o,u,x),{u_patternscale_a:[T/O,-P.height/2],u_patternscale_b:[T/V,-k.height/2],u_sdfgamma:S.width/(256*Math.min(O,V)*v.pixelRatio)/2,u_image:0,u_tex_y_a:P.y,u_tex_y_b:k.y,u_mix:g.t})};function _c(v,o){return 1/ae(v,1,o.tileZoom)}function Lt(v,o,u,p){return v.translatePosMatrix(p?p.posMatrix:o.tileID.posMatrix,o,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const Tn=(v,o,u,p,g)=>{return{u_matrix:v,u_tl_parent:o,u_scale_parent:u,u_buffer_scale:1,u_fade_t:p.mix,u_opacity:p.opacity*g.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:g.paint.get("raster-brightness-min"),u_brightness_high:g.paint.get("raster-brightness-max"),u_saturation_factor:(S=g.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(x=g.paint.get("raster-contrast"),x>0?1/(1-x):1+x),u_spin_weights:Fd(g.paint.get("raster-hue-rotate"))};var x,S};function Fd(v){v*=Math.PI/180;const o=Math.sin(v),u=Math.cos(v);return[(2*u+1)/3,(-Math.sqrt(3)*o-u+1)/3,(Math.sqrt(3)*o-u+1)/3]}const zd=(v,o,u,p,g,x,S,T,I,P)=>{const k=g.transform;return{u_is_size_zoom_constant:+("constant"===v||"source"===v),u_is_size_feature_constant:+("constant"===v||"camera"===v),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:k.cameraToCenterDistance,u_pitch:k.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:k.width/k.height,u_fade_change:g.options.fadeDuration?g.symbolFadeChange:1,u_matrix:x,u_label_plane_matrix:S,u_coord_matrix:T,u_is_text:+I,u_pitch_with_map:+p,u_texsize:P,u_texture:0}},ph=(v,o,u,p,g,x,S,T,I,P,k)=>{const O=g.transform;return y.e(zd(v,o,u,p,g,x,S,T,I,P),{u_gamma_scale:p?Math.cos(O._pitch)*O.cameraToCenterDistance:1,u_device_pixel_ratio:g.pixelRatio,u_is_halo:+k})},Io=(v,o,u,p,g,x,S,T,I,P)=>y.e(ph(v,o,u,p,g,x,S,T,!0,I,!0),{u_texsize_icon:P,u_texture_icon:1}),wr=(v,o,u)=>({u_matrix:v,u_opacity:o,u_color:u}),qs=(v,o,u,p,g,x)=>y.e(function(S,T,I,P){const k=I.imageManager.getPattern(S.from.toString()),O=I.imageManager.getPattern(S.to.toString()),{width:V,height:K}=I.imageManager.getPixelSize(),Z=Math.pow(2,P.tileID.overscaledZ),Y=P.tileSize*Math.pow(2,I.transform.tileZoom)/Z,G=Y*(P.tileID.canonical.x+P.tileID.wrap*Z),le=Y*P.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:k.tl,u_pattern_br_a:k.br,u_pattern_tl_b:O.tl,u_pattern_br_b:O.br,u_texsize:[V,K],u_mix:T.t,u_pattern_size_a:k.displaySize,u_pattern_size_b:O.displaySize,u_scale_a:T.fromScale,u_scale_b:T.toScale,u_tile_units_to_pixels:1/ae(P,1,I.transform.tileZoom),u_pixel_coord_upper:[G>>16,le>>16],u_pixel_coord_lower:[65535&G,65535&le]}}(p,x,u,g),{u_matrix:v,u_opacity:o}),_u={fillExtrusion:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix),u_lightpos:new y.aP(v,o.u_lightpos),u_lightintensity:new y.aM(v,o.u_lightintensity),u_lightcolor:new y.aP(v,o.u_lightcolor),u_vertical_gradient:new y.aM(v,o.u_vertical_gradient),u_opacity:new y.aM(v,o.u_opacity)}),fillExtrusionPattern:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix),u_lightpos:new y.aP(v,o.u_lightpos),u_lightintensity:new y.aM(v,o.u_lightintensity),u_lightcolor:new y.aP(v,o.u_lightcolor),u_vertical_gradient:new y.aM(v,o.u_vertical_gradient),u_height_factor:new y.aM(v,o.u_height_factor),u_image:new y.aL(v,o.u_image),u_texsize:new y.aQ(v,o.u_texsize),u_pixel_coord_upper:new y.aQ(v,o.u_pixel_coord_upper),u_pixel_coord_lower:new y.aQ(v,o.u_pixel_coord_lower),u_scale:new y.aP(v,o.u_scale),u_fade:new y.aM(v,o.u_fade),u_opacity:new y.aM(v,o.u_opacity)}),fill:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix)}),fillPattern:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix),u_image:new y.aL(v,o.u_image),u_texsize:new y.aQ(v,o.u_texsize),u_pixel_coord_upper:new y.aQ(v,o.u_pixel_coord_upper),u_pixel_coord_lower:new y.aQ(v,o.u_pixel_coord_lower),u_scale:new y.aP(v,o.u_scale),u_fade:new y.aM(v,o.u_fade)}),fillOutline:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix),u_world:new y.aQ(v,o.u_world)}),fillOutlinePattern:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix),u_world:new y.aQ(v,o.u_world),u_image:new y.aL(v,o.u_image),u_texsize:new y.aQ(v,o.u_texsize),u_pixel_coord_upper:new y.aQ(v,o.u_pixel_coord_upper),u_pixel_coord_lower:new y.aQ(v,o.u_pixel_coord_lower),u_scale:new y.aP(v,o.u_scale),u_fade:new y.aM(v,o.u_fade)}),circle:(v,o)=>({u_camera_to_center_distance:new y.aM(v,o.u_camera_to_center_distance),u_scale_with_map:new y.aL(v,o.u_scale_with_map),u_pitch_with_map:new y.aL(v,o.u_pitch_with_map),u_extrude_scale:new y.aQ(v,o.u_extrude_scale),u_device_pixel_ratio:new y.aM(v,o.u_device_pixel_ratio),u_matrix:new y.aN(v,o.u_matrix)}),collisionBox:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix),u_camera_to_center_distance:new y.aM(v,o.u_camera_to_center_distance),u_pixels_to_tile_units:new y.aM(v,o.u_pixels_to_tile_units),u_extrude_scale:new y.aQ(v,o.u_extrude_scale),u_overscale_factor:new y.aM(v,o.u_overscale_factor)}),collisionCircle:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix),u_inv_matrix:new y.aN(v,o.u_inv_matrix),u_camera_to_center_distance:new y.aM(v,o.u_camera_to_center_distance),u_viewport_size:new y.aQ(v,o.u_viewport_size)}),debug:(v,o)=>({u_color:new y.aR(v,o.u_color),u_matrix:new y.aN(v,o.u_matrix),u_overlay:new y.aL(v,o.u_overlay),u_overlay_scale:new y.aM(v,o.u_overlay_scale)}),clippingMask:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix)}),heatmap:(v,o)=>({u_extrude_scale:new y.aM(v,o.u_extrude_scale),u_intensity:new y.aM(v,o.u_intensity),u_matrix:new y.aN(v,o.u_matrix)}),heatmapTexture:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix),u_world:new y.aQ(v,o.u_world),u_image:new y.aL(v,o.u_image),u_color_ramp:new y.aL(v,o.u_color_ramp),u_opacity:new y.aM(v,o.u_opacity)}),hillshade:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix),u_image:new y.aL(v,o.u_image),u_latrange:new y.aQ(v,o.u_latrange),u_light:new y.aQ(v,o.u_light),u_shadow:new y.aR(v,o.u_shadow),u_highlight:new y.aR(v,o.u_highlight),u_accent:new y.aR(v,o.u_accent)}),hillshadePrepare:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix),u_image:new y.aL(v,o.u_image),u_dimension:new y.aQ(v,o.u_dimension),u_zoom:new y.aM(v,o.u_zoom),u_unpack:new y.aO(v,o.u_unpack)}),line:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix),u_ratio:new y.aM(v,o.u_ratio),u_device_pixel_ratio:new y.aM(v,o.u_device_pixel_ratio),u_units_to_pixels:new y.aQ(v,o.u_units_to_pixels)}),lineGradient:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix),u_ratio:new y.aM(v,o.u_ratio),u_device_pixel_ratio:new y.aM(v,o.u_device_pixel_ratio),u_units_to_pixels:new y.aQ(v,o.u_units_to_pixels),u_image:new y.aL(v,o.u_image),u_image_height:new y.aM(v,o.u_image_height)}),linePattern:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix),u_texsize:new y.aQ(v,o.u_texsize),u_ratio:new y.aM(v,o.u_ratio),u_device_pixel_ratio:new y.aM(v,o.u_device_pixel_ratio),u_image:new y.aL(v,o.u_image),u_units_to_pixels:new y.aQ(v,o.u_units_to_pixels),u_scale:new y.aP(v,o.u_scale),u_fade:new y.aM(v,o.u_fade)}),lineSDF:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix),u_ratio:new y.aM(v,o.u_ratio),u_device_pixel_ratio:new y.aM(v,o.u_device_pixel_ratio),u_units_to_pixels:new y.aQ(v,o.u_units_to_pixels),u_patternscale_a:new y.aQ(v,o.u_patternscale_a),u_patternscale_b:new y.aQ(v,o.u_patternscale_b),u_sdfgamma:new y.aM(v,o.u_sdfgamma),u_image:new y.aL(v,o.u_image),u_tex_y_a:new y.aM(v,o.u_tex_y_a),u_tex_y_b:new y.aM(v,o.u_tex_y_b),u_mix:new y.aM(v,o.u_mix)}),raster:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix),u_tl_parent:new y.aQ(v,o.u_tl_parent),u_scale_parent:new y.aM(v,o.u_scale_parent),u_buffer_scale:new y.aM(v,o.u_buffer_scale),u_fade_t:new y.aM(v,o.u_fade_t),u_opacity:new y.aM(v,o.u_opacity),u_image0:new y.aL(v,o.u_image0),u_image1:new y.aL(v,o.u_image1),u_brightness_low:new y.aM(v,o.u_brightness_low),u_brightness_high:new y.aM(v,o.u_brightness_high),u_saturation_factor:new y.aM(v,o.u_saturation_factor),u_contrast_factor:new y.aM(v,o.u_contrast_factor),u_spin_weights:new y.aP(v,o.u_spin_weights)}),symbolIcon:(v,o)=>({u_is_size_zoom_constant:new y.aL(v,o.u_is_size_zoom_constant),u_is_size_feature_constant:new y.aL(v,o.u_is_size_feature_constant),u_size_t:new y.aM(v,o.u_size_t),u_size:new y.aM(v,o.u_size),u_camera_to_center_distance:new y.aM(v,o.u_camera_to_center_distance),u_pitch:new y.aM(v,o.u_pitch),u_rotate_symbol:new y.aL(v,o.u_rotate_symbol),u_aspect_ratio:new y.aM(v,o.u_aspect_ratio),u_fade_change:new y.aM(v,o.u_fade_change),u_matrix:new y.aN(v,o.u_matrix),u_label_plane_matrix:new y.aN(v,o.u_label_plane_matrix),u_coord_matrix:new y.aN(v,o.u_coord_matrix),u_is_text:new y.aL(v,o.u_is_text),u_pitch_with_map:new y.aL(v,o.u_pitch_with_map),u_texsize:new y.aQ(v,o.u_texsize),u_texture:new y.aL(v,o.u_texture)}),symbolSDF:(v,o)=>({u_is_size_zoom_constant:new y.aL(v,o.u_is_size_zoom_constant),u_is_size_feature_constant:new y.aL(v,o.u_is_size_feature_constant),u_size_t:new y.aM(v,o.u_size_t),u_size:new y.aM(v,o.u_size),u_camera_to_center_distance:new y.aM(v,o.u_camera_to_center_distance),u_pitch:new y.aM(v,o.u_pitch),u_rotate_symbol:new y.aL(v,o.u_rotate_symbol),u_aspect_ratio:new y.aM(v,o.u_aspect_ratio),u_fade_change:new y.aM(v,o.u_fade_change),u_matrix:new y.aN(v,o.u_matrix),u_label_plane_matrix:new y.aN(v,o.u_label_plane_matrix),u_coord_matrix:new y.aN(v,o.u_coord_matrix),u_is_text:new y.aL(v,o.u_is_text),u_pitch_with_map:new y.aL(v,o.u_pitch_with_map),u_texsize:new y.aQ(v,o.u_texsize),u_texture:new y.aL(v,o.u_texture),u_gamma_scale:new y.aM(v,o.u_gamma_scale),u_device_pixel_ratio:new y.aM(v,o.u_device_pixel_ratio),u_is_halo:new y.aL(v,o.u_is_halo)}),symbolTextAndIcon:(v,o)=>({u_is_size_zoom_constant:new y.aL(v,o.u_is_size_zoom_constant),u_is_size_feature_constant:new y.aL(v,o.u_is_size_feature_constant),u_size_t:new y.aM(v,o.u_size_t),u_size:new y.aM(v,o.u_size),u_camera_to_center_distance:new y.aM(v,o.u_camera_to_center_distance),u_pitch:new y.aM(v,o.u_pitch),u_rotate_symbol:new y.aL(v,o.u_rotate_symbol),u_aspect_ratio:new y.aM(v,o.u_aspect_ratio),u_fade_change:new y.aM(v,o.u_fade_change),u_matrix:new y.aN(v,o.u_matrix),u_label_plane_matrix:new y.aN(v,o.u_label_plane_matrix),u_coord_matrix:new y.aN(v,o.u_coord_matrix),u_is_text:new y.aL(v,o.u_is_text),u_pitch_with_map:new y.aL(v,o.u_pitch_with_map),u_texsize:new y.aQ(v,o.u_texsize),u_texsize_icon:new y.aQ(v,o.u_texsize_icon),u_texture:new y.aL(v,o.u_texture),u_texture_icon:new y.aL(v,o.u_texture_icon),u_gamma_scale:new y.aM(v,o.u_gamma_scale),u_device_pixel_ratio:new y.aM(v,o.u_device_pixel_ratio),u_is_halo:new y.aL(v,o.u_is_halo)}),background:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix),u_opacity:new y.aM(v,o.u_opacity),u_color:new y.aR(v,o.u_color)}),backgroundPattern:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix),u_opacity:new y.aM(v,o.u_opacity),u_image:new y.aL(v,o.u_image),u_pattern_tl_a:new y.aQ(v,o.u_pattern_tl_a),u_pattern_br_a:new y.aQ(v,o.u_pattern_br_a),u_pattern_tl_b:new y.aQ(v,o.u_pattern_tl_b),u_pattern_br_b:new y.aQ(v,o.u_pattern_br_b),u_texsize:new y.aQ(v,o.u_texsize),u_mix:new y.aM(v,o.u_mix),u_pattern_size_a:new y.aQ(v,o.u_pattern_size_a),u_pattern_size_b:new y.aQ(v,o.u_pattern_size_b),u_scale_a:new y.aM(v,o.u_scale_a),u_scale_b:new y.aM(v,o.u_scale_b),u_pixel_coord_upper:new y.aQ(v,o.u_pixel_coord_upper),u_pixel_coord_lower:new y.aQ(v,o.u_pixel_coord_lower),u_tile_units_to_pixels:new y.aM(v,o.u_tile_units_to_pixels)}),terrain:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix),u_texture:new y.aL(v,o.u_texture),u_ele_delta:new y.aM(v,o.u_ele_delta)}),terrainDepth:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix),u_ele_delta:new y.aM(v,o.u_ele_delta)}),terrainCoords:(v,o)=>({u_matrix:new y.aN(v,o.u_matrix),u_texture:new y.aL(v,o.u_texture),u_terrain_coords_id:new y.aM(v,o.u_terrain_coords_id),u_ele_delta:new y.aM(v,o.u_ele_delta)})};class mh{constructor(o,u,p){this.context=o;const g=o.gl;this.buffer=g.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Gs={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class gh{constructor(o,u,p,g){this.length=u.length,this.attributes=p,this.itemSize=u.bytesPerElement,this.dynamicDraw=g,this.context=o;const x=o.gl;this.buffer=x.createBuffer(),o.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){if(o.length!==this.length)throw new Error(`Length of new data is ${o.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,u){for(let p=0;p<this.attributes.length;p++){const g=u.attributes[this.attributes[p].name];void 0!==g&&o.enableVertexAttribArray(g)}}setVertexAttribPointers(o,u,p){for(let g=0;g<this.attributes.length;g++){const x=this.attributes[g],S=u.attributes[x.name];void 0!==S&&o.vertexAttribPointer(S,x.components,o[Gs[x.type]],!1,this.itemSize,x.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const vc=new WeakMap;function ja(v){var o;if(vc.has(v))return vc.get(v);{const u=null===(o=v.getParameter(v.VERSION))||void 0===o?void 0:o.startsWith("WebGL 2.0");return vc.set(v,u),u}}class cn{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class vu extends cn{getDefault(){return y.aT.transparent}set(o){const u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Ds extends cn{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class hs extends cn{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class Bd extends cn{getDefault(){return[!0,!0,!0,!0]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Nr extends cn{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class St extends cn{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class Ud extends cn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const u=this.current;(o.func!==u.func||o.ref!==u.ref||o.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Vd extends cn{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class yh extends cn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=o,this.dirty=!1}}class ft extends cn{getDefault(){return[0,1]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class jd extends cn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=o,this.dirty=!1}}class $i extends cn{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class bc extends cn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.BLEND):u.disable(u.BLEND),this.current=o,this.dirty=!1}}class $d extends cn{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class $a extends cn{getDefault(){return y.aT.transparent}set(o){const u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Mp extends cn{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class bu extends cn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=o,this.dirty=!1}}class xu extends cn{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class _h extends cn{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class Hd extends cn{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class Pp extends cn{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class en extends cn{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Al extends cn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class wu extends cn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Cr extends cn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Ha extends cn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Rp extends cn{getDefault(){return null}set(o){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Vn extends cn{getDefault(){return null}set(o){var u;if(o===this.current&&!this.dirty)return;const p=this.gl;ja(p)?p.bindVertexArray(o):null===(u=p.getExtension("OES_vertex_array_object"))||void 0===u||u.bindVertexArrayOES(o),this.current=o,this.dirty=!1}}class qd extends cn{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Ml extends cn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class ut extends cn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class ao extends cn{constructor(o,u){super(o),this.context=o,this.parent=u}getDefault(){return null}}class oa extends ao{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class vh extends ao{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class xc extends ao{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class vn{constructor(o,u,p,g,x){this.context=o,this.width=u,this.height=p;const S=o.gl,T=this.framebuffer=S.createFramebuffer();if(this.colorAttachment=new oa(o,T),g)this.depthAttachment=x?new xc(o,T):new vh(o,T);else if(x)throw new Error("Stencil cannot be setted without depth");if(S.checkFramebufferStatus(S.FRAMEBUFFER)!==S.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const o=this.context.gl,u=this.colorAttachment.get();if(u&&o.deleteTexture(u),this.depthAttachment){const p=this.depthAttachment.get();p&&o.deleteRenderbuffer(p)}o.deleteFramebuffer(this.framebuffer)}}class Xn{constructor(o,u,p){this.blendFunction=o,this.blendColor=u,this.mask=p}}Xn.Replace=[1,0],Xn.disabled=new Xn(Xn.Replace,y.aT.transparent,[!1,!1,!1,!1]),Xn.unblended=new Xn(Xn.Replace,y.aT.transparent,[!0,!0,!0,!0]),Xn.alphaBlended=new Xn([1,771],y.aT.transparent,[!0,!0,!0,!0]);class Ug{constructor(o){var u,p;if(this.gl=o,this.clearColor=new vu(this),this.clearDepth=new Ds(this),this.clearStencil=new hs(this),this.colorMask=new Bd(this),this.depthMask=new Nr(this),this.stencilMask=new St(this),this.stencilFunc=new Ud(this),this.stencilOp=new Vd(this),this.stencilTest=new yh(this),this.depthRange=new ft(this),this.depthTest=new jd(this),this.depthFunc=new $i(this),this.blend=new bc(this),this.blendFunc=new $d(this),this.blendColor=new $a(this),this.blendEquation=new Mp(this),this.cullFace=new bu(this),this.cullFaceSide=new xu(this),this.frontFace=new _h(this),this.program=new Hd(this),this.activeTexture=new Pp(this),this.viewport=new en(this),this.bindFramebuffer=new Al(this),this.bindRenderbuffer=new wu(this),this.bindTexture=new Cr(this),this.bindVertexBuffer=new Ha(this),this.bindElementBuffer=new Rp(this),this.bindVertexArray=new Vn(this),this.pixelStoreUnpack=new qd(this),this.pixelStoreUnpackPremultiplyAlpha=new Ml(this),this.pixelStoreUnpackFlipY=new ut(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),ja(o)){this.HALF_FLOAT=o.HALF_FLOAT;const g=o.getExtension("EXT_color_buffer_half_float");this.RGBA16F=null!==(u=o.RGBA16F)&&void 0!==u?u:g?.RGBA16F_EXT,this.RGB16F=null!==(p=o.RGB16F)&&void 0!==p?p:g?.RGB16F_EXT,o.getExtension("EXT_color_buffer_float")}else{o.getExtension("EXT_color_buffer_half_float"),o.getExtension("OES_texture_half_float_linear");const g=o.getExtension("OES_texture_half_float");this.HALF_FLOAT=g?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,u){return new mh(this,o,u)}createVertexBuffer(o,u,p){return new gh(this,o,u,p)}createRenderbuffer(o,u,p){const g=this.gl,x=g.createRenderbuffer();return this.bindRenderbuffer.set(x),g.renderbufferStorage(g.RENDERBUFFER,o,u,p),this.bindRenderbuffer.set(null),x}createFramebuffer(o,u,p,g){return new vn(this,o,u,p,g)}clear({color:o,depth:u,stencil:p}){const g=this.gl;let x=0;o&&(x|=g.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),void 0!==u&&(x|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),void 0!==p&&(x|=g.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),g.clear(x)}setCullFace(o){!1===o.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){y.aG(o.blendFunction,Xn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}createVertexArray(){var o;return ja(this.gl)?this.gl.createVertexArray():null===(o=this.gl.getExtension("OES_vertex_array_object"))||void 0===o?void 0:o.createVertexArrayOES()}deleteVertexArray(o){var u;return ja(this.gl)?this.gl.deleteVertexArray(o):null===(u=this.gl.getExtension("OES_vertex_array_object"))||void 0===u?void 0:u.deleteVertexArrayOES(o)}unbindVAO(){this.bindVertexArray.set(null)}}class un{constructor(o,u,p){this.func=o,this.mask=u,this.range=p}}un.ReadOnly=!1,un.ReadWrite=!0,un.disabled=new un(519,un.ReadOnly,[0,1]);class gi{constructor(o,u,p,g,x,S){this.test=o,this.ref=u,this.mask=p,this.fail=g,this.depthFail=x,this.pass=S}}gi.disabled=new gi({func:519,mask:0},0,0,7680,7680,7680);class ai{constructor(o,u,p){this.enable=o,this.mode=u,this.frontFace=p}}let Ao;function Cu(v,o,u,p,g,x,S){const T=v.context,I=T.gl,P=v.useProgram("collisionBox"),k=[];let O=0,V=0;for(let ie=0;ie<p.length;ie++){const he=p[ie],_e=o.getTile(he),be=_e.getBucket(u);if(!be)continue;let Ee=he.posMatrix;0===g[0]&&0===g[1]||(Ee=v.translatePosMatrix(he.posMatrix,_e,g,x));const Me=S?be.textCollisionBox:be.iconCollisionBox,Ae=be.collisionCircleArray;if(Ae.length>0){const Ne=y.Z(),We=Ee;y.aU(Ne,be.placementInvProjMatrix,v.transform.glCoordMatrix),y.aU(Ne,Ne,be.placementViewportMatrix),k.push({circleArray:Ae,circleOffset:V,transform:We,invTransform:Ne,coord:he}),O+=Ae.length/4,V=O}Me&&P.draw(T,I.LINES,un.disabled,gi.disabled,v.colorModeForRenderPass(),ai.disabled,pc(Ee,v.transform,_e),v.style.map.terrain&&v.style.map.terrain.getTerrainData(he),u.id,Me.layoutVertexBuffer,Me.indexBuffer,Me.segments,null,v.transform.zoom,null,null,Me.collisionVertexBuffer)}if(!S||!k.length)return;const K=v.useProgram("collisionCircle"),Z=new y.aV;Z.resize(4*O),Z._trim();let Y=0;for(const ie of k)for(let he=0;he<ie.circleArray.length/4;he++){const _e=4*he,be=ie.circleArray[_e+0],Ee=ie.circleArray[_e+1],Me=ie.circleArray[_e+2],Ae=ie.circleArray[_e+3];Z.emplace(Y++,be,Ee,Me,Ae,0),Z.emplace(Y++,be,Ee,Me,Ae,1),Z.emplace(Y++,be,Ee,Me,Ae,2),Z.emplace(Y++,be,Ee,Me,Ae,3)}(!Ao||Ao.length<2*O)&&(Ao=function(ie){const he=2*ie,_e=new y.aX;_e.resize(he),_e._trim();for(let be=0;be<he;be++){const Ee=6*be;_e.uint16[Ee+0]=4*be+0,_e.uint16[Ee+1]=4*be+1,_e.uint16[Ee+2]=4*be+2,_e.uint16[Ee+3]=4*be+2,_e.uint16[Ee+4]=4*be+3,_e.uint16[Ee+5]=4*be+0}return _e}(O));const G=T.createIndexBuffer(Ao,!0),le=T.createVertexBuffer(Z,y.aW.members,!0);for(const ie of k){const he={u_matrix:ie.transform,u_inv_matrix:ie.invTransform,u_camera_to_center_distance:(ge=v.transform).cameraToCenterDistance,u_viewport_size:[ge.width,ge.height]};K.draw(T,I.TRIANGLES,un.disabled,gi.disabled,v.colorModeForRenderPass(),ai.disabled,he,v.style.map.terrain&&v.style.map.terrain.getTerrainData(ie.coord),u.id,le,G,y.S.simpleSegment(0,2*ie.circleOffset,ie.circleArray.length,ie.circleArray.length/2),null,v.transform.zoom,null,null,null)}var ge;le.destroy(),G.destroy()}ai.disabled=new ai(!1,1029,2305),ai.backCCW=new ai(!0,1029,2305);const Rl=y.ao(new Float32Array(16));function Eu(v,o,u,p,g,x){const{horizontalAlign:S,verticalAlign:T}=y.au(v);return new y.P((-(S-.5)*o/g+p[0])*x,(-(T-.5)*u/g+p[1])*x)}function Su(v,o,u,p,g,x,S,T,I,P,k){const O=v.text.placedSymbolArray,V=v.text.dynamicLayoutVertexArray,K=v.icon.dynamicLayoutVertexArray,Z={};V.clear();for(let Y=0;Y<O.length;Y++){const G=O.get(Y),le=G.hidden||!G.crossTileID||v.allowVerticalPlacement&&!G.placedOrientation?null:p[G.crossTileID];if(le){const ge=new y.P(G.anchorX,G.anchorY),ie=mi(ge,u?S:x,k),he=ra(g.cameraToCenterDistance,ie.signedDistanceFromCamera);let _e=y.aj(v.textSizeData,I,G)*he/y.ap;u&&(_e*=v.tilePixelRatio/T);const{width:be,height:Ee,anchor:Me,textOffset:Ae,textBoxScale:Ne}=le,We=Eu(Me,be,Ee,Ae,Ne,_e),jt=u?mi(ge.add(We),x,k).point:ie.point.add(o?We.rotate(-g.angle):We),Oe=v.allowVerticalPlacement&&G.placedOrientation===y.ai.vertical?Math.PI/2:0;for(let vt=0;vt<G.numGlyphs;vt++)y.ak(V,jt,Oe);P&&G.associatedIconIndex>=0&&(Z[G.associatedIconIndex]={shiftedAnchor:jt,angle:Oe})}else q(G.numGlyphs,V)}if(P){K.clear();const Y=v.icon.placedSymbolArray;for(let G=0;G<Y.length;G++){const le=Y.get(G);if(le.hidden)q(le.numGlyphs,K);else{const ge=Z[G];if(ge)for(let ie=0;ie<le.numGlyphs;ie++)y.ak(K,ge.shiftedAnchor,ge.angle);else q(le.numGlyphs,K)}}v.icon.dynamicLayoutVertexBuffer.updateData(K)}v.text.dynamicLayoutVertexBuffer.updateData(V)}function bh(v,o,u){return u.iconsInText&&o?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function wc(v,o,u,p,g,x,S,T,I,P,k,O){const V=v.context,K=V.gl,Z=v.transform,Y="map"===T,G="map"===I,le="viewport"!==T&&"point"!==u.layout.get("symbol-placement"),ge=Y&&!G&&!le,ie=!u.layout.get("symbol-sort-key").isConstant();let he=!1;const _e=v.depthModeForSublayer(0,un.ReadOnly),be=u._unevaluatedLayout.hasValue("text-variable-anchor")||u._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ee=[];for(const Me of p){const Ae=o.getTile(Me),Ne=Ae.getBucket(u);if(!Ne)continue;const We=g?Ne.text:Ne.icon;if(!We||!We.segments.get().length||!We.hasVisibleVertices)continue;const jt=We.programConfigurations.get(u.id),Oe=g||Ne.sdfIcons,vt=g?Ne.textSizeData:Ne.iconSizeData,st=G||0!==Z.pitch,An=v.useProgram(bh(Oe,g,Ne),jt),qt=y.ah(vt,Z.zoom),Nt=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Me);let Zt,ci,Fn,ir,zi=[0,0],Ci=null;if(g)ci=Ae.glyphAtlasTexture,Fn=K.LINEAR,Zt=Ae.glyphAtlasTexture.size,Ne.iconsInText&&(zi=Ae.imageAtlasTexture.size,Ci=Ae.imageAtlasTexture,ir=st||v.options.rotating||v.options.zooming||"composite"===vt.kind||"camera"===vt.kind?K.LINEAR:K.NEAREST);else{const ui=1!==u.layout.get("icon-size").constantOr(0)||Ne.iconsNeedLinear;ci=Ae.imageAtlasTexture,Fn=Oe||v.options.rotating||v.options.zooming||ui||st?K.LINEAR:K.NEAREST,Zt=Ae.imageAtlasTexture.size}const Tr=ae(Ae,1,v.transform.zoom),Rn=ke(Me.posMatrix,G,Y,v.transform,Tr),Ur=$s(Me.posMatrix,G,Y,v.transform,Tr),Ys=be&&Ne.hasTextData(),el="none"!==u.layout.get("icon-text-fit")&&Ys&&Ne.hasIconData();if(le){const ui=v.style.map.terrain?(Ir,Ai)=>v.style.map.terrain.getElevation(Me,Ir,Ai):null,Gi="map"===u.layout.get("text-rotation-alignment");je(Ne,Me.posMatrix,v,g,Rn,Ur,G,P,Gi,ui)}const Ul=v.translatePosMatrix(Me.posMatrix,Ae,x,S),Ac=le||g&&be||el?Rl:Rn,Dr=v.translatePosMatrix(Ur,Ae,x,S,!0),pr=Oe&&0!==u.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1);let Jr;Jr=Oe?Ne.iconsInText?Io(vt.kind,qt,ge,G,v,Ul,Ac,Dr,Zt,zi):ph(vt.kind,qt,ge,G,v,Ul,Ac,Dr,g,Zt,!0):zd(vt.kind,qt,ge,G,v,Ul,Ac,Dr,g,Zt);const pa={program:An,buffers:We,uniformValues:Jr,atlasTexture:ci,atlasTextureIcon:Ci,atlasInterpolation:Fn,atlasInterpolationIcon:ir,isSDF:Oe,hasHalo:pr};if(ie&&Ne.canOverlap){he=!0;const ui=We.segments.get();for(const Gi of ui)Ee.push({segments:new y.S([Gi]),sortKey:Gi.sortKey,state:pa,terrainData:Nt})}else Ee.push({segments:We.segments,sortKey:0,state:pa,terrainData:Nt})}he&&Ee.sort((Me,Ae)=>Me.sortKey-Ae.sortKey);for(const Me of Ee){const Ae=Me.state;if(V.activeTexture.set(K.TEXTURE0),Ae.atlasTexture.bind(Ae.atlasInterpolation,K.CLAMP_TO_EDGE),Ae.atlasTextureIcon&&(V.activeTexture.set(K.TEXTURE1),Ae.atlasTextureIcon&&Ae.atlasTextureIcon.bind(Ae.atlasInterpolationIcon,K.CLAMP_TO_EDGE)),Ae.isSDF){const Ne=Ae.uniformValues;Ae.hasHalo&&(Ne.u_is_halo=1,aa(Ae.buffers,Me.segments,u,v,Ae.program,_e,k,O,Ne,Me.terrainData)),Ne.u_is_halo=0}aa(Ae.buffers,Me.segments,u,v,Ae.program,_e,k,O,Ae.uniformValues,Me.terrainData)}}function aa(v,o,u,p,g,x,S,T,I,P){const k=p.context;g.draw(k,k.gl.TRIANGLES,x,S,T,ai.disabled,I,P,u.id,v.layoutVertexBuffer,v.indexBuffer,o,u.paint,p.transform.zoom,v.programConfigurations.get(u.id),v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer)}function Cc(v,o,u,p,g){if(!u||!p||!p.imageAtlas)return;const x=p.imageAtlas.patternPositions;let S=x[u.to.toString()],T=x[u.from.toString()];if(!S||!T){const I=g.getPaintProperty(o);S=x[I],T=x[I]}S&&T&&v.setConstantPatternPositions(S,T)}function Is(v,o,u,p,g,x,S){const T=v.context.gl,I="fill-pattern",P=u.paint.get(I),k=P&&P.constantOr(1),O=u.getCrossfadeParameters();let V,K,Z,Y,G;S?(K=k&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",V=T.LINES):(K=k?"fillPattern":"fill",V=T.TRIANGLES);const le=P.constantOr(null);for(const ge of p){const ie=o.getTile(ge);if(k&&!ie.patternsLoaded())continue;const he=ie.getBucket(u);if(!he)continue;const _e=he.programConfigurations.get(u.id),be=v.useProgram(K,_e),Ee=v.style.map.terrain&&v.style.map.terrain.getTerrainData(ge);k&&(v.context.activeTexture.set(T.TEXTURE0),ie.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),_e.updatePaintBuffers(O)),Cc(_e,I,le,ie,u);const Me=Ee?ge:null,Ae=v.translatePosMatrix(Me?Me.posMatrix:ge.posMatrix,ie,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));if(S){Y=he.indexBuffer2,G=he.segments2;const Ne=[T.drawingBufferWidth,T.drawingBufferHeight];Z="fillOutlinePattern"===K&&k?Va(Ae,v,O,ie,Ne):wn(Ae,Ne)}else Y=he.indexBuffer,G=he.segments,Z=k?fh(Ae,v,O,ie):Od(Ae);be.draw(v.context,V,g,v.stencilModeForClipping(ge),x,ai.disabled,Z,Ee,u.id,he.layoutVertexBuffer,Y,G,u.paint,v.transform.zoom,_e)}}function Ec(v,o,u,p,g,x,S){const T=v.context,I=T.gl,P="fill-extrusion-pattern",k=u.paint.get(P),O=k.constantOr(1),V=u.getCrossfadeParameters(),K=u.paint.get("fill-extrusion-opacity"),Z=k.constantOr(null);for(const Y of p){const G=o.getTile(Y),le=G.getBucket(u);if(!le)continue;const ge=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Y),ie=le.programConfigurations.get(u.id),he=v.useProgram(O?"fillExtrusionPattern":"fillExtrusion",ie);O&&(v.context.activeTexture.set(I.TEXTURE0),G.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),ie.updatePaintBuffers(V)),Cc(ie,P,Z,G,u);const _e=v.translatePosMatrix(Y.posMatrix,G,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),be=u.paint.get("fill-extrusion-vertical-gradient"),Ee=O?tr(_e,v,be,K,Y,V,G):fc(_e,v,be,K);he.draw(T,T.gl.TRIANGLES,g,x,S,ai.backCCW,Ee,ge,u.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,u.paint,v.transform.zoom,ie,v.style.map.terrain&&le.centroidVertexBuffer)}}function lt(v,o,u,p,g,x,S){const T=v.context,I=T.gl,P=u.fbo;if(!P)return;const k=v.useProgram("hillshade"),O=v.style.map.terrain&&v.style.map.terrain.getTerrainData(o);T.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,P.colorAttachment.get()),k.draw(T,I.TRIANGLES,g,x,S,ai.disabled,((V,K,Z,Y)=>{const G=Z.paint.get("hillshade-shadow-color"),le=Z.paint.get("hillshade-highlight-color"),ge=Z.paint.get("hillshade-accent-color");let ie=Z.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===Z.paint.get("hillshade-illumination-anchor")&&(ie-=V.transform.angle);const he=!V.options.moving;return{u_matrix:Y?Y.posMatrix:V.transform.calculatePosMatrix(K.tileID.toUnwrapped(),he),u_image:0,u_latrange:gc(0,K.tileID),u_light:[Z.paint.get("hillshade-exaggeration"),ie],u_shadow:G,u_highlight:le,u_accent:ge}})(v,u,p,O?o:null),O,p.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments)}function Tu(v,o,u,p,g,x){const S=v.context,T=S.gl,I=o.dem;if(I&&I.data){const P=I.dim,k=I.stride,O=I.getPixels();if(S.activeTexture.set(T.TEXTURE1),S.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||v.getTileTexture(k),o.demTexture){const K=o.demTexture;K.update(O,{premultiply:!1}),K.bind(T.NEAREST,T.CLAMP_TO_EDGE)}else o.demTexture=new ot(S,O,T.RGBA,{premultiply:!1}),o.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE);S.activeTexture.set(T.TEXTURE0);let V=o.fbo;if(!V){const K=new ot(S,{width:P,height:P,data:null},T.RGBA);K.bind(T.LINEAR,T.CLAMP_TO_EDGE),V=o.fbo=S.createFramebuffer(P,P,!0,!1),V.colorAttachment.set(K.texture)}S.bindFramebuffer.set(V.framebuffer),S.viewport.set([0,0,P,P]),v.useProgram("hillshadePrepare").draw(S,T.TRIANGLES,p,g,x,ai.disabled,((K,Z)=>{const Y=Z.stride,G=y.Z();return y.aS(G,0,y.N,-y.N,0,0,1),y.$(G,G,[0,-y.N,0]),{u_matrix:G,u_image:1,u_dimension:[Y,Y],u_zoom:K.overscaledZ,u_unpack:Z.getUnpackVector()}})(o.tileID,I),null,u.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments),o.needsHillshadePrepare=!1}}function tt(v,o,u,p,g,x){const S=p.paint.get("raster-fade-duration");if(!x&&S>0){const T=y.h.now(),I=(T-v.timeAdded)/S,P=o?(T-o.timeAdded)/S:-1,k=u.getSource(),O=g.coveringZoomLevel({tileSize:k.tileSize,roundZoom:k.roundZoom}),V=!o||Math.abs(o.tileID.overscaledZ-O)>Math.abs(v.tileID.overscaledZ-O),K=V&&v.refreshedUponExpiration?1:y.ad(V?I:1-P,0,1);return v.refreshedUponExpiration&&I>=1&&(v.refreshedUponExpiration=!1),o?{opacity:1,mix:1-K}:{opacity:K,mix:0}}return{opacity:1,mix:0}}const Sc=new y.aT(1,0,0,1),Ll=new y.aT(0,1,0,1),qa=new y.aT(0,0,1,1),Gd=new y.aT(1,0,1,1),Wd=new y.aT(0,1,1,1);function Tc(v,o,u,p){Ga(v,0,o+u/2,v.transform.width,u,p)}function As(v,o,u,p){Ga(v,o-u/2,0,u,v.transform.height,p)}function Ga(v,o,u,p,g,x){const S=v.context,T=S.gl;T.enable(T.SCISSOR_TEST),T.scissor(o*v.pixelRatio,u*v.pixelRatio,p*v.pixelRatio,g*v.pixelRatio),S.clear({color:x}),T.disable(T.SCISSOR_TEST)}function ds(v,o,u){const p=v.context,g=p.gl,x=u.posMatrix,S=v.useProgram("debug"),T=un.disabled,I=gi.disabled,P=v.colorModeForRenderPass(),k="$debug",O=v.style.map.terrain&&v.style.map.terrain.getTerrainData(u);p.activeTexture.set(g.TEXTURE0);const V=o.getTileByID(u.key).latestRawTileData,K=Math.floor((V&&V.byteLength||0)/1024),Z=o.getTile(u).tileSize,Y=512/Math.min(Z,512)*(u.overscaledZ/v.transform.zoom)*.5;let G=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(G+=` => ${u.overscaledZ}`),function(le,ge){le.initDebugOverlayCanvas();const ie=le.debugOverlayCanvas,he=le.context.gl,_e=le.debugOverlayCanvas.getContext("2d");_e.clearRect(0,0,ie.width,ie.height),_e.shadowColor="white",_e.shadowBlur=2,_e.lineWidth=1.5,_e.strokeStyle="white",_e.textBaseline="top",_e.font="bold 36px Open Sans, sans-serif",_e.fillText(ge,5,5),_e.strokeText(ge,5,5),le.debugOverlayTexture.update(ie),le.debugOverlayTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE)}(v,`${G} ${K}kB`),S.draw(p,g.TRIANGLES,T,I,Xn.alphaBlended,ai.disabled,mc(x,y.aT.transparent,Y),null,k,v.debugBuffer,v.quadTriangleIndexBuffer,v.debugSegments),S.draw(p,g.LINE_STRIP,T,I,P,ai.disabled,mc(x,y.aT.red),O,k,v.debugBuffer,v.tileBorderIndexBuffer,v.debugSegments)}function Cn(v,o,u){const p=v.context,g=p.gl,x=v.colorModeForRenderPass(),S=new un(g.LEQUAL,un.ReadWrite,v.depthRangeFor3D),T=v.useProgram("terrain"),I=o.getTerrainMesh();p.bindFramebuffer.set(null),p.viewport.set([0,0,v.width,v.height]);for(const P of u){const k=v.renderToTexture.getTexture(P),O=o.getTerrainData(P.tileID);p.activeTexture.set(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,k.texture);const V={u_matrix:v.transform.calculatePosMatrix(P.tileID.toUnwrapped()),u_texture:0,u_ele_delta:o.getMeshFrameDelta(v.transform.zoom)};T.draw(p,g.TRIANGLES,S,gi.disabled,x,ai.backCCW,V,O,"terrain",I.vertexBuffer,I.indexBuffer,I.segments)}}class nn{constructor(o,u){this.context=new Ug(o),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:y.Z(),renderTime:0},this.setup(),this.numSublayers=ls.maxUnderzooming+ls.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new hc}resize(o,u,p){if(this.width=Math.floor(o*p),this.height=Math.floor(u*p),this.pixelRatio=p,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style._order)this.style._layers[g].resize()}setup(){const o=this.context,u=new y.a_;u.emplaceBack(0,0),u.emplaceBack(y.N,0),u.emplaceBack(0,y.N),u.emplaceBack(y.N,y.N),this.tileExtentBuffer=o.createVertexBuffer(u,dc.members),this.tileExtentSegments=y.S.simpleSegment(0,0,4,2);const p=new y.a_;p.emplaceBack(0,0),p.emplaceBack(y.N,0),p.emplaceBack(0,y.N),p.emplaceBack(y.N,y.N),this.debugBuffer=o.createVertexBuffer(p,dc.members),this.debugSegments=y.S.simpleSegment(0,0,4,5);const g=new y.V;g.emplaceBack(0,0,0,0),g.emplaceBack(y.N,0,y.N,0),g.emplaceBack(0,y.N,0,y.N),g.emplaceBack(y.N,y.N,y.N,y.N),this.rasterBoundsBuffer=o.createVertexBuffer(g,kn.members),this.rasterBoundsSegments=y.S.simpleSegment(0,0,4,2);const x=new y.a_;x.emplaceBack(0,0),x.emplaceBack(1,0),x.emplaceBack(0,1),x.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(x,dc.members),this.viewportSegments=y.S.simpleSegment(0,0,4,2);const S=new y.a$;S.emplaceBack(0),S.emplaceBack(1),S.emplaceBack(3),S.emplaceBack(2),S.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(S);const T=new y.b0;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(T);const I=this.context.gl;this.stencilClearMode=new gi({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO)}clearStencil(){const o=this.context,u=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const p=y.Z();y.aS(p,0,this.width,this.height,0,0,1),y.a0(p,p,[u.drawingBufferWidth,u.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(o,u.TRIANGLES,un.disabled,this.stencilClearMode,Xn.disabled,ai.disabled,yu(p),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,u){if(this.currentStencilSource===o.source||!o.isTileClipped()||!u||!u.length)return;this.currentStencilSource=o.source;const p=this.context,g=p.gl;this.nextStencilID+u.length>256&&this.clearStencil(),p.setColorMode(Xn.disabled),p.setDepthMode(un.disabled);const x=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const S of u){const T=this._tileClippingMaskIDs[S.key]=this.nextStencilID++,I=this.style.map.terrain&&this.style.map.terrain.getTerrainData(S);x.draw(p,g.TRIANGLES,un.disabled,new gi({func:g.ALWAYS,mask:0},T,255,g.KEEP,g.KEEP,g.REPLACE),Xn.disabled,ai.disabled,yu(S.posMatrix),I,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,u=this.context.gl;return new gi({func:u.NOTEQUAL,mask:255},o,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(o){const u=this.context.gl;return new gi({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(o){const u=this.context.gl,p=o.sort((S,T)=>T.overscaledZ-S.overscaledZ),g=p[p.length-1].overscaledZ,x=p[0].overscaledZ-g+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const S={};for(let T=0;T<x;T++)S[T+g]=new gi({func:u.GEQUAL,mask:255},T+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=x,[S,p]}return[{[g]:gi.disabled},p]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new Xn([o.CONSTANT_COLOR,o.ONE],new y.aT(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Xn.unblended:Xn.alphaBlended}depthModeForSublayer(o,u,p){if(!this.opaquePassEnabledForLayer())return un.disabled;const g=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new un(p||this.context.gl.LEQUAL,u,[g,g])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,u){this.style=o,this.options=u,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(y.h.now()),this.imageManager.beginFrame();const p=this.style._order,g=this.style.sourceCaches,x={},S={},T={};for(const I in g){const P=g[I];P.used&&P.prepare(this.context),x[I]=P.getVisibleCoordinates(),S[I]=x[I].slice().reverse(),T[I]=P.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let I=0;I<p.length;I++)if(this.style._layers[p[I]].is3D()){this.opaquePassCutoff=I;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const I=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!y.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||I.length)&&(y.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(P,k){const O=P.context,V=O.gl,K=Xn.unblended,Z=new un(V.LEQUAL,un.ReadWrite,[0,1]),Y=k.getTerrainMesh(),G=k.sourceCache.getRenderableTiles(),le=P.useProgram("terrainDepth");O.bindFramebuffer.set(k.getFramebuffer("depth").framebuffer),O.viewport.set([0,0,P.width/devicePixelRatio,P.height/devicePixelRatio]),O.clear({color:y.aT.transparent,depth:1});for(const ge of G){const ie=k.getTerrainData(ge.tileID),he={u_matrix:P.transform.calculatePosMatrix(ge.tileID.toUnwrapped()),u_ele_delta:k.getMeshFrameDelta(P.transform.zoom)};le.draw(O,V.TRIANGLES,Z,gi.disabled,K,ai.backCCW,he,ie,"terrain",Y.vertexBuffer,Y.indexBuffer,Y.segments)}O.bindFramebuffer.set(null),O.viewport.set([0,0,P.width,P.height])}(this,this.style.map.terrain),function(P,k){const O=P.context,V=O.gl,K=Xn.unblended,Z=new un(V.LEQUAL,un.ReadWrite,[0,1]),Y=k.getTerrainMesh(),G=k.getCoordsTexture(),le=k.sourceCache.getRenderableTiles(),ge=P.useProgram("terrainCoords");O.bindFramebuffer.set(k.getFramebuffer("coords").framebuffer),O.viewport.set([0,0,P.width/devicePixelRatio,P.height/devicePixelRatio]),O.clear({color:y.aT.transparent,depth:1}),k.coordsIndex=[];for(const ie of le){const he=k.getTerrainData(ie.tileID);O.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,G.texture);const _e={u_matrix:P.transform.calculatePosMatrix(ie.tileID.toUnwrapped()),u_terrain_coords_id:(255-k.coordsIndex.length)/255,u_texture:0,u_ele_delta:k.getMeshFrameDelta(P.transform.zoom)};ge.draw(O,V.TRIANGLES,Z,gi.disabled,K,ai.backCCW,_e,he,"terrain",Y.vertexBuffer,Y.indexBuffer,Y.segments),k.coordsIndex.push(ie.tileID.key)}O.bindFramebuffer.set(null),O.viewport.set([0,0,P.width,P.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const I of p){const P=this.style._layers[I];if(!P.hasOffscreenPass()||P.isHidden(this.transform.zoom))continue;const k=S[P.source];("custom"===P.type||k.length)&&this.renderLayer(this,g[P.source],P,k)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?y.aT.black:y.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(o._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const I=this.style._layers[p[this.currentLayer]],P=g[I.source],k=x[I.source];this._renderTileClippingMasks(I,k),this.renderLayer(this,P,I,k)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const I=this.style._layers[p[this.currentLayer]],P=g[I.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(I))continue;const k=("symbol"===I.type?T:S)[I.source];this._renderTileClippingMasks(I,x[I.source]),this.renderLayer(this,P,I,k)}if(this.options.showTileBoundaries){const I=function(P,k){let O=null;const V=Object.values(P._layers).flatMap(G=>G.source&&!G.isHidden(k)?[P.sourceCaches[G.source]]:[]),K=V.filter(G=>"vector"===G.getSource().type),Z=V.filter(G=>"vector"!==G.getSource().type),Y=G=>{(!O||O.getSource().maxzoom<G.getSource().maxzoom)&&(O=G)};return K.forEach(G=>Y(G)),O||Z.forEach(G=>Y(G)),O}(this.style,this.transform.zoom);I&&function(P,k,O){for(let V=0;V<O.length;V++)ds(P,k,O[V])}(this,I,I.getVisibleCoordinates())}this.options.showPadding&&function(I){const P=I.transform.padding;Tc(I,I.transform.height-(P.top||0),3,Sc),Tc(I,P.bottom||0,3,Ll),As(I,P.left||0,3,qa),As(I,I.transform.width-(P.right||0),3,Gd);const k=I.transform.centerPoint;var O,V,K,Z;Ga(O=I,(V=k.x)-1,(K=I.transform.height-k.y)-10,2,20,Z=Wd),Ga(O,V-10,K-1,20,2,Z)}(this),this.context.setDefault()}renderLayer(o,u,p,g){if(!p.isHidden(this.transform.zoom)&&("background"===p.type||"custom"===p.type||(g||[]).length))switch(this.id=p.id,p.type){case"symbol":!function(x,S,T,I,P){if("translucent"!==x.renderPass)return;const k=gi.disabled,O=x.colorModeForRenderPass();(T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(V,K,Z,Y,G,le,ge){const ie=K.transform,he="map"===G,_e="map"===le;for(const be of V){const Ee=Y.getTile(be),Me=Ee.getBucket(Z);if(!Me||!Me.text||!Me.text.segments.get().length)continue;const Ae=y.ah(Me.textSizeData,ie.zoom),Ne=ae(Ee,1,K.transform.zoom),We=ke(be.posMatrix,_e,he,K.transform,Ne),jt="none"!==Z.layout.get("icon-text-fit")&&Me.hasIconData();if(Ae){const Oe=Math.pow(2,ie.zoom-Ee.tileID.overscaledZ);Su(Me,he,_e,ge,ie,We,be.posMatrix,Oe,Ae,jt,K.style.map.terrain?(vt,st)=>K.style.map.terrain.getElevation(be,vt,st):null)}}}(I,x,T,S,T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),P),0!==T.paint.get("icon-opacity").constantOr(1)&&wc(x,S,T,I,!1,T.paint.get("icon-translate"),T.paint.get("icon-translate-anchor"),T.layout.get("icon-rotation-alignment"),T.layout.get("icon-pitch-alignment"),T.layout.get("icon-keep-upright"),k,O),0!==T.paint.get("text-opacity").constantOr(1)&&wc(x,S,T,I,!0,T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.layout.get("text-keep-upright"),k,O),S.map.showCollisionBoxes&&(Cu(x,S,T,I,T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),!0),Cu(x,S,T,I,T.paint.get("icon-translate"),T.paint.get("icon-translate-anchor"),!1))}(o,u,p,g,this.style.placement.variableOffsets);break;case"circle":!function(x,S,T,I){if("translucent"!==x.renderPass)return;const P=T.paint.get("circle-opacity"),k=T.paint.get("circle-stroke-width"),O=T.paint.get("circle-stroke-opacity"),V=!T.layout.get("circle-sort-key").isConstant();if(0===P.constantOr(1)&&(0===k.constantOr(1)||0===O.constantOr(1)))return;const K=x.context,Z=K.gl,Y=x.depthModeForSublayer(0,un.ReadOnly),G=gi.disabled,le=x.colorModeForRenderPass(),ge=[];for(let ie=0;ie<I.length;ie++){const he=I[ie],_e=S.getTile(he),be=_e.getBucket(T);if(!be)continue;const Ee=be.programConfigurations.get(T.id),Me=x.useProgram("circle",Ee),Ae=be.layoutVertexBuffer,Ne=be.indexBuffer,We=x.style.map.terrain&&x.style.map.terrain.getTerrainData(he),jt={programConfiguration:Ee,program:Me,layoutVertexBuffer:Ae,indexBuffer:Ne,uniformValues:Kn(x,he,_e,T),terrainData:We};if(V){const Oe=be.segments.get();for(const vt of Oe)ge.push({segments:new y.S([vt]),sortKey:vt.sortKey,state:jt})}else ge.push({segments:be.segments,sortKey:0,state:jt})}V&&ge.sort((ie,he)=>ie.sortKey-he.sortKey);for(const ie of ge){const{programConfiguration:he,program:_e,layoutVertexBuffer:be,indexBuffer:Ee,uniformValues:Me,terrainData:Ae}=ie.state;_e.draw(K,Z.TRIANGLES,Y,G,le,ai.disabled,Me,Ae,T.id,be,Ee,ie.segments,T.paint,x.transform.zoom,he)}}(o,u,p,g);break;case"heatmap":!function(x,S,T,I){if(0!==T.paint.get("heatmap-opacity"))if("offscreen"===x.renderPass){const P=x.context,k=P.gl,O=gi.disabled,V=new Xn([k.ONE,k.ONE],y.aT.transparent,[!0,!0,!0,!0]);(function(K,Z,Y){const G=K.gl;K.activeTexture.set(G.TEXTURE1),K.viewport.set([0,0,Z.width/4,Z.height/4]);let le=Y.heatmapFbo;if(le)G.bindTexture(G.TEXTURE_2D,le.colorAttachment.get()),K.bindFramebuffer.set(le.framebuffer);else{const ge=G.createTexture();G.bindTexture(G.TEXTURE_2D,ge),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_S,G.CLAMP_TO_EDGE),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_T,G.CLAMP_TO_EDGE),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MIN_FILTER,G.LINEAR),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MAG_FILTER,G.LINEAR),le=Y.heatmapFbo=K.createFramebuffer(Z.width/4,Z.height/4,!1,!1),function(ie,he,_e,be){var Ee,Me;const Ae=ie.gl,Ne=null!==(Ee=ie.HALF_FLOAT)&&void 0!==Ee?Ee:Ae.UNSIGNED_BYTE,We=null!==(Me=ie.RGBA16F)&&void 0!==Me?Me:Ae.RGBA;Ae.texImage2D(Ae.TEXTURE_2D,0,We,he.width/4,he.height/4,0,Ae.RGBA,Ne,null),be.colorAttachment.set(_e)}(K,Z,ge,le)}})(P,x,T),P.clear({color:y.aT.transparent});for(let K=0;K<I.length;K++){const Z=I[K];if(S.hasRenderableParent(Z))continue;const Y=S.getTile(Z),G=Y.getBucket(T);if(!G)continue;const le=G.programConfigurations.get(T.id),ge=x.useProgram("heatmap",le),{zoom:ie}=x.transform;ge.draw(P,k.TRIANGLES,un.disabled,O,V,ai.disabled,Ot(Z.posMatrix,Y,ie,T.paint.get("heatmap-intensity")),null,T.id,G.layoutVertexBuffer,G.indexBuffer,G.segments,T.paint,x.transform.zoom,le)}P.viewport.set([0,0,x.width,x.height])}else"translucent"===x.renderPass&&(x.context.setColorMode(x.colorModeForRenderPass()),function(P,k){const O=P.context,V=O.gl,K=k.heatmapFbo;if(!K)return;O.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,K.colorAttachment.get()),O.activeTexture.set(V.TEXTURE1);let Z=k.colorRampTexture;Z||(Z=k.colorRampTexture=new ot(O,k.colorRamp,V.RGBA)),Z.bind(V.LINEAR,V.CLAMP_TO_EDGE),P.useProgram("heatmapTexture").draw(O,V.TRIANGLES,un.disabled,gi.disabled,P.colorModeForRenderPass(),ai.disabled,((Y,G,le,ge)=>{const ie=y.Z();y.aS(ie,0,Y.width,Y.height,0,0,1);const he=Y.context.gl;return{u_matrix:ie,u_world:[he.drawingBufferWidth,he.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:G.paint.get("heatmap-opacity")}})(P,k),null,k.id,P.viewportBuffer,P.quadTriangleIndexBuffer,P.viewportSegments,k.paint,P.transform.zoom)}(x,T))}(o,u,p,g);break;case"line":!function(x,S,T,I){if("translucent"!==x.renderPass)return;const P=T.paint.get("line-opacity"),k=T.paint.get("line-width");if(0===P.constantOr(1)||0===k.constantOr(1))return;const O=x.depthModeForSublayer(0,un.ReadOnly),V=x.colorModeForRenderPass(),K=T.paint.get("line-dasharray"),Z=T.paint.get("line-pattern"),Y=Z.constantOr(1),G=T.paint.get("line-gradient"),le=T.getCrossfadeParameters(),ge=Y?"linePattern":K?"lineSDF":G?"lineGradient":"line",ie=x.context,he=ie.gl;let _e=!0;for(const be of I){const Ee=S.getTile(be);if(Y&&!Ee.patternsLoaded())continue;const Me=Ee.getBucket(T);if(!Me)continue;const Ae=Me.programConfigurations.get(T.id),Ne=x.context.program.get(),We=x.useProgram(ge,Ae),jt=_e||We.program!==Ne,Oe=x.style.map.terrain&&x.style.map.terrain.getTerrainData(be),vt=Z.constantOr(null);if(vt&&Ee.imageAtlas){const qt=Ee.imageAtlas,Nt=qt.patternPositions[vt.to.toString()],Zt=qt.patternPositions[vt.from.toString()];Nt&&Zt&&Ae.setConstantPatternPositions(Nt,Zt)}const st=Oe?be:null,An=Y?Nd(x,Ee,T,le,st):K?Ie(x,Ee,T,K,le,st):G?Ap(x,Ee,T,Me.lineClipsArray.length,st):yc(x,Ee,T,st);if(Y)ie.activeTexture.set(he.TEXTURE0),Ee.imageAtlasTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE),Ae.updatePaintBuffers(le);else if(K&&(jt||x.lineAtlas.dirty))ie.activeTexture.set(he.TEXTURE0),x.lineAtlas.bind(ie);else if(G){const qt=Me.gradients[T.id];let Nt=qt.texture;if(T.gradientVersion!==qt.version){let Zt=256;if(T.stepInterpolant){const ci=S.getSource().maxzoom,Fn=be.canonical.z===ci?Math.ceil(1<<x.transform.maxZoom-be.canonical.z):1;Zt=y.ad(y.aY(Me.maxLineLength/y.N*1024*Fn),256,ie.maxTextureSize)}qt.gradient=y.aZ({expression:T.gradientExpression(),evaluationKey:"lineProgress",resolution:Zt,image:qt.gradient||void 0,clips:Me.lineClipsArray}),qt.texture?qt.texture.update(qt.gradient):qt.texture=new ot(ie,qt.gradient,he.RGBA),qt.version=T.gradientVersion,Nt=qt.texture}ie.activeTexture.set(he.TEXTURE0),Nt.bind(T.stepInterpolant?he.NEAREST:he.LINEAR,he.CLAMP_TO_EDGE)}We.draw(ie,he.TRIANGLES,O,x.stencilModeForClipping(be),V,ai.disabled,An,Oe,T.id,Me.layoutVertexBuffer,Me.indexBuffer,Me.segments,T.paint,x.transform.zoom,Ae,Me.layoutVertexBuffer2),_e=!1}}(o,u,p,g);break;case"fill":!function(x,S,T,I){const P=T.paint.get("fill-color"),k=T.paint.get("fill-opacity");if(0===k.constantOr(1))return;const O=x.colorModeForRenderPass(),V=T.paint.get("fill-pattern"),K=x.opaquePassEnabledForLayer()&&!V.constantOr(1)&&1===P.constantOr(y.aT.transparent).a&&1===k.constantOr(0)?"opaque":"translucent";if(x.renderPass===K){const Z=x.depthModeForSublayer(1,"opaque"===x.renderPass?un.ReadWrite:un.ReadOnly);Is(x,S,T,I,Z,O,!1)}if("translucent"===x.renderPass&&T.paint.get("fill-antialias")){const Z=x.depthModeForSublayer(T.getPaintProperty("fill-outline-color")?2:0,un.ReadOnly);Is(x,S,T,I,Z,O,!0)}}(o,u,p,g);break;case"fill-extrusion":!function(x,S,T,I){const P=T.paint.get("fill-extrusion-opacity");if(0!==P&&"translucent"===x.renderPass){const k=new un(x.context.gl.LEQUAL,un.ReadWrite,x.depthRangeFor3D);if(1!==P||T.paint.get("fill-extrusion-pattern").constantOr(1))Ec(x,S,T,I,k,gi.disabled,Xn.disabled),Ec(x,S,T,I,k,x.stencilModeFor3D(),x.colorModeForRenderPass());else{const O=x.colorModeForRenderPass();Ec(x,S,T,I,k,gi.disabled,O)}}}(o,u,p,g);break;case"hillshade":!function(x,S,T,I){if("offscreen"!==x.renderPass&&"translucent"!==x.renderPass)return;const P=x.context,k=x.depthModeForSublayer(0,un.ReadOnly),O=x.colorModeForRenderPass(),[V,K]="translucent"===x.renderPass?x.stencilConfigForOverlap(I):[{},I];for(const Z of K){const Y=S.getTile(Z);void 0!==Y.needsHillshadePrepare&&Y.needsHillshadePrepare&&"offscreen"===x.renderPass?Tu(x,Y,T,k,gi.disabled,O):"translucent"===x.renderPass&&lt(x,Z,Y,T,k,V[Z.overscaledZ],O)}P.viewport.set([0,0,x.width,x.height])}(o,u,p,g);break;case"raster":!function(x,S,T,I){if("translucent"!==x.renderPass||0===T.paint.get("raster-opacity")||!I.length)return;const P=x.context,k=P.gl,O=S.getSource(),V=x.useProgram("raster"),K=x.colorModeForRenderPass(),[Z,Y]=O instanceof Cs?[{},I]:x.stencilConfigForOverlap(I),G=Y[Y.length-1].overscaledZ,le=!x.options.moving;for(const ge of Y){const ie=x.depthModeForSublayer(ge.overscaledZ-G,1===T.paint.get("raster-opacity")?un.ReadWrite:un.ReadOnly,k.LESS),he=S.getTile(ge);he.registerFadeDuration(T.paint.get("raster-fade-duration"));const _e=S.findLoadedParent(ge,0),be=tt(he,_e,S,T,x.transform,x.style.map.terrain);let Ee,Me;const Ae="nearest"===T.paint.get("raster-resampling")?k.NEAREST:k.LINEAR;P.activeTexture.set(k.TEXTURE0),he.texture.bind(Ae,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),P.activeTexture.set(k.TEXTURE1),_e?(_e.texture.bind(Ae,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),Ee=Math.pow(2,_e.tileID.overscaledZ-he.tileID.overscaledZ),Me=[he.tileID.canonical.x*Ee%1,he.tileID.canonical.y*Ee%1]):he.texture.bind(Ae,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST);const Ne=x.style.map.terrain&&x.style.map.terrain.getTerrainData(ge),We=Ne?ge:null,jt=We?We.posMatrix:x.transform.calculatePosMatrix(ge.toUnwrapped(),le),Oe=Tn(jt,Me||[0,0],Ee||1,be,T);O instanceof Cs?V.draw(P,k.TRIANGLES,ie,gi.disabled,K,ai.disabled,Oe,Ne,T.id,O.boundsBuffer,x.quadTriangleIndexBuffer,O.boundsSegments):V.draw(P,k.TRIANGLES,ie,Z[ge.overscaledZ],K,ai.disabled,Oe,Ne,T.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments)}}(o,u,p,g);break;case"background":!function(x,S,T,I){const P=T.paint.get("background-color"),k=T.paint.get("background-opacity");if(0===k)return;const O=x.context,V=O.gl,K=x.transform,Z=K.tileSize,Y=T.paint.get("background-pattern");if(x.isPatternMissing(Y))return;const G=!Y&&1===P.a&&1===k&&x.opaquePassEnabledForLayer()?"opaque":"translucent";if(x.renderPass!==G)return;const le=gi.disabled,ge=x.depthModeForSublayer(0,"opaque"===G?un.ReadWrite:un.ReadOnly),ie=x.colorModeForRenderPass(),he=x.useProgram(Y?"backgroundPattern":"background"),_e=I||K.coveringTiles({tileSize:Z,terrain:x.style.map.terrain});Y&&(O.activeTexture.set(V.TEXTURE0),x.imageManager.bind(x.context));const be=T.getCrossfadeParameters();for(const Ee of _e){const Me=I?Ee.posMatrix:x.transform.calculatePosMatrix(Ee.toUnwrapped()),Ae=Y?qs(Me,k,x,Y,{tileID:Ee,tileSize:Z},be):wr(Me,k,P),Ne=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Ee);he.draw(O,V.TRIANGLES,ge,le,ie,ai.disabled,Ae,Ne,T.id,x.tileExtentBuffer,x.quadTriangleIndexBuffer,x.tileExtentSegments)}}(o,0,p,g);break;case"custom":!function(x,S,T){const I=x.context,P=T.implementation;if("offscreen"===x.renderPass){const k=P.prerender;k&&(x.setCustomLayerDefaults(),I.setColorMode(x.colorModeForRenderPass()),k.call(P,I.gl,x.transform.customLayerMatrix()),I.setDirty(),x.setBaseState())}else if("translucent"===x.renderPass){x.setCustomLayerDefaults(),I.setColorMode(x.colorModeForRenderPass()),I.setStencilMode(gi.disabled);const k="3d"===P.renderingMode?new un(x.context.gl.LEQUAL,un.ReadWrite,x.depthRangeFor3D):x.depthModeForSublayer(0,un.ReadOnly);I.setDepthMode(k),P.render(I.gl,x.transform.customLayerMatrix()),I.setDirty(),x.setBaseState(),I.bindFramebuffer.set(null)}}(o,0,p)}}translatePosMatrix(o,u,p,g,x){if(!p[0]&&!p[1])return o;const S=x?"map"===g?this.transform.angle:0:"viewport"===g?-this.transform.angle:0;if(S){const P=Math.sin(S),k=Math.cos(S);p=[p[0]*k-p[1]*P,p[0]*P+p[1]*k]}const T=[x?p[0]:ae(u,p[0],this.transform.zoom),x?p[1]:ae(u,p[1],this.transform.zoom),0],I=new Float32Array(16);return y.$(I,o,T),I}saveTileTexture(o){const u=this._tileTextures[o.size[0]];u?u.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const u=this._tileTextures[o];return u&&u.length>0?u.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const u=this.imageManager.getPattern(o.from.toString()),p=this.imageManager.getPattern(o.to.toString());return!u||!p}useProgram(o,u){this.cache=this.cache||{};const p=o+(u?u.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[p]||(this.cache[p]=new Et(this.context,oi[o],u,_u[o],this._showOverdrawInspector,this.style.map.terrain)),this.cache[p]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ot(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:o,drawingBufferHeight:u}=this.context.gl;return this.width!==o||this.height!==u}}class dr{constructor(o,u){this.points=o,this.planes=u}static fromInvProjectionMatrix(o,u,p){const g=Math.pow(2,p),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{const I=1/(T=y.ag([],T,o))[3]/u*g;return y.b3(T,T,[I,I,1/T[3],I])}),S=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{const I=function(V,K){var Z=K[0],Y=K[1],G=K[2],le=Z*Z+Y*Y+G*G;return le>0&&(le=1/Math.sqrt(le)),V[0]=K[0]*le,V[1]=K[1]*le,V[2]=K[2]*le,V}([],(V=[],K=$e([],x[T[0]],x[T[1]]),Z=$e([],x[T[2]],x[T[1]]),Y=K[0],ge=Z[0],V[0]=(G=K[1])*(he=Z[2])-(le=K[2])*(ie=Z[1]),V[1]=le*ge-Y*he,V[2]=Y*ie-G*ge,V)),P=-((k=I)[0]*(O=x[T[1]])[0]+k[1]*O[1]+k[2]*O[2]);var V,K,Z,Y,G,le,ge,ie,he,k,O;return I.concat(P)});return new dr(x,S)}}class la{constructor(o,u){var p,g,x;this.min=o,this.max=u,this.center=function(p,g,x){return p[0]=.5*g[0],p[1]=.5*g[1],p[2]=.5*g[2],p}([],((p=[])[0]=(g=this.min)[0]+(x=this.max)[0],p[1]=g[1]+x[1],p[2]=g[2]+x[2],p))}quadrant(o){const u=[o%2==0,o<2],p=os(this.min),g=os(this.max);for(let x=0;x<u.length;x++)p[x]=u[x]?this.min[x]:this.center[x],g[x]=u[x]?this.center[x]:this.max[x];return g[2]=this.max[2],new la(p,g)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}intersects(o){const u=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let p=!0;for(let g=0;g<o.planes.length;g++){const x=o.planes[g];let S=0;for(let T=0;T<u.length;T++)y.b4(x,u[T])>=0&&S++;if(0===S)return 0;S!==u.length&&(p=!1)}if(p)return 2;for(let g=0;g<3;g++){let x=Number.MAX_VALUE,S=-Number.MAX_VALUE;for(let T=0;T<o.points.length;T++){const I=o.points[T][g]-this.min[g];x=Math.min(x,I),S=Math.max(S,I)}if(S<0||x>this.max[g]-this.min[g])return 0}return 1}}class Wa{constructor(o=0,u=0,p=0,g=0){if(isNaN(o)||o<0||isNaN(u)||u<0||isNaN(p)||p<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=u,this.left=p,this.right=g}interpolate(o,u,p){return null!=u.top&&null!=o.top&&(this.top=y.B.number(o.top,u.top,p)),null!=u.bottom&&null!=o.bottom&&(this.bottom=y.B.number(o.bottom,u.bottom,p)),null!=u.left&&null!=o.left&&(this.left=y.B.number(o.left,u.left,p)),null!=u.right&&null!=o.right&&(this.right=y.B.number(o.right,u.right,p)),this}getCenter(o,u){const p=y.ad((this.left+o-this.right)/2,0,o),g=y.ad((this.top+u-this.bottom)/2,0,u);return new y.P(p,g)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new Wa(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Dc{constructor(o,u,p,g,x){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===x||!!x,this._minZoom=o||0,this._maxZoom=u||22,this._minPitch=p??0,this._maxPitch=g??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new y.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Wa,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const o=new Dc(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return o.apply(this),o}apply(o){this.tileSize=o.tileSize,this.latRange=o.latRange,this.width=o.width,this.height=o.height,this._center=o._center,this._elevation=o._elevation,this._minEleveationForCurrentTile=o._minEleveationForCurrentTile,this.zoom=o.zoom,this.angle=o.angle,this._fov=o._fov,this._pitch=o._pitch,this._unmodified=o._unmodified,this._edgeInsets=o._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(o){void 0===o?o=!0:null===o&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new y.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(o){const u=-y.b5(o,-180,180)*Math.PI/180;var p;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=(p=new y.A(4),y.A!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p),function(p,g,x){var S=g[0],T=g[1],I=g[2],P=g[3],k=Math.sin(x),O=Math.cos(x);p[0]=S*O+I*k,p[1]=T*O+P*k,p[2]=S*-k+I*O,p[3]=T*-k+P*O}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const u=y.ad(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=o/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(o){const u=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this.tileZoom=Math.max(0,Math.floor(u)),this.scale=this.zoomScale(u),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(o){o!==this._elevation&&(this._elevation=o,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,u,p){this._unmodified=!1,this._edgeInsets.interpolate(o,u,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const u=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(o){const u=[new y.b6(0,o)];if(this._renderWorldCopies){const p=this.pointCoordinate(new y.P(0,0)),g=this.pointCoordinate(new y.P(this.width,0)),x=this.pointCoordinate(new y.P(this.width,this.height)),S=this.pointCoordinate(new y.P(0,this.height)),T=Math.floor(Math.min(p.x,g.x,x.x,S.x)),I=Math.floor(Math.max(p.x,g.x,x.x,S.x)),P=1;for(let k=T-P;k<=I+P;k++)0!==k&&u.push(new y.b6(k,o))}return u}coveringTiles(o){var u,p;let g=this.coveringZoomLevel(o);const x=g;if(void 0!==o.minzoom&&g<o.minzoom)return[];void 0!==o.maxzoom&&g>o.maxzoom&&(g=o.maxzoom);const S=this.pointCoordinate(this.getCameraPoint()),T=y.U.fromLngLat(this.center),I=Math.pow(2,g),P=[I*S.x,I*S.y,0],k=[I*T.x,I*T.y,0],O=dr.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,g);let V=o.minzoom||0;!o.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(V=g);const K=o.terrain?2/Math.min(this.tileSize,o.tileSize)*this.tileSize:3,Z=ie=>({aabb:new la([ie*I,0,0],[(ie+1)*I,I,0]),zoom:0,x:0,y:0,wrap:ie,fullyVisible:!1}),Y=[],G=[],le=g,ge=o.reparseOverscaled?x:g;if(this._renderWorldCopies)for(let ie=1;ie<=3;ie++)Y.push(Z(-ie)),Y.push(Z(ie));for(Y.push(Z(0));Y.length>0;){const ie=Y.pop(),he=ie.x,_e=ie.y;let be=ie.fullyVisible;if(!be){const We=ie.aabb.intersects(O);if(0===We)continue;be=2===We}const Ee=o.terrain?P:k,Me=ie.aabb.distanceX(Ee),Ae=ie.aabb.distanceY(Ee),Ne=Math.max(Math.abs(Me),Math.abs(Ae));if(ie.zoom===le||Ne>K+(1<<le-ie.zoom)-2&&ie.zoom>=V){const We=le-ie.zoom,jt=P[0]-.5-(he<<We),Oe=P[1]-.5-(_e<<We);G.push({tileID:new y.O(ie.zoom===le?ge:ie.zoom,ie.wrap,ie.zoom,he,_e),distanceSq:Ue([k[0]-.5-he,k[1]-.5-_e]),tileDistanceToCamera:Math.sqrt(jt*jt+Oe*Oe)})}else for(let We=0;We<4;We++){const jt=(he<<1)+We%2,Oe=(_e<<1)+(We>>1),vt=ie.zoom+1;let st=ie.aabb.quadrant(We);if(o.terrain){const An=new y.O(vt,ie.wrap,vt,jt,Oe),qt=o.terrain.getMinMaxElevation(An),Nt=null!==(u=qt.minElevation)&&void 0!==u?u:this.elevation,Zt=null!==(p=qt.maxElevation)&&void 0!==p?p:this.elevation;st=new la([st.min[0],st.min[1],Nt],[st.max[0],st.max[1],Zt])}Y.push({aabb:st,zoom:vt,x:jt,y:Oe,wrap:ie.wrap,fullyVisible:be})}}return G.sort((ie,he)=>ie.distanceSq-he.distanceSq).map(ie=>ie.tileID)}resize(o,u){this.width=o,this.height=u,this.pixelsToGLUnits=[2/o,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const u=y.ad(o.lat,-this.maxValidLatitude,this.maxValidLatitude);return new y.P(y.G(o.lng)*this.worldSize,y.H(u)*this.worldSize)}unproject(o){return new y.U(o.x/this.worldSize,o.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(o){const u=this.pointLocation(this.centerPoint,o),p=o.getElevationForLngLatZoom(u,this.tileZoom);if(!(this.elevation-p))return;const g=this.getCameraPosition(),x=y.U.fromLngLat(g.lngLat,g.altitude),S=y.U.fromLngLat(u,p),T=x.x-S.x,I=x.y-S.y,P=x.z-S.z,k=Math.sqrt(T*T+I*I+P*P),O=this.scaleZoom(this.cameraToCenterDistance/k/this.tileSize);this._elevation=p,this._center=u,this.zoom=O}setLocationAtPoint(o,u){const p=this.pointCoordinate(u),g=this.pointCoordinate(this.centerPoint),x=this.locationCoordinate(o),S=new y.U(x.x-(p.x-g.x),x.y-(p.y-g.y));this.center=this.coordinateLocation(S),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(o,u){return u?this.coordinatePoint(this.locationCoordinate(o),u.getElevationForLngLatZoom(o,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(o))}pointLocation(o,u){return this.coordinateLocation(this.pointCoordinate(o,u))}locationCoordinate(o){return y.U.fromLngLat(o)}coordinateLocation(o){return o&&o.toLngLat()}pointCoordinate(o,u){if(u){const V=u.pointCoordinate(o);if(null!=V)return V}const p=[o.x,o.y,0,1],g=[o.x,o.y,1,1];y.ag(p,p,this.pixelMatrixInverse),y.ag(g,g,this.pixelMatrixInverse);const x=p[3],S=g[3],T=p[1]/x,I=g[1]/S,P=p[2]/x,k=g[2]/S,O=P===k?0:(0-P)/(k-P);return new y.U(y.B.number(p[0]/x,g[0]/S,O)/this.worldSize,y.B.number(T,I,O)/this.worldSize)}coordinatePoint(o,u=0,p=this.pixelMatrix){const g=[o.x*this.worldSize,o.y*this.worldSize,u,1];return y.ag(g,g,p),new y.P(g[0]/g[3],g[1]/g[3])}getBounds(){const o=Math.max(0,this.height/2-this.getHorizon());return(new Gn).extend(this.pointLocation(new y.P(0,o))).extend(this.pointLocation(new y.P(this.width,o))).extend(this.pointLocation(new y.P(this.width,this.height))).extend(this.pointLocation(new y.P(0,this.height)))}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new Gn([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(o){o?(this.lngRange=[o.getWest(),o.getEast()],this.latRange=[o.getSouth(),o.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(o,u=!1){const p=o.key,g=u?this._alignedPosMatrixCache:this._posMatrixCache;if(g[p])return g[p];const x=o.canonical,S=this.worldSize/this.zoomScale(x.z),T=x.x+Math.pow(2,x.z)*o.wrap,I=y.ao(new Float64Array(16));return y.$(I,I,[T*S,x.y*S,0]),y.a0(I,I,[S/y.N,S/y.N,1]),y.a1(I,u?this.alignedProjMatrix:this.projMatrix,I),g[p]=new Float32Array(I),g[p]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let o,u,p,g,x=-90,S=90,T=-180,I=180;const P=this.size,k=this._unmodified;if(this.latRange){const K=this.latRange;x=y.H(K[1])*this.worldSize,S=y.H(K[0])*this.worldSize,o=S-x<P.y?P.y/(S-x):0}if(this.lngRange){const K=this.lngRange;T=y.b5(y.G(K[0])*this.worldSize,0,this.worldSize),I=y.b5(y.G(K[1])*this.worldSize,0,this.worldSize),I<T&&(I+=this.worldSize),u=I-T<P.x?P.x/(I-T):0}const O=this.point,V=Math.max(u||0,o||0);if(V)return this.center=this.unproject(new y.P(u?(I+T)/2:O.x,o?(S+x)/2:O.y)),this.zoom+=this.scaleZoom(V),this._unmodified=k,void(this._constraining=!1);if(this.latRange){const K=O.y,Z=P.y/2;K-Z<x&&(g=x+Z),K+Z>S&&(g=S-Z)}if(this.lngRange){const K=(T+I)/2,Z=y.b5(O.x,K-this.worldSize/2,K+this.worldSize/2),Y=P.x/2;Z-Y<T&&(p=T+Y),Z+Y>I&&(p=I-Y)}void 0===p&&void 0===g||(this.center=this.unproject(new y.P(void 0!==p?p:O.x,void 0!==g?g:O.y)).wrap()),this._unmodified=k,this._constraining=!1}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,u=this.point.x,p=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=y.b7(1,this.center.lat)*this.worldSize;let g=y.ao(new Float64Array(16));y.a0(g,g,[this.width/2,-this.height/2,1]),y.$(g,g,[1,-1,0]),this.labelPlaneMatrix=g,g=y.ao(new Float64Array(16)),y.a0(g,g,[1,-1,1]),y.$(g,g,[-1,-1,0]),y.a0(g,g,[2/this.width,2/this.height,1]),this.glCoordMatrix=g;const x=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),S=Math.min(this.elevation,this._minEleveationForCurrentTile),T=x-S*this._pixelPerMeter/Math.cos(this._pitch),I=S<0?T:x,P=Math.PI/2+this._pitch,k=this._fov*(.5+o.y/this.height),O=Math.sin(k)*I/Math.sin(y.ad(Math.PI-P-k,.01,Math.PI-.01)),V=this.getHorizon(),K=2*Math.atan(V/this.cameraToCenterDistance)*(.5+o.y/(2*V)),Z=Math.sin(K)*I/Math.sin(y.ad(Math.PI-P-K,.01,Math.PI-.01)),Y=Math.min(O,Z),G=1.01*(Math.cos(Math.PI/2-this._pitch)*Y+I),le=this.height/50;g=new Float64Array(16),y.b8(g,this._fov,this.width/this.height,le,G),g[8]=2*-o.x/this.width,g[9]=2*o.y/this.height,y.a0(g,g,[1,-1,1]),y.$(g,g,[0,0,-this.cameraToCenterDistance]),y.b9(g,g,this._pitch),y.ae(g,g,this.angle),y.$(g,g,[-u,-p,0]),this.mercatorMatrix=y.a0([],g,[this.worldSize,this.worldSize,this.worldSize]),y.a0(g,g,[1,1,this._pixelPerMeter]),this.pixelMatrix=y.a1(new Float64Array(16),this.labelPlaneMatrix,g),y.$(g,g,[0,0,-this.elevation]),this.projMatrix=g,this.invProjMatrix=y.as([],g),this.pixelMatrix3D=y.a1(new Float64Array(16),this.labelPlaneMatrix,g);const ge=this.width%2/2,ie=this.height%2/2,he=Math.cos(this.angle),_e=Math.sin(this.angle),be=u-Math.round(u)+he*ge+_e*ie,Ee=p-Math.round(p)+he*ie+_e*ge,Me=new Float64Array(g);if(y.$(Me,Me,[be>.5?be-1:be,Ee>.5?Ee-1:Ee,0]),this.alignedProjMatrix=Me,g=y.as(new Float64Array(16),this.pixelMatrix),!g)throw new Error("failed to invert matrix");this.pixelMatrixInverse=g,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const o=this.pointCoordinate(new y.P(0,0)),u=[o.x*this.worldSize,o.y*this.worldSize,0,1];return y.ag(u,u,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new y.P(0,o))}getCameraQueryGeometry(o){const u=this.getCameraPoint();if(1===o.length)return[o[0],u];{let p=u.x,g=u.y,x=u.x,S=u.y;for(const T of o)p=Math.min(p,T.x),g=Math.min(g,T.y),x=Math.max(x,T.x),S=Math.max(S,T.y);return[new y.P(p,g),new y.P(x,g),new y.P(x,S),new y.P(p,S),new y.P(p,g)]}}}function Fr(v,o){let u,p=!1,g=null,x=null;const S=()=>{g=null,p&&(v.apply(x,u),g=setTimeout(S,o),p=!1)};return(...T)=>(p=!0,x=this,u=T,g||S(),g)}class Mo{constructor(o){this._getCurrentHash=()=>{const u=window.location.hash.replace("#","");if(this._hashName){let p;return u.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(p=g)}),(p&&p[1]||"").split("/")}return u.split("/")},this._onHashChange=()=>{const u=this._getCurrentHash();if(u.length>=3&&!u.some(p=>isNaN(p))){const p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:p,pitch:+(u[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const u=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,u)}catch{}},this._updateHash=Fr(this._updateHashUnthrottled,300),this._hashName=o&&encodeURIComponent(o)}addTo(o){return this._map=o,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(o){const u=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,g=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,g),S=Math.round(u.lng*x)/x,T=Math.round(u.lat*x)/x,I=this._map.getBearing(),P=this._map.getPitch();let k="";if(k+=o?`/${S}/${T}/${p}`:`${p}/${T}/${S}`,(I||P)&&(k+="/"+Math.round(10*I)/10),P&&(k+=`/${Math.round(P)}`),this._hashName){const O=this._hashName;let V=!1;const K=window.location.hash.slice(1).split("&").map(Z=>{const Y=Z.split("=")[0];return Y===O?(V=!0,`${Y}=${k}`):Z}).filter(Z=>Z);return V||K.push(`${O}=${k}`),`#${K.join("&")}`}return`#${k}`}}const Za={linearity:.3,easing:y.ba(0,0,.3,1)},xh=y.e({deceleration:2500,maxSpeed:1400},Za),Du=y.e({deceleration:20,maxSpeed:1400},Za),wh=y.e({deceleration:1e3,maxSpeed:360},Za),Ch=y.e({deceleration:1e3,maxSpeed:90},Za);class kl{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:y.h.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,u=y.h.now();for(;o.length>0&&u-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,pan:new y.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)u.zoom+=x.zoomDelta||0,u.bearing+=x.bearingDelta||0,u.pitch+=x.pitchDelta||0,x.panDelta&&u.pan._add(x.panDelta),x.around&&(u.around=x.around),x.pinchAround&&(u.pinchAround=x.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(u.pan.mag()){const x=Ol(u.pan.mag(),p,y.e({},xh,o||{}));g.offset=u.pan.mult(x.amount/u.pan.mag()),g.center=this._map.transform.center,Ws(g,x)}if(u.zoom){const x=Ol(u.zoom,p,Du);g.zoom=this._map.transform.zoom+x.amount,Ws(g,x)}if(u.bearing){const x=Ol(u.bearing,p,wh);g.bearing=this._map.transform.bearing+y.ad(x.amount,-179,179),Ws(g,x)}if(u.pitch){const x=Ol(u.pitch,p,Ch);g.pitch=this._map.transform.pitch+x.amount,Ws(g,x)}if(g.zoom||g.bearing){const x=void 0===u.pinchAround?u.around:u.pinchAround;g.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),y.e(g,{noMoveStart:!0})}}function Ws(v,o){(!v.duration||v.duration<o.duration)&&(v.duration=o.duration,v.easing=o.easing)}function Ol(v,o,u){const{maxSpeed:p,linearity:g,deceleration:x}=u,S=y.ad(v*g/(o/1e3),-p,p),T=Math.abs(S)/(x*g);return{easing:u.easing,duration:1e3*T,amount:S*(T/2)}}class fs extends y.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,p,g={}){const x=xe.mousePos(u.getCanvasContainer(),p),S=u.unproject(x);super(o,y.e({point:x,lngLat:S,originalEvent:p},g)),this._defaultPrevented=!1,this.target=u}}class Nl extends y.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,p){const g="touchend"===o?p.changedTouches:p.touches,x=xe.touchPos(u.getCanvasContainer(),g),S=x.map(I=>u.unproject(I)),T=x.reduce((I,P,k,O)=>I.add(P.div(O.length)),new y.P(0,0));super(o,{points:x,point:T,lngLats:S,lngLat:u.unproject(T),originalEvent:p}),this._defaultPrevented=!1}}class Zd extends y.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,p){super(o,{originalEvent:p}),this._defaultPrevented=!1}}class Kd{constructor(o,u){this._map=o,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new Zd(o.type,this._map,o))}mousedown(o,u){return this._mousedownPos=u,this._firePreventable(new fs(o.type,this._map,o))}mouseup(o){this._map.fire(new fs(o.type,this._map,o))}click(o,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new fs(o.type,this._map,o))}dblclick(o){return this._firePreventable(new fs(o.type,this._map,o))}mouseover(o){this._map.fire(new fs(o.type,this._map,o))}mouseout(o){this._map.fire(new fs(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Nl(o.type,this._map,o))}touchmove(o){this._map.fire(new Nl(o.type,this._map,o))}touchend(o){this._map.fire(new Nl(o.type,this._map,o))}touchcancel(o){this._map.fire(new Nl(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ms{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(o){this._map.fire(new fs(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new fs("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._ignoreContextMenu||this._map.fire(new fs(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Po{constructor(o){this._map=o}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(o){return this.transform.pointLocation(y.P.convert(o),this._map.terrain)}}class Eh{constructor(o,u){this._map=o,this._tr=new Po(o),this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,u){this.isEnabled()&&o.shiftKey&&0===o.button&&(xe.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(o,u){if(!this._active)return;const p=u;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const g=this._startPos;this._lastPos=p,this._box||(this._box=xe.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",o));const x=Math.min(g.x,p.x),S=Math.max(g.x,p.x),T=Math.min(g.y,p.y),I=Math.max(g.y,p.y);xe.setTransform(this._box,`translate(${x}px,${T}px)`),this._box.style.width=S-x+"px",this._box.style.height=I-T+"px"}mouseupWindow(o,u){if(!this._active||0!==o.button)return;const p=this._startPos,g=u;if(this.reset(),xe.suppressClick(),p.x!==g.x||p.y!==g.y)return this._map.fire(new y.k("boxzoomend",{originalEvent:o})),{cameraAnimation:x=>x.fitScreenCoordinates(p,g,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&27===o.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",o))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(xe.remove(this._box),this._box=null),xe.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,u){return this._map.fire(new y.k(o,{originalEvent:u}))}}function Ps(v,o){if(v.length!==o.length)throw new Error(`The number of touches and points are not equal - touches ${v.length}, points ${o.length}`);const u={};for(let p=0;p<v.length;p++)u[v[p].identifier]=o[p];return u}class Ro{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,u,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=o.timeStamp),p.length===this.numTouches&&(this.centroid=function(g){const x=new y.P(0,0);for(const S of g)x._add(S);return x.div(g.length)}(u),this.touches=Ps(p,u)))}touchmove(o,u,p){if(this.aborted||!this.centroid)return;const g=Ps(p,u);for(const x in this.touches){const S=g[x];(!S||S.dist(this.touches[x])>30)&&(this.aborted=!0)}}touchend(o,u,p){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),0===p.length){const g=!this.aborted&&this.centroid;if(this.reset(),g)return g}}}class Iu{constructor(o){this.singleTap=new Ro(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,u,p){this.singleTap.touchstart(o,u,p)}touchmove(o,u,p){this.singleTap.touchmove(o,u,p)}touchend(o,u,p){const g=this.singleTap.touchend(o,u,p);if(g){const x=o.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(g)<30;if(x&&S||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}}}class Lo{constructor(o){this._tr=new Po(o),this._zoomIn=new Iu({numTouches:1,numTaps:2}),this._zoomOut=new Iu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,u,p){this._zoomIn.touchstart(o,u,p),this._zoomOut.touchstart(o,u,p)}touchmove(o,u,p){this._zoomIn.touchmove(o,u,p),this._zoomOut.touchmove(o,u,p)}touchend(o,u,p){const g=this._zoomIn.touchend(o,u,p),x=this._zoomOut.touchend(o,u,p),S=this._tr;return g?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:S.zoom+1,around:S.unproject(g)},{originalEvent:o})}):x?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:S.zoom-1,around:S.unproject(x)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class lo{constructor(o){this._enabled=!!o.enable,this._moveStateManager=o.moveStateManager,this._clickTolerance=o.clickTolerance||1,this._moveFunction=o.move,this._activateOnStart=!!o.activateOnStart,o.assignEvents(this),this.reset()}reset(o){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(o)}_move(...o){const u=this._moveFunction(...o);if(u.bearingDelta||u.pitchDelta||u.around||u.panDelta)return this._active=!0,u}dragStart(o,u){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(o)&&(this._moveStateManager.startMove(o),this._lastPoint=u.length?u[0]:u,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(o,u){if(!this.isEnabled())return;const p=this._lastPoint;if(!p)return;if(o.preventDefault(),!this._moveStateManager.isValidMoveEvent(o))return void this.reset(o);const g=u.length?u[0]:u;return!this._moved&&g.dist(p)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=g,this._move(p,g))}dragEnd(o){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(o)&&(this._moved&&xe.suppressClick(),this.reset(o))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Lp={0:1,2:2};class Sh{constructor(o){this._correctEvent=o.checkCorrectEvent}startMove(o){const u=xe.mouseButton(o);this._eventButton=u}endMove(o){delete this._eventButton}isValidStartEvent(o){return this._correctEvent(o)}isValidMoveEvent(o){return!function(u,p){const g=Lp[p];return void 0===u.buttons||(u.buttons&g)!==g}(o,this._eventButton)}isValidEndEvent(o){return xe.mouseButton(o)===this._eventButton}}class Xd{constructor(){this._firstTouch=void 0}_isOneFingerTouch(o){return 1===o.targetTouches.length}_isSameTouchEvent(o){return o.targetTouches[0].identifier===this._firstTouch}startMove(o){this._firstTouch=o.targetTouches[0].identifier}endMove(o){delete this._firstTouch}isValidStartEvent(o){return this._isOneFingerTouch(o)}isValidMoveEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}isValidEndEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}}const Er=v=>{v.mousedown=v.dragStart,v.mousemoveWindow=v.dragMove,v.mouseup=v.dragEnd,v.contextmenu=function(o){o.preventDefault()}},Fl=({enable:v,clickTolerance:o,bearingDegreesPerPixelMoved:u=.8})=>{const p=new Sh({checkCorrectEvent:g=>0===xe.mouseButton(g)&&g.ctrlKey||2===xe.mouseButton(g)});return new lo({clickTolerance:o,move:(g,x)=>({bearingDelta:(x.x-g.x)*u}),moveStateManager:p,enable:v,assignEvents:Er})},ko=({enable:v,clickTolerance:o,pitchDegreesPerPixelMoved:u=-.5})=>{const p=new Sh({checkCorrectEvent:g=>0===xe.mouseButton(g)&&g.ctrlKey||2===xe.mouseButton(g)});return new lo({clickTolerance:o,move:(g,x)=>({pitchDelta:(x.y-g.y)*u}),moveStateManager:p,enable:v,assignEvents:Er})};class Ye{constructor(o,u){this._minTouches=o.cooperativeGestures?2:1,this._clickTolerance=o.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new y.P(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(o,u,p){return this._calculateTransform(o,u,p)}touchmove(o,u,p){if(this._map._cooperativeGestures&&(2===this._minTouches&&p.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(o,!1,p.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(p.length<this._minTouches))return o.preventDefault(),this._calculateTransform(o,u,p)}touchend(o,u,p){this._calculateTransform(o,u,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,u,p){p.length>0&&(this._active=!0);const g=Ps(p,u),x=new y.P(0,0),S=new y.P(0,0);let T=0;for(const P in g){const k=g[P],O=this._touches[P];O&&(x._add(k),S._add(k.sub(O)),T++,g[P]=k)}if(this._touches=g,T<this._minTouches||!S.mag())return;const I=S.div(T);return this._sum._add(I),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(T),panDelta:I}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class nr{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(o,u,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([u[0],u[1]]))}touchmove(o,u,p){if(!this._firstTwoTouches)return;o.preventDefault();const[g,x]=this._firstTwoTouches,S=ca(p,u,g),T=ca(p,u,x);if(!S||!T)return;const I=this._aroundCenter?null:S.add(T).div(2);return this._move([S,T],I,o)}touchend(o,u,p){if(!this._firstTwoTouches)return;const[g,x]=this._firstTwoTouches,S=ca(p,u,g),T=ca(p,u,x);S&&T||(this._active&&xe.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&"center"===o.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ca(v,o,u){for(let p=0;p<v.length;p++)if(v[p].identifier===u)return o[p]}function Ka(v,o){return Math.log(v/o)/Math.LN2}class Hi extends nr{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,u){const p=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Ka(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ka(this._distance,p),pinchAround:u}}}function Fe(v,o){return 180*v.angleWith(o)/Math.PI}class dn extends nr{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,u){const p=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Fe(this._vector,p),pinchAround:u}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const u=25/(Math.PI*this._minDiameter)*360,p=Fe(o,this._startVector);return Math.abs(p)<u}}function qi(v){return Math.abs(v.y)>Math.abs(v.x)}class zr extends nr{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(o,u,p){super.touchstart(o,u,p),this._currentTouchCount=p.length}_start(o){this._lastPoints=o,qi(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,u,p){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const g=o[0].sub(this._lastPoints[0]),x=o[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(g,x,p.timeStamp),this._valid?(this._lastPoints=o,this._active=!0,{pitchDelta:(g.y+x.y)/2*-.5}):void 0}gestureBeginsVertically(o,u,p){if(void 0!==this._valid)return this._valid;const g=o.mag()>=2,x=u.mag()>=2;if(!g&&!x)return;if(!g||!x)return void 0===this._firstMove&&(this._firstMove=p),p-this._firstMove<100&&void 0;const S=o.y>0==u.y>0;return qi(o)&&qi(u)&&S}}const ua={panStep:100,bearingStep:15,pitchStep:10};class Qr{constructor(o){this._tr=new Po(o);const u=ua;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let u=0,p=0,g=0,x=0,S=0;switch(o.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:o.shiftKey?p=-1:(o.preventDefault(),x=-1);break;case 39:o.shiftKey?p=1:(o.preventDefault(),x=1);break;case 38:o.shiftKey?g=1:(o.preventDefault(),S=-1);break;case 40:o.shiftKey?g=-1:(o.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(p=0,g=0),{cameraAnimation:T=>{const I=this._tr;T.easeTo({duration:300,easeId:"keyboardHandler",easing:Th,zoom:u?Math.round(I.zoom)+u*(o.shiftKey?2:1):I.zoom,bearing:I.bearing+p*this._bearingStep,pitch:I.pitch+g*this._pitchStep,offset:[-x*this._panStep,-S*this._panStep],center:I.center},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Th(v){return v*(2-v)}const Dh=4.000244140625;class Au{constructor(o,u){this._onTimeout=p=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(p)},this._map=o,this._tr=new Po(o),this._el=o.getCanvasContainer(),this._triggerRenderFrame=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&"center"===o.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!o[this._map._metaKey])return;o.preventDefault()}let u=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const p=y.h.now(),g=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,0!==u&&u%Dh==0?this._type="wheel":0!==u&&Math.abs(u)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(g*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),o.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=o,this._delta-=u,this._active||this._start(o)),o.preventDefault()}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=xe.mousePos(this._el,o),p=this._tr;this._around=y.L.convert(this._aroundCenter?p.center:p.unproject(u)),this._aroundPoint=p.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._tr.transform;if(0!==this._delta){const T="wheel"===this._type&&Math.abs(this._delta)>Dh?this._wheelZoomRate:this._defaultZoomRate;let I=2/(1+Math.exp(-Math.abs(this._delta*T)));this._delta<0&&0!==I&&(I=1/I);const P="number"==typeof this._targetZoom?o.zoomScale(this._targetZoom):o.scale;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(P*I))),"wheel"===this._type&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u="number"==typeof this._targetZoom?this._targetZoom:o.zoom,p=this._startZoom,g=this._easing;let x,S=!1;if("wheel"===this._type&&p&&g){const T=Math.min((y.h.now()-this._lastWheelEventTime)/200,1),I=g(T);x=y.B.number(p,u,I),T<1?this._frameId||(this._frameId=!0):S=!0}else x=u,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!S,zoomDelta:x-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let u=y.bb;if(this._prevEase){const p=this._prevEase,g=(y.h.now()-p.start)/p.duration,x=p.easing(g+.01)-p.easing(g),S=.27/Math.sqrt(x*x+1e-4)*.01,T=Math.sqrt(.0729-S*S);u=y.ba(S,T,.25,1)}return this._prevEase={start:y.h.now(),duration:o,easing:u},u}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Ih{constructor(o,u){this._clickZoom=o,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ah{constructor(o){this._tr=new Po(o),this.reset()}reset(){this._active=!1}dblclick(o,u){return o.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:this._tr.zoom+(o.shiftKey?-1:1),around:this._tr.unproject(u)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class li{constructor(){this._tap=new Iu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(o,u,p){if(!this._swipePoint)if(this._tapTime){const g=u[0],x=o.timeStamp-this._tapTime<500,S=this._tapPoint.dist(g)<30;x&&S?p.length>0&&(this._swipePoint=g,this._swipeTouch=p[0].identifier):this.reset()}else this._tap.touchstart(o,u,p)}touchmove(o,u,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const g=u[0],x=g.y-this._swipePoint.y;return this._swipePoint=g,o.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(o,u,p)}touchend(o,u,p){if(this._tapTime)this._swipePoint&&0===p.length&&this.reset();else{const g=this._tap.touchend(o,u,p);g&&(this._tapTime=o.timeStamp,this._tapPoint=g)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qe{constructor(o,u,p){this._el=o,this._mousePan=u,this._touchPan=p}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class bt{constructor(o,u,p){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=u,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Dn{constructor(o,u,p,g){this._el=o,this._touchZoom=u,this._touchRotate=p,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Br=v=>v.zoom||v.drag||v.pitch||v.rotate;class Xa extends y.k{}function Oi(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta}class ha{constructor(o,u){this.handleWindowEvent=g=>{this.handleEvent(g,`${g.type}Window`)},this.handleEvent=(g,x)=>{if("blur"===g.type)return void this.stop(!0);this._updatingCamera=!0;const S="renderFrame"===g.type?void 0:g,T={needsRenderFrame:!1},I={},P={},k=g.touches,O=k?this._getMapTouches(k):void 0,V=O?xe.touchPos(this._el,O):xe.mousePos(this._el,g);for(const{handlerName:Y,handler:G,allowed:le}of this._handlers){if(!G.isEnabled())continue;let ge;this._blockedByActive(P,le,Y)?G.reset():G[x||g.type]&&(ge=G[x||g.type](g,V,O),this.mergeHandlerResult(T,I,ge,Y,S),ge&&ge.needsRenderFrame&&this._triggerRenderFrame()),(ge||G.isActive())&&(P[Y]=G)}const K={};for(const Y in this._previousActiveHandlers)P[Y]||(K[Y]=S);this._previousActiveHandlers=P,(Object.keys(K).length||Oi(T))&&(this._changes.push([T,I,K]),this._triggerRenderFrame()),(Object.keys(P).length||Oi(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Z}=T;Z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Z(this._map))},this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new kl(o),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[g,x,S]of this._listeners)xe.addEventListener(g,x,g===document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[o,u,p]of this._listeners)xe.removeEventListener(o,u,o===document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(o){const u=this._map,p=u.getCanvasContainer();this._add("mapEvent",new Kd(u,o));const g=u.boxZoom=new Eh(u,o);this._add("boxZoom",g),o.interactive&&o.boxZoom&&g.enable();const x=new Lo(u),S=new Ah(u);u.doubleClickZoom=new Ih(S,x),this._add("tapZoom",x),this._add("clickZoom",S),o.interactive&&o.doubleClickZoom&&u.doubleClickZoom.enable();const T=new li;this._add("tapDragZoom",T);const I=u.touchPitch=new zr(u);this._add("touchPitch",I),o.interactive&&o.touchPitch&&u.touchPitch.enable(o.touchPitch);const P=Fl(o),k=ko(o);u.dragRotate=new bt(o,P,k),this._add("mouseRotate",P,["mousePitch"]),this._add("mousePitch",k,["mouseRotate"]),o.interactive&&o.dragRotate&&u.dragRotate.enable();const O=(({enable:le,clickTolerance:ge})=>{const ie=new Sh({checkCorrectEvent:he=>0===xe.mouseButton(he)&&!he.ctrlKey});return new lo({clickTolerance:ge,move:(he,_e)=>({around:_e,panDelta:_e.sub(he)}),activateOnStart:!0,moveStateManager:ie,enable:le,assignEvents:Er})})(o),V=new Ye(o,u);u.dragPan=new Qe(p,O,V),this._add("mousePan",O),this._add("touchPan",V,["touchZoom","touchRotate"]),o.interactive&&o.dragPan&&u.dragPan.enable(o.dragPan);const K=new dn,Z=new Hi;u.touchZoomRotate=new Dn(p,Z,K,T),this._add("touchRotate",K,["touchPan","touchZoom"]),this._add("touchZoom",Z,["touchPan","touchRotate"]),o.interactive&&o.touchZoomRotate&&u.touchZoomRotate.enable(o.touchZoomRotate);const Y=u.scrollZoom=new Au(u,()=>this._triggerRenderFrame());this._add("scrollZoom",Y,["mousePan"]),o.interactive&&o.scrollZoom&&u.scrollZoom.enable(o.scrollZoom);const G=u.keyboard=new Qr(u);this._add("keyboard",G),o.interactive&&o.keyboard&&u.keyboard.enable(),this._add("blockableMapEvent",new Ms(u))}_add(o,u,p){this._handlers.push({handlerName:o,handler:u,allowed:p}),this._handlersById[o]=u}stop(o){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Br(this._eventsInProgress)||this.isZooming()}_blockedByActive(o,u,p){for(const g in o)if(g!==p&&(!u||u.indexOf(g)<0))return!0;return!1}_getMapTouches(o){const u=[];for(const p of o)this._el.contains(p.target)&&u.push(p);return u}mergeHandlerResult(o,u,p,g,x){if(!p)return;y.e(o,p);const S={handlerName:g,originalEvent:p.originalEvent||x};void 0!==p.zoomDelta&&(u.zoom=S),void 0!==p.panDelta&&(u.drag=S),void 0!==p.pitchDelta&&(u.pitch=S),void 0!==p.bearingDelta&&(u.rotate=S)}_applyChanges(){const o={},u={},p={};for(const[g,x,S]of this._changes)g.panDelta&&(o.panDelta=(o.panDelta||new y.P(0,0))._add(g.panDelta)),g.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+g.pitchDelta),void 0!==g.around&&(o.around=g.around),void 0!==g.pinchAround&&(o.pinchAround=g.pinchAround),g.noInertia&&(o.noInertia=g.noInertia),y.e(u,x),y.e(p,S);this._updateMapTransform(o,u,p),this._changes=[]}_updateMapTransform(o,u,p){const g=this._map,x=g._getTransformForUpdate(),S=g.terrain;if(!(Oi(o)||S&&this._terrainMovement))return this._fireEvents(u,p,!0);let{panDelta:T,zoomDelta:I,bearingDelta:P,pitchDelta:k,around:O,pinchAround:V}=o;void 0!==V&&(O=V),g._stop(!0),O=O||g.transform.centerPoint;const K=x.pointLocation(T?O.sub(T):O);P&&(x.bearing+=P),k&&(x.pitch+=k),I&&(x.zoom+=I),S?this._terrainMovement||!u.drag&&!u.zoom?u.drag&&this._terrainMovement?x.center=x.pointLocation(x.centerPoint.sub(T)):x.setLocationAtPoint(K,O):(this._terrainMovement=!0,this._map._elevationFreeze=!0,x.setLocationAtPoint(K,O),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,x.recalculateZoom(g.terrain)})):x.setLocationAtPoint(K,O),g._applyUpdatedTransform(x),this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(u,p,!0)}_fireEvents(o,u,p){const g=Br(this._eventsInProgress),x=Br(o),S={};for(const k in o){const{originalEvent:O}=o[k];this._eventsInProgress[k]||(S[`${k}start`]=O),this._eventsInProgress[k]=o[k]}!g&&x&&this._fireEvent("movestart",x.originalEvent);for(const k in S)this._fireEvent(k,S[k]);x&&this._fireEvent("move",x.originalEvent);for(const k in o){const{originalEvent:O}=o[k];this._fireEvent(k,O)}const T={};let I;for(const k in this._eventsInProgress){const{handlerName:O,originalEvent:V}=this._eventsInProgress[k];this._handlersById[O].isActive()||(delete this._eventsInProgress[k],I=u[O]||V,T[`${k}end`]=I)}for(const k in T)this._fireEvent(k,T[k]);const P=Br(this._eventsInProgress);if(p&&(g||x)&&!P){this._updatingCamera=!0;const k=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),O=V=>0!==V&&-this._bearingSnap<V&&V<this._bearingSnap;!k||!k.essential&&y.h.prefersReducedMotion?(this._map.fire(new y.k("moveend",{originalEvent:I})),O(this._map.getBearing())&&this._map.resetNorth()):(O(k.bearing||this._map.getBearing())&&(k.bearing=0),k.freezeElevation=!0,this._map.easeTo(k,{originalEvent:I})),this._updatingCamera=!1}}_fireEvent(o,u){this._map.fire(new y.k(o,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new Xa("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class xi extends y.E{constructor(o,u){super(),this._renderFrameCallback=()=>{const p=Math.min((y.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(p)),p<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=u.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new y.L(this.transform.center.lng,this.transform.center.lat)}setCenter(o,u){return this.jumpTo({center:o},u)}panBy(o,u,p){return o=y.P.convert(o).mult(-1),this.panTo(this.transform.center,y.e({offset:o},u),p)}panTo(o,u,p){return this.easeTo(y.e({center:o},u),p)}getZoom(){return this.transform.zoom}setZoom(o,u){return this.jumpTo({zoom:o},u),this}zoomTo(o,u,p){return this.easeTo(y.e({zoom:o},u),p)}zoomIn(o,u){return this.zoomTo(this.getZoom()+1,o,u),this}zoomOut(o,u){return this.zoomTo(this.getZoom()-1,o,u),this}getBearing(){return this.transform.bearing}setBearing(o,u){return this.jumpTo({bearing:o},u),this}getPadding(){return this.transform.padding}setPadding(o,u){return this.jumpTo({padding:o},u),this}rotateTo(o,u,p){return this.easeTo(y.e({bearing:o},u),p)}resetNorth(o,u){return this.rotateTo(0,y.e({duration:1e3},o),u),this}resetNorthPitch(o,u){return this.easeTo(y.e({bearing:0,pitch:0,duration:1e3},o),u),this}snapToNorth(o,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,u):this}getPitch(){return this.transform.pitch}setPitch(o,u){return this.jumpTo({pitch:o},u),this}cameraForBounds(o,u){o=Gn.convert(o);const p=u&&u.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),p,u)}_cameraForBoxAndBearing(o,u,p,g){const x={top:0,bottom:0,right:0,left:0};if("number"==typeof(g=y.e({padding:x,offset:[0,0],maxZoom:this.transform.maxZoom},g)).padding){const _e=g.padding;g.padding={top:_e,bottom:_e,right:_e,left:_e}}g.padding=y.e(x,g.padding);const S=this.transform,T=S.padding,I=S.project(y.L.convert(o)),P=S.project(y.L.convert(u)),k=I.rotate(-p*Math.PI/180),O=P.rotate(-p*Math.PI/180),V=new y.P(Math.max(k.x,O.x),Math.max(k.y,O.y)),K=new y.P(Math.min(k.x,O.x),Math.min(k.y,O.y)),Z=V.sub(K),Y=(S.width-(T.left+T.right+g.padding.left+g.padding.right))/Z.x,G=(S.height-(T.top+T.bottom+g.padding.top+g.padding.bottom))/Z.y;if(G<0||Y<0)return void y.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const le=Math.min(S.scaleZoom(S.scale*Math.min(Y,G)),g.maxZoom),ge=y.P.convert(g.offset),ie=new y.P((g.padding.left-g.padding.right)/2,(g.padding.top-g.padding.bottom)/2).rotate(p*Math.PI/180),he=ge.add(ie).mult(S.scale/S.zoomScale(le));return{center:S.unproject(I.add(P).div(2).sub(he)),zoom:le,bearing:p}}fitBounds(o,u,p){return this._fitInternal(this.cameraForBounds(o,u),u,p)}fitScreenCoordinates(o,u,p,g,x){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(y.P.convert(o)),this.transform.pointLocation(y.P.convert(u)),p,g),g,x)}_fitInternal(o,u,p){return o?(delete(u=y.e(o,u)).padding,u.linear?this.easeTo(u,p):this.flyTo(u,p)):this}jumpTo(o,u){this.stop();const p=this._getTransformForUpdate();let g=!1,x=!1,S=!1;return"zoom"in o&&p.zoom!==+o.zoom&&(g=!0,p.zoom=+o.zoom),void 0!==o.center&&(p.center=y.L.convert(o.center)),"bearing"in o&&p.bearing!==+o.bearing&&(x=!0,p.bearing=+o.bearing),"pitch"in o&&p.pitch!==+o.pitch&&(S=!0,p.pitch=+o.pitch),null==o.padding||p.isPaddingEqual(o.padding)||(p.padding=o.padding),this._applyUpdatedTransform(p),this.fire(new y.k("movestart",u)).fire(new y.k("move",u)),g&&this.fire(new y.k("zoomstart",u)).fire(new y.k("zoom",u)).fire(new y.k("zoomend",u)),x&&this.fire(new y.k("rotatestart",u)).fire(new y.k("rotate",u)).fire(new y.k("rotateend",u)),S&&this.fire(new y.k("pitchstart",u)).fire(new y.k("pitch",u)).fire(new y.k("pitchend",u)),this.fire(new y.k("moveend",u))}calculateCameraOptionsFromTo(o,u,p,g=0){const x=y.U.fromLngLat(o,u),S=y.U.fromLngLat(p,g),T=S.x-x.x,I=S.y-x.y,P=S.z-x.z,k=Math.hypot(T,I,P);if(0===k)throw new Error("Can't calculate camera options with same From and To");const O=Math.hypot(T,I),V=this.transform.scaleZoom(this.transform.cameraToCenterDistance/k/this.transform.tileSize),K=180*Math.atan2(T,-I)/Math.PI;let Z=180*Math.acos(O/k)/Math.PI;return Z=P<0?90-Z:90+Z,{center:S.toLngLat(),zoom:V,pitch:Z,bearing:K}}easeTo(o,u){this._stop(!1,o.easeId),(!1===(o=y.e({offset:[0,0],duration:500,easing:y.bb},o)).animate||!o.essential&&y.h.prefersReducedMotion)&&(o.duration=0);const p=this._getTransformForUpdate(),g=this.getZoom(),x=this.getBearing(),S=this.getPitch(),T=this.getPadding(),I="zoom"in o?+o.zoom:g,P="bearing"in o?this._normalizeBearing(o.bearing,x):x,k="pitch"in o?+o.pitch:S,O="padding"in o?o.padding:p.padding,V=y.P.convert(o.offset);let K=p.centerPoint.add(V);const Z=p.pointLocation(K),Y=y.L.convert(o.center||Z);this._normalizeCenter(Y);const G=p.project(Z),le=p.project(Y).sub(G),ge=p.zoomScale(I-g);let ie,he;o.around&&(ie=y.L.convert(o.around),he=p.locationPoint(ie));const _e={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||I!==g,this._rotating=this._rotating||x!==P,this._pitching=this._pitching||k!==S,this._padding=!p.isPaddingEqual(O),this._easeId=o.easeId,this._prepareEase(u,o.noMoveStart,_e),this.terrain&&this._prepareElevation(Y),this._ease(be=>{if(this._zooming&&(p.zoom=y.B.number(g,I,be)),this._rotating&&(p.bearing=y.B.number(x,P,be)),this._pitching&&(p.pitch=y.B.number(S,k,be)),this._padding&&(p.interpolatePadding(T,O,be),K=p.centerPoint.add(V)),this.terrain&&!o.freezeElevation&&this._updateElevation(be),ie)p.setLocationAtPoint(ie,he);else{const Ee=p.zoomScale(p.zoom-g),Me=I>g?Math.min(2,ge):Math.max(.5,ge),Ae=Math.pow(Me,1-be),Ne=p.unproject(G.add(le.mult(be*Ae)).mult(Ee));p.setLocationAtPoint(p.renderWorldCopies?Ne.wrap():Ne,K)}this._applyUpdatedTransform(p),this._fireMoveEvents(u)},be=>{this.terrain&&this._finalizeElevation(),this._afterEase(u,be)},o),this}_prepareEase(o,u,p={}){this._moving=!0,u||p.moving||this.fire(new y.k("movestart",o)),this._zooming&&!p.zooming&&this.fire(new y.k("zoomstart",o)),this._rotating&&!p.rotating&&this.fire(new y.k("rotatestart",o)),this._pitching&&!p.pitching&&this.fire(new y.k("pitchstart",o))}_prepareElevation(o){this._elevationCenter=o,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(o){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const u=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(o<1&&u!==this._elevationTarget){const p=this._elevationTarget-this._elevationStart;this._elevationStart+=o*(p-(u-(p*o+this._elevationStart))/(1-o)),this._elevationTarget=u}this.transform.elevation=y.B.number(this._elevationStart,this._elevationTarget,o)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(o){if(!this.transformCameraUpdate)return;const u=o.clone(),{center:p,zoom:g,pitch:x,bearing:S,elevation:T}=this.transformCameraUpdate(u);p&&(u.center=p),void 0!==g&&(u.zoom=g),void 0!==x&&(u.pitch=x),void 0!==S&&(u.bearing=S),void 0!==T&&(u.elevation=T),this.transform.apply(u)}_fireMoveEvents(o){this.fire(new y.k("move",o)),this._zooming&&this.fire(new y.k("zoom",o)),this._rotating&&this.fire(new y.k("rotate",o)),this._pitching&&this.fire(new y.k("pitch",o))}_afterEase(o,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId;const p=this._zooming,g=this._rotating,x=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new y.k("zoomend",o)),g&&this.fire(new y.k("rotateend",o)),x&&this.fire(new y.k("pitchend",o)),this.fire(new y.k("moveend",o))}flyTo(o,u){if(!o.essential&&y.h.prefersReducedMotion){const st=y.F(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(st,u)}this.stop(),o=y.e({offset:[0,0],speed:1.2,curve:1.42,easing:y.bb},o);const p=this._getTransformForUpdate(),g=this.getZoom(),x=this.getBearing(),S=this.getPitch(),T=this.getPadding(),I="zoom"in o?y.ad(+o.zoom,p.minZoom,p.maxZoom):g,P="bearing"in o?this._normalizeBearing(o.bearing,x):x,k="pitch"in o?+o.pitch:S,O="padding"in o?o.padding:p.padding,V=p.zoomScale(I-g),K=y.P.convert(o.offset);let Z=p.centerPoint.add(K);const Y=p.pointLocation(Z),G=y.L.convert(o.center||Y);this._normalizeCenter(G);const le=p.project(Y),ge=p.project(G).sub(le);let ie=o.curve;const he=Math.max(p.width,p.height),_e=he/V,be=ge.mag();if("minZoom"in o){const st=y.ad(Math.min(o.minZoom,g,I),p.minZoom,p.maxZoom),An=he/p.zoomScale(st-g);ie=Math.sqrt(An/be*2)}const Ee=ie*ie;function Me(st){const An=(_e*_e-he*he+(st?-1:1)*Ee*Ee*be*be)/(2*(st?_e:he)*Ee*be);return Math.log(Math.sqrt(An*An+1)-An)}function Ae(st){return(Math.exp(st)-Math.exp(-st))/2}function Ne(st){return(Math.exp(st)+Math.exp(-st))/2}const We=Me(!1);let jt=function(st){return Ne(We)/Ne(We+ie*st)},Oe=function(st){return he*((Ne(We)*(Ae(An=We+ie*st)/Ne(An))-Ae(We))/Ee)/be;var An},vt=(Me(!0)-We)/ie;if(Math.abs(be)<1e-6||!isFinite(vt)){if(Math.abs(he-_e)<1e-6)return this.easeTo(o,u);const st=_e<he?-1:1;vt=Math.abs(Math.log(_e/he))/ie,Oe=function(){return 0},jt=function(An){return Math.exp(st*ie*An)}}return o.duration="duration"in o?+o.duration:1e3*vt/("screenSpeed"in o?+o.screenSpeed/ie:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=x!==P,this._pitching=k!==S,this._padding=!p.isPaddingEqual(O),this._prepareEase(u,!1),this.terrain&&this._prepareElevation(G),this._ease(st=>{const An=st*vt,qt=1/jt(An);p.zoom=1===st?I:g+p.scaleZoom(qt),this._rotating&&(p.bearing=y.B.number(x,P,st)),this._pitching&&(p.pitch=y.B.number(S,k,st)),this._padding&&(p.interpolatePadding(T,O,st),Z=p.centerPoint.add(K)),this.terrain&&!o.freezeElevation&&this._updateElevation(st);const Nt=1===st?G:p.unproject(le.add(ge.mult(Oe(An))).mult(qt));p.setLocationAtPoint(p.renderWorldCopies?Nt.wrap():Nt,Z),this._applyUpdatedTransform(p),this._fireMoveEvents(u)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(u)},o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const p=this._onEaseEnd;delete this._onEaseEnd,p.call(this,u)}if(!o){const p=this.handlers;p&&p.stop(!1)}return this}_ease(o,u,p){!1===p.animate||0===p.duration?(o(1),u()):(this._easeStart=y.h.now(),this._easeOptions=p,this._onEaseFrame=o,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(o,u){o=y.b5(o,-180,180);const p=Math.abs(o-u);return Math.abs(o-360-u)<p&&(o-=360),Math.abs(o+360-u)<p&&(o+=360),o}_normalizeCenter(o){const u=this.transform;if(!u.renderWorldCopies||u.lngRange)return;const p=o.lng-u.center.lng;o.lng+=p>180?-360:p<-180?360:0}queryTerrainElevation(o){return this.terrain?this.terrain.getElevationForLngLatZoom(y.L.convert(o),this.transform.tileZoom)-this.transform.elevation:null}}class Ni{constructor(o={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=u=>{!u||"metadata"!==u.sourceDataType&&"visibility"!==u.sourceDataType&&"style"!==u.dataType&&"terrain"!==u.type||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=o}getDefaultPosition(){return"bottom-right"}onAdd(o){return this._map=o,this._compact=this.options&&this.options.compact,this._container=xe.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=xe.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=xe.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){xe.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(o,u){const p=this._map._getUIString(`AttributionControl.${u}`);o.title=p,o.setAttribute("aria-label",p)}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(g=>"string"!=typeof g?"":g)):"string"==typeof this.options.customAttribution&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const g=this._map.style.stylesheet;this.styleOwner=g.owner,this.styleId=g.id}const u=this._map.style.sourceCaches;for(const g in u){const x=u[g];if(x.used||x.usedForTerrain){const S=x.getSource();S.attribution&&o.indexOf(S.attribution)<0&&o.push(S.attribution)}}o=o.filter(g=>String(g).trim()),o.sort((g,x)=>g.length-x.length),o=o.filter((g,x)=>{for(let S=x+1;S<o.length;S++)if(o[S].indexOf(g)>=0)return!1;return!0});const p=o.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,o.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class In{constructor(o={}){this._updateCompact=()=>{const u=this._container.children;if(u.length){const p=u[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&p.classList.add("maplibregl-compact"):p.classList.remove("maplibregl-compact")}},this.options=o}getDefaultPosition(){return"bottom-left"}onAdd(o){this._map=o,this._compact=this.options&&this.options.compact,this._container=xe.create("div","maplibregl-ctrl");const u=xe.create("a","maplibregl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){xe.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class kt{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const u=++this._id;return this._queue.push({callback:o,id:u,cancelled:!1}),u}remove(o){const u=this._currentlyRunning,p=u?this._queue.concat(u):this._queue;for(const g of p)if(g.id===o)return void(g.cancelled=!0)}run(o=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const p of u)if(!p.cancelled&&(p.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Ya={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var Mh=y.Q([{name:"a_pos3d",type:"Int16",components:3}]);class Qa extends y.E{constructor(o){super(),this.sourceCache=o,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,o.usedForTerrain=!0,o.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(o,u){this.sourceCache.update(o,u),this._renderableTilesKeys=[];const p={};for(const g of o.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u}))p[g.key]=!0,this._renderableTilesKeys.push(g.key),this._tiles[g.key]||(g.posMatrix=new Float64Array(16),y.aS(g.posMatrix,0,y.N,0,y.N,0,1),this._tiles[g.key]=new za(g,this.tileSize));for(const g in this._tiles)p[g]||delete this._tiles[g]}freeRtt(o){for(const u in this._tiles){const p=this._tiles[u];(!o||p.tileID.equals(o)||p.tileID.isChildOf(o)||o.isChildOf(p.tileID))&&(p.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(o=>this.getTileByID(o))}getTileByID(o){return this._tiles[o]}getTerrainCoords(o){const u={};for(const p of this._renderableTilesKeys){const g=this._tiles[p].tileID;if(g.canonical.equals(o.canonical)){const x=o.clone();x.posMatrix=new Float64Array(16),y.aS(x.posMatrix,0,y.N,0,y.N,0,1),u[p]=x}else if(g.canonical.isChildOf(o.canonical)){const x=o.clone();x.posMatrix=new Float64Array(16);const S=g.canonical.z-o.canonical.z,T=g.canonical.x-(g.canonical.x>>S<<S),I=g.canonical.y-(g.canonical.y>>S<<S),P=y.N>>S;y.aS(x.posMatrix,0,P,0,P,0,1),y.$(x.posMatrix,x.posMatrix,[-T*P,-I*P,0]),u[p]=x}else if(o.canonical.isChildOf(g.canonical)){const x=o.clone();x.posMatrix=new Float64Array(16);const S=o.canonical.z-g.canonical.z,T=o.canonical.x-(o.canonical.x>>S<<S),I=o.canonical.y-(o.canonical.y>>S<<S),P=y.N>>S;y.aS(x.posMatrix,0,y.N,0,y.N,0,1),y.$(x.posMatrix,x.posMatrix,[T*P,I*P,0]),y.a0(x.posMatrix,x.posMatrix,[1/2**S,1/2**S,0]),u[p]=x}}return u}getSourceTile(o,u){const p=this.sourceCache._source;let g=o.overscaledZ-this.deltaZoom;if(g>p.maxzoom&&(g=p.maxzoom),g<p.minzoom)return null;this._sourceTileCache[o.key]||(this._sourceTileCache[o.key]=o.scaledTo(g).key);let x=this.sourceCache.getTileByID(this._sourceTileCache[o.key]);if((!x||!x.dem)&&u)for(;g>=p.minzoom&&(!x||!x.dem);)x=this.sourceCache.getTileByID(o.scaledTo(g--).key);return x}tilesAfterTime(o=Date.now()){return Object.values(this._tiles).filter(u=>u.timeAdded>=o)}}class wi{constructor(o,u,p){this.painter=o,this.sourceCache=new Qa(u),this.options=p,this.exaggeration="number"==typeof p.exaggeration?p.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(o,u,p,g=y.N){var x;if(!(u>=0&&u<g&&p>=0&&p<g))return 0;const S=this.getTerrainData(o),T=null===(x=S.tile)||void 0===x?void 0:x.dem;if(!T)return 0;const I=((Z=[])[0]=(G=S.u_terrain_matrix)[0]*(le=(Y=[u/g*y.N,p/g*y.N])[0])+G[4]*(ge=Y[1])+G[12],Z[1]=G[1]*le+G[5]*ge+G[13],Z),P=[I[0]*T.dim,I[1]*T.dim],k=Math.floor(P[0]),O=Math.floor(P[1]),V=P[0]-k,K=P[1]-O;var Z,Y,G,le,ge;return T.get(k,O)*(1-V)*(1-K)+T.get(k+1,O)*V*(1-K)+T.get(k,O+1)*(1-V)*K+T.get(k+1,O+1)*V*K}getElevationForLngLatZoom(o,u){const{tileID:p,mercatorX:g,mercatorY:x}=this._getOverscaledTileIDFromLngLatZoom(o,u);return this.getElevation(p,g%y.N,x%y.N,y.N)}getElevation(o,u,p,g=y.N){return this.getDEMElevation(o,u,p,g)*this.exaggeration}getTerrainData(o){if(!this._emptyDemTexture){const g=this.painter.context,x=new y.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ot(g,x,g.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ot(g,new y.R({width:1,height:1}),g.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=y.ao([])}const u=this.sourceCache.getSourceTile(o,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const g=this.painter.context;u.demTexture=this.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new ot(g,u.dem.getPixels(),g.gl.RGBA,{premultiply:!1}),u.demTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const p=u&&u+u.tileID.key+o.key;if(p&&!this._demMatrixCache[p]){const g=this.sourceCache.sourceCache._source.maxzoom;let x=o.canonical.z-u.tileID.canonical.z;o.overscaledZ>o.canonical.z&&(o.canonical.z>=g?x=o.canonical.z-g:y.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const S=o.canonical.x-(o.canonical.x>>x<<x),T=o.canonical.y-(o.canonical.y>>x<<x),I=y.bc(new Float64Array(16),[1/(y.N<<x),1/(y.N<<x),0]);y.$(I,I,[S*y.N,T*y.N,0]),this._demMatrixCache[o.key]={matrix:I,coord:o}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:p?this._demMatrixCache[o.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getFramebuffer(o){const u=this.painter,p=u.width/devicePixelRatio,g=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===p&&this._fbo.height===g||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ot(u.context,{width:p,height:g,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ot(u.context,{width:p,height:g,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(p,g,!0,!1),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,p,g))),this._fbo.colorAttachment.set("coords"===o?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const o=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let x=0,S=0;x<this._coordsTextureSize;x++)for(let T=0;T<this._coordsTextureSize;T++,S+=4)u[S+0]=255&T,u[S+1]=255&x,u[S+2]=T>>8<<4|x>>8,u[S+3]=0;const p=new y.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),g=new ot(o,p,o.gl.RGBA,{premultiply:!1});return g.bind(o.gl.NEAREST,o.gl.CLAMP_TO_EDGE),this._coordsTexture=g,g}pointCoordinate(o){const u=new Uint8Array(4),p=this.painter.context,g=p.gl;p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),g.readPixels(o.x,this.painter.height/devicePixelRatio-o.y-1,1,1,g.RGBA,g.UNSIGNED_BYTE,u),p.bindFramebuffer.set(null);const x=u[0]+(u[2]>>4<<8),S=u[1]+((15&u[2])<<8),T=this.coordsIndex[255-u[3]],I=T&&this.sourceCache.getTileByID(T);if(!I)return null;const P=this._coordsTextureSize,k=(1<<I.tileID.canonical.z)*P;return new y.U((I.tileID.canonical.x*P+x)/k,(I.tileID.canonical.y*P+S)/k,this.getElevation(I.tileID,x,S,P))}getTerrainMesh(){if(this._mesh)return this._mesh;const o=this.painter.context,u=new y.bd,p=new y.b0,g=this.meshSize,x=y.N/g,S=g*g;for(let O=0;O<=g;O++)for(let V=0;V<=g;V++)u.emplaceBack(V*x,O*x,0);for(let O=0;O<S;O+=g+1)for(let V=0;V<g;V++)p.emplaceBack(V+O,g+V+O+1,g+V+O+2),p.emplaceBack(V+O,g+V+O+2,V+O+1);const T=u.length,I=T+2*(g+1);for(const O of[0,1])for(let V=0;V<=g;V++)for(const K of[0,1])u.emplaceBack(V*x,O*y.N,K);for(let O=0;O<2*g;O+=2)p.emplaceBack(I+O,I+O+1,I+O+3),p.emplaceBack(I+O,I+O+3,I+O+2),p.emplaceBack(T+O,T+O+3,T+O+1),p.emplaceBack(T+O,T+O+2,T+O+3);const P=u.length,k=P+2*(g+1);for(const O of[0,1])for(let V=0;V<=g;V++)for(const K of[0,1])u.emplaceBack(O*y.N,V*x,K);for(let O=0;O<2*g;O+=2)p.emplaceBack(P+O,P+O+1,P+O+3),p.emplaceBack(P+O,P+O+3,P+O+2),p.emplaceBack(k+O,k+O+3,k+O+1),p.emplaceBack(k+O,k+O+2,k+O+3);return this._mesh={indexBuffer:o.createIndexBuffer(p),vertexBuffer:o.createVertexBuffer(u,Mh.members),segments:y.S.simpleSegment(0,0,u.length,p.length)},this._mesh}getMeshFrameDelta(o){return 2*Math.PI*y.be/Math.pow(2,o)/5}getMinTileElevationForLngLatZoom(o,u){var p;const{tileID:g}=this._getOverscaledTileIDFromLngLatZoom(o,u);return null!==(p=this.getMinMaxElevation(g).minElevation)&&void 0!==p?p:0}getMinMaxElevation(o){const u=this.getTerrainData(o).tile,p={minElevation:null,maxElevation:null};return u&&u.dem&&(p.minElevation=u.dem.min*this.exaggeration,p.maxElevation=u.dem.max*this.exaggeration),p}_getOverscaledTileIDFromLngLatZoom(o,u){const p=y.U.fromLngLat(o.wrap()),g=(1<<u)*y.N,x=p.x*g,S=p.y*g,T=Math.floor(x/y.N),I=Math.floor(S/y.N);return{tileID:new y.O(u,0,u,T,I),mercatorX:x,mercatorY:S}}}class Ic{constructor(o,u,p){this._context=o,this._size=u,this._tileSize=p,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const o of this._objects)o.texture.destroy(),o.fbo.destroy()}_createObject(o){const u=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),p=new ot(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return p.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),u.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),u.colorAttachment.set(p.texture),{id:o,fbo:u,texture:p,stamp:-1,inUse:!1}}getObjectForId(o){return this._objects[o]}useObject(o){o.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(u=>o.id!==u),this._recentlyUsed.push(o.id)}stampObject(o){o.stamp=++this._stamp}getOrCreateFreeObject(){for(const u of this._recentlyUsed)if(!this._objects[u].inUse)return this._objects[u];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const o=this._createObject(this._objects.length);return this._objects.push(o),o}freeObject(o){o.inUse=!1}freeAllObjects(){for(const o of this._objects)this.freeObject(o)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some(o=>!o.inUse)}}const Fi={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class ps{constructor(o,u){this.painter=o,this.terrain=u,this.pool=new Ic(o.context,30,u.sourceCache.tileSize*u.qualityFactor)}destruct(){this.pool.destruct()}getTexture(o){return this.pool.getObjectForId(o.rtt[this._stacks.length-1].id).texture}prepareForRender(o,u){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=o._order.filter(p=>!o._layers[p].isHidden(u)),this._coordsDescendingInv={};for(const p in o.sourceCaches){this._coordsDescendingInv[p]={};const g=o.sourceCaches[p].getVisibleCoordinates();for(const x of g){const S=this.terrain.sourceCache.getTerrainCoords(x);for(const T in S)this._coordsDescendingInv[p][T]||(this._coordsDescendingInv[p][T]=[]),this._coordsDescendingInv[p][T].push(S[T])}}this._coordsDescendingInvStr={};for(const p of o._order){const g=o._layers[p],x=g.source;if(Fi[g.type]&&!this._coordsDescendingInvStr[x]){this._coordsDescendingInvStr[x]={};for(const S in this._coordsDescendingInv[x])this._coordsDescendingInvStr[x][S]=this._coordsDescendingInv[x][S].map(T=>T.key).sort().join()}}for(const p of this._renderableTiles)for(const g in this._coordsDescendingInvStr){const x=this._coordsDescendingInvStr[g][p.tileID.key];x&&x!==p.rttCoords[g]&&(p.rtt=[])}}renderLayer(o){if(o.isHidden(this.painter.transform.zoom))return!1;const u=o.type,p=this.painter,g=this._renderableLayerIds[this._renderableLayerIds.length-1]===o.id;if(Fi[u]&&(this._prevType&&Fi[this._prevType]||this._stacks.push([]),this._prevType=u,this._stacks[this._stacks.length-1].push(o.id),!g))return!0;if(Fi[this._prevType]||Fi[u]&&g){this._prevType=u;const x=this._stacks.length-1,S=this._stacks[x]||[];for(const T of this._renderableTiles){if(this.pool.isFull()&&(Cn(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(T),T.rtt[x]){const P=this.pool.getObjectForId(T.rtt[x].id);if(P.stamp===T.rtt[x].stamp){this.pool.useObject(P);continue}}const I=this.pool.getOrCreateFreeObject();this.pool.useObject(I),this.pool.stampObject(I),T.rtt[x]={id:I.id,stamp:I.stamp},p.context.bindFramebuffer.set(I.fbo.framebuffer),p.context.clear({color:y.aT.transparent,stencil:0}),p.currentStencilSource=void 0;for(let P=0;P<S.length;P++){const k=p.style._layers[S[P]],O=k.source?this._coordsDescendingInv[k.source][T.tileID.key]:[T.tileID];p.context.viewport.set([0,0,I.fbo.width,I.fbo.height]),p._renderTileClippingMasks(k,O),p.renderLayer(p,p.style.sourceCaches[k.source],k,O),k.source&&(T.rttCoords[k.source]=this._coordsDescendingInvStr[k.source][T.tileID.key])}}return Cn(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Fi[u]}return!1}}const _t={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:y.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},Rs=v=>{v.touchstart=v.dragStart,v.touchmoveWindow=v.dragMove,v.touchend=v.dragEnd},Zs={showCompass:!0,showZoom:!0,visualizePitch:!1};class Ja{constructor(o,u,p=!1){this.mousedown=S=>{this.startMouse(y.e({},S,{ctrlKey:!0,preventDefault:()=>S.preventDefault()}),xe.mousePos(this.element,S)),xe.addEventListener(window,"mousemove",this.mousemove),xe.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=S=>{this.moveMouse(S,xe.mousePos(this.element,S))},this.mouseup=S=>{this.mouseRotate.dragEnd(S),this.mousePitch&&this.mousePitch.dragEnd(S),this.offTemp()},this.touchstart=S=>{1!==S.targetTouches.length?this.reset():(this._startPos=this._lastPos=xe.touchPos(this.element,S.targetTouches)[0],this.startTouch(S,this._startPos),xe.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),xe.addEventListener(window,"touchend",this.touchend))},this.touchmove=S=>{1!==S.targetTouches.length?this.reset():(this._lastPos=xe.touchPos(this.element,S.targetTouches)[0],this.moveTouch(S,this._lastPos))},this.touchend=S=>{0===S.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const g=o.dragRotate._mouseRotate.getClickTolerance(),x=o.dragRotate._mousePitch.getClickTolerance();this.element=u,this.mouseRotate=Fl({clickTolerance:g,enable:!0}),this.touchRotate=(({enable:S,clickTolerance:T,bearingDegreesPerPixelMoved:I=.8})=>{const P=new Xd;return new lo({clickTolerance:T,move:(k,O)=>({bearingDelta:(O.x-k.x)*I}),moveStateManager:P,enable:S,assignEvents:Rs})})({clickTolerance:g,enable:!0}),this.map=o,p&&(this.mousePitch=ko({clickTolerance:x,enable:!0}),this.touchPitch=(({enable:S,clickTolerance:T,pitchDegreesPerPixelMoved:I=-.5})=>{const P=new Xd;return new lo({clickTolerance:T,move:(k,O)=>({pitchDelta:(O.y-k.y)*I}),moveStateManager:P,enable:S,assignEvents:Rs})})({clickTolerance:x,enable:!0})),xe.addEventListener(u,"mousedown",this.mousedown),xe.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),xe.addEventListener(u,"touchcancel",this.reset)}startMouse(o,u){this.mouseRotate.dragStart(o,u),this.mousePitch&&this.mousePitch.dragStart(o,u),xe.disableDrag()}startTouch(o,u){this.touchRotate.dragStart(o,u),this.touchPitch&&this.touchPitch.dragStart(o,u),xe.disableDrag()}moveMouse(o,u){const p=this.map,{bearingDelta:g}=this.mouseRotate.dragMove(o,u)||{};if(g&&p.setBearing(p.getBearing()+g),this.mousePitch){const{pitchDelta:x}=this.mousePitch.dragMove(o,u)||{};x&&p.setPitch(p.getPitch()+x)}}moveTouch(o,u){const p=this.map,{bearingDelta:g}=this.touchRotate.dragMove(o,u)||{};if(g&&p.setBearing(p.getBearing()+g),this.touchPitch){const{pitchDelta:x}=this.touchPitch.dragMove(o,u)||{};x&&p.setPitch(p.getPitch()+x)}}off(){const o=this.element;xe.removeEventListener(o,"mousedown",this.mousedown),xe.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),xe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),xe.removeEventListener(window,"touchend",this.touchend),xe.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){xe.enableDrag(),xe.removeEventListener(window,"mousemove",this.mousemove),xe.removeEventListener(window,"mouseup",this.mouseup),xe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),xe.removeEventListener(window,"touchend",this.touchend)}}let ni;function tn(v,o,u){if(v=new y.L(v.lng,v.lat),o){const p=new y.L(v.lng-360,v.lat),g=new y.L(v.lng+360,v.lat),x=u.locationPoint(v).distSqr(o);u.locationPoint(p).distSqr(o)<x?v=p:u.locationPoint(g).distSqr(o)<x&&(v=g)}for(;Math.abs(v.lng-u.center.lng)>180;){const p=u.locationPoint(v);if(p.x>=0&&p.y>=0&&p.x<=u.width&&p.y<=u.height)break;v.lng>u.center.lng?v.lng-=360:v.lng+=360}return v}const Ks={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Mu(v,o,u){const p=v.classList;for(const g in Ks)p.remove(`maplibregl-${u}-anchor-${g}`);p.add(`maplibregl-${u}-anchor-${o}`)}class da extends y.E{constructor(o){if(super(),this._onKeyPress=u=>{const p=u.code,g=u.charCode||u.keyCode;"Space"!==p&&"Enter"!==p&&32!==g&&13!==g||this.togglePopup()},this._onMapClick=u=>{const p=u.originalEvent.target,g=this._element;this._popup&&(p===g||g.contains(p))&&this.togglePopup()},this._update=u=>{if(!this._map)return;const p=this._map.loaded()&&!this._map.isMoving();("terrain"===u?.type||"render"===u?.type&&!p)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=tn(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let g="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?g=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(g=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let x="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?x="rotateX(0deg)":"map"===this._pitchAlignment&&(x=`rotateX(${this._map.getPitch()}deg)`),u&&"moveend"!==u.type||(this._pos=this._pos.round()),xe.setTransform(this._element,`${Ks[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${x} ${g}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const S=this._map.unproject(this._pos),T=40075016.686*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=S.distanceTo(this._lngLat)>20*T?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=u=>{if(!this._isDragging){const p=this._clickTolerance||this._map._clickTolerance;this._isDragging=u.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=u.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new y.k("dragstart"))),this.fire(new y.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new y.k("dragend")),this._state="inactive"},this._addDragHandler=u=>{this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(this._pos).add(this._offset),this._pointerdownPos=u.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&"auto"!==o.pitchAlignment?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=y.P.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=xe.create("div"),this._element.setAttribute("aria-label","Map marker");const u=xe.createNS("http://www.w3.org/2000/svg","svg"),p=41,g=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${p}px`),u.setAttributeNS(null,"width",`${g}px`),u.setAttributeNS(null,"viewBox",`0 0 ${g} ${p}`);const x=xe.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");const S=xe.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");const T=xe.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(3.0, 29.0)"),T.setAttributeNS(null,"fill","#000000");const I=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const le of I){const ge=xe.createNS("http://www.w3.org/2000/svg","ellipse");ge.setAttributeNS(null,"opacity","0.04"),ge.setAttributeNS(null,"cx","10.5"),ge.setAttributeNS(null,"cy","5.80029008"),ge.setAttributeNS(null,"rx",le.rx),ge.setAttributeNS(null,"ry",le.ry),T.appendChild(ge)}const P=xe.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"fill",this._color);const k=xe.createNS("http://www.w3.org/2000/svg","path");k.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),P.appendChild(k);const O=xe.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"opacity","0.25"),O.setAttributeNS(null,"fill","#000000");const V=xe.createNS("http://www.w3.org/2000/svg","path");V.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),O.appendChild(V);const K=xe.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"transform","translate(6.0, 7.0)"),K.setAttributeNS(null,"fill","#FFFFFF");const Z=xe.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Y=xe.createNS("http://www.w3.org/2000/svg","circle");Y.setAttributeNS(null,"fill","#000000"),Y.setAttributeNS(null,"opacity","0.25"),Y.setAttributeNS(null,"cx","5.5"),Y.setAttributeNS(null,"cy","5.5"),Y.setAttributeNS(null,"r","5.4999962");const G=xe.createNS("http://www.w3.org/2000/svg","circle");G.setAttributeNS(null,"fill","#FFFFFF"),G.setAttributeNS(null,"cx","5.5"),G.setAttributeNS(null,"cy","5.5"),G.setAttributeNS(null,"r","5.4999962"),Z.appendChild(Y),Z.appendChild(G),S.appendChild(T),S.appendChild(P),S.appendChild(O),S.appendChild(K),S.appendChild(Z),u.appendChild(S),u.setAttributeNS(null,"height",p*this._scale+"px"),u.setAttributeNS(null,"width",g*this._scale+"px"),this._element.appendChild(u),this._offset=y.P.convert(o&&o.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",u=>{u.preventDefault()}),this._element.addEventListener("mousedown",u=>{u.preventDefault()}),Mu(this._element,this._anchor,"marker"),o&&o.className)for(const u of o.className.split(" "))this._element.classList.add(u);this._popup=null}addTo(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),o.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),xe.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=y.L.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const g=Math.abs(13.5)/Math.SQRT2;o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,-1*(24.6+g)],"bottom-right":[-g,-1*(24.6+g)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(o){return this._offset=y.P.convert(o),this._update(),this}addClassName(o){this._element.classList.add(o)}removeClassName(o){this._element.classList.remove(o)}toggleClassName(o){return this._element.classList.toggle(o)}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&"auto"!==o?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const En={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let jn=0,Xs=!1;const Oo={maxWidth:100,unit:"metric"};function Ii(v,o,u){const p=u&&u.maxWidth||100,g=v._container.clientHeight/2,x=v.unproject([0,g]),S=v.unproject([p,g]),T=x.distanceTo(S);if(u&&"imperial"===u.unit){const I=3.2808*T;I>5280?zl(o,p,I/5280,v._getUIString("ScaleControl.Miles")):zl(o,p,I,v._getUIString("ScaleControl.Feet"))}else u&&"nautical"===u.unit?zl(o,p,T/1852,v._getUIString("ScaleControl.NauticalMiles")):T>=1e3?zl(o,p,T/1e3,v._getUIString("ScaleControl.Kilometers")):zl(o,p,T,v._getUIString("ScaleControl.Meters"))}function zl(v,o,u,p){const g=function(x){const S=Math.pow(10,`${Math.floor(x)}`.length-1);let T=x/S;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:function(I){const P=Math.pow(10,Math.ceil(-Math.log(I)/Math.LN10));return Math.round(I*P)/P}(T),S*T}(u);v.style.width=o*(g/u)+"px",v.innerHTML=`${g}&nbsp;${p}`}const Sr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},fr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function fa(v){if(v){if("number"==typeof v){const o=Math.round(Math.abs(v)/Math.SQRT2);return{center:new y.P(0,0),top:new y.P(0,v),"top-left":new y.P(o,o),"top-right":new y.P(-o,o),bottom:new y.P(0,-v),"bottom-left":new y.P(o,-o),"bottom-right":new y.P(-o,-o),left:new y.P(v,0),right:new y.P(-v,0)}}if(v instanceof y.P||Array.isArray(v)){const o=y.P.convert(v);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:y.P.convert(v.center||[0,0]),top:y.P.convert(v.top||[0,0]),"top-left":y.P.convert(v["top-left"]||[0,0]),"top-right":y.P.convert(v["top-right"]||[0,0]),bottom:y.P.convert(v.bottom||[0,0]),"bottom-left":y.P.convert(v["bottom-left"]||[0,0]),"bottom-right":y.P.convert(v["bottom-right"]||[0,0]),left:y.P.convert(v.left||[0,0]),right:y.P.convert(v.right||[0,0])}}return fa(new y.P(0,0))}const No={extend:(v,...o)=>y.e(v,...o),run(v){v()},logToElement(v,o=!1,u="log"){const p=window.document.getElementById(u);p&&(o&&(p.innerHTML=""),p.innerHTML+=`<br>${v}`)}};class Vt{static get version(){return"3.5.2"}static get workerCount(){return Ss.workerCount}static set workerCount(o){Ss.workerCount=o}static get maxParallelImageRequests(){return y.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(o){y.c.MAX_PARALLEL_IMAGE_REQUESTS=o}static get workerUrl(){return y.c.WORKER_URL}static set workerUrl(o){y.c.WORKER_URL=o}static addProtocol(o,u){y.c.REGISTERED_PROTOCOLS[o]=u}static removeProtocol(o){delete y.c.REGISTERED_PROTOCOLS[o]}}return Vt.Map=class extends xi{constructor(v){if(y.bf.mark(y.bg.create),null!=(v=y.e({},_t,v)).minZoom&&null!=v.maxZoom&&v.minZoom>v.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=v.minPitch&&null!=v.maxPitch&&v.minPitch>v.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=v.minPitch&&v.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=v.maxPitch&&v.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Dc(v.minZoom,v.maxZoom,v.minPitch,v.maxPitch,v.renderWorldCopies),{bearingSnap:v.bearingSnap}),this._cooperativeGesturesOnWheel=o=>{this._onCooperativeGesture(o,o[this._metaKey],1)},this._contextLost=o=>{o.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new y.k("webglcontextlost",{originalEvent:o}))},this._contextRestored=o=>{this._setupPainter(),this.resize(),this._update(),this.fire(new y.k("webglcontextrestored",{originalEvent:o}))},this._onMapScroll=o=>{if(o.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=v.interactive,this._cooperativeGestures=v.cooperativeGestures,this._metaKey=0===navigator.platform.indexOf("Mac")?"metaKey":"ctrlKey",this._maxTileCacheSize=v.maxTileCacheSize,this._maxTileCacheZoomLevels=v.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=v.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=v.preserveDrawingBuffer,this._antialias=v.antialias,this._trackResize=v.trackResize,this._bearingSnap=v.bearingSnap,this._refreshExpiredTiles=v.refreshExpiredTiles,this._fadeDuration=v.fadeDuration,this._crossSourceCollisions=v.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=v.collectResourceTiming,this._renderTaskQueue=new kt,this._controls=[],this._mapId=y.a2(),this._locale=y.e({},Ya,v.locale),this._clickTolerance=v.clickTolerance,this._overridePixelRatio=v.pixelRatio,this._maxCanvasSize=v.maxCanvasSize,this.transformCameraUpdate=v.transformCameraUpdate,this._imageQueueHandle=Ji.addThrottleControl(()=>this.isMoving()),this._requestManager=new bl(v.transformRequest),"string"==typeof v.container){if(this._container=document.getElementById(v.container),!this._container)throw new Error(`Container '${v.container}' not found.`)}else{if(!(v.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=v.container}if(v.maxBounds&&this.setMaxBounds(v.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let o=!1;const u=Fr(p=>{this._trackResize&&!this._removed&&this.resize(p)._update()},50);this._resizeObserver=new ResizeObserver(p=>{o?u(p):o=!0}),this._resizeObserver.observe(this._container)}this.handlers=new ha(this,v),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=v.hash&&new Mo("string"==typeof v.hash&&v.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch}),v.bounds&&(this.resize(),this.fitBounds(v.bounds,y.e({},v.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=v.localIdeographFontFamily,this._validateStyle=v.validateStyle,v.style&&this.setStyle(v.style,{localIdeographFontFamily:v.localIdeographFontFamily}),v.attributionControl&&this.addControl(new Ni({customAttribution:v.customAttribution})),v.maplibreLogo&&this.addControl(new In,v.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",o=>{this._update("style"===o.dataType),this.fire(new y.k(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new y.k(`${o.dataType}dataloading`,o))}),this.on("dataabort",o=>{this.fire(new y.k("sourcedataabort",o))})}_getMapId(){return this._mapId}addControl(v,o){if(void 0===o&&(o=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new y.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=v.onAdd(this);this._controls.push(v);const p=this._controlPositions[o];return-1!==o.indexOf("bottom")?p.insertBefore(u,p.firstChild):p.appendChild(u),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new y.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(v);return o>-1&&this._controls.splice(o,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}calculateCameraOptionsFromTo(v,o,u,p){return null==p&&this.terrain&&(p=this.terrain.getElevationForLngLatZoom(u,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(v,o,u,p)}resize(v){var o;const u=this._containerDimensions(),p=u[0],g=u[1],x=this._getClampedPixelRatio(p,g);if(this._resizeCanvas(p,g,x),this.painter.resize(p,g,x),this.painter.overLimit()){const T=this.painter.context.gl;this._maxCanvasSize=[T.drawingBufferWidth,T.drawingBufferHeight];const I=this._getClampedPixelRatio(p,g);this._resizeCanvas(p,g,I),this.painter.resize(p,g,I)}this.transform.resize(p,g),null===(o=this._requestedCameraState)||void 0===o||o.resize(p,g);const S=!this._moving;return S&&(this.stop(),this.fire(new y.k("movestart",v)).fire(new y.k("move",v))),this.fire(new y.k("resize",v)),S&&this.fire(new y.k("moveend",v)),this}_getClampedPixelRatio(v,o){const{0:u,1:p}=this._maxCanvasSize,g=this.getPixelRatio(),x=v*g,S=o*g;return Math.min(x>u?u/x:1,S>p?p/S:1)*g}getPixelRatio(){var v;return null!==(v=this._overridePixelRatio)&&void 0!==v?v:devicePixelRatio}setPixelRatio(v){this._overridePixelRatio=v,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(v){return this.transform.setMaxBounds(Gn.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this._update(),this.getZoom()<v&&this.setZoom(v),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.maxZoom=v,this._update(),this.getZoom()>v&&this.setZoom(v),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this._update(),this.getPitch()<v&&this.setPitch(v),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this._update(),this.getPitch()>v&&this.setPitch(v),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.renderWorldCopies=v,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(v){return this._cooperativeGestures=v,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(v){return this.transform.locationPoint(y.L.convert(v),this.style&&this.terrain)}unproject(v){return this.transform.pointLocation(y.P.convert(v),this.terrain)}isMoving(){var v;return this._moving||(null===(v=this.handlers)||void 0===v?void 0:v.isMoving())}isZooming(){var v;return this._zooming||(null===(v=this.handlers)||void 0===v?void 0:v.isZooming())}isRotating(){var v;return this._rotating||(null===(v=this.handlers)||void 0===v?void 0:v.isRotating())}_createDelegatedListener(v,o,u){if("mouseenter"===v||"mouseover"===v){let p=!1;return{layer:o,listener:u,delegates:{mousemove:x=>{const S=this.getLayer(o)?this.queryRenderedFeatures(x.point,{layers:[o]}):[];S.length?p||(p=!0,u.call(this,new fs(v,this,x.originalEvent,{features:S}))):p=!1},mouseout:()=>{p=!1}}}}if("mouseleave"===v||"mouseout"===v){let p=!1;return{layer:o,listener:u,delegates:{mousemove:S=>{(this.getLayer(o)?this.queryRenderedFeatures(S.point,{layers:[o]}):[]).length?p=!0:p&&(p=!1,u.call(this,new fs(v,this,S.originalEvent)))},mouseout:S=>{p&&(p=!1,u.call(this,new fs(v,this,S.originalEvent)))}}}}{const p=g=>{const x=this.getLayer(o)?this.queryRenderedFeatures(g.point,{layers:[o]}):[];x.length&&(g.features=x,u.call(this,g),delete g.features)};return{layer:o,listener:u,delegates:{[v]:p}}}}on(v,o,u){if(void 0===u)return super.on(v,o);const p=this._createDelegatedListener(v,o,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(p);for(const g in p.delegates)this.on(g,p.delegates[g]);return this}once(v,o,u){if(void 0===u)return super.once(v,o);const p=this._createDelegatedListener(v,o,u);for(const g in p.delegates)this.once(g,p.delegates[g]);return this}off(v,o,u){return void 0===u?super.off(v,o):(this._delegatedListeners&&this._delegatedListeners[v]&&(p=>{const g=this._delegatedListeners[v];for(let x=0;x<g.length;x++){const S=g[x];if(S.layer===o&&S.listener===u){for(const T in S.delegates)this.off(T,S.delegates[T]);return g.splice(x,1),this}}})(),this)}queryRenderedFeatures(v,o){if(!this.style)return[];let u;const p=v instanceof y.P||Array.isArray(v),g=p?v:[[0,0],[this.transform.width,this.transform.height]];if(o=o||(p?{}:v)||{},g instanceof y.P||"number"==typeof g[0])u=[y.P.convert(g)];else{const x=y.P.convert(g[0]),S=y.P.convert(g[1]);u=[x,new y.P(S.x,x.y),S,new y.P(x.x,S.y),x]}return this.style.queryRenderedFeatures(u,o,this.transform)}querySourceFeatures(v,o){return this.style.querySourceFeatures(v,o)}setStyle(v,o){return!1!==(o=y.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},o)).diff&&o.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&v?(this._diffStyle(v,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._updateStyle(v,o))}setTransformRequest(v){return this._requestManager.setTransformRequest(v),this}_getUIString(v){const o=this._locale[v];if(null==o)throw new Error(`Missing UI string '${v}'`);return o}_updateStyle(v,o){if(o.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(v,o));const u=this.style&&o.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!v)),v?(this.style=new hr(this,o||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof v?this.style.loadURL(v,o,u):this.style.loadJSON(v,o,u),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new hr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,o){if("string"==typeof v){const u=this._requestManager.transformRequest(v,bi.Style);y.f(u,(p,g)=>{p?this.fire(new y.j(p)):g&&this._updateDiff(g,o)})}else"object"==typeof v&&this._updateDiff(v,o)}_updateDiff(v,o){try{this.style.setState(v,o)&&this._update(!0)}catch(u){y.w(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(v,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():y.w("There is no style added to the map.")}addSource(v,o){return this._lazyInitEmptyStyle(),this.style.addSource(v,o),this._update(!0)}isSourceLoaded(v){const o=this.style&&this.style.sourceCaches[v];if(void 0!==o)return o.loaded();this.fire(new y.j(new Error(`There is no source with ID '${v}'`)))}setTerrain(v){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),v){const o=this.style.sourceCaches[v.source];if(!o)throw new Error(`cannot load terrain, because there exists no source with ID: ${v.source}`);for(const u in this.style._layers){const p=this.style._layers[u];"hillshade"===p.type&&p.source===v.source&&y.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new wi(this.painter,o,v),this.painter.renderToTexture=new ps(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=u=>{"style"===u.dataType?this.terrain.sourceCache.freeRtt():"source"===u.dataType&&u.tile&&(u.sourceId!==v.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(u.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new y.k("terrain",{terrain:v})),this}getTerrain(){var v,o;return null!==(o=null===(v=this.terrain)||void 0===v?void 0:v.options)&&void 0!==o?o:null}areTilesLoaded(){const v=this.style&&this.style.sourceCaches;for(const o in v){const u=v[o]._tiles;for(const p in u){const g=u[p];if("loaded"!==g.state&&"errored"!==g.state)return!1}}return!0}addSourceType(v,o,u){return this._lazyInitEmptyStyle(),this.style.addSourceType(v,o,u)}removeSource(v){return this.style.removeSource(v),this._update(!0)}getSource(v){return this.style.getSource(v)}addImage(v,o,u={}){const{pixelRatio:p=1,sdf:g=!1,stretchX:x,stretchY:S,content:T}=u;if(this._lazyInitEmptyStyle(),!(o instanceof HTMLImageElement||y.a(o))){if(void 0===o.width||void 0===o.height)return this.fire(new y.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:I,height:P,data:k}=o,O=o;return this.style.addImage(v,{data:new y.R({width:I,height:P},new Uint8Array(k)),pixelRatio:p,stretchX:x,stretchY:S,content:T,sdf:g,version:0,userImage:O}),O.onAdd&&O.onAdd(this,v),this}}{const{width:I,height:P,data:k}=y.h.getImageData(o);this.style.addImage(v,{data:new y.R({width:I,height:P},k),pixelRatio:p,stretchX:x,stretchY:S,content:T,sdf:g,version:0})}}updateImage(v,o){const u=this.style.getImage(v);if(!u)return this.fire(new y.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=o instanceof HTMLImageElement||y.a(o)?y.h.getImageData(o):o,{width:g,height:x,data:S}=p;if(void 0===g||void 0===x)return this.fire(new y.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(g!==u.data.width||x!==u.data.height)return this.fire(new y.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const T=!(o instanceof HTMLImageElement||y.a(o));return u.data.replace(S,T),this.style.updateImage(v,u),this}getImage(v){return this.style.getImage(v)}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new y.j(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v,o){Ji.getImage(this._requestManager.transformRequest(v,bi.Image),o)}listImages(){return this.style.listImages()}addLayer(v,o){return this._lazyInitEmptyStyle(),this.style.addLayer(v,o),this._update(!0)}moveLayer(v,o){return this.style.moveLayer(v,o),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}setLayerZoomRange(v,o,u){return this.style.setLayerZoomRange(v,o,u),this._update(!0)}setFilter(v,o,u={}){return this.style.setFilter(v,o,u),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,o,u,p={}){return this.style.setPaintProperty(v,o,u,p),this._update(!0)}getPaintProperty(v,o){return this.style.getPaintProperty(v,o)}setLayoutProperty(v,o,u,p={}){return this.style.setLayoutProperty(v,o,u,p),this._update(!0)}getLayoutProperty(v,o){return this.style.getLayoutProperty(v,o)}setGlyphs(v,o={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(v,o),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(v,o,u={}){return this._lazyInitEmptyStyle(),this.style.addSprite(v,o,u,p=>{p||this._update(!0)}),this}removeSprite(v){return this._lazyInitEmptyStyle(),this.style.removeSprite(v),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(v,o={}){return this._lazyInitEmptyStyle(),this.style.setSprite(v,o,u=>{u||this._update(!0)}),this}setLight(v,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,o),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(v,o){return this.style.setFeatureState(v,o),this._update()}removeFeatureState(v,o){return this.style.removeFeatureState(v,o),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let v=0,o=0;return this._container&&(v=this._container.clientWidth||400,o=this._container.clientHeight||300),[v,o]}_setupContainer(){const v=this._container;v.classList.add("maplibregl-map");const o=this._canvasContainer=xe.create("div","maplibregl-canvas-container",v);this._interactive&&o.classList.add("maplibregl-interactive"),this._canvas=xe.create("canvas","maplibregl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const u=this._containerDimensions(),p=this._getClampedPixelRatio(u[0],u[1]);this._resizeCanvas(u[0],u[1],p);const g=this._controlContainer=xe.create("div","maplibregl-control-container",v),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{x[S]=xe.create("div",`maplibregl-ctrl-${S} `,g)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=xe.create("div","maplibregl-cooperative-gesture-screen",this._container);let v="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";0===navigator.platform.indexOf("Mac")&&(v="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use \u2318 + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`\n            <div class="maplibregl-desktop-message">${v}</div>\n            <div class="maplibregl-mobile-message">${"boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>\n        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){xe.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(v,o,u){this._canvas.width=Math.floor(u*v),this._canvas.height=Math.floor(u*o),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${o}px`}_setupPainter(){const v={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let o=null;this._canvas.addEventListener("webglcontextcreationerror",p=>{o={requestedAttributes:v},p&&(o.statusMessage=p.statusMessage,o.type=p.type)},{once:!0});const u=this._canvas.getContext("webgl2",v)||this._canvas.getContext("webgl",v);if(!u){const p="Failed to initialize WebGL";throw o?(o.message=p,new Error(JSON.stringify(o))):new Error(p)}this.painter=new nn(u,this.transform),Xr.testSupport(u)}_onCooperativeGesture(v,o,u){return!o&&u<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_render(v){const o=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(v),this._removed)return;let u=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const g=this.transform.zoom,x=y.h.now();this.style.zoomHistory.update(g,x);const S=new y.a8(g,{now:x,fadeDuration:o,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),T=S.crossFadingFactor();1===T&&T===this._crossFadingFactor||(u=!0,this._crossFadingFactor=T),this.style.update(S)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,o,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:o,showPadding:this.showPadding}),this.fire(new y.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,y.bf.mark(y.bg.load),this.fire(new y.k("load"))),this.style&&(this.style.hasTransitions()||u)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const p=this._sourcesDirty||this._styleDirty||this._placementDirty;return p||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new y.k("idle")),!this._loaded||this._fullyLoaded||p||(this._fullyLoaded=!0,y.bf.mark(y.bg.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var v;this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Ji.removeThrottleControl(this._imageQueueHandle),null===(v=this._resizeObserver)||void 0===v||v.disconnect();const o=this.painter.context.gl.getExtension("WEBGL_lose_context");o&&o.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),xe.remove(this._canvasContainer),xe.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),y.bf.clearMetrics(),this._removed=!0,this.fire(new y.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=y.h.frame(v=>{y.bf.frame(v),this._frame=null,this._render(v)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get version(){return"3.5.2"}getCameraTargetElevation(){return this.transform.elevation}},Vt.NavigationControl=class{constructor(v){this._updateZoomButtons=()=>{const o=this._map.getZoom(),u=o===this._map.getMaxZoom(),p=o===this._map.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},this._rotateCompassArrow=()=>{const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=o},this._setButtonTitle=(o,u)=>{const p=this._map._getUIString(`NavigationControl.${u}`);o.title=p,o.setAttribute("aria-label",p)},this.options=y.e({},Zs,v),this._container=xe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),xe.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),xe.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=xe.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ja(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){xe.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(v,o){const u=xe.create("button",v,this._container);return u.type="button",u.addEventListener("click",o),u}},Vt.GeolocateControl=class extends y.E{constructor(v){super(),this._onSuccess=o=>{if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new y.k("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(o),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new y.k("geolocate",o)),this._finish()}},this._updateCamera=o=>{const u=new y.L(o.coords.longitude,o.coords.latitude),p=o.coords.accuracy,g=this._map.getBearing(),x=y.e({bearing:g},this.options.fitBoundsOptions),S=Gn.fromLngLat(u,p);this._map.fitBounds(S,x,{geolocateSource:!0})},this._updateMarker=o=>{if(o){const u=new y.L(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=o=>{if(this._map){if(this.options.trackUserLocation)if(1===o.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===o.code&&Xs)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new y.k("error",o)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=o=>{if(this._map){if(this._container.addEventListener("contextmenu",u=>u.preventDefault()),this._geolocateButton=xe.create("button","maplibregl-ctrl-geolocate",this._container),xe.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===o){y.w("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=xe.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new da({element:this._dotElement}),this._circleElement=xe.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new da({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{u.geolocateSource||"ACTIVE_LOCK"!==this._watchState||u.originalEvent&&"resize"===u.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new y.k("trackuserlocationend")))})}},this.options=y.e({},En,v)}onAdd(v){return this._map=v,this._container=xe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(o,u=!1){void 0===ni||u?void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then(p=>{ni="denied"!==p.state,o(ni)}).catch(()=>{ni=!!window.navigator.geolocation,o(ni)}):(ni=!!window.navigator.geolocation,o(ni)):o(ni)}(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),xe.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,jn=0,Xs=!1}_isOutOfMapMaxBounds(v){const o=this._map.getMaxBounds(),u=v.coords;return o&&(u.longitude<o.getWest()||u.longitude>o.getEast()||u.latitude<o.getSouth()||u.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const v=this._map.getBounds(),o=v.getSouthEast(),u=v.getNorthEast(),p=o.distanceTo(u),g=Math.ceil(this._accuracy/(p/this._map._container.clientHeight)*2);this._circleElement.style.width=`${g}px`,this._circleElement.style.height=`${g}px`}trigger(){if(!this._setup)return y.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new y.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":jn--,Xs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new y.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new y.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let v;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),jn++,jn>1?(v={maximumAge:6e5,timeout:0},Xs=!0):(v=this.options.positionOptions,Xs=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,v)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},Vt.AttributionControl=Ni,Vt.LogoControl=In,Vt.ScaleControl=class{constructor(v){this._onMove=()=>{Ii(this._map,this._container,this.options)},this.setUnit=o=>{this.options.unit=o,Ii(this._map,this._container,this.options)},this.options=y.e({},Oo,v)}getDefaultPosition(){return"bottom-left"}onAdd(v){return this._map=v,this._container=xe.create("div","maplibregl-ctrl maplibregl-ctrl-scale",v.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){xe.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},Vt.FullscreenControl=class extends y.E{constructor(v={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,v&&v.container&&(v.container instanceof HTMLElement?this._container=v.container:y.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=xe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){xe.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const v=this._fullscreenButton=xe.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);xe.create("span","maplibregl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.title=v}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new y.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new y.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},Vt.TerrainControl=class{constructor(v){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=v}onAdd(v){return this._map=v,this._container=xe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=xe.create("button","maplibregl-ctrl-terrain",this._container),xe.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){xe.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},Vt.Popup=class extends y.E{constructor(v){super(),this.remove=()=>(this._content&&xe.remove(this._content),this._container&&(xe.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new y.k("close")),this),this._onMouseUp=o=>{this._update(o.point)},this._onMouseMove=o=>{this._update(o.point)},this._onDrag=o=>{this._update(o.point)},this._update=o=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=xe.create("div","maplibregl-popup",this._map.getContainer()),this._tip=xe.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const S of this.options.className.split(" "))this._container.classList.add(S);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=tn(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!o)return;const u=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat);let p=this.options.anchor;const g=fa(this.options.offset);if(!p){const S=this._container.offsetWidth,T=this._container.offsetHeight;let I;I=u.y+g.bottom.y<T?["top"]:u.y>this._map.transform.height-T?["bottom"]:[],u.x<S/2?I.push("left"):u.x>this._map.transform.width-S/2&&I.push("right"),p=0===I.length?"bottom":I.join("-")}const x=u.add(g[p]).round();xe.setTransform(this._container,`${Ks[p]} translate(${x.x}px,${x.y}px)`),Mu(this._container,p,"popup")},this._onClose=()=>{this.remove()},this.options=y.e(Object.create(Sr),v)}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new y.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(v){return this._lngLat=y.L.convert(v),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(document.createTextNode(v))}setHTML(v){const o=document.createDocumentFragment(),u=document.createElement("body");let p;for(u.innerHTML=v;p=u.firstChild,p;)o.appendChild(p);return this.setDOMContent(o)}getMaxWidth(){var v;return null===(v=this._container)||void 0===v?void 0:v.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=xe.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(v),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(v){this._container&&this._container.classList.add(v)}removeClassName(v){this._container&&this._container.classList.remove(v)}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){if(this._container)return this._container.classList.toggle(v)}_createCloseButton(){this.options.closeButton&&(this._closeButton=xe.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector(fr);v&&v.focus()}},Vt.Marker=da,Vt.Style=hr,Vt.LngLat=y.L,Vt.LngLatBounds=Gn,Vt.Point=y.P,Vt.MercatorCoordinate=y.U,Vt.Evented=y.E,Vt.AJAXError=y.bh,Vt.config=y.c,Vt.CanvasSource=so,Vt.GeoJSONSource=Wn,Vt.ImageSource=Cs,Vt.RasterDEMTileSource=Na,Vt.RasterTileSource=Oa,Vt.VectorTileSource=er,Vt.VideoSource=pn,Vt.setRTLTextPlugin=y.bi,Vt.getRTLTextPluginStatus=y.bj,Vt.prewarm=function(){uc().acquire(mn)},Vt.clearPrewarmedResources=function(){const v=js;v&&(v.isPreloaded()&&1===v.numActive()?(v.release(mn),js=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},No.extend(Vt,{isSafari:y.ac,getPerformanceMetrics:y.bf.getPerformanceMetrics}),Vt}),xn}()}},mu=>{mu(mu.s=310)}]);